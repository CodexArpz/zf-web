<h2>ZF-11967: Connection to RabbitMQ through STOMP causes a timeout</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2012-01-04T16:21:59.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2012-03-08T17:34:44.000+0000</dd>

    <dt>Status:</dt>
    <dd>Open</dd>

    <dt>Fix version(s):</dt>
    <dd><ul></ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Dan Osipov (danospv)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Justin Plock (jplock)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Queue</li>
            <li>zf-crteam-review</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
        <li><a href="/issues/browse/ZF-9958">ZF-9958</a></li>
        </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>Timeout occurs in the Zend_Queue_Stomp_Client_Connection::read function. This is due to incorrect reading of the end of frame.</p>

<p>Switching the two variables around in the condition, so that \0\n signifies the end of message instead of \n\0 fixes the problem. ie
...
if (ord($prev) == 10 &amp;&amp; ord($data) == 0) {
...</p>

<p>See this thread for more info about the end of frame implementation in different clients
<a href="http://activemq.2283324.n4.nabble.com/Stomp-C-Client-frame-end-signature-td2398333.html">http://activemq.2283324.n4.nabble.com/Stomp-C-Clieâ€¦</a></p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>
    <p class="comments">No comments to display</p>
    
</div>

