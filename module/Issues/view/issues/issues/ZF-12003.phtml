<h2>ZF-12003: Zend_Validate_Hostname fails on domain containing dashes</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2012-01-17T07:04:03.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2012-08-17T09:22:06.000+0000</dd>

    <dt>Status:</dt>
    <dd>Open</dd>

    <dt>Fix version(s):</dt>
    <dd><ul></ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Ivan (elgris)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Thomas Weidner (thomas)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Validate</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
        <li><a href="/issues/browse/ZF-12035">ZF-12035</a></li>
        </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>Zend_Validate_Hostname fails on domain containing dashes. E.g. valid cyrillic domain like "вася-пупкин.рф" after processing with 'idn_to_ascii' function becomes invalid for Zend_Validate_Hostname while "васяпупкин.рф" is still valid.
The problem can be in th way Zend_Validate_Hostname processes dashes at the beginning of ascii-represented domains. Thus, 
idn_to_ascii("васяпупкин.рф") results in 'xn--80adthqjaot2j.xn--p1ai' string with two dashes on positions 3 and 4.
idn_to_ascii("вася-пупкин.рф") results in 'xn----7sbf0ajtlapw3k.xn--p1ai' string with FOUR dashes on positions 3-6.
So, condition in Zend_Validate_Hostname at pos.600 fails ((strpos($domainPart, '-') === 0)) and domain becomes invalid.</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Egor Chernodarov (eg321) on 2012-08-17T08:03:48.000+0000</p> 
        <div class="body">
            <p>Seems it's duplicate of <a href="http://framework.zend.com/issues/browse/ZF-12035">http://framework.zend.com/issues/browse/ZF-12035</a>.
Please vote it.</p>

        </div>
    </div>
    </div>

