<h2>ZF-7559: Sqlsrv - The active result for the query contains no fields.</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2009-08-11T04:24:34.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2010-04-16T12:48:55.000+0000</dd>

    <dt>Status:</dt>
    <dd>Closed</dd>

    <dt>Fix version(s):</dt>
    <dd><ul></ul></dd>

    <dt>Reporter:</dt>
    <dd>
        None
                    </dd>

    <dt>Assignee:</dt>
    <dd>
                Juozas Kaziukenas (juokaz)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Db</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>I'm having problems with the following basic query</p>

<p>//$this-&gt;_adapter is an instance of the Sqlsrv adapter
$this-&gt;_adapter-&gt;fetchAll('EXECUTE prcWebPostageCountry');</p>

<p>throws the exception:</p>

<pre class="literal">

The active result for the query contains no fields.

#0 C:\PHP\includes\ZendFramework-1.9.0-minimal\library\Zend\Db\Statement.php(325): Zend_Db_Statement_Sqlsrv-&gt;fetch(5)
#1 C:\PHP\includes\ZendFramework-1.9.0-minimal\library\Zend\Db\Adapter\Abstract.php(707): Zend_Db_Statement-&gt;fetchAll(5)
#2 C:\Documents and Settings\Administrator\My Documents\WORK\_DEVELOPMENT\CPAS4009\application\models\Postage.php(27): Zend_Db_Adapter_Abstract-&gt;fetchAll('EXECUTE prcWebP...')
#3 C:\Documents and Settings\Administrator\My Documents\WORK\_DEVELOPMENT\CPAS4009\application\modules\default\controllers\TestController.php(96): Postage-&gt;getCountryList()
#4 C:\PHP\includes\ZendFramework-1.9.0-minimal\library\Zend\Controller\Action.php(513): TestController-&gt;indexAction()
#5 C:\PHP\includes\ZendFramework-1.9.0-minimal\library\Zend\Controller\Dispatcher\Standard.php(289): Zend_Controller_Action-&gt;dispatch('indexAction')
#6 C:\PHP\includes\ZendFramework-1.9.0-minimal\library\Zend\Controller\Front.php(946): Zend_Controller_Dispatcher_Standard-&gt;dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))
#7 C:\PHP\includes\ZendFramework-1.9.0-minimal\library\Zend\Application\Bootstrap\Bootstrap.php(77): Zend_Controller_Front-&gt;dispatch()
#8 C:\PHP\includes\ZendFramework-1.9.0-minimal\library\Zend\Application.php(335): Zend_Application_Bootstrap_Bootstrap-&gt;run()
#9 C:\Documents and Settings\Administrator\My Documents\WORK\_DEVELOPMENT\CPAS4009\public_html\index.php(49): Zend_Application-&gt;run()
#10 {main}
</pre>

<p>The procedure is valid and runs with the (dodgy) pdo_mssql on windows and in Management Studio Express.</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Juozas Kaziukenas (juokaz) on 2009-08-11T06:15:08.000+0000</p> 
        <div class="body">
            <p>Thanks David,</p>

<p>it seems to be sqlsrv problem <a href="http://social.msdn.microsoft.com/Forums/en-US/sqldriverforphp/thread/fd6015cd-d42f-470d-b8c7-ae9e6786f59c">http://social.msdn.microsoft.com/Forums/en-US/â€¦</a>. I will still try to look at it.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Ralph Schindler (ralph) on 2009-08-17T10:08:54.000+0000</p> 
        <div class="body">
            <p>Changing to "Should Have" for "next mini release".
Marked as Minor, assigned to Juozas.</p>

<p>Appears might be a driver level issue.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Juozas Kaziukenas (juokaz) on 2010-04-09T09:15:22.000+0000</p> 
        <div class="body">
            <p>I need your actual procedure to reproduce, because the ones I tried do work fine.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Juozas Kaziukenas (juokaz) on 2010-04-16T12:48:55.000+0000</p> 
        <div class="body">
            <p>Added working procedure code in r21900</p>

<p>If not working procedure is found - please reopen this.</p>

        </div>
    </div>
    </div>

