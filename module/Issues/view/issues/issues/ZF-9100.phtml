<h2>ZF-9100: Zend_Controller_Dispatcher_Exception after updating Zend from 1.9 to 1.10</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2010-02-06T03:04:53.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2010-02-08T11:14:36.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul>        <li>1.10.1 (10/Feb/10)</li>
    </ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Ernest Szulikowski (est)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Matthew Weier O'Phinney (matthew)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Controller</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
        <li><a href="/issues/secure/attachment/12711/.htaccess">.htaccess</a></li>
            <li><a href="/issues/secure/attachment/12712/application.ini">application.ini</a></li>
            <li><a href="/issues/secure/attachment/12713/Bootstrap.php">Bootstrap.php</a></li>
            <li><a href="/issues/secure/attachment/12714/folders.txt">folders.txt</a></li>
            <li><a href="/issues/secure/attachment/12715/index.php">index.php</a></li>
            <li><a href="/issues/secure/attachment/12716/sample_ZF-9100.zip">sample_ZF-9100.zip</a></li>
        </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>I did not make any changes in my project. After updating ZF library from
<a href="http://framework.zend.com/svn/framework/standard/branches/release-1.9/library/">http://framework.zend.com/svn/framework/…</a>
to
<a href="http://framework.zend.com/svn/framework/standard/branches/release-1.10/library/">http://framework.zend.com/svn/framework/…</a>
I have dispatcher Exceptions:</p>

<p>{{Zend_Controller_Dispatcher_Exception: Invalid controller specified (index) in D:\www\SvnIPMCore\ipmcore\lib\Zend\Controller\Dispatcher\Standard.php}}</p>

<p>and actually can't do anything.
Switching back to 1.9 solves the problem, and makes everything work again...</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Matthew Weier O'Phinney (matthew) on 2010-02-06T05:40:50.000+0000</p> 
        <div class="body">
            <p>Can you please provide information regarding your application setup?
* your application.ini, if you're using Zend_Application
* your Bootstrap class (if you've made any modifications to it)
* your index.php (if different than that generated by Zend_Tool)
* your .htaccess (if different than that generated by Zend_Tool)
* an overview of your directory structure</p>

<p>I have successfully switched from 1.9 to 1.10 without problems; without the above, reproducing the issue will be by conjecture only.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Ernest Szulikowski (est) on 2010-02-06T06:40:39.000+0000</p> 
        <div class="body">
            <p>Thank you for response. I attached affected files. 
I was using my own Routes (while removing the default one), but after deleting all my custom Routes and reverting the default the result was no better.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Ernest Szulikowski (est) on 2010-02-06T08:43:36.000+0000</p> 
        <div class="body">
            <p>I can reproduce this issue with this simple project (included with ZF 1.10).</p>

<p>Expected result:
"Hello Kittie!" displayed in browser
Actual result:
{{Zend_Controller_Dispatcher_Exception: Invalid controller specified (index) in D:\www\html\sample_ZF-9100\lib\Zend\Controller\Dispatcher\Standard.php on line 242}}</p>

<p>The last Call Stack:
{{4. | Zend_Controller_Front-&gt;dispatch( $request = ???, $response = ??? ) | ..\Bootstrap.php:97}}</p>

<p>Tested under Win XP, Apache, PHP 5.3.1</p>

<p>Again, after replacing 1.10 with 1.9 libs I have Expected result, no errors.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Matthew Weier O'Phinney (matthew) on 2010-02-08T10:21:11.000+0000</p> 
        <div class="body">
            <p>I traced the problem -- and it's a combination of two errors in your code, and one that occurs in Zend_Loader::isReadable().</p>

<p>Zend_Loader::isReadable() checks to see if a file is readable on the include_path. In your application, your include_path does not include '.', so checks against absolute paths fail. Adding '.' to the start or end of your include_path fixes this issue.</p>

<p>That said, I've updated Zend_Loader::isReadable() to fix the absolute paths issue.</p>

<p>The next problems is the fact that your application does not include a full ZF installation, and thus several classes that are consumed by the MVC are not present.</p>

<pre class="highlight"><code>
Warning: require_once(Zend/Filter/Inflector.php) [function.require-once]: failed to open stream
</code></pre>

<p>(This class is required by the ViewRenderer).</p>

<p>Please test your application against a full install of ZF, and test to ensure it works against the changes currently in trunk. Open a new issue if you're having problems.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Matthew Weier O'Phinney (matthew) on 2010-02-08T10:22:04.000+0000</p> 
        <div class="body">
            <p>Marking as "incomplete", as part of the issue was a tangentially related issue in Zend_Loader::isReadable(), and the rest was due to issues in the reporter's setup.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Ernest Szulikowski (est) on 2010-02-08T11:14:36.000+0000</p> 
        <div class="body">
            <p>I don't use entire ZF installation as it is simply to big (I just forgot to include Filter in this example, and also what about
bq. "because it has many loosely coupled components that you can use more or less independently."
Usually everything works, and if not I just add required directory in Phing build script.</p>

<p>I can confirm, this was not an issue, adding '.' to set_include_path solved problem with release-1.10.
Also tested against trunk (rev. 20993), and here works ok both ways: with or without '.' in include path.</p>

<p>Many, many thanks.
E.</p>

        </div>
    </div>
    </div>

