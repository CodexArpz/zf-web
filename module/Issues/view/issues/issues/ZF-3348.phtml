<h2>ZF-3348: OpenId check_immediate without log in shouldn't return cancel</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2008-05-29T04:29:23.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2008-09-02T10:39:34.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul>        <li>1.6.0 (02/Sep/08)</li>
    </ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Marko Gräßlin (marko_ekaabo)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Dmitry Stogov (dmitry)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_OpenId</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>OpenId check_Immediate with logged out User returns "openid.mode cancel"  instead  "openid.mode setup_needed" .
The dump of the validator on <a href="http://openidenabled.com/resources/openid-test/checkup">http://openidenabled.com/resources/openid-test/…</a> returns:</p>

<pre><code>*
  Redirecting to &lt;a rel="nofollow" href="http://www.communipedia.com/openid/provide?openid.identity=http%3A%2F%2Fmarko.yiid.net%2F&amp;openid.mode=checkid_immediate&amp;openid.return_to=http%3A%2F%2Fopenidenabled.com%2Fresources%2Fopenid-test%2Fdiagnose-server%2FTestDumbCheckidImmediateSetupNeeded%2F%3Faction%3Dresponse%26attempt%3D1%26nonce%3DYW7sK1df&amp;openid.trust_root=http%3A%2F%2Fopenidenabled.com%2Fresources%2Fopenid-test%2Fdiagnose-server%2FTestDumbCheckidImmediateSetupNeeded%2F"&gt;http://communipedia.com/openid/provide/&amp;hellip;&lt;/a&gt;
  openid.identity   &lt;a rel="nofollow" href="http://marko.yiid.net/"&gt;http://marko.yiid.net/&lt;/a&gt;
  openid.mode   checkid_immediate
  openid.return_to  &lt;a rel="nofollow" href="http://openidenabled.com/resources/openid-test/diagnose-server/TestDumbCheckidImmediateSetupNeeded/?action=response&amp;attempt=1&amp;nonce=YW7sK1df"&gt;http://openidenabled.com/resources/openid-test/&amp;hellip;&lt;/a&gt;
  openid.trust_root &lt;a rel="nofollow" href="http://openidenabled.com/resources/openid-test/diagnose-server/TestDumbCheckidImmediateSetupNeeded/"&gt;http://openidenabled.com/resources/openid-test/&amp;hellip;&lt;/a&gt;
*
  Response received:
  action    response
  attempt   1
  nonce YW7sK1df
  openid.mode   cancel
  openid.user_setup_url &lt;a rel="nofollow" href="http://www.communipedia.com/auth/login?openid.identity=http%3A%2F%2Fmarko.yiid.net%2F&amp;openid.mode=checkid_setup&amp;openid.return_to=http%3A%2F%2Fopenidenabled.com%2Fresources%2Fopenid-test%2Fdiagnose-server%2FTestDumbCheckidImmediateSetupNeeded%2F%3Faction%3Dresponse%26attempt%3D1%26nonce%3DYW7sK1df&amp;openid.trust_root=http%3A%2F%2Fopenidenabled.com%2Fresources%2Fopenid-test%2Fdiagnose-server%2FTestDumbCheckidImmediateSetupNeeded%2F"&gt;http://communipedia.com/auth/login/&amp;hellip;&lt;/a&gt;
* Operation Cancelled.
</code></pre>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Wil Sinclair (wil) on 2008-06-01T12:56:28.000+0000</p> 
        <div class="body">
            <p>Please assign and categorize as necessary. I've preliminarily targeted a release.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Dmitry Stogov (dmitry) on 2008-07-15T10:01:25.000+0000</p> 
        <div class="body">
            <p>Fixed only for OpenID 2.0, because OpenID 1.1 specification says nothing about "setup_needed" response.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Wil Sinclair (wil) on 2008-09-02T10:39:34.000+0000</p> 
        <div class="body">
            <p>Updating for the 1.6.0 release.</p>

        </div>
    </div>
    </div>

