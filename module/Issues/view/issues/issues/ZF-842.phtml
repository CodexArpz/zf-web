<h2>ZF-842: Index creation problem</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2007-02-02T09:09:17.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2007-07-05T14:43:43.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul></ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Alexander Veremyev (alexander)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Alexander Veremyev (alexander)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Search_Lucene</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>Index creation throws an exceptions in DevZone environment:</p>

<hr /><p><br /><b>Warning</b>:  Cannot modify header information - headers already sent by (output started at /home/www/devzone.zend.com-2007-01-0                          2-HappyNewYear-04/www/app/controllers/ReindexController.php:126) in <b>/home/www/devzone.zend.com-2007-01-02-HappyNewYear-04/www/ap                          p/controllers/ReindexController.php</b> on line <b>117</b><br /></p>

<h2>Unexpected Exception: Index compound file doesn't contain _38.fnm file.</h2>

<p><br />#0 /home/www/devzone.zend.com-2007-01-02-Happ                          yNewYear-04/zendlib/library/Zend/Search/Lucene/Index/SegmentInfo.php(153): Zend_Search_Lucene_Index_SegmentInfo-&gt;openCompoundFile('                          .fnm')</p>

<h1>1 /home/www/devzone.zend.com-2007-01-02-HappyNewYear-04/zendlib/library/Zend/Search/Lucene/Index/Writer.php(410): Zend_Search_Luce                          ne_Index_SegmentInfo-&gt;__construct('_38', 10, Object(Zend_Search_Lucene_Storage_Directory_Filesystem))</h1>

<h1>2 /home/www/devzone.zend.com-2007-01-02-HappyNewYear-04/zendlib/library/Zend/Search/Lucene/Index/Writer.php(430): Zend_Search_Luce                          ne_Index_Writer-&gt;_updateSegments()</h1>

<h1>3 /home/www/devzone.zend.com-2007-01-02-HappyNewYear-04/zendlib/library/Zend/Search/Lucene/Index/Writer.php(217): Zend_Search_Luce                          ne_Index_Writer-&gt;commit()</h1>

<h1>4 /home/www/devzone.zend.com-2007-01-02-HappyNewYear-04/zendlib/library/Zend/Search/Lucene.php(802): Zend_Search_Lucene_Index_Writ                          er-&gt;addDocument(Object(Zend_Search_Lucene_Document))</h1>

<h1>5 /home/www/devzone.zend.com-2007-01-02-HappyNewYear-04/www/app/controllers/ReindexController.php(108): Zend_Search_Lucene-&gt;addDoc                          ument(Object(Zend_Search_Lucene_Document))</h1>

<h1>6 /home/www/devzone.zend.com-2007-01-02-HappyNewYear-04/www/app/controllers/ReindexController.php(29): ReindexController::doReinde                          x()</h1>

<h1>7 /home/www/devzone.zend.com-2007-01-02-HappyNewYear-04/zendlib/library/Zend/Controller/Dispatcher.php(436): ReindexController-&gt;Al                          lAction()</h1>

<h1>8 /home/www/devzone.zend.com-2007-01-02-HappyNewYear-04/zendlib/library/Zend/Controller/Front.php(725): Zend_Controller_Dispatcher                          -&gt;dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))</h1>

<h2>#9 /home/www/devzone.zend.com-2007-01-02-HappyNewYear-04/www/index.php(78): Zend_Controller_Front-&gt;dispatch()</h2>

<hr /><h2>Unexpected Exception: Index compound file doesn't contain _33.fnm file.</h2>

<p><br />#0 /home/www/staging.devzone.zend.com/zendlib/library/Zend/Search/Lucene/Index/SegmentInfo.php(153): Zend_Search_Lucene_Index_SegmentInfo-&gt;openCompoundFile('.fnm')</p>

<h1>1 /home/www/staging.devzone.zend.com/zendlib/library/Zend/Search/Lucene/Index/Writer.php(410): Zend_Search_Lucene_Index_SegmentInfo-&gt;__construct('_33', 10, Object(Zend_Search_Lucene_Storage_Directory_Filesystem))</h1>

<h1>2 /home/www/staging.devzone.zend.com/zendlib/library/Zend/Search/Lucene/Index/Writer.php(430): Zend_Search_Lucene_Index_Writer-&gt;_updateSegments()</h1>

<h1>3 /home/www/staging.devzone.zend.com/zendlib/library/Zend/Search/Lucene/Index/Writer.php(217): Zend_Search_Lucene_Index_Writer-&gt;commit()</h1>

<h1>4 /home/www/staging.devzone.zend.com/zendlib/library/Zend/Search/Lucene.php(802): Zend_Search_Lucene_Index_Writer-&gt;addDocument(Object(Zend_Search_Lucene_Document))</h1>

<h1>5 /home/www/staging.devzone.zend.com/www/app/controllers/ReindexController.php(111): Zend_Search_Lucene-&gt;addDocument(Object(Zend_Search_Lucene_Document))</h1>

<h1>6 /home/www/staging.devzone.zend.com/www/app/controllers/ReindexController.php(29): ReindexController::doReindex()</h1>

<h1>7 /home/www/staging.devzone.zend.com/zendlib/library/Zend/Controller/Dispatcher.php(436): ReindexController-&gt;AllAction()</h1>

<h1>8 /home/www/staging.devzone.zend.com/zendlib/library/Zend/Controller/Front.php(725): Zend_Controller_Dispatcher-&gt;dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))</h1>

<h2>#9 /home/www/staging.devzone.zend.com/www/index.php(77): Zend_Controller_Front-&gt;dispatch()</h2>

<p>...</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Alexander Veremyev (alexander) on 2007-02-02T09:15:57.000+0000</p> 
        <div class="body">
            <p>Fixed.</p>

<p>Problem was caused by concurrent index creation.</p>

<p>It may be a result of wget behavior, if it tries to get page within several connections/parts.</p>

        </div>
    </div>
    </div>

