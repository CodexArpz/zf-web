<h2>ZF-2944: File trailer dictionary keys should not be limited</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Improvement</dd>

    <dt>Created:</dt>
    <dd>2008-03-21T18:10:00.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2012-08-31T08:59:54.000+0000</dd>

    <dt>Status:</dt>
    <dd>Open</dd>

    <dt>Fix version(s):</dt>
    <dd><ul></ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Willie Alberty (willie)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Dolf Schimmel (Freeaqingme) (freak)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Pdf</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
        <li><a href="/issues/browse/ZF-2603">ZF-2603</a></li>
        </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>The entries in a PDF document's file trailer dictionary are currently limited to one of the following ten values: Size, Prev, Root, Encrypt, Info, ID, Index, W, XRefStm, DocChecksum</p>

<p>Most of these entry types are described in the current version of the PDF reference. However, for forward-compatibility, this list should not be limited at all. Future versions of the PDF standard may introduce new dictionary keys which our implementation does not recognize. Additionally, other PDF implementations may add keys which do not appear in any version of the standard (see ZF-2603).</p>

<p>Our behavior should be to preserve and ignore any unrecognized keys. Change the Zend_Pdf_Trailer class and subclasses so that no key name validation is performed. Create and use class constants for the trailer keys generated/consumed by the framework to protect against bugs.</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Willie Alberty (willie) on 2008-03-21T18:10:45.000+0000</p> 
        <div class="body">
            <p>Linking to OpenOffice issue which is a practical example of this problem.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Wil Sinclair (wil) on 2008-03-25T20:20:16.000+0000</p> 
        <div class="body">
            <p>Please categorize/fix as needed.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by jim sloan (jsloan) on 2008-10-08T03:53:26.000+0000</p> 
        <div class="body">
            <p>This is still not fixed in version 1.6, but I do see the comment at line 52:
/** @todo Make warning (log entry) instead of an exception */</p>

<p>For now I have to path the code to add 'PDFCreactiveX' to the $_allowedKeys array so that I can process PDF's generated by the Net-It Central publishing software.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Marques Johansson (displague) on 2011-10-19T14:56:30.000+0000</p> 
        <div class="body">
            <p>I don't like modifying ZF source directly because time has a tendency to forget modifications to external libraries.</p>

<p>I ran into this problem with an ABCpdf trailer in a PDF I was trying to parse and append.  I assume this was generated using the VB.net / ASP generator of the same name.</p>

<p>My work-around was to add this block of code before any Zend_Pdf instances are made:</p>

<p>$zpt_other_allowed_keys = array('ABCpdf');
$zpt = new ReflectionProperty('Zend_Pdf_Trailer', '_allowedKeys');
$zpt-&gt;setAccessible(true);
$zpt-&gt;setValue(null, array_merge($zpt-&gt;getValue(), $zpt_other_allowed_keys));</p>

        </div>
    </div>
    </div>

