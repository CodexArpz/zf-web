<h2>ZF-1989: Unit tests under default configuration require exceptionally long time</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Unit Tests: Improvement</dd>

    <dt>Created:</dt>
    <dd>2007-09-24T13:35:13.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2008-03-21T16:25:23.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul>        <li>1.5.0 (17/Mar/08)</li>
    </ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Darby Felton (darby)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Thomas Weidner (thomas)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Currency</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>The unit tests for Zend_Currency under the default configuration appear to require an exceptionally long time to run, relative to the tests for other framework components. If there is some way to significantly improve the performance of these tests without compromising their effectiveness, we should make an effort to do this.</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Thomas Weidner (thomas) on 2007-09-24T15:17:43.000+0000</p> 
        <div class="body">
            <p>On my testbed it requires 6 to 22 seconds...
I added caching tests which increased speed to 3-15 seconds.</p>

<p>But in my opinon even 22 seconds are a normal time for a complete testbed.</p>

<pre class="highlight"><code>
C:\3rdParty\Zend Framework\tests&gt;phpunit --report C:\temp\reports Zend
_CurrencyTest
PHPUnit 3.1.0beta2 by Sebastian Bergmann.

............

Time: 14 seconds


OK (12 tests)

Generating report, this may take a moment.Der Befehl "neato" ist entweder falsch
 geschrieben oder
konnte nicht gefunden werden.
</code></pre>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Darby Felton (darby) on 2007-09-24T15:51:54.000+0000</p> 
        <div class="body">
            <p>Maybe I just need a faster computer. ;)</p>

<p>I was able to get the tests to run in 16 seconds, so I'll resolve this issue.</p>

<p>When I ran the tests, however, I did encounter many many warnings of the following nature:</p>

<pre class="highlight"><code>
Warning: implode(): Argument to implode must be an array. in trunk\library\Zend\Locale\Data.php on line 265

Call Stack:
    0.0016   1. {main}() PEAR\PHPUnit\TextUI\Command.php:0
    0.6633   2. PHPUnit_TextUI_Command::main() PEAR\PHPUnit\TextUI\Command.php:463
    1.1373   3. PHPUnit_TextUI_TestRunner-&gt;doRun() PEAR\PHPUnit\TextUI\Command.php:106
    1.1376   4. PHPUnit_Framework_TestSuite-&gt;run() PEAR\PHPUnit\TextUI\TestRunner.php:299
   17.3058   5. PHPUnit_Framework_TestSuite-&gt;runTest() PEAR\PHPUnit\Framework\TestSuite.php:526
   17.3058   6. PHPUnit_Framework_TestCase-&gt;run() PEAR\PHPUnit\Framework\TestSuite.php:546
   17.3058   7. PHPUnit_Framework_TestResult-&gt;run() PEAR\PHPUnit\Framework\TestCase.php:277
   17.3059   8. PHPUnit_Framework_TestCase-&gt;runBare() PEAR\PHPUnit\Framework\TestResult.php:548
   17.3117   9. PHPUnit_Framework_TestCase-&gt;runTest() PEAR\PHPUnit\Framework\TestCase.php:299
   17.3117  10. ReflectionMethod-&gt;invoke() PEAR\PHPUnit\Framework\TestCase.php:365
   17.3117  11. Zend_CurrencyTest-&gt;testToString() trunk\tests\Zend\CurrencyTest.php:0
   17.3118  12. Zend_Currency-&gt;__construct() trunk\tests\Zend\CurrencyTest.php:495
   17.3295  13. Zend_Currency-&gt;_updateFormat() trunk\library\Zend\Currency.php:188
   17.3295  14. Zend_Locale_Data::getContent() trunk\library\Zend\Currency.php:214
   17.3296  15. implode() trunk\library\Zend\Locale\Data.php:265
</code></pre>

<p>I'll create a separate issue for this.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Thomas Weidner (thomas) on 2007-09-24T15:56:49.000+0000</p> 
        <div class="body">
            <p>These error has already been fixed with SVN 6504 when I added caching support.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Darby Felton (darby) on 2007-09-24T15:56:52.000+0000</p> 
        <div class="body">
            <p>Nevermind - you already fixed it. Thanks, Thomas! :)</p>

        </div>
    </div>
    </div>

