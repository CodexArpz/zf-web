<h2>ZF-9691: Invalid locale is passed to Zend_Date::_calcdetail()</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Patch</dd>

    <dt>Created:</dt>
    <dd>2010-04-16T05:35:48.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2011-10-11T07:45:50.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul>        <li>1.10.4 (28/Apr/10)</li>
    </ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Alexander Grimalovsky (flying)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Thomas Weidner (thomas)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Date</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
        <li><a href="/issues/secure/attachment/13004/Date.patch">Date.patch</a></li>
        </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>Zend_Date::_date() and Zend_Date::_time() are passing invalid locale to Zend_Date::_calcdetail():
$return = $this-&gt;_calcdetail($calc, $time, self::TIMES, 'de'); // 'de' is used instead of $locale</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Alexander Grimalovsky (flying) on 2010-04-16T05:36:51.000+0000</p> 
        <div class="body">
            <p>Patch for fixing issue, created agains rev.21753</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Thomas Weidner (thomas) on 2010-04-16T06:16:20.000+0000</p> 
        <div class="body">
            <p>This is no failure. The code works as intended.</p>

<p>Please give a reproducable example to see what your problem is!</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Thomas Weidner (thomas) on 2010-04-16T09:17:18.000+0000</p> 
        <div class="body">
            <p>Closing as non-issue
No response from the reporter</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Nikita Baksalyar (nbaksalyar) on 2011-07-21T20:42:35.000+0000</p> 
        <div class="body">
            <p>This issue is still present.</p>

<p>Problem example:</p>

<p>$date = Zend_Date::now('en_US');
$date-&gt;addDate('1 month'); // If file "de.xml" is deleted - exception appears ("locale 'de' not found")</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Pawel Szczekutowicz (fenoms) on 2011-10-11T07:45:50.000+0000</p> 
        <div class="body">
            <p>Can confirm this.</p>

<p>Example:
Zend_Date::now()-&gt;setTime('00:00:00', 'HH:mm:ss', 'pl_PL');</p>

<p>If we give locale "pl_PL" method setTime still uses "de" locale (by calling Zend/Date.php(3478): Zend_Date-&gt;set('00:00:00', 'WW', 'de')). Additionally if file "de.xml" is missing an exception occurs.</p>

        </div>
    </div>
    </div>

