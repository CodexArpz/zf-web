<h2>ZF-2501: PDO_MYSQL  MYSQLI failing testcases</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Unit Tests: Problem</dd>

    <dt>Created:</dt>
    <dd>2008-01-26T16:12:12.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2008-12-17T13:36:56.000+0000</dd>

    <dt>Status:</dt>
    <dd>Closed</dd>

    <dt>Fix version(s):</dt>
    <dd><ul></ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Julian Davchev (jmut)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Darby Felton (darby)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Db</li>
            <li>Zend_Db_Adapter_Mysqli</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <h1>1) test case report</h1>

<h1>2) TestConfigure.php</h1>

<h1>3) mysql user privileges</h1>

<h1>4) running system environment</h1>

<h1>1)</h1>

<p>jmut@<a>dexter:/storage/www/frameworks/zendframework/tests</a>$ php Zend/Db/AllTests.php</p>

<p>PHPUnit 3.2.11 by Sebastian Bergmann.</p>

<p>............................................................  60 / 902
..................................I......................... 120 / 902
......................I.......S............................. 180 / 902
........................................................I... 240 / 902
............................................................ 300 / 902
.........................S.................................. 360 / 902
S........................................................... 420 / 902
....................................S....................... 480 / 902
........F....F....F.......................S................. 540 / 902
...............................................E............ 600 / 902
............................................................ 660 / 902
......................................S..................... 720 / 902
.............S..........................S................... 780 / 902
.................................................S.......... 840 / 902
.....................F....F....F.....................SSSSSSS 900 / 902
SS</p>

<p>Time: 03:22</p>

<p>There was 1 error:</p>

<p>1) testZF2059(Zend_Db_Adapter_Pdo_MysqlTest)
Zend_Db_Statement_Exception: SQLSTATE[HY093]: Invalid parameter number: no parameters were bound
/storage/www/frameworks/zendframework/library/Zend/Db/Statement.php:283
/storage/www/frameworks/zendframework/library/Zend/Db/Adapter/Abstract.php:406
/storage/www/frameworks/zendframework/library/Zend/Db/Adapter/Pdo/Abstract.php:206
/storage/www/frameworks/zendframework/library/Zend/Db/Adapter/Abstract.php:613
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:70
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:194</p>

<p>--</p>

<p>There were 6 failures:</p>

<p>1) testTableRelationshipFindParentRowException(Zend_Db_Table_Relationships_MysqliTest)
Failed asserting that two strings are equal.
expected string 
difference      &lt;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx??????&gt;
got string      
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:70
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:194</p>

<p>2) testTableRelationshipFindManyToManyRowsetException(Zend_Db_Table_Relationships_MysqliTest)
Failed asserting that two strings are equal.
expected string 
difference      &lt;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx??????&gt;
got string      
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:70
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:194</p>

<p>3) testTableRelationshipFindDependentRowsetException(Zend_Db_Table_Relationships_MysqliTest)
Failed asserting that two strings are equal.
expected string 
difference      &lt;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx??????&gt;
got string      
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:70
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:194</p>

<p>4) testTableRelationshipFindParentRowException(Zend_Db_Table_Relationships_Pdo_MysqlTest)
Failed asserting that two strings are equal.
expected string 
difference      &lt;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx??????&gt;
got string      
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:70
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:194</p>

<p>5) testTableRelationshipFindManyToManyRowsetException(Zend_Db_Table_Relationships_Pdo_MysqlTest)
Failed asserting that two strings are equal.
expected string 
difference      &lt;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx??????&gt;
got string      
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:70
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:194</p>

<p>6) testTableRelationshipFindDependentRowsetException(Zend_Db_Table_Relationships_Pdo_MysqlTest)
Failed asserting that two strings are equal.
expected string 
difference      &lt;xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx??????&gt;
got string      
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:70
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:194</p>

<p>FAILURES!
Tests: 902, Failures: 6, Errors: 1, Incomplete: 3, Skipped: 18.</p>

<h1>2)</h1>

<p>define('TESTS_ZEND_DB_ADAPTER_PDO_MYSQL_ENABLED',  true);
define('TESTS_ZEND_DB_ADAPTER_MYSQLI_ENABLED',  true);
define('TESTS_ZEND_DB_ADAPTER_MYSQL_HOSTNAME', '127.0.0.1');
define('TESTS_ZEND_DB_ADAPTER_MYSQL_USERNAME', 'test');
define('TESTS_ZEND_DB_ADAPTER_MYSQL_PASSWORD', 'test');
define('TESTS_ZEND_DB_ADAPTER_MYSQL_DATABASE', 't');
define('TESTS_ZEND_DB_ADAPTER_MYSQL_PORT', 3306);</p>

<h1>3)</h1>

<p>mysql&gt; show grants for test@localhost;
+-------------------------------------------------------------------------------------------------------------+
| Grants for test@localhost                                                                                   |
+-------------------------------------------------------------------------------------------------------------+
| GRANT USAGE ON <em>.</em> TO 'test'@'localhost' IDENTIFIED BY PASSWORD '<em>94BDCEBE19083CE2A1F959FD02F964C7AF4CFC29' |
| GRANT SELECT, INSERT, UPDATE, DELETE, CREATE, DROP ON <code>t</code>.</em> TO 'test'@'localhost'                           |
+-------------------------------------------------------------------------------------------------------------+</p>

<h1>4)</h1>

<p>RUNNING SYSTEM:</p>

<h1>Kernel: 2.6.22.1</h1>

<h1>PHP 5.2.5 (cli) (built: Nov 10 2007 14:12:24)</h1>

<p>with Xdebug v2.0.2, Copyright (c) 2002-2007, by Derick Rethans</p>

<h1>DRIVERS: (from phpinfo())</h1>

<p>mysqli Client API library version   5.0.45
PDO drivers     mysql, sqlite, sqlite2
PDO Driver for MySQL, client library version    5.0.45</p>

<h1>Using ZF: rev 7644</h1>

<h1>PHPUnit 3.2.11</h1>

<h1>Slackware current</h1>

<h1>System:</h1>

<p>./configure --prefix=/usr --enable-force-cgi-redirect --enable-fastcgi --enable-pcntl --enable-readline --enable-sigchild --prefix=/usr --sysconfdir=/etc --disable-safe-mode --enable-apc --enable-apc-mmap --enable-memory-limit --enable-suhosin --disable-magic-quotes --enable-zend-multibyte --enable-mbregex --enable-tokenizer=shared --with-config-file-scan-dir=/etc/php --with-config-file-path=/etc/httpd --with-mod_charset --with-layout=PHP --enable-sigchild --enable-xml --with-libxml-dir=/usr --enable-simplexml --enable-spl --enable-filter --disable-debug --with-openssl=shared --with-pcre-regex=/usr --with-zlib=shared,/usr --enable-bcmath=shared --with-bz2=shared,/usr --enable-calendar=shared --enable-ctype=shared --with-curl=shared --with-curlwrappers --enable-dba=shared --with-gdbm=/usr --with-db4=/usr --enable-dbase=shared --enable-exif=shared --enable-ftp=shared --with-gd=shared --with-jpeg-dir=/usr --with-png-dir=/usr --with-zlib-dir=/usr --with-xpm-dir=/usr --with-freetype-dir=/usr --with-t1lib=/usr --enable-gd-native-ttf --enable-gd-jis-conv --with-gettext=shared,/usr --with-gmp=shared,/usr --with-iconv=shared --with-imap-ssl=/usr --with-imap=/usr/local/lib/c-client --with-ldap=shared --enable-mbstring=shared --with-hash --with-mhash=shared,/usr --with-mysql=shared,/usr --with-mysqli=shared,/usr/bin/mysql_config --enable-pdo=shared --with-pdo-mysql=shared,/usr --with-pdo-sqlite=shared --with-pspell=shared,/usr --with-mm=/usr --enable-shmop=shared --with-snmp=shared,/usr --enable-soap=shared --enable-sockets --with-sqlite=shared --enable-sqlite-utf8 --with-regex=php --enable-sysvmsg --enable-sysvsem --enable-sysvshm --enable-wddx=shared --with-xsl=shared,/usr --enable-zip=shared --with-tsrm-pthreads --enable-shared=yes --enable-static=no --with-gnu-ld --with-pic --build=i486-slackware-linux</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Darby Felton (darby) on 2008-03-06T10:16:31.000+0000</p> 
        <div class="body">
            <p>I cannot reproduce this problem with the latest trunk version. Julian, can you verify that this issue still exists for you with latest SVN of trunk?</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Darby Felton (darby) on 2008-03-06T10:17:26.000+0000</p> 
        <div class="body">
            <p>Resolving as cannot reproduce. Please feel free to reopen if the issue is found to exist with latest trunk.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Julian Davchev (jmut) on 2008-03-07T02:14:13.000+0000</p> 
        <div class="body">
            <p>For some reason I don't have privilege to reopen ticket.  I don't have section "Available workflow actions" sections</p>

<p>jmut@<a>dexter:/storage/www/frameworks/zendframework/tests</a>$ php Zend/Db/AllTests.php
PHPUnit 3.2.13 by Sebastian Bergmann.</p>

<p>............................................................  60 / 972
............................................I............... 120 / 972
..........................................I.......S......... 180 / 972
............................................................ 240 / 972
...................I........................................ 300 / 972
..........................................................S. 360 / 972
..................................S......................... 420 / 972
............................................................ 480 / 972
....................S....................................... 540 / 972
...........................S................................ 600 / 972
...................................E........................ 660 / 972
............................................................ 720 / 972
....................................S....................... 780 / 972
............S..........................S.................... 840 / 972
..........................................................S. 900 / 972
............................................................ 960 / 972
...SSSSSSSSS</p>

<p>Time: 01:04</p>

<p>There was 1 error:</p>

<p>1) testZF2059(Zend_Db_Adapter_Pdo_MysqlTest)
Zend_Db_Statement_Exception: SQLSTATE[HY093]: Invalid parameter number: no parameters were bound
/storage/www/frameworks/zendframework/library/Zend/Db/Statement.php:283
/storage/www/frameworks/zendframework/library/Zend/Db/Adapter/Abstract.php:406
/storage/www/frameworks/zendframework/library/Zend/Db/Adapter/Pdo/Abstract.php:206
/storage/www/frameworks/zendframework/library/Zend/Db/Adapter/Abstract.php:617
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:70
/storage/www/frameworks/zendframework/tests/Zend/Db/AllTests.php:194</p>

<p>FAILURES!
Tests: 972, Errors: 1, Incomplete: 3, Skipped: 18.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Julian Davchev (jmut) on 2008-03-07T02:21:55.000+0000</p> 
        <div class="body">
            <p>above test + error is using revision 8625</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Darby Felton (darby) on 2008-03-07T08:12:57.000+0000</p> 
        <div class="body">
            <p>Reopening on behalf of [~jmut].</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Darby Felton (darby) on 2008-03-07T13:25:35.000+0000</p> 
        <div class="body">
            <p>The failures have been fixed, and the only error left is related to ZF-2059, which remains open.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Wil Sinclair (wil) on 2008-12-17T13:36:56.000+0000</p> 
        <div class="body">
            <p>Bookkeeping. Closing and assigning all old unassigned issues. The only unassigned issues should be new and unreviewed.</p>

        </div>
    </div>
    </div>

