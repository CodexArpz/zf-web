<h2>ZF-8839: Zend_Db_Adapter_Sqlsrv: Attempted to connect to a server of version 9. Only connections to SQL Server 2000 (8) or later are supported.</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2010-01-16T07:56:09.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2010-04-16T05:42:39.000+0000</dd>

    <dt>Status:</dt>
    <dd>Closed</dd>

    <dt>Fix version(s):</dt>
    <dd><ul></ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Denis Brumann (brumann)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Juozas Kaziukenas (juokaz)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Db</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>When trying to connect to a SQL Server 2005-database (v9.0.4053) using Zend_Db_Adapter_Sqlsrv in ZF 1.9.7 and 1.10.0 Beta1 I get the following error message:</p>

<p>Attempted to connect to a server of version 9. Only connections to SQL Server 2000 (8) or later are supported.</p>

<p>When using ZF 1.9.5 (bundled with Zend Server CE 4.0.6) everything works fine.
For testing purposes I just ran the following two lines of code in my IndexController:</p>

<p>$db = Zend_Db_Table_Abstract::getDefaultAdapter();
$db-&gt;describeTable($tableName);</p>

<p>using the following configuration in application.ini:</p>

<p>resources.db.adapter = "Sqlsrv"
resources.db.params.host = "localhost"
resources.db.params.dbname = "AdventureWorks"
resources.db.params.username = "username"
resources.db.params.password = "password"
resources.db.params.driver_options.CharacterSet = "UTF-8"</p>

<p>Stack trace:</p>

<h1>0 D:\Web\lib\Zend\Db\Adapter\Abstract.php(448): Zend_Db_Adapter_Sqlsrv-&gt;_connect()</h1>

<h1>1 D:\Web\lib\Zend\Db\Adapter\Sqlsrv.php(437): Zend_Db_Adapter_Abstract-&gt;query('exec sp_columns...')</h1>

<h1>2 D:\Web\app\modules\frontend\controllers\IndexController.php(13): Zend_Db_Adapter_Sqlsrv-&gt;describeTable('Person.Address')</h1>

<h1>3 D:\Web\lib\Zend\Controller\Action.php(513): IndexController-&gt;indexAction()</h1>

<h1>4 D:\Web\lib\Zend\Controller\Dispatcher\Standard.php(289): Zend_Controller_Action-&gt;dispatch('indexAction')</h1>

<h1>5 D:\Web\lib\Zend\Controller\Front.php(946): Zend_Controller_Dispatcher_Standard-&gt;dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Ht in D:\Web\lib\Zend\Db\Adapter\Sqlsrv.php on line 167</h1>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Denis Brumann (brumann) on 2010-01-22T10:11:30.000+0000</p> 
        <div class="body">
            <p>The problem can be closed, as this was merely caused by a missing "." PATH_SEPARATOR in the include_path. I apologise for anyy inconvinience.</p>

        </div>
    </div>
    </div>

