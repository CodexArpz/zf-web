<h2>ZF-10143: Sqlsrv should display also the SQL statement in case of an execption</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Improvement</dd>

    <dt>Created:</dt>
    <dd>2010-07-13T01:01:30.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2012-11-20T21:37:54.000+0000</dd>

    <dt>Status:</dt>
    <dd>Open</dd>

    <dt>Fix version(s):</dt>
    <dd><ul></ul></dd>

    <dt>Reporter:</dt>
    <dd>
        None
                    </dd>

    <dt>Assignee:</dt>
    <dd>
        None
                    </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Db</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
        <li><a href="/issues/browse/ZF-10086">ZF-10086</a></li>
        </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>Componend: Zend_Db_Adapter_Sqlsrv
File: \Zend\Db\Statement\sqlsrv.php
Line 205: throw new Zend_Db_Statement_Sqlsrv_Exception(sqlsrv_errors());</p>

<p>In case of an SQL error the line 205 return only the SQL error message, which may look like this:</p>

<p>[Microsoft][SQL Server Native Client 10.0][SQL Server]Incorrect syntax near the keyword 'WHERE'.
File: Sqlsrv.php, Line: 205</p>

<p>Debugging would be easier if the SQL statement is also returned. So please change to something like</p>

<p>Line 205: throw new Zend_Db_Statement_Sqlsrv_Exception(sqlsrv_errors() . " when executing " . $this-&gt;_originalSQL);</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Dolf Schimmel (Freeaqingme) (freak) on 2010-07-16T17:14:16.000+0000</p> 
        <div class="body">
            <p>I don't agree, this is not the intention of exception messages. If you want to retrieve the original query you should catch the exception, and use the db profiler in order to get the actual query/queries.</p>

        </div>
    </div>
    </div>

