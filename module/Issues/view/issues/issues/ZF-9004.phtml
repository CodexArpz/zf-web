<h2>ZF-9004: Zend_Validate_File_isImage doesn't allow all image mime types</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Improvement</dd>

    <dt>Created:</dt>
    <dd>2010-01-29T01:45:07.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2010-02-22T14:44:23.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul>        <li>1.10.2 (24/Feb/10)</li>
    </ul></dd>

    <dt>Reporter:</dt>
    <dd>
        None
                    </dd>

    <dt>Assignee:</dt>
    <dd>
                Thomas Weidner (thomas)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Validate_File</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>...
Within the constructor it defines all allowed image mime types but you can't define really all.
I think it's better to remove all 'image/*' types and add a simple 'image' to allowed mime list.</p>

<p>For example currently "image/pjpeg" isn't an image.</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Thomas Weidner (thomas) on 2010-01-29T02:44:44.000+0000</p> 
        <div class="body">
            <p>Nope:</p>

<p>This would unsecure this validator as someone could simply set a own type like "image/blabla" which would then be accepted.</p>

<p>On the other hand there are some mimetypes which are NO images and still use the image mimetype (image processing programs). These are actually NOT accepted by this validator.</p>

<p>The existing list of mimetypes is build from the official accepted mimetype list. You can still add own mimetypes or also set "images" when you want to get unsecure.</p>

<p>Other image-types could be added per request, but until now there was none.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Marc Bennewitz (GIATA mbH) (mben) on 2010-01-29T03:16:01.000+0000</p> 
        <div class="body">
            <blockquote>
  <p>This would unsecure this validator as someone could simply set a own type like "image/blabla" which would then be accepted.
  He can set an own type to one of the accepted type (e.g. "image/jpeg"), too.
  Additionally is has only effect if headerCheck is activated and no mimetype functions are available.</p>
  
  <p>On the other hand there are some mimetypes which are NO images and still use the image mimetype (image processing programs). These are actually NOT accepted by this validator.
  OK, this makes sense. But for example the mimetype "image/jpeg" passes on *.jgw (JPEG world file), too.</p>
</blockquote>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Thomas Weidner (thomas) on 2010-02-22T14:44:23.000+0000</p> 
        <div class="body">
            <p>Fixed with r21138</p>

        </div>
    </div>
    </div>

