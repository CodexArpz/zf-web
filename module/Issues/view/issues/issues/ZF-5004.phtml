<h2>ZF-5004: Zend_OpenId_Consumer - Fails to associate with the provider</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2008-11-20T04:34:30.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2008-12-21T05:47:41.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul>        <li>1.7.1 (01/Dec/08)</li>
    </ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Shunmuga Prasath (shunmugaprasath)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Dmitry Stogov (dmitry)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_OpenId</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>Zend_OpenId_Consumer fails to associate with the openID provider. Tried two providers, verisign and myopenid.</p>

<p>The method  _associate in Zend_OpenId_Consumer returns false. The following condition</p>

<p>if (strlen($secret) != 32) {
                return false;
            }</p>

<p>fails and hence consumer is not able to associate with provider. When i do a var_dump of $secret i get (length=32). but strlen doesnt return 32 making the above condition false.</p>

<p>Update:-
   I do have mbstring installed. Below is the what phpinfo shows</p>

<p>mbstring
Multibyte Support   enabled
Multibyte string engine     libmbfl
Multibyte (japanese) regex support  enabled
Multibyte regex (oniguruma) version     3.7.1</p>

<p>mbstring extension makes use of "streamable kanji code filter and converter", which is distributed under the GNU Lesser General Public License version 2.1.</p>

<p>Directive   Local Value Master Value
mbstring.detect_order   no value    no value
mbstring.encoding_translation   Off Off
mbstring.func_overload  2   2
mbstring.http_input pass    pass
mbstring.http_output    pass    pass
mbstring.internal_encoding  UTF-8   UTF-8
mbstring.language   neutral neutral
mbstring.script_encoding    no value    no value
mbstring.strict_detection   Off Off
mbstring.substitute_character   no value    no value</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Dmitry Stogov (dmitry) on 2008-12-01T03:10:51.000+0000</p> 
        <div class="body">
            <p>Do you have ext/mbstring installed? I suppose it might be the reason of this failure.</p>

        </div>
    </div>
    </div>

