<h2>ZF-11171: Zend_Translate_Adapter_Gettext fopens and doesn't fclose</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2011-03-14T07:44:00.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2011-08-30T19:22:59.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul>        <li>1.11.6 (05/May/11)</li>
    </ul></dd>

    <dt>Reporter:</dt>
    <dd>
                John Flatness (zerocrates)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Adam Lundrigan (adamlundrigan)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Translate</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>In _loadTranslationData, Zend_Translate_Adapter_Gettext fopens the translation file and never fcloses it.</p>

<p>This can result in PHP holding a lot of open file handles for files that, as far as I can tell, have already been fully processed. Handles for any invalid files encountered during a scan are also held.</p>

<p>In particular, it seems like there should be fclose calls before both "is not a gettext file" exception throws and before the function returns.</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Adam Lundrigan (adamlundrigan) on 2011-04-30T06:49:32.000+0000</p> 
        <div class="body">
            <p>Fixed in trunk r23903</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Satoru Yoshida (satoruyoshida) on 2011-05-03T11:20:46.000+0000</p> 
        <div class="body">
            <p>Hello, Adam. I will push [solve] button as proxy for You.
If You want to release at next mini, You can merge this commit fron trunk to 1.11 branch.</p>

<p>Thanks.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Thomas Weidner (thomas) on 2011-05-03T14:22:58.000+0000</p> 
        <div class="body">
            <p>Adam, thnx for your fix</p>

<p>Still reopening this issue</p>

<p>Please do actually not close I18n related issues as I18n is being reworked. This is intentionally</p>

<p>Thnx</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Satoru Yoshida (satoruyoshida) on 2011-05-03T15:05:07.000+0000</p> 
        <div class="body">
            <p>You can find in 1.11 branch at r23961</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Ralph Schindler (ralph) on 2011-05-03T17:01:04.000+0000</p> 
        <div class="body">
            <p>Thomas, unless the commit doesn't look good, and you have valid issues with the work done, please don't reassign and reopen.  Adam did acceptable work, it was reviewed and approved.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Thomas Weidner (thomas) on 2011-08-30T19:22:30.000+0000</p> 
        <div class="body">
            <p>@Ralph: As there was no response to my request regarding I18n components I integrated it within ZF2 with <a href="https://github.com/zendframework/zf2/pull/277">GH-277</a>. If this is against your intention on how I have to handle issues for my components please state it and I will remove it again from ZF2.</p>

        </div>
    </div>
    </div>

