<h2>ZF-11344: HtmlEntities filter can return empty string when string contains invalid characters for current character set</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2011-05-04T15:37:01.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2011-05-04T19:45:22.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul>        <li>1.11.6 (05/May/11)</li>
    </ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Matthew Weier O'Phinney (matthew)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Matthew Weier O'Phinney (matthew)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Filter</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>When a string provided to htmlentities() contains characters not understood by the current character set (or the character set passed to htmlentities()), the function returns an empty string.</p>

<p>When used as part of a form element or input filter, this could actually lead to an invalid value, as the validators may have correctly validated the value, but then filtering may result in an empty string. This can then lead to SQL issues (if the value is passed to a database, and the database expects a particular range of values).</p>

<p>Ideally, the value should be converted to the charset specified to the filter (or the default if none specified) if an empty string is detected following the htmlentities() call.</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Matthew Weier O'Phinney (matthew) on 2011-05-04T18:57:45.000+0000</p> 
        <div class="body">
            <p>Issue is now fixed in trunk and 1.11 release branch.</p>

        </div>
    </div>
    </div>

