<h2>ZF-10355: Additional option to Zend_Application_Resource_Multidb and Zend_Application_Resource_Db for adding Adapter(s) to Zend_Registry</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Improvement</dd>

    <dt>Created:</dt>
    <dd>2010-08-21T12:15:40.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2011-06-04T01:18:26.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul></ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Chris Martin (cgmartin)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Dolf Schimmel (Freeaqingme) (freak)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Application_Resource</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
        <li><a href="/issues/browse/ZF-9903">ZF-9903</a></li>
        </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
        <li><a href="/issues/secure/attachment/13262/zfTrunkRoot.diff">zfTrunkRoot.diff</a></li>
        </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>Needed a way for Zend_Application_Resource_Session, when using Zend_Session_SaveHandler_DbTable, to explicitly set the DbAdapter when also using Zend_Application_Resource_Multidb and when the necessary Session adapter was NOT the Zend_Db_Table default adapter.</p>

<p>By optionally adding the Multidb adapters to the Zend_Registry via a 'registryKey' option, you are able to use any of your configured Multidb adapters for the Zend_Session_SaveHandler_DbTable, regardless of the default adapter.</p>

<p>Similar discussion found here: <a href="http://zend-framework-community.634137.n4.nabble.com/Zend-Application-Resource-Multidb-td1460058.html">http://zend-framework-community.634137.n4.nabble.com/â€¦</a></p>

<p>See attached patch file. Added new 'registryKey' option to Multidb and Db Resource classes, with updated docs and unit tests. Added it to Zend_Application_Resource_Db since there appeared to be concern about backwards compatibility from Multidb in the Nabble discussion by Ralph Schindler.</p>

<p>Patched against trunk r22874.</p>

<p>M       tests/Zend/Application/Resource/MultidbTest.php
M       tests/Zend/Application/Resource/DbTest.php
M       library/Zend/Application/Resource/Multidb.php
M       library/Zend/Application/Resource/Db.php
M       documentation/manual/en/module_specs/Zend_Application-AvailableResources-Db.xml
M       documentation/manual/en/module_specs/Zend_Application-AvailableResources-Multidb.xml</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Chris Martin (cgmartin) on 2010-08-21T12:16:34.000+0000</p> 
        <div class="body">
            <p>M       tests/Zend/Application/Resource/MultidbTest.php
M       tests/Zend/Application/Resource/DbTest.php
M       library/Zend/Application/Resource/Multidb.php
M       library/Zend/Application/Resource/Db.php
M       documentation/manual/en/module_specs/Zend_Application-AvailableResources-Db.xml
M       documentation/manual/en/module_specs/Zend_Application-AvailableResources-Multidb.xml</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Dolf Schimmel (Freeaqingme) (freak) on 2010-08-21T12:33:22.000+0000</p> 
        <div class="body">
            <p>We're moving away from storing everything in a singleton instance of zend_registry, and rather save everything in zend_app, which acts as DI container. Having said that, we'd have to discuss if we want it to be all stored in zend_registry.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Chris Martin (cgmartin) on 2010-08-21T13:59:30.000+0000</p> 
        <div class="body">
            <p>Understood. Thank you for reviewing.</p>

<p>Yes perhaps some kind of registry attached to zend_app that the application resources can interact with to access these types of shared objects.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Dolf Schimmel (Freeaqingme) (freak) on 2011-06-04T01:18:26.000+0000</p> 
        <div class="body">
            <p>Closing as wont-fix for the reasons outlined above.</p>

        </div>
    </div>
    </div>

