<h2>ZF-5965: Does not work with livejournal.com</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2009-03-08T04:48:47.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2009-05-04T11:37:04.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul>        <li>1.8.0 (30/Apr/09)</li>
    </ul></dd>

    <dt>Reporter:</dt>
    <dd>
        None
                    </dd>

    <dt>Assignee:</dt>
    <dd>
                Dmitry Stogov (dmitry)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_OpenId</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
        <li><a href="/issues/browse/ZF-5818">ZF-5818</a></li>
        </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>Warning: parse_url(/auth/openid?openid.mode=id_res&amp;openid.claimed_id=<a href="http://akiraspb.livejournal.com/&amp;openid.identity=http://akiraspb.livejournal.com/&amp;openid.return_to=http://2qo.dev/auth/openid&amp;openid.response_nonce=2009-03-08T11:44:21ZaAPUC8&amp;openid.assoc_handle=1236467514:uKI7h5rRhnZiviaBbkJn:fc886b3944&amp;openid.signed=mode,claimed_id,identity,return_to,response_nonce,assoc_handle&amp;openid.sig=/jpC8xacTcZahBuraZ2eHE/%2BYVI%3D">http://akiraspb.livejournal.com/&amp;openid.identity=h…</a>) [function.parse-url]: Unable to parse URL in /Users/akira/Projects/2qo.dev/library/Zend/Controller/Request/Http.php on line 391</p>

<p>Warning: parse_url(/auth/openid?openid.mode=id_res&amp;openid.claimed_id=<a href="http://akiraspb.livejournal.com/&amp;openid.identity=http://akiraspb.livejournal.com/&amp;openid.return_to=http://2qo.dev/auth/openid&amp;openid.response_nonce=2009-03-08T11:44:21ZaAPUC8&amp;openid.assoc_handle=1236467514:uKI7h5rRhnZiviaBbkJn:fc886b3944&amp;openid.signed=mode,claimed_id,identity,return_to,response_nonce,assoc_handle&amp;openid.sig=/jpC8xacTcZahBuraZ2eHE/%2BYVI%3D">http://akiraspb.livejournal.com/&amp;openid.identity=h…</a>) [function.parse-url]: Unable to parse URL in /Users/akira/Projects/2qo.dev/library/Zend/Controller/Request/Http.php on line 392</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by akira (akira.spb) on 2009-03-08T04:49:41.000+0000</p> 
        <div class="body">
            <p>Скорее бы починили :(</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by thing2b (thing2b) on 2009-03-22T13:18:09.000+0000</p> 
        <div class="body">
            <p>This seems to be caused by the same problem as <a href="http://framework.zend.com/issues/browse/ZF-5818">http://framework.zend.com/issues/browse/ZF-5818</a></p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by akira (akira.spb) on 2009-04-08T13:52:56.000+0000</p> 
        <div class="body">
            <p>Код из примера <a href="http://framework.zend.com/manual/en/zend.openid.consumer.html">http://framework.zend.com/manual/en/…</a>
Да там любой пример не будет работать с ЖЖ или блоггером. chi.mp тоже не работает.
работает только myopenid.com</p>

<p>Валится  parse_url только ЖЖ, остальные ошибок не выдают, просто редиректит и не авторизует.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by akira (akira.spb) on 2009-04-08T13:55:14.000+0000</p> 
        <div class="body">
            <p>Вот такой вид редиректа: <a href="http://2qo.ru/auth/openid?openid.mode=id_res&amp;openid.claimed_id=http://akiraspb.livejournal.com/&amp;openid.identity=http://akiraspb.livejournal.com/&amp;openid.return_to=http://2qo.ru/auth/openid&amp;openid.response_nonce=2009-04-08T20:45:28ZK0BDoM&amp;openid.assoc_handle=1239223526:wYvDPmVQFtt9iCoqUiwP:c63c604a4b&amp;openid.signed=mode,claimed_id,identity,return_to,response_nonce,assoc_handle&amp;openid.sig=bQH3E8HdSBp1ARODAjWxKqqoXL0%3D">http://2qo.ru/auth/openid/…</a></p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Aleksey Rechinskiy (arech) on 2009-05-01T01:45:54.000+0000</p> 
        <div class="body">
            <p>LiveJournal.com is the most popular blogging engine in Russia and nearby countries. You may want to look at <a href="http://blogs.yandex.ru/">http://blogs.yandex.ru/</a> at "СЕРВИСЫ" frame to see, that it is as twice as popular as nearest competitor "Блоги@Mail.Ru" and more than 5 times as popular as Blogger.com.</p>

<p>It is vital to any OpenID solution to support LiveJournal...
I like Zend Framework very much, it has already saved me a lot of time and It would be very nice, when Zend_OpenID will be fixed to support LiveJournal.</p>

<p>Thanks for understanding.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Joel Rodrigues (jdrodrigues) on 2009-05-02T02:02:46.000+0000</p> 
        <div class="body">
            <p>I just succeeded in using livejournal.com with ZendFramework-1.8.0-minimal without issues.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Alexander Veremyev (alexander) on 2009-05-04T09:14:25.000+0000</p> 
        <div class="body">
            <h2>Dmitry's answer:</h2>

<p>I'm not sure what's wrong.
I just was able to login to ZendFramework consumer using livejornal openid account without problems.</p>

<p>According to parse_url() documentation at [<a href="http://www.php.net/manual/en/function.parse-url.php">http://php.net/manual/en/…</a>] it doesn't work with relative URLs.</p>

<h2>Zend_OpenId doesn't use parse_url() directly, so it's probably nothing can be fixed there.</h2>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Alexander Veremyev (alexander) on 2009-05-04T09:15:38.000+0000</p> 
        <div class="body">
            <h2>Shahar's answer:</h2>

<h2>From the little I can make out of it (sorry, most of the bug report is in Russian which I can't read) the problem is Zend_Controller related (and not Zend_Http) so I don't know a lot about it.</h2>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Alexander Veremyev (alexander) on 2009-05-04T09:18:29.000+0000</p> 
        <div class="body">
            <p>Issue is probably [<a href="http://2qo.ru/">http://2qo.ru/</a>] related.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Alexander Veremyev (alexander) on 2009-05-04T10:58:14.000+0000</p> 
        <div class="body">
            <h2>Additional info from Alexander (akira):</h2>

<h2>It's not only [<a href="http://2qo.ru/">http://2qo.ru/</a>] problem, all my zf 1.7 based projects don't give full openid support.</h2>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Alexander Veremyev (alexander) on 2009-05-04T11:13:37.000+0000</p> 
        <div class="body">
            <p>It seems it duplicates [ZF-5818] which is actually closed now</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Alexander Veremyev (alexander) on 2009-05-04T11:37:04.000+0000</p> 
        <div class="body">
            <p>Already fixed.</p>

<p>See <a href="http://framework.zend.com/code/changelog/Zend_Framework?cs=14900">cs-14900</a>.</p>

        </div>
    </div>
    </div>

