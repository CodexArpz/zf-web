<h2>ZF-2603: Unknown trailer dictionary key 'DocChecksum' with OpenOffice-made PDF</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Bug</dd>

    <dt>Created:</dt>
    <dd>2008-02-08T11:41:31.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2008-03-21T18:29:06.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul>        <li>1.5.1 (25/Mar/08)</li>
    </ul></dd>

    <dt>Reporter:</dt>
    <dd>
        None
                    </dd>

    <dt>Assignee:</dt>
    <dd>
                Logan Buesching (ljbuesch)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Pdf</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
        <li><a href="/issues/browse/ZF-2944">ZF-2944</a></li>
        </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
        <li><a href="/issues/secure/attachment/11187/SampleDocument.odt">SampleDocument.odt</a></li>
            <li><a href="/issues/secure/attachment/11186/SampleDocument.pdf">SampleDocument.pdf</a></li>
        </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>I opened a document in OpenOffice 2.3, and exported it to PDF with the default values.  When I tried to load the PDF document, I got the following exception thrown:</p>

<p>Fatal error: Uncaught exception 'Zend_Pdf_Exception' with message 'Unknown trailer dictionary key: 'DocChecksum'.' in Zend/Pdf/Trailer.php:53 Stack trace: #0 Zend/Pdf/Trailer.php(68): Zend_Pdf_Trailer-&gt;_checkDictKey('DocChecksum')</p>

<h1>1 Zend/Pdf/Trailer/Keeper.php(64): Zend_Pdf_Trailer-&gt;__construct(Object(Zend_Pdf_Element_Dictionary))</h1>

<h1>2 Zend/Pdf/Parser.php(335): Zend_Pdf_Trailer_Keeper-&gt;__construct(Object(Zend_Pdf_Element_Dictionary), Object(Zend_Pdf_Element_Reference_Context))</h1>

<h1>3 Zend/Pdf/Parser.php(455): Zend_Pdf_Parser-&gt;_loadXRefTable('1197829')</h1>

<h1>4 Zend/Pdf.php(291): Zend_Pdf_Parser-&gt;__construct('system/applicat...', Object(Zend_Pdf_ElementFactory_Proxy), true)</h1>

<h1>5 Zend/Pdf.php(244): Z in Zend/Pdf/Trailer.php on line 53</h1>

<p>How to reproduce:
Open OpenOffice v2.3, enter any text, and export to PDF.  Then try to load that document using Zend_Pdf.</p>

<p>Suggested fix:
Unless you're against adding the DocChecksum key to the $_allowedKeys, I would just add it to it.</p>

<p>Tested on 1.0.2, but pretty sure the problem exists in 1.0.3.</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Andries Seutens (andries) on 2008-03-17T04:26:06.000+0000</p> 
        <div class="body">
            <p>Updated fix versions</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Willie Alberty (willie) on 2008-03-18T01:28:49.000+0000</p> 
        <div class="body">
            <p>Logan, I don't have OpenOffice on my computer. Can you upload a sample document so I can take a closer look?</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Andries Seutens (andries) on 2008-03-19T02:50:39.000+0000</p> 
        <div class="body">
            <p>The code freeze for 1.5.1 releases is currently scheduled for 21:00 (9:00pm) PST (GMT-8) on Friday, March 21. Would it be possible to address this issue before then? It would be sincerely appreciated :)</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Willie Alberty (willie) on 2008-03-19T10:31:54.000+0000</p> 
        <div class="body">
            <p>I can fix it this week if someone is able to upload a sample document from OpenOffice.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Andries Seutens (andries) on 2008-03-19T10:52:20.000+0000</p> 
        <div class="body">
            <p>I attached a sample PDF export from an open office document. I have not verified if the error occures with this file.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Andries Seutens (andries) on 2008-03-19T10:52:43.000+0000</p> 
        <div class="body">
            <p>also attached the source document.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Willie Alberty (willie) on 2008-03-21T18:28:14.000+0000</p> 
        <div class="body">
            <p>Added "DocChecksum" to the valid trailer dictionary keys. Created ZF-2603 to remove trailer key limitations altogether.</p>

<p>Fixed in trunk and 1.5.1. Please verify and close.</p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Willie Alberty (willie) on 2008-03-21T18:29:06.000+0000</p> 
        <div class="body">
            <p>That is, created ZF-2944 to remove trailer key limitations altogether.</p>

        </div>
    </div>
    </div>

