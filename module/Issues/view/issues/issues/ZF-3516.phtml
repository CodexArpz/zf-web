<h2>ZF-3516: Zend_Filter_HtmlEntities should support htmlentities() fourth argument double_encode</h2>

<dl class="metadata">
    <dt>Issue Type:</dt>
    <dd>Improvement</dd>

    <dt>Created:</dt>
    <dd>2008-06-26T07:02:30.000+0000</dd>

    <dt>Last Updated:</dt>
    <dd>2009-06-20T06:35:15.000+0000</dd>

    <dt>Status:</dt>
    <dd>Resolved</dd>

    <dt>Fix version(s):</dt>
    <dd><ul>        <li>1.9.0 (31/Jul/09)</li>
    </ul></dd>

    <dt>Reporter:</dt>
    <dd>
                Oren Sol (stanzapub)
            </dd>

    <dt>Assignee:</dt>
    <dd>
                Thomas Weidner (thomas)
            </dd>

    <dt>Tags:</dt>
    <dd><ul>        <li>Zend_Filter</li>
        </ul></dd>

    <dt>Related issues:</dt>
    <dd><ul>
    </ul></dd>

    <dt>Attachments:</dt>
    <dd><ul>
    </ul></dd>
</dl>

<div class="description">
    <h3>Description</h3>

    <div class="body">
        <p>Zend_Filter_HtmlEntities uses htmlentities with 3 arguments, while the function has a 4th argument that determines if already-encoded entities are skipped or not.</p>

<p>Should be used and available to set/get, to enable using the filter on a string that might contain entities.</p>

    </div>
</div>

<div class="comments">
    <h3>Comments</h3>

    <div class="comment">
        <p class="metadata">Posted by Patrick Lee (patrick) on 2009-04-07T13:06:56.000+0000</p> 
        <div class="body">
            <p>I can submit a patch to resolve this issue, but I want to clarify something first.  Since the optional 4th argument of htmlentities() was added in PHP 5.2.3 and the minimum ZF version is 5.2.4, do we need to examine the PHP version and react accordingly or can we simply assume support for it?  If we do need to test for PHP version, here are the possible scenarios:</p>

<p>1) Only 3 arguments given.  No need to test PHP version; call htmlentities() with 3 arguments.
2) All 4 arguments given and PHP &gt;= 5.2.3.  Call htmlentities() with 4 arguments.
3) All 4 arguments given and PHP &lt; 5.2.3.  Call htmlentities() with 3 arguments and/or throw an exception.</p>

<p>I'm wondering exactly how to handle scenario #3.</p>

<p>NOTE: Current minimum PHP version for ZF taken from this URL: <a href="http://framework.zend.com/manual/en/requirements.html">http://framework.zend.com/manual/en/â€¦</a></p>

        </div>
    </div>
        <div class="comment">
        <p class="metadata">Posted by Thomas Weidner (thomas) on 2009-06-20T06:35:10.000+0000</p> 
        <div class="body">
            <p>Added new feature with r16185</p>

        </div>
    </div>
    </div>

