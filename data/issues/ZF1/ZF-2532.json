{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2532",
    "key": "ZF-2532",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Wrong encoded of the subject, if the subject is longer than Zend_Mime::LINELENGTH."
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2532\/votes",
                "votes": 10,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/3",
                "name": "Duplicate"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-10-06T08:38:23.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikespook",
                "name": "mikespook",
                "displayName": "Xing Xing",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-01-31T00:57:48.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-10-06T08:41:39.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "In Zend_Mail::_encodeHeader() and Zend_Mail::setSubject().\n\nNow, it is:\n=?utf-8?Q?mikespook=20=E9=82=80=E8=AB=8B=E6=82=A8=E9=80=B2=E5=85=A5=20ecbattle.net=20=E7=?=9A=84=E4=B8=96=E7=95=8C=E5=85=A7?=\n\nBut should be:\n=?utf-8?Q?mikespook=20=E9=82=80=E8=AB=8B=E6=82=A8=E9=80=B2=E5=85=A5=20ecbattle.net=20=E7=?=\n=?utf-8?Q?9A=84=E4=B8=96=E7=95=8C=E5=85=A7?=\n\nAnd if I modify the code in Zend\/Mail.php line: 392.\n\n    protected function _encodeHeader($value)\n    {\n      if (Zend_Mime::isPrintable($value)) {\n          return $value;\n      } else {\n          $quotedValue = Zend_Mime::encodeQuotedPrintable($value);\n          $quotedValue = str_replace(array('?', ' '), array('=3F', '=20'), $quotedValue);\n          return '=?' . $this->_charset . '?Q?' . $quotedValue . '?=';\n      }\n    }\n\nto:\n\n    protected function _encodeHeader($value)\n    {\n      if (Zend_Mime::isPrintable($value)) {\n          return $value;\n      } else {\n          $quotedValue = Zend_Mime::encodeQuotedPrintable($value, 200);\n          $quotedValue = str_replace(array('?', ' '), array('=3F', '=20'), $quotedValue);\n          return '=?' . $this->_charset . '?Q?' . $quotedValue . '?=';\n      }\n    }\n\nthere will be no problem. but if it is longer than 200, the subject will be showed hash.\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2532\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                "name": "nico",
                "displayName": "Nico Edtinger",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-1688",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1688",
                    "type": {
                        "name": "Duplicate",
                        "direction": "OUTBOUND",
                        "description": "duplicates"
                    }
                },
                {
                    "issueKey": "ZF-3912",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3912",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11247",
                    "filename": "ZF-2532.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=letssurf",
                        "name": "letssurf",
                        "displayName": "James Dempster",
                        "active": true
                    },
                    "created": "2008-04-18T16:43:09.000+0000",
                    "size": 6173,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11247\/ZF-2532.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10140",
                    "id": 10140,
                    "description": "Mini Release",
                    "name": "1.0.3",
                    "userReleaseDate": "30\/Nov\/07",
                    "archived": true,
                    "releaseDate": "2007-11-30",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10018",
                    "id": 10018,
                    "name": "Zend_Mail",
                    "description": "high-level utility to build MIME-compliant messages and send using a mail transport adapter",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/18730",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikespook",
                        "name": "mikespook",
                        "displayName": "Xing Xing",
                        "active": true
                    },
                    "body": "In the version 1.5, it also has this issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikespook",
                        "name": "mikespook",
                        "displayName": "Xing Xing",
                        "active": true
                    },
                    "created": "2008-01-31T00:59:21.000+0000",
                    "updated": "2008-01-31T00:59:21.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/19248",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=covidiu",
                        "name": "covidiu",
                        "displayName": "Ovidiu Curcan",
                        "active": true
                    },
                    "body": "I ran into the same probkem while trying to send a newsletter. I came up with a quick & dirty fix (see below). It's a bit of a hack and it only works for the subject (not for other headers). Problems go deeper.\n\nPatch to be applied agains ZF 1.0.3: \n\n{code}\n--- Zend\/Mail.php\t2007-09-08 17:59:21.000000000 +0300\n+++ Zend\/Mail.php\t2008-02-17 13:12:32.000000000 +0200\n@@ -389,8 +389,9 @@\n       if (Zend_Mime::isPrintable($value)) {\n           return $value;\n       } else {\n-          $quotedValue = Zend_Mime::encodeQuotedPrintable($value);\n+          $quotedValue = Zend_Mime::encodeQuotedPrintable($value, 60);\n           $quotedValue = str_replace(array('?', ' '), array('=3F', '=20'), $quotedValue);\n+          $quotedValue = str_replace(\"=\\n\", \"?=\\n=?\". $this->_charset . '?Q?', $quotedValue);\n           return '=?' . $this->_charset . '?Q?' . $quotedValue . '?=';\n       }\n     }\n@@ -577,7 +578,14 @@\n         if ($this->_subject === null) {\n             $subject = strtr($subject,\"\\r\\n\\t\",'???');\n             $this->_subject = $this->_encodeHeader($subject);\n-            $this->_storeHeader('Subject', $this->_subject);\n+            $subjectPieces = explode(\"\\n\", $this->_subject);\n+            $this->_storeHeader('Subject', $subjectPieces[0]);\n+            unset($subjectPieces[0]);\n+            if ($subjectPieces) {\n+                foreach ($subjectPieces as $piece) {\n+                    $this->_storeHeader('Subject', $piece, true);\n+                }\n+            }\n         } else {\n             throw new Zend_Mail_Exception('Subject set twice');\n         }\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=covidiu",
                        "name": "covidiu",
                        "displayName": "Ovidiu Curcan",
                        "active": true
                    },
                    "created": "2008-02-19T12:12:59.000+0000",
                    "updated": "2008-02-19T12:12:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21115",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "Please evaluate and categorize\/assign as necessary.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-04-18T15:48:52.000+0000",
                    "updated": "2008-04-18T15:48:52.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21142",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=letssurf",
                        "name": "letssurf",
                        "displayName": "James Dempster",
                        "active": true
                    },
                    "body": "From what I could work out, a problem with encoding occurs when the subject line is greater than 75 chars and UTF8 chars of 2 or more bytes are being used. The subject line then needs to be split on to multiple lines if this split occurs in the middle of a quoted printable character i.e. between byte one and two the subject line breaks.\n\nThe easiest solution would be to use php iconv_mime_encode, but I found this to have a problem for quoted printable (Q Encoded) subject lines that where quote long. This is a bug in php it's self.\n\nI've supplied a patch which is as far as I've gotten with the problem so far. I've tried to reproduce what iconv_mimie_encode would do for the Q encoding scheme. I think more evaluation testing and input is needed.\n\nAlso I've started to make the encoding technique usable by addTo for users whom have an alias in UTF8 encoded characters.\n\nI've so far tested that this works with Thunderbird and Gmail (with what I understand the standards to be).\n\nMore feedback please.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=letssurf",
                        "name": "letssurf",
                        "displayName": "James Dempster",
                        "active": true
                    },
                    "created": "2008-04-18T16:43:09.000+0000",
                    "updated": "2008-04-18T16:43:09.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22320",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=zfmyszak",
                        "name": "zfmyszak",
                        "displayName": "Adam Myszak",
                        "active": true
                    },
                    "body": "hello.\nIn my opinion the bug is in the '_storeHeader()' method of Zend_Mail class.\nI don't know why is there a instruction: $value = strtr($value,\"\\r\\n\\t\",'???'); ?\nThe specification of ARPA (RFC 2822) don't accept char '?' for divide a header. \nYou should change that instruction to replace char '?'  for another. \n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=zfmyszak",
                        "name": "zfmyszak",
                        "displayName": "Adam Myszak",
                        "active": true
                    },
                    "created": "2008-06-12T23:44:10.000+0000",
                    "updated": "2008-06-12T23:44:10.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2532\/transitions"
}