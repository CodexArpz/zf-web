{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7957",
    "key": "ZF-7957",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Navigation_Page_Mvc should use the 'default'-route when nothing is specified"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField",
            "value": {
                "timeoriginalestimate": 0,
                "timeestimate": 0
            }
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7957\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-10-16T15:09:15.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=machine",
                "name": "machine",
                "displayName": "Patrik \u00c5kerstrand",
                "active": false
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-09-25T07:09:13.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-08-12T15:53:08.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend_Navigation_Page_Mvc::getHref started to throw exceptions at me when I added a route in a module. The reason was:\n\n# I was in a module with the following route:\n{code:title=class Network_Bootstrap extends Zend_Application_Module_Bootstrap|borderStyle=solid}\npublic function _initRoutes () {\n   [...]\n   $networkRoute = new Zend_Controller_Router_Route(\n\t\t\t'network\/:networkName\/:controller\/:action\/*',\n\t\t\tarray (\n\t\t\t\t'module' => 'network',\n\t\t\t\t'controller' => 'main',\n\t\t\t\t'action' => 'index'\n\t\t\t),\n\t\t\tarray (\n\t\t\t\t'networkName' => '[a-z0-9\\-]+'\n\t\t\t)\n\t\t);\n   \n\t\t$router->addRoute(\n\t\t\t'network',\n\t\t\t$networkRoute\n\t\t);\n   }\n{code}\n# My navigation config looked like (excerpt):\n{code:title=configs\/navigation.xml|borderStyle=solid}\n\t<networks>\n\t\t<label>Network<\/label>\n\t\t<module>networks<\/module>\n\t\t<pages>\n\t\t\t<aNetwork>\n\t\t\t\t<id>networkCrumb<\/id>\n\t\t\t\t<module>network<\/module>\n\t\t\t\t<controller>main<\/controller>\n\t\t\t\t<route>network<\/route>\n\t\t\t\t<params>\n\t\t\t\t\t<networkName \/>\n\t\t\t\t<\/params>\n\t[...]\n{code}\n# The problems started when I was in the 'network' module\n\nNow, Zend_Navigation_Page_Mvc uses the router to assemble the URI, and if I don't specify a route to use, it'll use the current route. This caused problems for every page that did not specify a route in the config, since they then passed NULL to the router => they used the 'network'-route => threw exception since the 'network'-route required a networkName-parameter.\n\nSuggested solutions:\n# Make Zend_Navigation_Page_Mvc explicitly use 'default' as the route unless it's configured\n# Make 'route' a required attribute for instantiating a Zend_Navigation_Page_Mvc."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7957\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=robinsk",
                "name": "robinsk",
                "displayName": "Robin Skoglund",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10406",
                    "id": 10406,
                    "name": "Zend_Navigation",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35311",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=robinsk",
                        "name": "robinsk",
                        "displayName": "Robin Skoglund",
                        "active": true
                    },
                    "body": "I believe this is a documented feature, at least it's by design.\n\nThe first suggested solution was actually how the component worked initially, but the 'default' route was removed by request, since many people reported they did not use a default route, or did not call it 'default'.\n\nThe second suggestion will make it much harder to use the component for simple setups. Not having to specify routes is great for small applications where you only use one module anyway.\n\nIt's not an issue, really, it's just something one needs to be aware of.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=robinsk",
                        "name": "robinsk",
                        "displayName": "Robin Skoglund",
                        "active": true
                    },
                    "created": "2009-10-16T15:09:08.000+0000",
                    "updated": "2009-10-16T15:09:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36888",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=umpirsky",
                        "name": "umpirsky",
                        "displayName": "Sasa Stamenkovic",
                        "active": true
                    },
                    "body": "Haha, I can't believe what I've just read. \r\n\r\nWhat to do then, choose between having custom routes and navigation, that's silly!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=umpirsky",
                        "name": "umpirsky",
                        "displayName": "Sasa Stamenkovic",
                        "active": true
                    },
                    "created": "2009-12-13T06:26:05.000+0000",
                    "updated": "2009-12-13T06:26:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36889",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=robinsk",
                        "name": "robinsk",
                        "displayName": "Robin Skoglund",
                        "active": true
                    },
                    "body": "@Sasa what the hell are you talking about?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=robinsk",
                        "name": "robinsk",
                        "displayName": "Robin Skoglund",
                        "active": true
                    },
                    "created": "2009-12-13T06:32:24.000+0000",
                    "updated": "2009-12-13T06:32:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36890",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=umpirsky",
                        "name": "umpirsky",
                        "displayName": "Sasa Stamenkovic",
                        "active": true
                    },
                    "body": ":)\r\n\r\nOK. Here is my situation:\r\n\r\nI have route\r\n\r\nresources.router.routes.car.route = \"\/oglas\/:id\"\r\nresources.router.routes.car.defaults.module = \"default\"\r\nresources.router.routes.car.defaults.controller = \"search\"\r\nresources.router.routes.car.defaults.action = \"view\"\r\n\r\nWhen i go to e.g. \/oglas\/25 page loads with error (i used Zend_Navigation on that page):\r\n\r\n2009-12-13T14:25:52+01:00 ERR (3): Zend_Controller_Router_Exception: id is not specified in Zend\\View\\Helper\\Navigation\\HelperAbstract.php #519.\r\nbecause Zend_Navigation_Page_Mvc uses custom route, which is currently active, instead using default route.\r\n\r\nHow do you think I can deal with that?\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=umpirsky",
                        "name": "umpirsky",
                        "displayName": "Sasa Stamenkovic",
                        "active": true
                    },
                    "created": "2009-12-13T06:50:19.000+0000",
                    "updated": "2009-12-13T06:50:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41970",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sandwyrm",
                        "name": "sandwyrm",
                        "displayName": "James Zimmerman",
                        "active": true
                    },
                    "body": "Although I cannot speak for Sasa's comments, I believe there is a flaw with Navigation and Routing that is not by design here that is not being seen by the support person and I am experiencing the same issue.  I understand that by not forcing the MVC page class to have an explicit default route, the MVC page maintains it's structural ambiguity, however, there should be a simple means to declare a global default route somewhere and I have not yet seen that documented or in response to this ticket.  My experience is much larger and disgusting to suggest hand modification of the navigation definitions since there are 197 core defined navigational elements in my project's navigation as well as several hundred more dynamic ones, all but 17 of which assume the default route.  We hadn't, until recently, been adding any advanced routing into our project and navigation behaved as expected, however, upon adding two new routes that used variables in the route definition, we experienced these issues.  It doesn't affect only the specific module, but all of navigation is rewritten with the last loaded route, not the last defined route, but it appears to be the last loaded route, so this seems to change depending on which route we're currently using, or whichever order includes made it in.  Sure, this could be seen as a feature, but when you have over 200 navigational elements maintained in a project and suddenly routing is rewriting them seemingly out of the blue and apparently picking, at random, which route it will write each url with, it does not look like expected behavior or a feature.  The quick solution, I simply modified my copy of Zend_Navigation_Page_Mvc and set line 87 to\r\n\r\n[code]\r\nprotected $_route = 'default';\r\n[\/code]\r\n\r\nand magically everything, everywhere was fixed.  I'm not saying we should hard-code the default value, but there should be an exposed method somewhere that allows us to establish a default globally when not defined if we so choose or need to do so.  Leaving it as is does not seem very professional and forcing developers with long standing and lengthy navigation configurations to update every element by hand simply because they added a route or two doesn't seem like an acceptable product support option to me either.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sandwyrm",
                        "name": "sandwyrm",
                        "displayName": "James Zimmerman",
                        "active": true
                    },
                    "created": "2010-08-12T15:53:02.000+0000",
                    "updated": "2010-08-12T15:53:02.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7957\/transitions"
}