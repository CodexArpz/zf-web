{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5030",
    "key": "ZF-5030",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Failure to parse Zend_Locale objects is Zend_Locale::isLocale"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5030\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/5",
                "name": "Cannot Reproduce"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-11-23T12:11:33.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjlucas",
                "name": "mjlucas",
                "displayName": "James Lucas",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-11-22T16:17:16.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-11-26T13:55:29.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "After upgrading to Zend Framework 1.7 (from 1.6.2) Zend_Date objects started throwing exceptions on construction with an error \"Given locale (Object id #1) does not exist\" when they are passed a Zend_Locale object (They construct fine if given a locale string [eg. en_AU])\n\nThis has been traced back to Zend_Locale::_prepareLocale() where it evaluates the Zend_Locale object passed (valid) as a string and converts it into the string \"Object id #1\".\n\nTest code:\n{code}\n<?php\n\nset_include_path('\/opt\/library');\nrequire_once '\/opt\/library\/Zend\/Locale.php';\nrequire_once '\/opt\/library\/Zend\/Date.php';\n\n$locale1 = new Zend_Locale('en_AU');\n\n\/\/This Works\nif (!Zend_Locale::isLocale('en_AU', true, false))\n  echo \"Zend Locale failed to identify local string as valid\";\n\/\/This doesn't\nif (!Zend_Locale::isLocale($locale1, true, false))\n  echo \"Zend Locale failed to idenfiy a Zend_Local object as valid\";\n\n$date = new Zend_Date();\n$date->setLocale($locale1); \/\/Throws Exception\n{code}\n\nOutput:\n{noformat} \nPHP Notice:  Object of class Zend_Locale to string conversion in \/opt\/library\/Zend\/Locale.php on line 885\nZend Locale failed to idenfiy a Zend_Local object as validPHP Notice:  Object of class Zend_Locale to string conversion in \/opt\/library\/Zend\/Locale.php on line 885\nPHP Notice:  Object of class Zend_Locale to string conversion in \/opt\/library\/Zend\/Locale.php on line 885\nPHP Fatal error:  Uncaught exception 'Zend_Date_Exception' with message 'Given locale (Object id #1) does not exist' in \/opt\/library\/Zend\/Date.php:4517\nStack trace:\n#0 \/tmp\/test.php(17): Zend_Date->setLocale(Object(Zend_Locale))\n#1 {main}\n  thrown in \/opt\/library\/Zend\/Date.php on line 4517\n{noformat} "
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/1",
                "name": "Blocker"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5030\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-5077",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5077",
                    "type": {
                        "name": "Duplicate",
                        "direction": "OUTBOUND",
                        "description": "duplicates"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10260",
                    "id": 10260,
                    "description": "Minor Release",
                    "name": "1.7.0",
                    "userReleaseDate": "17\/Nov\/08",
                    "archived": false,
                    "releaseDate": "2008-11-17",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10073",
                    "id": 10073,
                    "name": "Zend_Locale",
                    "description": "Zend_Locale is a basic wrapper for all I18N and L10N issues for the Zend Framework. It provides the userbasically with access to translation functionality. It can handle different source file types for translation.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26591",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjlucas",
                        "name": "mjlucas",
                        "displayName": "James Lucas",
                        "active": true
                    },
                    "body": "Actually this looks like a issue with the string conversion issue. When the locale is converted to a string with (string) $locale, this is where the \"Object id #1\" appears.\n\nThis is with php version 1.5.6 (RHEL5 package). Looking at the PHP documentation there are differences in how the __toString magic method is applied between 5.1 and 5.2 (http:\/\/au.php.net\/oop5.magic) could this be related.\n\nTest code:\n{code}\n<?php\n\nset_include_path('\/opt\/library');\nrequire_once '\/opt\/library\/Zend\/Locale.php';\nrequire_once '\/opt\/library\/Zend\/Date.php';\n\necho \"Test 1\\n\";\n$locale1 = new Zend_Locale('en_AU');\nprint_r($locale1);\necho \"\\n\";\n\necho \"Test 2\\n\";\n$convert = (string) $locale1;\necho $convert;\necho \"\\n\";\n\n\"Test 3\\n\";\n$convert2 = $locale1->toString();\necho $convert2;\necho \"\\n\";\n{code}\n\nResult:\n{noformat}\nTest 1\nZend_Locale Object\n(\n    [_locale:protected] => en_AU\n)\n\nTest 2\nObject id #1\nTest 3\nen_AU\n{noformat}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjlucas",
                        "name": "mjlucas",
                        "displayName": "James Lucas",
                        "active": true
                    },
                    "created": "2008-11-22T18:36:33.000+0000",
                    "updated": "2008-11-22T18:36:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26593",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Sorry, but the minimum requirements for ZF are 5.2.4 and not 1.5.6 !",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-11-23T00:44:02.000+0000",
                    "updated": "2008-11-23T00:44:02.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26594",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjlucas",
                        "name": "mjlucas",
                        "displayName": "James Lucas",
                        "active": true
                    },
                    "body": "http:\/\/framework.zend.com\/manual\/en\/requirements.html states that 1.5.4 is the minimum requirement with recommended 5.2.3. \n\n5.1.6 is the version shipped with Redhat Enterprise Linux 5.2 (latest version). I would think that Zend Framework is aiming to support the latest in Enterprise releases?!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjlucas",
                        "name": "mjlucas",
                        "displayName": "James Lucas",
                        "active": true
                    },
                    "created": "2008-11-23T01:01:21.000+0000",
                    "updated": "2008-11-23T01:01:21.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26595",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "No... PHP 1.5.4 is not supported by ZF.\n\nAccording to manual:\nA.1. PHP Version\nZend recommends PHP 5.2.3 or higher for critical security and performance enhancements, although Zend Framework requires only PHP 5.1.4 or later.\n\nBut, and this is emminent, ZF can not solve problems of php itself. PHP 5.1.4, 5.2.1 and 5.2.5, which are the versions I am testing against, behave correct.\nYou could run unittests to check this. With such a problem within PHP also other classes will not work.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-11-23T01:19:06.000+0000",
                    "updated": "2008-11-23T01:19:06.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26596",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjlucas",
                        "name": "mjlucas",
                        "displayName": "James Lucas",
                        "active": true
                    },
                    "body": "Can you please run the two tests I posted above and let me know if you get the same or different results with your v5.1.4? Looking into the issue further there are enough documented cases that the magic method does not work in any version of 5.1 and you should use $object->__toString() instead of (String)$object\n\nIf 5.1.4 is indeed the minimum requirement then should the components using the magic method be modified to call the __toString function directly? Otherwise\nthe doco needs to be updated that parts of 1.7 won't work on php 5.1 (eg Redhat 5 distributed versions). I know the Framework can't fix problems with php (only working around them) but there is a valid method that works across these versions.\n\nShould I move this to the email list for further discussion?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjlucas",
                        "name": "mjlucas",
                        "displayName": "James Lucas",
                        "active": true
                    },
                    "created": "2008-11-23T01:46:35.000+0000",
                    "updated": "2008-11-23T01:46:35.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26604",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I added a forth test, which you have missed:\n{code}\nvar_dump(Zend_Locale::isLocale($locale1));\n{code}\n\nThis are my results:\n\n{code}\nPHP Version:5.1.4\nTest 1\nZend_Locale Object\n(\n    [_locale:protected] => en_AU\n)\n\nTest 2\nObject id #1\nTest 3\nen_AU\nTest 3\nbool(true)\n{code}\n\nand\n\n{code}\nPHP Version:5.2.5\nTest 1\nZend_Locale Object\n(\n    [_locale:protected] => en_AU\n)\n\nTest 2\nen_AU\nTest 3\nen_AU\nTest 3\nboolean true\n{code}\n\nAnd these are my problems... wether in 5.1.4 nor in 5.2.5 I can reproduce this.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-11-23T12:10:28.000+0000",
                    "updated": "2008-11-23T12:10:28.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26608",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjlucas",
                        "name": "mjlucas",
                        "displayName": "James Lucas",
                        "active": true
                    },
                    "body": "You did reproduced this in your 5.1.4 PHP installation. Test 2 outputted \"Object id #1\" which shows the __toString magic method didn't fire.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjlucas",
                        "name": "mjlucas",
                        "displayName": "James Lucas",
                        "active": true
                    },
                    "created": "2008-11-23T14:02:02.000+0000",
                    "updated": "2008-11-23T14:02:02.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26609",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "This issue was not about a PHP 5.1.4 problem, this issue was about this failing code:\n{code}\nif (!Zend_Locale::isLocale($locale1, true, false))\n  echo \"Zend Locale failed to idenfiy a Zend_Local object as valid\";\n{code}\n\nwhich I tested with the 4th test I added....\nand both PHP versions return true.\n\nUnder 5.1.4 with (bool) true and under 5.2.5 with boolean true.\nBut, and this is what you originally issued, both return true when calling isValid running actual trunk.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-11-23T14:12:45.000+0000",
                    "updated": "2008-11-23T14:12:45.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26687",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shagren",
                        "name": "shagren",
                        "displayName": "Ilya Gruzinov",
                        "active": true
                    },
                    "body": "I have this problem on 5.1.6 too (CentOS)\nAnd all works good on 5.2(Debian Stable)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shagren",
                        "name": "shagren",
                        "displayName": "Ilya Gruzinov",
                        "active": true
                    },
                    "created": "2008-11-25T09:42:55.000+0000",
                    "updated": "2008-11-25T09:42:55.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5030\/transitions"
}