{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6448",
    "key": "ZF-6448",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Incorrect handling of UTF-8 strings while formatting numbers"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6448\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/3",
                "name": "Duplicate"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-04-28T11:34:16.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=amgarude",
                "name": "amgarude",
                "displayName": "Andrew Magruder",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-04-28T06:53:31.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-04-28T11:34:16.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "errors"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "This code:\n\n$zCurrency = new Zend_Currency('USD');\necho $zCurrency->toCurrency(22.79);\n\nResults in this output:\n\n$22.790\n\nNote additional trailing zero.  This appears to be related to the multibyte string configurations of PHP.  We are configured for UTF-8 across all components including the iconv PHP extension.  The specific problem is with the iconv_strpos function call in Zend\/Local\/Format.php:430-433:\n\n        }\n        if (iconv_strpos($number, '-') !== false) {\n            $number = iconv_substr($number, 1);\n        }\n        $group  = iconv_strrpos($format, ',');\n        $group2 = iconv_strpos ($format, ',');\n        $point  = iconv_strpos ($format, '0');\n        \/\/ Add fraction\n        $rest = \"\";\n        if (($value < 0) && (strpos($format, '.'))) {\n            $rest   = substr(substr($format, strpos($format, '.') + 1), -1, 1);\n        }\n\nWhen changed to:\n\n        }\n        if (iconv_strpos($number, '-') !== false) {\n            $number = iconv_substr($number, 1);\n        }\n        $group  = mb_strpos($format, ',');\n        $group2 = mb_strpos($format, ',');\n        $point  = mb_strpos($format, '0');\n        \/\/ Add fraction\n        $rest = \"\";\n        if (($value < 0) && (strpos($format, '.'))) {\n            $rest   = substr(substr($format, strpos($format, '.') + 1), -1, 1);\n        }\n\nChanges the output of the above code snippet to:\n\n$22.79\n\nWhich is the expected correct value.\n\nWe're using PHP v5.2.8, iconv 2.3.4.  Here are the relevant sections of our PHP ini file:\n\n[iconv]\niconv.input_encoding = UTF-8\niconv.internal_encoding = UTF-8\niconv.output_encoding = UTF-8\n\n[mbstring]\nmbstring.language = neutral\nmbstring.internal_encoding = UTF-8\nmbstring.http_input = auto\nmbstring.http_output = UTF-8\nmbstring.encoding_translation = On\nmbstring.detect_order = auto\nmbstring.func_overload = 0\n\nPlease note that the iconv_strpos function is used in many other places in that file, so it's likely that other bugs exist that either our code path isn't transversing or simply haven't been detected yet.  For what it's worth, we detected this bug as part of an upgrade process between 1.7.4 and 1.7.8."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/6",
                "name": "N\/A"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6448\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10300",
                    "id": 10300,
                    "description": "Mini Release",
                    "name": "1.7.8",
                    "userReleaseDate": "30\/Mar\/09",
                    "archived": false,
                    "releaseDate": "2009-03-30",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10073",
                    "id": 10073,
                    "name": "Zend_Locale",
                    "description": "Zend_Locale is a basic wrapper for all I18N and L10N issues for the Zend Framework. It provides the userbasically with access to translation functionality. It can handle different source file types for translation.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30494",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I'm not able to reproduce your behaviour.\nCan you give some additional details ?\n\nAlso to note that mbstr* is depreciated because it's not available in most of the installations per default. Iconv is installed per default.\nSo mbstr* must not be used for the I18N core.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-04-28T10:57:33.000+0000",
                    "updated": "2009-04-28T10:57:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30496",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=amgarude",
                        "name": "amgarude",
                        "displayName": "Andrew Magruder",
                        "active": true
                    },
                    "body": "Darn it!  I totally forgot I pulled a hotfix for this bug: ZF-6208 and applied it to my ZF install.  I nuked out everything and republished 1.7.8 and this works correctly now.\n\nSorry to report a bug that someone else found and already fixed.  :\/\n\nPlease close this report.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=amgarude",
                        "name": "amgarude",
                        "displayName": "Andrew Magruder",
                        "active": true
                    },
                    "created": "2009-04-28T11:07:58.000+0000",
                    "updated": "2009-04-28T11:07:58.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30497",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Closing due to being duplicate of already fixed issue",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-04-28T11:34:15.000+0000",
                    "updated": "2009-04-28T11:34:15.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6448\/transitions"
}