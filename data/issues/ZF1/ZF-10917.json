{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10917",
    "key": "ZF-10917",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Side-effect on file upload when file name can also be found under DOCUMENT_ROOT"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10917\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cptbrowser",
                "name": "cptbrowser",
                "displayName": "C",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-01-05T08:25:52.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-01-05T08:25:52.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "ERROR MESSAGE:\r\n\r\nWarning: finfo_file() : File or path not found 'index.php' in [..]\\Zend\\File\\Transfer\\Adapter\\Abstract.php on line 1302\r\n\r\n------------------------------------------------------------------------------\r\n\r\nERROR DESCRIPTION:\r\n\r\nIf you upload a file, using Zend_Form\/Zend_Form_Element_File, you'll get an error\r\nif - and only if - the basename of the file can also be found in your DOCUMENT_ROOT (or if you\r\nselect a file from your DOCUMENT_ROOT to be uploaded), f.e. if you try to upload\r\nan 'index.php', '.htaccess', ... (error\r\n\r\n------------------------------------------------------------------------------\r\n\r\nCAUSING CLASS AND LINES OF CODE:\r\n\r\nZend_File_Transfer_Adapter_Abstract::_detectMimeType($value)\r\n\r\nprotected function _detectMimeType($value)\r\n{\r\n\t\/*\r\n\t$value = array\r\n\t  'name' => string 'index.php' (length=9)\r\n\t  'type' => string '' (length=0)\r\n\t  'tmp_name' => string 'D:\\xampp\\tmp\\phpEDA4.tmp' (length=24)\r\n\t  'error' => int 0\r\n\t  \/\/ ..\r\n\t*\/\r\n\tif (file_exists($value['name'])) { \/\/ TRUE, but checked the wrong file!\r\n\t\t$file = $value['name'];\r\n\t} else if (file_exists($value['tmp_name'])) { \/\/ would be better to check first!\r\n\t\t$file = $value['tmp_name'];\r\n\t} else {\r\n\t\treturn null;\r\n\t}\r\n\r\n\tif (class_exists('finfo', false)) {\r\n\t\t\/\/ ..\r\n\r\n\t\tif (!empty($mime)) {\r\n\t\t\t$result = finfo_file($mime, $file); \/\/ $file = 'index.php', causes error (see error message)\r\n\t\t}\r\n\r\n\t\t\/\/ ..\r\n\t}\r\n\r\n\t\/\/ ..\r\n\r\n\treturn $result;\r\n}\r\n\r\n------------------------------------------------------------------------------\r\n\r\nSOLUTION:\r\n\r\nI don't know why there is a file_exists($value['name']) check, it seems to me wrong and unnecessary.\r\n\r\n------------------------------------------------------------------------------\r\n\r\nFURTHER INFORMATION:\r\n\r\nI'm using Zend_Form and Zend_Form_Element_File:\r\n\r\n(Zend_Form sub-class)\r\n\r\n$this->setAttrib('enctype', 'multipart\/form-data');\r\n\r\n\/\/ ..\r\n\r\n$elem = new Zend_Form_Element_File('file');\r\n$elem->setLabel('Datei hochladen');\r\n$elem->setRequired(true);\r\n$this->addElement($elem);\r\n\r\nand Zend_Form on a standalone base, no MVC is used. It happened in version 1.11.0 but I did not see any changes in that file for 1.11.2.\r\n\r\nCUSTOM BACKTRACE:\r\n\r\n1\t0.0004\t319640\t{main}( )\t..\\index.php:0\r\n2\t0.0061\t602928\tdispatcher->dispatch( )\t..\\index.php:23\r\n3\t0.0947\t6651864\tController->dispatch( )\t..\\dispatcher.php:158\r\n4\t0.0947\t6652112\tcall_user_func_array ( )\t..\\controller.php:233\r\n5\t0.0947\t6652248\tFileController->file_upload( )\t..\\controller.php:0\r\n6\t0.0950\t6708448\tZend_Form->__construct( )\t..\\file_controller.php:48\r\n7\t0.0950\t6708480\tGf_File_Form_Upload->init( )\t..\\Form.php:240\r\n8\t0.0981\t7032192\tZend_Form_Element_File->addValidator( )\t..\\Upload.php:17\r\n9\t0.0981\t7032192\tZend_Form_Element_File->getTransferAdapter( )\t..\\File.php:217\r\n10\t0.0981\t7032240\tZend_Form_Element_File->setTransferAdapter( )\t..\\File.php:202\r\n11\t0.1019\t7565192\tZend_File_Transfer_Adapter_Http->__construct( )\t..\\File.php:178\r\n12\t0.1019\t7565664\tZend_File_Transfer_Adapter_Http->_prepareFiles( )\t..\\Http.php:53\r\n13\t0.1019\t7566776\tZend_File_Transfer_Adapter_Abstract->_detectMimeType( )\t..\\Http.php:468\r\n14\t0.1020\t7567296\tfinfo_file ( )\t..\\Abstract.php:1302\r\n\r\nPHP-Version is 5.3.1, using Windows 7 with XAMPP.\r\n\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10917\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10520",
                    "id": 10520,
                    "description": "Mini Release",
                    "name": "1.11.2",
                    "userReleaseDate": "30\/Dec\/10",
                    "archived": false,
                    "releaseDate": "2010-12-30",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10320",
                    "id": 10320,
                    "name": "Zend_File_Transfer",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [

            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10917\/transitions"
}