{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12021",
    "key": "ZF-12021",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Custom decorators in Zend_Form_Element constructor produces \"Plugin by name 'Mylabel' was not found in the registry; used paths: Zend_Form_Decorator_: Zend\/Form\/Decorator\/ \" error"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12021\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-01-23T22:13:41.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rasa7777",
                "name": "rasa7777",
                "displayName": "Ross Smith",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2012-01-23T21:45:40.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-01-23T22:59:11.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "Zend_Form",
                "decorator"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "{code}\r\nclass Application_Form_MyForm extends Zend_Form\r\n{\r\n    public function init()\r\n    {\r\n        $this->addElementPrefixPath('My_Decorator', 'My\/Decorator\/', 'decorator');\r\n        $element = new Zend_Form_Element_Text('email', array(\r\n            'label' => 'Email',\r\n            'decorators' => array(\r\n                'ViewHelper',\r\n                'Mylabel',\r\n            ),\r\n        ));\r\n        $this->addElement($element);\r\n    }\r\n}\r\n{code}\r\nfails with the following error:\r\n{{Plugin by name 'Mylabel' was not found in the registry; used paths: Zend_Form_Decorator_: Zend\/Form\/Decorator\/}}\r\n\r\nThe following does work:\r\n\r\n{code}\r\nclass Application_Form_MyForm extends Zend_Form\r\n{\r\n    public function init()\r\n    {\r\n        $this->addElementPrefixPath('My_Decorator', 'My\/Decorator\/', 'decorator');\r\n        $element = new Zend_Form_Element_Text('email', array(\r\n            'label' => 'Email',\r\n            'decorators' => array(\r\n                'ViewHelper',\r\n            ),\r\n        ));\r\n        $element->addDecorator('Mylabel');\r\n        $this->addElement($element);\r\n    }\r\n}\r\n{code}\r\nIt is not obvious from\r\nhttp:\/\/framework.zend.com\/manual\/en\/zend.form.decorators.html\r\nthat the first example is not supported.\r\n\r\nWe should either fix the code to support this usage, or spell out in the documentation that custom decorators are not supported in Zend_Form_Element constructors.\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12021\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "zend-form-element"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bittarman",
                "name": "bittarman",
                "displayName": "Ryan Mauger",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10981",
                    "id": 10981,
                    "description": "Mini Release",
                    "name": "1.11.11",
                    "userReleaseDate": "29\/Sep\/11",
                    "archived": false,
                    "releaseDate": "2011-09-29",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49558",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bittarman",
                        "name": "bittarman",
                        "displayName": "Ryan Mauger",
                        "active": true
                    },
                    "body": "This is untrue.\r\n\r\nYou can pass a key \"prefixPath\" with an array of prefix paths to be added, which if you use the notation given in your issue, you would have to pass to every element rather than the form.\r\n\r\nI'm closing this as not an issue, though you may want to consider opening a documentation issue to clear this up.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bittarman",
                        "name": "bittarman",
                        "displayName": "Ryan Mauger",
                        "active": true
                    },
                    "created": "2012-01-23T22:13:41.000+0000",
                    "updated": "2012-01-23T22:13:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49559",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=xerkus",
                        "name": "xerkus",
                        "displayName": "Aleksey 'Xerkus' Khudyakov",
                        "active": true
                    },
                    "body": "Why should it work?\r\nYou configured form, but then created separate element. How configuration from one object should appear in unrelated other?\r\n\r\nYour second example works only because your decorator lazy loaded on access. And that access occurs after element added to form, where decorator prefixes are injected into element instance.\r\n\r\nYou must either provide decorator prefixes to element constructor or create it from form instance, see Zend_Form::addElement() and Zend_From::createElement()\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=xerkus",
                        "name": "xerkus",
                        "displayName": "Aleksey 'Xerkus' Khudyakov",
                        "active": true
                    },
                    "created": "2012-01-23T22:21:53.000+0000",
                    "updated": "2012-01-23T22:21:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49560",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rasa7777",
                        "name": "rasa7777",
                        "displayName": "Ross Smith",
                        "active": true
                    },
                    "body": "Ryan,\r\n\r\nThanks for your prompt response.\r\n\r\nYou are correct, the following code works:\r\n{code}\r\nclass Application_Form_MyForm extends Zend_Form\r\n{\r\n    public function init()\r\n    {\r\n        $element = new Zend_Form_Element_Text('email', array(\r\n            'label' => 'Email',\r\n            'prefixPath' => array(\r\n                'decorator' => array(\r\n                    'prefix'    => 'My_Decorator', \r\n                    'path'      => 'My\/Decorator\/', \r\n                 ),\r\n             ),\r\n            'decorators' => array(\r\n                'ViewHelper',\r\n                'Mylabel',\r\n            ),\r\n        ));\r\n        $this->addElement($element);\r\n    }\r\n}\r\n{code}\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rasa7777",
                        "name": "rasa7777",
                        "displayName": "Ross Smith",
                        "active": true
                    },
                    "created": "2012-01-23T22:23:45.000+0000",
                    "updated": "2012-01-23T22:23:45.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49561",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rasa7777",
                        "name": "rasa7777",
                        "displayName": "Ross Smith",
                        "active": true
                    },
                    "body": "Aleksey 'Xerkus' Khudyakov states:\r\n> Why should it work?\r\n> You configured form, but then created separate element. How configuration from one object should appear in unrelated other?\r\n\r\nI think it's reasonable to assume that by calling\r\n{code}\r\n$this->addElementPrefixPath('My_Decorator', 'My\/Decorator\/', 'decorator');\r\n{code}\r\nthat this would apply to all future calls to {{addElement()}}, regardless of how the object was created that was passed to it.\r\n\r\nIt is not obvious (at least to me) that this is not the case.\r\n\r\nI've reviewed the documentation, and don't find this requirement mentioned anywhere. Should it be updated?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rasa7777",
                        "name": "rasa7777",
                        "displayName": "Ross Smith",
                        "active": true
                    },
                    "created": "2012-01-23T22:31:37.000+0000",
                    "updated": "2012-01-23T22:31:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49562",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=xerkus",
                        "name": "xerkus",
                        "displayName": "Aleksey 'Xerkus' Khudyakov",
                        "active": true
                    },
                    "body": "{quote}that this would apply to all future calls to addElement(), regardless of how the object was created that was passed to it.{quote}\r\n\r\nExactly. But check exception's stack trace: it thrown BEFORE $this->addElement($element); call.\r\nIt should be something like Element::__construct() -> addDefaultDecorators() -> getDecorators() -> _loadDecorator(). Do not remember exact api.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=xerkus",
                        "name": "xerkus",
                        "displayName": "Aleksey 'Xerkus' Khudyakov",
                        "active": true
                    },
                    "created": "2012-01-23T22:58:25.000+0000",
                    "updated": "2012-01-23T22:59:11.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12021\/transitions"
}