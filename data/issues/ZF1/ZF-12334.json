{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12334",
    "key": "ZF-12334",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Remove optgroup and other unneeded options from element Select in Zend extend Dojo"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12334\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=moh_mousa",
                "name": "moh_mousa",
                "displayName": "Mohammad R. Mousa",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2012-07-13T01:19:58.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-07-14T01:08:01.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "My form extend Zend_Dojo_Form\r\n\r\nI used both Dojo FilteringSelect and Zend Select element\r\n\r\nthis is the Zend Select code \r\n{code}\r\n    $mainForm->addElement(\r\n        'select',\r\n        'locale_id',\r\n         array(\r\n             'label' \t\t=> 'Vehicle_For_Sale_Locale',\r\n             'required'\t\t=> true,\r\n             'value'\t\t=> '',\r\n\t     'multiOptions'  => $this -> _getLocaleAvailabe(),\r\n            )\r\n    );\r\n{code}\r\nand this is the Dojo FilteringSelect code\r\n{code}\r\n    $mainForm->addElement(\t\t\t\t\t\r\n            'FilteringSelect',\r\n            'type_id',\r\n            array(\r\n                'label' \t\t=> $this-> view -> __('Vehicle_For_Sale_Type'),\r\n                'required'\t\t=> true,\r\n                'value'\t\t\t=> '',\r\n                'id'\t\t\t=> 'type_id',\r\n\t            'multiOptions'  => $this -> _getLocaleAvailabe(),\r\n\t         \r\n\t\t)\r\n    );\r\n{code}\r\nFilteringSelect rendered proberly\r\nbut Zend Select rendered like this\r\n{code}\r\n    <select required=\"1\" id=\"main-locale_id\" name=\"main[locale_id]\">\r\n        <optgroup label=\"options\" id=\"main-locale_id-optgroup-options\">\r\n            <option selected=\"selected\" label=\"--SELECT Language--\" value=\"\">--SELECT Language--<\/option>\r\n            <option label=\"English\" value=\"1\">English<\/option>\r\n            <option label=\"Arabic\" value=\"2\">Arabic<\/option>\r\n            <option label=\"Franci\" value=\"3\">Franci<\/option>\r\n        <\/optgroup>\r\n        <option label=\"&lt;br \/&gt;\" value=\"listsep\">&lt;br \/&gt;<\/option>\r\n        <option label=\"main-locale_id\" value=\"id\">main-locale_id<\/option>\r\n    <\/select>\r\n{code}\r\nI believe I didn't add optgroup and the last two options\r\n{code}\r\n<option label=\"&lt;br \/&gt;\" value=\"listsep\">&lt;br \/&gt;<\/option>\r\n<option label=\"main-locale_id\" value=\"id\">main-locale_id<\/option> \r\n{code}\r\nHow can I remove the last two options and optgroup ?"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12334\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10311",
                    "id": 10311,
                    "name": "Zend_Dojo",
                    "description": "Dojo integration with Zend Framework",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51348",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=moh_mousa",
                        "name": "moh_mousa",
                        "displayName": "Mohammad R. Mousa",
                        "active": true
                    },
                    "body": "After my tracing I found that \r\nIn class \r\n{code}Zend_View_Helper_FormSelect{code} \r\nthe method \r\n{code}formSelect{code}\r\ncalled twice its contains the following\r\n{code}\r\n        foreach ((array) $options as $opt_value => $opt_label) {\r\n            if (is_array($opt_label)) {\r\n                $opt_disable = '';\r\n                if (is_array($disable) && in_array($opt_value, $disable)) {\r\n                    $opt_disable = ' disabled=\"disabled\"';\r\n                }\r\n                if (null !== $translator) {\r\n                    $opt_value = $translator->translate($opt_value);\r\n                }\r\n                $opt_id = ' id=\"' . $this->view->escape($id) . '-optgroup-'\r\n                        . $this->view->escape($opt_value) . '\"';\r\n                $list[] = '<optgroup'\r\n                        . $opt_disable\r\n                        . $opt_id\r\n                        . ' label=\"' . $this->view->escape($opt_value) .'\">';\r\n                foreach ($opt_label as $val => $lab) {\r\n                    $list[] = $this->_build($val, $lab, $value, $disable);\r\n                }\r\n                $list[] = '<\/optgroup>';\r\n            } else {\r\n                $list[] = $this->_build($opt_value, $opt_label, $value, $disable);\r\n            }\r\n        }\r\n{code}\r\n\r\nactually the {code}$this->_build{code} called twice for the same element.\r\nfirst called time its render the optgroup and its option\r\nsecond called time its add the last two options ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=moh_mousa",
                        "name": "moh_mousa",
                        "displayName": "Mohammad R. Mousa",
                        "active": true
                    },
                    "created": "2012-07-13T13:10:40.000+0000",
                    "updated": "2012-07-13T13:10:40.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51349",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=moh_mousa",
                        "name": "moh_mousa",
                        "displayName": "Mohammad R. Mousa",
                        "active": true
                    },
                    "body": "the {code}if (is_array($opt_label)){code}\r\nfirst called time will be the array\r\nand the second called time will be the label\r\n\r\nI beleive this is a bug !!\r\nAny suggestions for help ?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=moh_mousa",
                        "name": "moh_mousa",
                        "displayName": "Mohammad R. Mousa",
                        "active": true
                    },
                    "created": "2012-07-13T13:14:59.000+0000",
                    "updated": "2012-07-13T13:14:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51350",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=frosch",
                        "name": "frosch",
                        "displayName": "Frank Br\u00fcckner",
                        "active": true
                    },
                    "body": "Hi Mohammad,\r\nI can not reproduce your problem. Here is my test script:\r\n{code}\r\n$form = new Zend_Dojo_Form();\r\n\r\n$multiOptions = array(\r\n    1, 2, 3, 4, 5\r\n);\r\n\r\n$form->addElement(\r\n    'select',\r\n    'foo',\r\n    array(\r\n        'label'        => 'Foo',\r\n        'multiOptions' => $multiOptions,\r\n    )\r\n);\r\n\r\n$form->addElement(\r\n    'FilteringSelect',\r\n    'bar',\r\n    array(\r\n        'label'        => 'Bar',\r\n        'multiOptions' => $multiOptions,\r\n    )\r\n);\r\n{code}\r\n{code:borderStyle=solid|title=Output for the first select element}\r\n<select name=\"foo\" id=\"foo\">\r\n    <option value=\"0\" label=\"1\">1<\/option>\r\n    <option value=\"1\" label=\"2\">2<\/option>\r\n    <option value=\"2\" label=\"3\">3<\/option>\r\n    <option value=\"3\" label=\"4\">4<\/option>\r\n    <option value=\"4\" label=\"5\">5<\/option>\r\n<\/select>\r\n{code}\r\n\r\nCan you provide the content of {{$this->_getLocaleAvailabe()}}?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=frosch",
                        "name": "frosch",
                        "displayName": "Frank Br\u00fcckner",
                        "active": true
                    },
                    "created": "2012-07-13T14:01:10.000+0000",
                    "updated": "2012-07-13T14:01:10.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51351",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=moh_mousa",
                        "name": "moh_mousa",
                        "displayName": "Mohammad R. Mousa",
                        "active": true
                    },
                    "body": "Zend_Debug::dump($this->_getLocaleAvailabe());\r\narray(4) {\r\n  [\"\"] => string(19) \"--SELECT Language--\"\r\n  [1] => string(7) \"English\"\r\n  [2] => string(6) \"Arabic\"\r\n  [3] => string(6) \"Franci\"\r\n}\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=moh_mousa",
                        "name": "moh_mousa",
                        "displayName": "Mohammad R. Mousa",
                        "active": true
                    },
                    "created": "2012-07-13T15:17:15.000+0000",
                    "updated": "2012-07-13T15:17:15.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51352",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=moh_mousa",
                        "name": "moh_mousa",
                        "displayName": "Mohammad R. Mousa",
                        "active": true
                    },
                    "body": "I also tried to give the index for '--SELECT Language--' value 0 and '0' but no luck\r\neven remove the first index from array '--SELECT Language--' to be like\r\n{code}\r\narray(4) { [0] => string(7) \"English\" [1] => string(6) \"Arabic\" [2] => string(6) \"Franci\" }\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=moh_mousa",
                        "name": "moh_mousa",
                        "displayName": "Mohammad R. Mousa",
                        "active": true
                    },
                    "created": "2012-07-13T15:19:42.000+0000",
                    "updated": "2012-07-13T15:19:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51357",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=moh_mousa",
                        "name": "moh_mousa",
                        "displayName": "Mohammad R. Mousa",
                        "active": true
                    },
                    "body": "Any update !\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=moh_mousa",
                        "name": "moh_mousa",
                        "displayName": "Mohammad R. Mousa",
                        "active": true
                    },
                    "created": "2012-07-14T01:08:01.000+0000",
                    "updated": "2012-07-14T01:08:01.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12334\/transitions"
}