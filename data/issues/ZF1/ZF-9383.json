{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9383",
    "key": "ZF-9383",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Validate_File_MimeType doesn't recognize mime types when a charset is returned"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9383\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/5",
                "name": "Cannot Reproduce"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10440",
                    "id": 10440,
                    "description": "Mini Release",
                    "name": "1.10.3",
                    "userReleaseDate": "01\/Apr\/10",
                    "archived": false,
                    "releaseDate": "2010-04-01",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-03-09T12:21:57.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=micxer",
                "name": "micxer",
                "displayName": "Michael Weinrich",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-03-09T11:23:54.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-03-12T04:13:48.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "With PECL fileinfo 1.0.4, PHP 5.2.10(.dfsg.1-2ubuntu6.4) and libmagic1 5.03(-ubuntu1), the code\r\n<code>\r\n$f = new finfo(FILEINFO_MIME); \r\necho $f->file(\"\/tmp\/store\/fS69Jh\");\r\n<\/code>\r\nreturns \r\n<code>image\/jpeg; charset=binary<\/code>.\r\n\r\nZend_Validate_File_MimeType->isValid() from Version 1.10.2 always returns false with the message fileMimeTypeFalse, because if the mime type isn't found in the given list for valid types, it is exploded by '\/' and by '-'. Then it tries again to find a valid mime type in the new list, which isn't successful and false is returned. A quick fix is attached as a patch, but the proper way would be to check if a charset is given and then remove it first."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9383\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12868",
                    "filename": "Zend_Validate_File_MimeType.php.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=micxer",
                        "name": "micxer",
                        "displayName": "Michael Weinrich",
                        "active": true
                    },
                    "created": "2010-03-09T12:16:21.000+0000",
                    "size": 509,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12868\/Zend_Validate_File_MimeType.php.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10412",
                    "id": 10412,
                    "description": "Mini Release",
                    "name": "1.10.1",
                    "userReleaseDate": "10\/Feb\/10",
                    "archived": false,
                    "releaseDate": "2010-02-10",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10430",
                    "id": 10430,
                    "description": "Mini Release",
                    "name": "1.10.2",
                    "userReleaseDate": "24\/Feb\/10",
                    "archived": false,
                    "releaseDate": "2010-02-24",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10321",
                    "id": 10321,
                    "name": "Zend_Validate_File",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39129",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Not reproducable...\r\n\r\nZF uses FILEINFO_MIME_TYPE when available (below 5.2.9 or below 1.0.0) which forces finfo not to return the charset but only the type information.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-03-09T12:21:57.000+0000",
                    "updated": "2010-03-09T12:21:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39166",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=verysimple",
                        "name": "verysimple",
                        "displayName": "Michael Ekoka",
                        "active": true
                    },
                    "body": "Just had the exact same issue. Ubuntu 9.10 PHP.5.2.10 ZF 1.10\r\n\r\nThe combination PHPv5.2, Fileinfo linked to a more recent libmagic (version unknown) will also produce mimetypes that look like \"image\/jpeg; charset=binary\" and according to [RFC2045|http:\/\/www.faqs.org\/rfcs\/rfc2045.html] this is kosher. The PHP team even considers this a bug fix [http:\/\/bugs.php.net\/48885].\r\n\r\nHowever, it seems that the new constant FILEINFO_MIME_TYPE is only available in 5.3, since FileInfo is only maintained there. I don't exactly know how old libmagic has to be for fileinfo to truncate the charset, but downgrading libmagic is not even an option since a substantial number of applications on linux depends on it.\r\n\r\nIf a workaround such as the one just submitted by M. Weinrich is not implemented, my suggestion would be to add a note in the documentation informing people with that machine profile that the best way to solve this issue is to either uninstall fileinfo and let mime_content_type do the job, or upgrade to PHP 5.3.\r\n\r\nmime_content_type is supposed to be deprecated, but then again why would I switch to FileInfo if it's only supported for 5.3+. It's not even in the Ubuntu repos and has to be explicitly installed through pecl. Personally, I don't see how or why it should be considered stable for v5.2.\r\n\r\nmime_content_type is doing a great job so far, until I switch to 5.3, I'll stick with it.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=verysimple",
                        "name": "verysimple",
                        "displayName": "Michael Ekoka",
                        "active": true
                    },
                    "created": "2010-03-11T09:53:40.000+0000",
                    "updated": "2010-03-11T09:53:40.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39182",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "According to the developer of FINFO the constant depends on the finfo release and not on the used PHP version.\r\n\r\nAnd the attached patch can not be implemented as it is based on an outdated release. Additionally I can not verify the behaviour. Even when setting the other constant manually within the core-code the mimetypes are recognised without problems.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-03-12T04:13:48.000+0000",
                    "updated": "2010-03-12T04:13:48.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9383\/transitions"
}