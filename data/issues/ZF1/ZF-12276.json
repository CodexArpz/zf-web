{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12276",
    "key": "ZF-12276",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "OpenID Sreg extension:: parseRequest overwrites provided credentials when used in the provider context"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12276\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alanbdee",
                "name": "alanbdee",
                "displayName": "Alan B. Dee",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2012-06-11T18:25:36.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-06-11T18:25:36.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "openid",
                "provider"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "It appears that when providing the requested credentials to sreg extension in the provider context it overrides those credentials with booleans. \r\nProvider example: \r\n\/\/... pull user info\r\n$user_params = array(\r\n\t\t'nickname' => $user->getNickName(),\r\n\t\t'fullname' => $user->getFullName(),\r\n\t\t'email' => $user->getEmail()\r\n);\r\n$sreg = new iChain_OpenId_Sreg($user_params);\r\n$ret = $provider->handle(null, $sreg);\r\nConsumer example: \r\n$props = \tarray(\r\n\t\t\"nickname\"=>false,\r\n\t\t\"email\"=>true,\r\n\t\t\"fullname\"=>true,\r\n);\t\r\n$sreg = new iChain_OpenId_Sreg($props, null, 2.0);\r\n$consumer = new Zend_OpenId_Consumer();\r\nif($consumer->verify($_GET, $id, $sreg)){\r\n     \/\/ $_GET[openid_sreg_email] => 1\r\n     \/\/ $_GET[openid_sreg_fullname] => 1\r\n}\r\n\r\nThe problem appears to be in Zend_OpenId_Extensions_Sreg::parseRequest. The unit tests only test the provided version number and policy url. When used in the consumer context it populates the $_props with a key\/value array of attributes and booleans (if those are required). When using it in the provider context that same property is used to hold the actual values the provider should be sending. Instead it sends those booleans back. \r\n\r\nA simple solution is to remove the following line from Zend_OpenId_Extensions_Sreg::parseRequest:\r\n$this->_props = (count($props2) > 0) ? $props2 : null; \r\nHowever it was put there for a reason and I am unsure why. I'm guessing to provide backwards compatibility with sreg 1.0 when used in the consumer context. "
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12276\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dmitry",
                "name": "dmitry",
                "displayName": "Dmitry Stogov",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10981",
                    "id": 10981,
                    "description": "Mini Release",
                    "name": "1.11.11",
                    "userReleaseDate": "29\/Sep\/11",
                    "archived": false,
                    "releaseDate": "2011-09-29",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10210",
                    "id": 10210,
                    "name": "Zend_OpenId",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [

            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12276\/transitions"
}