{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8393",
    "key": "ZF-8393",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Http\/Socket client timeout auto-retry"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/11",
                "name": "Patch",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8393\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-08-26T14:14:33.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbondc",
                "name": "jbondc",
                "displayName": "Jonathan Bond-Caron",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-11-25T10:50:00.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-08-26T14:14:33.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Occasionally, HTTP servers can timeout (bad network connection, busy server, ...)\r\n\r\nThe HTTP client adapters should be able to retry the connection if a timeout happens.\r\nI've only patched the socket adapter since it's the only I use and can test.\r\n\r\nIn my patch, the 'default timeout retry' = 2, I found it's a good value with real-world tests.\r\n\r\nBut it also changes the http client behavior, time spent on request is at most (timeout retry * timeout seconds).\r\n\r\nMaybe the best is to set 'default timeout retry' = 0 and add the patch in a mini release.\r\nThen set 'timeout retry' = 2 in the next minor release.\r\n\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8393\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                "name": "padraic",
                "displayName": "P\u00e1draic Brady",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12423",
                    "filename": "socket_timeout_retry.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbondc",
                        "name": "jbondc",
                        "displayName": "Jonathan Bond-Caron",
                        "active": true
                    },
                    "created": "2009-11-25T10:50:43.000+0000",
                    "size": 1876,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12423\/socket_timeout_retry.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10390",
                    "id": 10390,
                    "description": "Mini Release",
                    "name": "1.9.6",
                    "userReleaseDate": "24\/Nov\/09",
                    "archived": false,
                    "releaseDate": "2009-11-24",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10015",
                    "id": 10015,
                    "name": "Zend_Http_Client",
                    "description": "performs HTTP requests",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36517",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shahar",
                        "name": "shahar",
                        "displayName": "Shahar Evron",
                        "active": true
                    },
                    "body": "I personally don't think retry control belongs in the adapter. \r\n\r\nWhat I think we should do is use specific error codes in Zend_Http_Client_Adapter_Exception to designate things like timeout, and then users could easily implement retrying in their own code through some loop with try \/ catch, or subclass \/ encapsulate Z_H_C to do that.\r\n\r\nIf anything I think this belongs in the client and not in the adapter - it's the client's job to retry in case of failure. Second, I think Z_H_C is becoming too complex as it is, that's why I prefer the first solution.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shahar",
                        "name": "shahar",
                        "displayName": "Shahar Evron",
                        "active": true
                    },
                    "created": "2009-11-26T00:27:16.000+0000",
                    "updated": "2009-11-26T00:27:16.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36518",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "body": "i agree with you :)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "created": "2009-11-26T00:30:08.000+0000",
                    "updated": "2009-11-26T00:30:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36533",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbondc",
                        "name": "jbondc",
                        "displayName": "Jonathan Bond-Caron",
                        "active": true
                    },
                    "body": "I agree that retry control should not be in the the adapter.\r\n\r\nNot sure I understood if you think Z_H_C must have this functionality built in. I think it must have some builtin (simple) code for common cases.\r\n\r\nHow about this:\r\n- adapters throw Zend_Http_Client_Adapter_ConnectTimeoutException\r\n- Z_H_C automatically handles exception Zend_Http_Client_Adapter_ConnectTimeoutException\r\n  within builtin retry code (config parameter 'retry')\r\n\r\n- Users can disable the default 'exception recovery' by Z_H_C and for example implement their own retry control\r\n  $client->setConfig(array('exceptionrecovery' => false))\r\n  \r\nThis is somewhat similar to:\r\nhttp:\/\/hc.apache.org\/httpclient-3.x\/exception-handling.html\r\n\r\nI'm more interested in 'connection timeout' since that happens rather frequently.\r\nAs for throwing Zend_Http_Client_Adapter_Exception with specific error codes, that sounds great but more work to map the error codes in curl & socket adapters.\r\n\r\n\r\nAs a note, most http clients (curl, wget, ..) have a builtin retry feature:\r\n\r\n--retry <num>\r\n\r\nIf a transient error is returned when curl tries to perform a transfer, it will retry this number of times before giving up. Setting the number to 0 makes curl do no retries (which is the default). Transient error means either: a timeout, an FTP 5xx response code or an HTTP 5xx response code.\r\n\r\nWhen curl is about to retry a transfer, it will first wait one second and then for all forthcoming retries it will double the waiting time until it reaches 10 minutes which then will be the delay between the rest of the retries. By using --retry-delay you disable this exponential backoff algorithm. See also --retry-max-time to limit the total time allowed for retries. (Added in 7.12.3)\r\n\r\nIf this option is used multiple times, the last occurrence decide the amount. \r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbondc",
                        "name": "jbondc",
                        "displayName": "Jonathan Bond-Caron",
                        "active": true
                    },
                    "created": "2009-11-27T05:40:33.000+0000",
                    "updated": "2009-11-27T05:40:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48190",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "Marking issue as Won't Fix for the following reasons:\n\n1. This is an improvement and should be targeted for ZF2. I'd suggest the reporter file a ZF2 feature request for it.\n2. We are unable to introduce new behaviour in a mini release and there is no certainty that a new minor 1.12 release will have sufficient resources to do anything except improve MVC forward compatibility with ZF2.\n ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2011-08-26T14:14:33.000+0000",
                    "updated": "2011-08-26T14:14:33.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8393\/transitions"
}