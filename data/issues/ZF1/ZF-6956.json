{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6956",
    "key": "ZF-6956",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_CodeGenerator_Php_Property::fromReflection() has no meaningful implementation -- patch provided"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/5",
                "name": "Sub-task",
                "subtask": true
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6956\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-06-28T13:15:52.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=448191",
                "name": "448191",
                "displayName": "John Kleijn",
                "active": true
            }
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-06-08T10:06:11.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-06-28T13:15:52.000+0000"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": ".. also Zend_Reflection_Property is missing includes.\n\nBasically Zend_CodeGenerator_Php_Property::fromReflection() does nothing with the $reflectionProperty argument: no state is set. Below is a patch which fixes this deficiency and adds unit tests. isStatic() is broken, but there already is a bug report for that (ZF-6444). Other issues exist with Zend_CodeGenerator and Zend_Reflection as well. If I find time I'll post them, if not someone should take a close look at those components. I don't think they should have been released yet.\n\nThis patch was created on the 1.8.3 tag (but the issue also exists in 1.8.2):\n\nIndex: tests\/Zend\/CodeGenerator\/Php\/PropertyTest.php.\n===================================================================\n{code}\n--- tests\/Zend\/CodeGenerator\/Php\/PropertyTest.php\t(revision 15950)\n+++ tests\/Zend\/CodeGenerator\/Php\/PropertyTest.php\t(working copy)\n@@ -18,7 +18,6 @@\n  * @copyright  Copyright (c) 2005-2008 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n  * @license    http:\/\/framework.zend.com\/license\/new-bsd     New BSD License\n  *\/\n-\n \/**\n  * @see TestHelper\n  *\/\n@@ -24,6 +23,7 @@\n  *\/\n require_once dirname(__FILE__) . '\/..\/..\/..\/TestHelper.php';\n \n+require_once 'Zend\/Reflection\/Property.php';\n require_once 'Zend\/CodeGenerator\/Php\/Property.php';\n \n \/**\n@@ -37,8 +37,11 @@\n  *\/\n class Zend_CodeGenerator_Php_PropertyTest extends PHPUnit_Framework_TestCase\n {\n+    private $_dummyProperty = 'foo';\n+    \n+    protected static $_dummyStaticProperty = 'bar';\n     \n-    public function testConstructor()\n+    public function testConstructor ()\n     {\n         $codeGenProperty = new Zend_CodeGenerator_Php_Property();\n         $this->isInstanceOf($codeGenProperty, 'Zend_CodeGenerator_Php_Property');\n@@ -44,6 +47,39 @@\n         $this->isInstanceOf($codeGenProperty, 'Zend_CodeGenerator_Php_Property');\n     }\n     \n+    public function testWillLoadFromReflection ()\n+    {\n+        $reflProp = new Zend_Reflection_Property(__class__, '_dummyProperty');\n+        \n+        $cgProp = Zend_CodeGenerator_Php_Property::fromReflection($reflProp);\n+        \n+        $this->assertSame($cgProp->getName(), '_dummyProperty');\n+        $this->assertSame($cgProp->getDefaultValue(), 'foo');\n+        $this->assertSame($cgProp->getVisibility(), 'private');\n+        \n+        $reflProp = new Zend_Reflection_Property(__class__, '_dummyStaticProperty');\n+        \n+        $cgProp = Zend_CodeGenerator_Php_Property::fromReflection($reflProp);\n+        \n+        $this->assertSame($cgProp->getName(), '_dummyStaticProperty');\n+        $this->assertSame($cgProp->getDefaultValue(), 'bar');\n+        $this->assertSame($cgProp->getVisibility(), 'protected');\n+    }\n     \n-    \n+    public function testZF6444 ()\n+    {\n+        $this->markTestInComplete(\"Depends on ZF-6444\");\n+        \n+        $reflProp = new Zend_Reflection_Property(__class__, '_dummyProperty');\n+        \n+        $cgProp = Zend_CodeGenerator_Php_Property::fromReflection($reflProp);\n+        \n+        $this->assertFalse($cgProp->isStatic());\n+        \n+        $reflProp = new Zend_Reflection_Property(__class__, '_dummyStaticProperty');\n+        \n+        $cgProp = Zend_CodeGenerator_Php_Property::fromReflection($reflProp);\n+        \n+        $this->assertTrue($cgProp->isStatic());\n+    }\n }\n{code}\n\nIndex: library\/Zend\/Reflection\/Property.php\n===================================================================\n{code}\n--- library\/Zend\/Reflection\/Property.php\t(revision 15950)\n+++ library\/Zend\/Reflection\/Property.php\t(working copy)\n@@ -19,6 +19,10 @@\n  * @version    $Id$\n  *\/\n \n+require_once 'Zend\/Reflection\/Class.php';\n+require_once 'Zend\/Reflection\/Docblock.php';\n+require_once 'Zend\/Reflection\/Exception.php';\n+\n \/**\n  * @todo       implement line numbers\n  * @category   Zend\n@@ -38,7 +42,6 @@\n         $phpReflection  = parent::getDeclaringClass();\n         $zendReflection = new $reflectionClass($phpReflection->getName());\n         if (!$zendReflection instanceof Zend_Reflection_Class) {\n-            require_once 'Zend\/Reflection\/Exception.php';\n             throw new Zend_Reflection_Exception('Invalid reflection class provided; must extend Zend_Reflection_Class');\n         }\n         unset($phpReflection);\n{code}\n\nIndex: library\/Zend\/CodeGenerator\/Php\/Property.php\n===================================================================\n{code}\n--- library\/Zend\/CodeGenerator\/Php\/Property.php\t(revision 15950)\n+++ library\/Zend\/CodeGenerator\/Php\/Property.php\t(working copy)\n@@ -26,6 +26,11 @@\n require_once 'Zend\/CodeGenerator\/Php\/Member\/Abstract.php';\n \n \/**\n+ * @see Zend_Reflection_Property\n+ *\/\n+require_once 'Zend\/Reflection\/Property.php';\n+\n+\/**\n  * @category   Zend\n  * @package    Zend_CodeGenerator\n  * @copyright  Copyright (c) 2005-2009 Zend Technologies USA Inc. (http:\/\/www.zend.com)\n@@ -42,7 +47,7 @@\n      * @var string\n      *\/\n     protected $_defaultValue = null;\n-\n+    \n     \/**\n      * fromReflection()\n      *\n@@ -51,6 +56,25 @@\n      *\/\n     public static function fromReflection(Zend_Reflection_Property $reflectionProperty) {\n         $property = new self();\n+        \n+        $property->setName($reflectionProperty->getName());\n+        \n+        $allDefaultProperties = $reflectionProperty->getDeclaringClass()->getDefaultProperties();\n+        \n+        $property->setDefaultValue($allDefaultProperties[$reflectionProperty->getName()]);\n+        \n+        if ($reflectionProperty->getDocComment()) {\n+            $property->setDocblock(Zend_CodeGenerator_Php_Docblock::fromReflection($reflectionProperty->getDocComment()));\n+        }\n+        \n+        if ($reflectionProperty->isPrivate()) {\n+            $property->setVisibility(self::VISIBILITY_PRIVATE);\n+        } elseif ($reflectionProperty->isProtected()) {\n+            $property->setVisibility(self::VISIBILITY_PROTECTED);\n+        } else {\n+            $property->setVisibility(self::VISIBILITY_PUBLIC);\n+        }\n+        \n         $property->setSourceDirty(false);\n         \n         return $property;\n{code}\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6956\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                "name": "ralph",
                "displayName": "Ralph Schindler",
                "active": true
            }
        },
        "parent": {
            "name": "parent",
            "type": "issuelinks",
            "value": {
                "issueKey": "ZF-6962",
                "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6962",
                "type": {
                    "name": "Parent",
                    "direction": "INBOUND"
                }
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11989",
                    "filename": "ZF-6956.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=448191",
                        "name": "448191",
                        "displayName": "John Kleijn",
                        "active": true
                    },
                    "created": "2009-06-08T10:08:43.000+0000",
                    "size": 5386,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11989\/ZF-6956.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10330",
                    "id": 10330,
                    "description": "Mini Release",
                    "name": "1.8.2",
                    "userReleaseDate": "27\/May\/09",
                    "archived": false,
                    "releaseDate": "2009-05-27",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10407",
                    "id": 10407,
                    "name": "Zend_CodeGenerator",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31674",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=448191",
                        "name": "448191",
                        "displayName": "John Kleijn",
                        "active": true
                    },
                    "body": "Mentioned patch not screwed up by wiki formatting",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=448191",
                        "name": "448191",
                        "displayName": "John Kleijn",
                        "active": true
                    },
                    "created": "2009-06-08T10:08:47.000+0000",
                    "updated": "2009-06-08T10:08:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31698",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=448191",
                        "name": "448191",
                        "displayName": "John Kleijn",
                        "active": true
                    },
                    "body": "Patch included in patch in ZF-6962",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=448191",
                        "name": "448191",
                        "displayName": "John Kleijn",
                        "active": true
                    },
                    "created": "2009-06-09T05:19:33.000+0000",
                    "updated": "2009-06-09T05:19:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32245",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "Fixed in r16344",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2009-06-28T13:15:52.000+0000",
                    "updated": "2009-06-28T13:15:52.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6956\/transitions"
}