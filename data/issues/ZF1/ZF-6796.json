{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6796",
    "key": "ZF-6796",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Form_Element_File - unable to create a Custom ErrorMessage"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6796\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/3",
                "name": "Duplicate"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10241",
                    "id": 10241,
                    "description": "Minor Release",
                    "name": "1.8.0",
                    "userReleaseDate": "30\/Apr\/09",
                    "archived": false,
                    "releaseDate": "2009-04-30",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-05-26T06:48:01.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=virus-2k",
                "name": "virus-2k",
                "displayName": "Gerrit B",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-05-25T06:57:25.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-05-26T06:47:59.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I think a Code explains it very well.\nI want to Add Custom Error Messages in a Zend_Form_Element_File-Field.\nIn a Zend_Form_Element_Text this is no Problem and works well with $form->txtelementname->addError( 'custom message' )\n\nBut it doesn't work with Zend_Form_Element_File. Here's a example code (copied from my controller)\n\nI needed this because i want to check the filemime with _my_ function. (Please ask not why because i think that's irrelevant)\n\n{code:php} \n<?php\n\n\/\/ inner action function\n\nrequire_once( FORM_PATH . 'AdminDownloadUpload.php' );\n$form = new Frm_AdminDownloadUpload();\n\nif( $this->getRequest()->isPost() ) {\n        \t\n        \t$fileValid = false;\n        \tif( $form->file->isValid( $this->getRequest()->getPost() ) ) {\n        \t   if( !$form->file->receive() ) {\n                    $form->file->addError( 'admin.download.lblFileUploadFailed' );\n                }\n\n                if( !$form->isErrors() && $form->file->isUploaded() && $form->file->isReceived() ) {\n                \t\/\/ check for valid mime\n                \t$check = Frames::getInstance()->checkMime( null, $form->file->getFileName() );\n                \tif( !$check ) {\n                \t\t$form->file->addError( 'admin.download.lblFileUploadFailedMimeType' );\n                \t\t@unlink( $form->file->getFileName() );\n                \t} else {\n                \t\t$fileValid = true;\n                \t}\n                }\n        \t}\n        \tif( $form->isValid( $this->getRequest()->getPost() ) ) {\n        \t\t$post = $form->getValues();\n        \t\t\n        \t\t\/\/ works?!        \t\t\n        \t\tvar_dump( $post );\n        \t\tdie;\n        \t} else {\n        \t\t\/\/ delete file again because form isn't valid\n        \t\tif( $fileValid ) {\n        \t\t    $form->file->addError( 'admin.download.lblFileUploadFailedFormNotValid' );\n        \t\t    if( file_exists( $form->file->getFileName() ) ) @unlink( $form->file->getFileName() );\n        \t\t}\n        \t}\n        }\n\n        $this->view->assign( 'form', $form );\n\n?>\n{\/code}\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6796\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10272",
                    "id": 10272,
                    "description": "Mini Release",
                    "name": "1.7.5",
                    "userReleaseDate": "16\/Feb\/09",
                    "archived": false,
                    "releaseDate": "2009-02-16",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31333",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Are you sure you're on ZF 1.8 ?\nThe actual unittests for this component cover also addError and show no problem. User-errors are also returned.\n\nWhat your code does not explain is what you get returned as failure because I don't see that you are calling getErrors().",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-05-25T14:07:56.000+0000",
                    "updated": "2009-05-25T14:07:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31336",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=virus-2k",
                        "name": "virus-2k",
                        "displayName": "Gerrit B",
                        "active": true
                    },
                    "body": "I use the Zend MVC. So i only do a <?= $form ?> in the Template.\nI don't use getErrors because Zend_Form does the Job for me?! (as you see in the Controller $form->isValid..)\n\nOn all other Fields I got a ErrorMessage (incl. CustomErrorMessages) right under the input-Field except for the File Element.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=virus-2k",
                        "name": "virus-2k",
                        "displayName": "Gerrit B",
                        "active": true
                    },
                    "created": "2009-05-25T15:12:10.000+0000",
                    "updated": "2009-05-25T15:12:10.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31352",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I tried to reproduce this, but I was not able.\nAll output is like expected.\n\nSee the following testcode:\n\n{code}\n<?php\nerror_reporting(E_ALL|E_STRICT);\nini_set('include_path',ini_get('include_path').PATH_SEPARATOR.'..\/library');\nrequire_once('Zend\/Loader\/Autoloader.php');\n$loader = Zend_Loader_Autoloader::getInstance();\n\n\n$request = new Zend_Controller_Request_Http();\n\n\/\/ setup the form\n$form = new Zend_Form();\n$form->setMethod(Zend_Form::METHOD_POST)\n     ->setAttrib('enctype', Zend_Form::ENCTYPE_MULTIPART);\n\n        $form = new Zend_Form();\n$element  = new Zend_Form_Element_File('file');\n$element->setLabel('Image');\n$element->setAttrib('class', 'myClass');\n$element->setRequired(true);\n$element->addFilter('rename', array('target' => 'C:\/temp\/myfile.file', 'overwrite' => true));\n\n$form->addElement($element);\n$form->setAttrib('enctype', 'multipart\/form-data');\n$form->addElement('submit', 'Submit');\n\n\n\/\/ check the form\nif($request->isPost()) {\n    $formData = $request->getPost();\n    if($form->isValid($formData)) {\n        $form->file->addError('Test Error before receive');\n        $form->file->receive();\n        $form->file->addError('Test Error after receive');\n    } else {\n        $form->file->addError('Test Error when invalid');\n\/\/        print_r($form->file->getMessages());\n    }\n}\n\n?>\n\n<html>\n<head>\n<title>Test<\/title>\n<\/head>\n<body>\n<?php echo $form->render(new Zend_View());?>\n<\/body>\n<\/html>\n{code}\n\nUploading a file I am getting:\n* Test Error before receive\n* Test Error after receive\n\nUploading a invalid file I get:\n* The file 'file' was not uploaded\n* Test Error when invalid\n\nAll error messages are returned as expected.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-05-26T03:13:58.000+0000",
                    "updated": "2009-05-26T03:13:58.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31357",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=virus-2k",
                        "name": "virus-2k",
                        "displayName": "Gerrit B",
                        "active": true
                    },
                    "body": "Ok, ok. It's all my fault.\n\nI checked the Versions now and found out, that the Script uses the ZF installed on Server (which was 1.7.5) and not the ZF in my Library Path.\nIt works as expected with Version 1.8.1 and I'm sorry for my mistake. :-\/\n\nThanks anyway.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=virus-2k",
                        "name": "virus-2k",
                        "displayName": "Gerrit B",
                        "active": true
                    },
                    "created": "2009-05-26T05:40:32.000+0000",
                    "updated": "2009-05-26T05:40:32.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31358",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=virus-2k",
                        "name": "virus-2k",
                        "displayName": "Gerrit B",
                        "active": true
                    },
                    "body": "I've updated this issue to Version 1.7.5 not 1.8.1.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=virus-2k",
                        "name": "virus-2k",
                        "displayName": "Gerrit B",
                        "active": true
                    },
                    "created": "2009-05-26T05:41:51.000+0000",
                    "updated": "2009-05-26T05:41:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31359",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Closing as duplicate",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-05-26T06:47:56.000+0000",
                    "updated": "2009-05-26T06:47:56.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6796\/transitions"
}