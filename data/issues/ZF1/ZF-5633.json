{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5633",
    "key": "ZF-5633",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Wrong response code when header location is used"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5633\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-09-18T12:56:21.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=symetrix",
                "name": "symetrix",
                "displayName": "Symetrix",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-01-26T01:45:09.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-10-07T06:55:17.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "code",
                "header",
                "headers",
                "location",
                "response",
                "responseCode"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "When setting location header, and when this header is not the first, the responseCode is ignore because \nheader ($header['name'], . ': ' . $header['value'], $header['replace'])\nmodify the response code if $header['name'] == 'location'"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5633\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10271",
                    "id": 10271,
                    "description": "Mini Release",
                    "name": "1.7.2",
                    "userReleaseDate": "23\/Dec\/08",
                    "archived": false,
                    "releaseDate": "2008-12-23",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10011",
                    "id": 10011,
                    "name": "Zend_Controller",
                    "description": "front controller, including router and dispatcher",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34648",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=travisp",
                        "name": "travisp",
                        "displayName": "Travis Pew",
                        "active": true
                    },
                    "body": "I guess this is because for php, the location header is a special case:\n\n{quote} The second special case is the \"Location:\" header. Not only does it send this header back to the browser, but it also returns a REDIRECT (302) status code to the browser unless some 3xx status code has already been set. \n[PHP: header - Manual|http:\/\/www.php.net\/manual\/en\/function.header.php]\n{quote}\n\nCurrently:\nThe responseCode that Zend_Controller_Response sets will depend on whether or not the location header is the first header that Zend comes across. If the location header was the first header that was set, _httpResponseCode if set will override the location header. If the location header is not the first header that was set, php's standard behavior will be followed (overriding _httpResponseCode if it was anything other than 201 or 3xx).\n\nI don't think what Symetrix thought was a problem should be a problem but I think there is another potential problem:\nA user sets a responseCode, then later sets the location header (this is the only header that the user sets). The user's location header will essentially be overruled by the *prior* set responseCode:\n\n{code}\n$response = new Zend_Controller_Response_Http();\n$response->setHttpResponseCode(200);\n$response->setHeader('location', 'http:\/\/www.php.net');\n$response->sendHeaders();\n\/\/result = HTTP\/1.1 200 OK\n\n$response = new Zend_Controller_Response_Http();\n$response->setHttpResponseCode(200);\n$response->setHeader('X-test', 'test');\n$response->setHeader('location', 'http:\/\/www.php.net');\n$response->sendHeaders();\n\/\/result = HTTP\/1.1 302 Found\n{code}\n\nEither the httpResponseCode should be the code that is always sent back or we should let location override the response code regardless of whether it was the first or second set header.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=travisp",
                        "name": "travisp",
                        "displayName": "Travis Pew",
                        "active": true
                    },
                    "created": "2009-09-18T09:36:25.000+0000",
                    "updated": "2009-09-18T09:36:25.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34672",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Calling setHeader('Location', '...') will not set the response code (unless, of course, PHP does when it detects the Location header). If you call setRedirect(), however, you have the option of providing a response code -- and in that case, it *will* set the response code.\n\nThere are reasons for this. For instance, with REST, when a new item is POST'd, you should specify a \"201: Created\" header, but also include a \"Location\" header pointing to the URI for the newly created resource. If setHeader('Location', ...') actually set the response code automatically, this would be problematic",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2009-09-18T12:56:11.000+0000",
                    "updated": "2009-09-18T12:56:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35105",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=airr",
                        "name": "airr",
                        "displayName": "I Yu",
                        "active": true
                    },
                    "body": "How i can fix this problem? \nWebDav-classes do not work with this problem.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=airr",
                        "name": "airr",
                        "displayName": "I Yu",
                        "active": true
                    },
                    "created": "2009-10-07T06:55:15.000+0000",
                    "updated": "2009-10-07T06:55:15.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5633\/transitions"
}