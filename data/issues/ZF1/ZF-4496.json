{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4496",
    "key": "ZF-4496",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Test_PHPUnit_ControllerTestCase breaks data provider tests"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4496\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-11-09T12:39:36.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bradley.holt",
                "name": "bradley.holt",
                "displayName": "Bradley Holt",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-10-06T05:34:45.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-11-24T02:28:19.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Data provider tests do not work within test cases that extend Zend_Test_PHPUnit_ControllerTestCase. In other test cases extending PHPUnit_Framework_TestCase directly, data providers seem to work fine. Here is a test within the CourseControllerTest class which extends Zend_Test_PHPUnit_ControllerTestCase:\n\n    \/**\n     * @dataProvider seedCourses\n     * @param string $id\n     *\/\n    public function testShowActionWithGetMethodAndIdParameterShouldContainCourseData($id)\n    {\n        $this->getRequest()->setMethod('GET');\n        $this->dispatch('\/course\/show\/' . $id . '\/');\n        $this->assertResponseCode(200);\n    }\n\nAnd the data provider (also within the CourseControllerTest class):\n\n    \/**\n     * @return array\n     *\/\n    public static function seedCourses()\n    {\n        return array(\n            '1'          => array('1'),\n            '65535'      => array('FFFF'),\n        );\n    }\n\nI expect the following when I run the test with \"phpunit --testdox\":\n\nCourseController\n[x] Show action with get method and id parameter should contain course data with data set \"1\"\n[x] Show action with get method and id parameter should contain course data with data set \"65535\"\n\nBut instead I get:\n\nCourseController\n[] Show action with get method and id parameter should contain course data\n\nIf I run without \"--testdox\" I see the following error message:\n\nMissing argument 1 for CourseControllerTest::testShowActionWithGetMethodAndIdParameterShouldContainCourseData()\n\nIt appears that something within Zend_Test_PHPUnit_ControllerTestCase is preventing data provider tests from working correctly and this is just being seen as a \"regular\" test."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4496\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10201",
                    "id": 10201,
                    "description": "Mini Release",
                    "name": "1.6.1",
                    "userReleaseDate": "15\/Sep\/08",
                    "archived": false,
                    "releaseDate": "2008-09-15",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10312",
                    "id": 10312,
                    "name": "Zend_Test_PHPUnit",
                    "description": "PHPUnit test scaffolding for ZF MVC applications",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25092",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bradley.holt",
                        "name": "bradley.holt",
                        "displayName": "Bradley Holt",
                        "active": true
                    },
                    "body": "I removed my constructor and now data driven tests work correctly. My constructor did have a call to parent::__construct() so I'm not sure why this makes a difference.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bradley.holt",
                        "name": "bradley.holt",
                        "displayName": "Bradley Holt",
                        "active": true
                    },
                    "created": "2008-10-12T10:07:57.000+0000",
                    "updated": "2008-10-12T10:07:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25876",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "I just tried the following:\n{code}\n    \/**\n     * @dataProvider provider\n     *\/\n    public function testIteration($id)\n    {\n        $url = '\/index\/index\/id\/' . $id;\n        $this->dispatch($url);\n        $this->assertEquals($id, $this->request->getParam('id'));\n    }\n\n    public function provider()\n    {\n        return array(\n            array(1),\n            array(2),\n            array(3),\n        );\n    }\n{code}\nand it worked as expected.\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-11-07T12:00:13.000+0000",
                    "updated": "2008-11-07T12:00:13.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25892",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bradley.holt",
                        "name": "bradley.holt",
                        "displayName": "Bradley Holt",
                        "active": true
                    },
                    "body": "Try adding a constructor and it should break:\n\n{code}\n    public function __construct()\n    {\n        parent::__construct(); \n    }\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bradley.holt",
                        "name": "bradley.holt",
                        "displayName": "Bradley Holt",
                        "active": true
                    },
                    "created": "2008-11-07T13:37:39.000+0000",
                    "updated": "2008-11-07T13:37:39.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25984",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "I just tested, and what you say is true. However, it's also true of *any* TestCase extending PHPUnit_Framework_TestCase -- I verified this by writing the following:\n\n{code}\n<?php\nclass FooTest extends PHPUnit_Framework_TestCase\n{\n    public function __construct()\n    {\n        parent::__construct();\n    }\n\n    \/**\n     * @dataProvider provider\n     *\/\n    public function testProvider($id)\n    {\n        $this->assertNotNull($id);\n    }\n\n    public function provider()\n    {\n        return array(\n            array(1),\n            array(2),\n            array(3),\n        );\n    }\n}\n?>\n{code}\n\nThis results in the same error -- \"Missing argument 1 for FooTest::testProvider()\". \n\nI'm filing a report upstream to the PHPUnit project.\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-11-09T12:27:54.000+0000",
                    "updated": "2008-11-09T12:27:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25985",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "A ticket already exists for it: http:\/\/www.phpunit.de\/ticket\/602\n\nI re-opened the ticket, which was closed for PHPUnit 3.3.4, after verifying that the code still does not work as expected. Please track the PHPUnit ticket for updates, as this is an upstream issue, and not a ZF issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-11-09T12:39:14.000+0000",
                    "updated": "2008-11-09T12:39:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36452",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=twisty",
                        "name": "twisty",
                        "displayName": "Tim Brayshaw",
                        "active": true
                    },
                    "body": "Also see http:\/\/www.phpunit.de\/ticket\/824, which has disabled the functionality to print the data set information.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=twisty",
                        "name": "twisty",
                        "displayName": "Tim Brayshaw",
                        "active": true
                    },
                    "created": "2009-11-24T02:28:18.000+0000",
                    "updated": "2009-11-24T02:28:18.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4496\/transitions"
}