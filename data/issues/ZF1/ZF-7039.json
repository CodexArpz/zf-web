{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7039",
    "key": "ZF-7039",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Service_Amazon_Ec2 Improperly Formats Signature\/Request"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7039\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10320",
                    "id": 10320,
                    "description": "Minor Release",
                    "name": "1.9.0",
                    "userReleaseDate": "31\/Jul\/09",
                    "archived": false,
                    "releaseDate": "2009-07-31",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-06-30T18:27:25.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=edoceo",
                "name": "edoceo",
                "displayName": "edoceo",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-06-18T00:08:03.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-07-31T20:53:54.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "EC2 Services use the API from 2008-12-01 and the current version is 2009-04-04\n\nWhen signing requests the documentation states the code is setting the Timestamp parameter but the code actually sets Expires to the current time.\nTimestamp should be set to the current time, or Expires should be set to a few seconds in the future\nThe code also used gmdate('c') which creates a timestamp in the wrong format for AWS\n\nWhen signing requests Amazons documentation says that we *should* include empty parameters (ie \"...Device=&Force=&InstanceId=&...\") and the signature code does this, however when the Parameters are passed to the Zend_Http_Client that code drops empty (===null) data and changes the data we send that AWS expects to see to get the Signature:\n\nObserve (data to sign)\n-----\nPOST\nec2.amazonaws.com\n\/\nAWSAccessKeyId=0XXXYXXX7XXX3XXXDXXX&Action=DetachVolume&Device=&Force=&InstanceId=&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2009-06-18T06%3A57%3A20Z&Version=2008-12-01&VolumeId=vol-0de71234\n-----\n\nObserve (data sent)\n-----\nAction=DetachVolume&VolumeId=vol-0de70864&Force=0&AWSAccessKeyId=0JG3YBM57GQM3BJWDT02&SignatureVersion=2&Timestamp=2009-06-18T06%3A57%3A20Z&Version=2008-12-01&SignatureMethod=HmacSHA256&Signature=XAXCu8itY1%2BIPanMf6qnx1pMCrQ20gzzS2Wgs99kl5Y%3D\n-----\n\nNotice that DeviceID and InstanceID have been dropped as well as Force has changed from blank to zero\n(This is behaviour request calling detachVolume and only passing the volume_id paramter)  That is to say:\n\nSaying this:\n$ebs->detachVolume('vol-0de71234')\nwill fail because the signature it creates is not valid\n\nBut if we say this\n$ebs->detachVolume('vol-0de71234','','',0)\nThe signature will succeed\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7039\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                "name": "sidhighwind",
                "displayName": "Jon Whitcraft",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-7163",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7163",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12021",
                    "filename": "zf-ebs.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=edoceo",
                        "name": "edoceo",
                        "displayName": "edoceo",
                        "active": true
                    },
                    "created": "2009-06-18T00:13:38.000+0000",
                    "size": 1781,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12021\/zf-ebs.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10331",
                    "id": 10331,
                    "description": "Mini Release",
                    "name": "1.8.3",
                    "userReleaseDate": "09\/Jun\/09",
                    "archived": false,
                    "releaseDate": "2009-06-09",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10404",
                    "id": 10404,
                    "name": "Zend_Service_Amazon_Ec2",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31942",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=edoceo",
                        "name": "edoceo",
                        "displayName": "edoceo",
                        "active": true
                    },
                    "body": "This is a patch that does two things:\n\n1) Forces data types for parameters on EBS->detachVolume() so they are treated the same by both Zend_Service_Amazon_Ec2_Abstract and Zend_Client_Http to correct the signature issue\n\n2) Fixes a minor formatting issue in Zend_Service_Amazon_Ec2_Abstract\n\n3) Changes the AWS parameter from Expires to Timestamp (which should help users who's clocks are off by a little bit)\n\n4) Changes the format of the Timestamp value to match exactly with what Amazon wants.\n\ngmdate('c');  - this format includes a trailing '+00:00' which AWS hates (but has seemed to work so far (oddly))\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=edoceo",
                        "name": "edoceo",
                        "displayName": "edoceo",
                        "active": true
                    },
                    "created": "2009-06-18T00:13:42.000+0000",
                    "updated": "2009-06-18T00:13:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31947",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "body": "I am currently working on the update to 04-04-2009 and I should have it ready to check into the trunk by next monday.  Once I get [ZF-6717|http:\/\/framework.zend.com\/issues\/browse\/ZF-6717] done I will apply this patch and post it.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "created": "2009-06-18T03:18:18.000+0000",
                    "updated": "2009-06-18T03:18:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32309",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "body": "Fixed merged into the release branch with r16392",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "created": "2009-06-30T18:27:25.000+0000",
                    "updated": "2009-06-30T18:27:25.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7039\/transitions"
}