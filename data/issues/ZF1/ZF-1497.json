{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1497",
    "key": "ZF-1497",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Session doesn't allow you to destory\/recreate a session"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField",
            "value": {
                "timeoriginalestimate": 4320,
                "timeestimate": 4320
            }
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1497\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10170",
                    "id": 10170,
                    "description": "Mini Release",
                    "name": "1.0.4",
                    "userReleaseDate": "26\/Feb\/08",
                    "archived": true,
                    "releaseDate": "2008-02-26",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-02-19T12:35:52.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coogle",
                "name": "coogle",
                "displayName": "John Coggeshall",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2007-06-05T15:45:23.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-08-26T10:38:13.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "The following doesn't work:\n\n{code}\nZend_Session::start();\nZend_Session::destroy();\nZend_Session::start();\n{code}\n\nIt never writes any session data, because the second start() command is silently ignored.\n\nHere is a patch which fixes the problem:\n\n{code}\nIndex: Session.php\n===================================================================\n--- Session.php (revision 5124)\n+++ Session.php (working copy)\n@@ -360,11 +360,6 @@\n                . \" output started in {$filename}\/{$linenum}\");\n         }\n\n-        \/\/ See http:\/\/www.php.net\/manual\/en\/ref.session.php for explanation\n-        if (defined('SID')) {\n-            throw new Zend_Session_Exception('session has already been started by session.auto-start or session_start()');\n-        }\n-\n         \/**\n          * Hack to throw exceptions on start instead of php errors\n          * @see http:\/\/framework.zend.com\/issues\/browse\/ZF-1325\n@@ -379,6 +374,7 @@\n            throw new Zend_Session_Exception(__CLASS__ . '::' . __FUNCTION__ . '() - ' . Zend_Session_Exception::$sessionStartError);\n         }\n\n+        self::$_destroyed = false;\n         parent::$_readable = true;\n         parent::$_writable = true;\n         self::$_sessionStarted = true;\n@@ -594,11 +590,15 @@\n         }\n\n         session_destroy();\n+\n         self::$_destroyed = true;\n-\n+               self::$_sessionStarted = false;\n+               self::$_regenerateIdState = -1;\n+\n         if ($remove_cookie) {\n             self::expireSessionCookie();\n         }\n     }\n{code}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/customFieldOption\/10039",
                "value": "  Should Have"
            }
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1497\/watchers",
                "isWatching": false,
                "watchCount": 4
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "zf-crteam-padraic",
                "zf-crteam-priority"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                "name": "ralph",
                "displayName": "Ralph Schindler",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-11420",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11420",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10023",
                    "id": 10023,
                    "description": "Release Candidate 1",
                    "name": "1.0.0 RC1",
                    "userReleaseDate": "28\/May\/07",
                    "archived": true,
                    "releaseDate": "2007-05-28",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10096",
                    "id": 10096,
                    "name": "Zend_Session",
                    "description": "A standardized interface to common functionality found in or indigenous to site session implementations. ",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/15004",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Assign to Darby.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-06-07T11:26:36.000+0000",
                    "updated": "2007-06-07T11:26:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/16116",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "John, I dont follow what the use case is here.\n\nStart\nDestroy\nStart.. \n\nAll within a single request, aside from making it \"possible\", I am interested in the Use case you present for applications to do this.\n\n-ralph",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2007-08-01T12:30:23.000+0000",
                    "updated": "2007-08-01T12:30:23.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/16201",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coogle",
                        "name": "coogle",
                        "displayName": "John Coggeshall",
                        "active": true
                    },
                    "body": "The idea here probably was that I wanted to start from scratch with a new session every time that particular controller was called, although I'm pretty sure the code itself has changed to the point where that use-case has disappeared.\n\nRegardless, nothing should just be silently ignored -- it should either tell me I'm using the API incorrectly or do what I ask it to.\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coogle",
                        "name": "coogle",
                        "displayName": "John Coggeshall",
                        "active": true
                    },
                    "created": "2007-08-06T09:33:58.000+0000",
                    "updated": "2007-08-06T09:33:58.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/19132",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "Added a check in Zend_Session::start() to throw an exception if destroy was called before start().\n\nIn r8010.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2008-02-14T15:09:11.000+0000",
                    "updated": "2008-02-14T15:09:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46927",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tvgece",
                        "name": "tvgece",
                        "displayName": "venu",
                        "active": true
                    },
                    "body": "My requirement is, When user agent change session should destroy, and it should start new session. But Zend_Session::start() is throwing an exception if destroy was called before start().\r\n\r\n<pre>\r\ntry { \r\nZend_Session::start();\r\n } catch (Zend_Session_Exception $e) {\r\n Zend_Session::destroy(true); \r\nZend_Session::start(); \/\/ breaking here \r\nZend_Session::regenerateId(); \r\n}\r\nZend_Session::registerValidator(new Zend_Session_Validator_HttpUserAgent());\r\n<\/pre>\r\n\r\n\r\nI have a global session management in bootstrap, which validates the request and starts session. By that time, request won't be dispatched. Then why to make another request to redirect to another page? As we already knew that session is wrong one? we could easily start new one right?\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tvgece",
                        "name": "tvgece",
                        "displayName": "venu",
                        "active": true
                    },
                    "created": "2011-05-31T13:10:29.000+0000",
                    "updated": "2011-05-31T13:10:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46928",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tvgece",
                        "name": "tvgece",
                        "displayName": "venu",
                        "active": true
                    },
                    "body": "I have posted a new issue here, Please check it once",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tvgece",
                        "name": "tvgece",
                        "displayName": "venu",
                        "active": true
                    },
                    "created": "2011-05-31T13:11:32.000+0000",
                    "updated": "2011-05-31T13:11:32.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46930",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tvgece",
                        "name": "tvgece",
                        "displayName": "venu",
                        "active": true
                    },
                    "body": "here it is http:\/\/framework.zend.com\/issues\/browse\/ZF-11420",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tvgece",
                        "name": "tvgece",
                        "displayName": "venu",
                        "active": true
                    },
                    "created": "2011-05-31T13:14:37.000+0000",
                    "updated": "2011-05-31T13:14:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48178",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=joust",
                        "name": "joust",
                        "displayName": "Artur Bodera",
                        "active": true
                    },
                    "body": "*IMPORTANT!*\r\n{{session_destroy()}} will (by design) prevent any further session cookies to be sent.\r\nThis means your use case *must be avoided* if you are using cookies.\r\n\r\n\r\n\r\nHere is more info in php manual comments:\r\nhttp:\/\/www.php.net\/manual\/en\/function.session-destroy.php#85379\r\n\r\nHere are my analysis on the issue:\r\nhttp:\/\/framework.zend.com\/issues\/browse\/ZF2-52?focusedCommentId=48042&page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-48042\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=joust",
                        "name": "joust",
                        "displayName": "Artur Bodera",
                        "active": true
                    },
                    "created": "2011-08-26T10:38:13.000+0000",
                    "updated": "2011-08-26T10:38:13.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1497\/transitions"
}