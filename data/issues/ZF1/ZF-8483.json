{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8483",
    "key": "ZF-8483",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Make Strip-Tags more secure"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8483\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-11-20T20:52:45.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-12-06T07:30:53.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-11-20T20:52:45.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Actually Zend_Filter_StripTags is very unsecure when you are whitespacing tags and attributes.\r\n\r\nSee here for details: http:\/\/blog.astrumfutura.com\/archives\/425-Zend_Filter_StripTags-Friend,-Foe,-or-Security-Nightmare.html\r\n\r\nCase 1:\r\n{code}\r\n$filter = new Zend_Filter_StripTags;\r\n$filter->setTagsAllowed(array(\r\n    'img' => array('src')\r\n));\r\n$out = $filter->filter('<img src=\"http:\/\/example.com\/image.png\"\/>');\r\n{code}\r\n\r\nOutput incorrect: \r\n{code}\r\n<img src \/>\r\n{code}\r\n\r\nShould be with source content!!\r\n\r\nCase 2:\r\n{code}\r\n$filter = new Zend_Filter_StripTags;\r\n$filter->setTagsAllowed(array(\r\n    'div'\r\n));\r\n$out = $filter->filter('<\/div><\/div><\/div><\/div><\/div><\/div><\/div>');\r\n{code}\r\n\r\nWrong output:\r\n{code}\r\n<\/div><\/div><\/div><\/div><\/div><\/div><\/div>\r\n{code}\r\n\r\nCorrect behaviour:\r\nNon-opened tags should be stripped.\r\nAlso opened tags without closing them should be stripped.\r\n\r\nCase 3:\r\n{code}\r\n$filter = new Zend_Filter_StripTags;\r\n$filter->setTagsAllowed(array(\r\n    'a' => array('href')\r\n));\r\n$out = $filter->filter('<a href=\"data:text\/html;base64,PHNjcmlwdD5hbGVydChkb2N1bWVudC5kb21haW4pPC9zY3JpcHQ%2B\">Click Me And Win IPOD!!!!<\/a>');\r\n{code}\r\n\r\nXSS-Attacks...\r\n\r\nTwo possible solutions:\r\n1. Stripping XSS... possible for simple things like above, but not a perfect solution.\r\n\r\n2. Use HTMLPurifier somewhere within ZF as callback: http:\/\/htmlpurifier.org\/"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8483\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User"
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-8502",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8502",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                },
                {
                    "issueKey": "ZF-8484",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8484",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10013",
                    "id": 10013,
                    "name": "Zend_Filter",
                    "description": "methods for filtering data",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36775",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "I can also comfirm there are other XSS vector exploits possible with the StripTags filter - the example given is the simplest one. All told, StripTags is really really bad.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2009-12-07T06:17:53.000+0000",
                    "updated": "2009-12-07T06:17:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36800",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "I cannot reproduce the output by use case 1.  IN my tests on 5.2.11, 5.3.0 and 5.3.1- the StripTags method works as expected.\r\n\r\nAs for the div example, it seems like this too is working as expected.  StripTags is a static filter, it does not do token based parsing of the stream of text, as such, it has no semantic awareness of the stream of text as hierarchical HTML.  That being the case, if follows strict whitelist or strip rules.  Since div is in the whitelist, it is valid to have all closing div tags.  Ideally, the users strategy would not be to have a definition to leave only divs in place.\r\n\r\nAs for use case 3, this too is working as expected.  Currently, StripTags does not validate the *VALUE* of a whitelisted attribute.  This too should be taken into consideration by developers when developing a stripping strategy. In this case, the href is whitelisted, therefore the attribute and value both can pass the StripTags filter. \r\n\r\nAlso, it should be noted that from a security standpoint, even though obfuscated.. the severity here is really not much higher than if the target text was actually \r\n{code}\r\n<a href=\"http:\/\/some.really.com\/porn\/and\/click\/tracking\/ridden\/site.html\" \/>\r\n{code} \r\n\r\nAgain, StripTags does not have a semantic awareness of what is good and evil to humans, thus, it here too is doing what it was told to do.\r\n\r\nI am inclined to mark as close on this one, but there should perhaps be an issue raised that would allow developers to add an additional regex for validating the value of a whitelisted attribute.\r\n\r\n-ralph",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2009-12-08T06:01:05.000+0000",
                    "updated": "2009-12-08T06:01:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36801",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "The report is an \"improvement\" type rather than a bug report. I agree these are not fixable bugs, and the report can be closed if the improvements will not be added.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2009-12-08T06:35:28.000+0000",
                    "updated": "2009-12-08T06:35:28.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/52436",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "body": "Bulk change of all issues last updated before 1st January 2010 as \"Won't Fix\".\r\n\r\nFeel free to re-open and provide a patch if you want to fix this issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "created": "2012-11-20T20:52:45.000+0000",
                    "updated": "2012-11-20T20:52:45.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8483\/transitions"
}