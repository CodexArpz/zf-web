{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6151",
    "key": "ZF-6151",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Translate the title attribute on form buttons including images (FormImage, Submit, Reset, Button)"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6151\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10310",
                    "id": 10310,
                    "description": "Mini Release",
                    "name": "1.8.1",
                    "userReleaseDate": "12\/May\/09",
                    "archived": false,
                    "releaseDate": "2009-05-12",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-04-04T06:58:20.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                "name": "mcleod@spaceweb.nl",
                "displayName": "Bart McLeod",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-03-28T03:52:42.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-04-04T07:00:02.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "The title attribute on form elements, specifically buttons, allows for the creation of tooltips.\n\nThese tooltips can be very useful, but they need to be translated.\n\nAccording to the documentation, Zend_Form offers no translation for the title attribute, but I think it would be an improvement if it would.\n\nObviously, if we are to offer this functionality, the manual needs to be updated accordingly and tests have to be written.\n\nI can write the tests, but I have no experience with changing the manual.\n\nApart from that, I do not know if there are arguments against translating the attribute or any attributes in general.\n\nI have a sample implementation that works for the FormImage element, but I should also work for submit.\n\n{code}\n\/\/ inside form\/element\/Image.php\n    \/**\n     * Set the title (tooltip) for the image button. The tooltip will be translated if a translator\n     * is available and not disabled.\n     *\n     * @param string $title\n     * @return provides a fluent interface\n     *\/\n    public function setTitle($title)\n    {\n        \/\/ translate title (tooltip)\n        if (!$this->_translatorDisabled and null !== ($translator = $this->getTranslator())) {\n            $title = $translator->translate($title);\n        }\n        \n        $this->setAttrib('title', $title);\n        return $this;\n    }\n{code}\n\nIf it is to work for submit and reset this function has to inside \/form\/Element.php with slightly simple comments:\n\n{code}\n    \/**\n     * Set the title (tooltip). The tooltip will be translated if a translator\n     * is available and not disabled.\n     *\n     * @param string $title\n     * @return provides a fluent interface\n     *\/\n    public function setTitle($title)\n    {\n        if (!$this->_translatorDisabled and null !== ($translator = $this->getTranslator())) {\n            $title = $translator->translate($title);\n        }\n        \n        $this->setAttrib('title', $title);\n        return $this;\n    }\n{code}\n\nThe drawback of these is that setDisableTranslator() will have no effect if it is called after setTitle or if 'title' is passed in as an option before.\n\nThe only other way I tried so far, was to put this functionality in the render method, so that normal behavior of setDisableTranslator() and getAttrib('title') are ensured. The latter should always return the untranslated version, but it will not if we use the naive implementation listed above.\n\nThe drawback of translating in the render method is that we would impact all form elements performance wise, with a check for the presence of a title attribute. With large forms this impact will be considerable and very wasteful as most elements will not have title attributes and will not require translation of this attribute.\n\nTherefore I think one way to offer this is to create a common base class for elements that can have tooltips.  However, this is not the way Zend Framework works in general. On the contrary, we try to avoid this. The way to go would be to create an new decorator, that translates the tooltip. This would be a tooltip decorator. Is it already here and have I been missing it all along? No luckily, it looks like it is not yet there.\n\nThen  adding such a decorator manually would be more work then just translate the title attribute manually while passing it in... so I should be looking for a way to add this decorator to those elements that can benefit from it, like image, submit and reset. The best place for this will be loadDefaultDecorators().\n\n\nInside Zend_Form_Element_Submit.php:\n{code}\n    \/**\n     * Default decorators\n     *\n     * Uses only 'Tooltip',  'Submit' and 'DtDdWrapper' decorators by default.\n     * \n     * @return void\n     *\/\n    public function loadDefaultDecorators()\n    {\n        if ($this->loadDefaultDecoratorsIsDisabled()) {\n            return;\n        }\n\n        $decorators = $this->getDecorators();\n        if (empty($decorators)) {\n            $this->addDecorator('Tooltip')\n                 ->addDecorator('ViewHelper')\n                 ->addDecorator('DtDdWrapper');\n        }\n    }\n{code}\n\nThis works indeed. It required a new decorator: Zend_Form_Decorator_Tooltip and it requires Zend_Form_Element_Submit and Zend_Form_Element_Image to load this decorator as the first decorator in loadDefaultDecorators(). This is not a problem since the decorator doesn't add any output, only translates the title attribute when the element is rendered.\n\nI will attach my proposal for Zend_Form_Decorator_Tooltip.\n\nIf I receive no negative feedback, I will add two unit tests that will test the following:\n1. Does the title get translated if a translation is present\n2. Does the title remain unchanged when the translator is disabled\n\nLike I said before, I have no experience in updating the manual. I would appreciate it very much if Matthew or someone else would take care of that bit."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6151\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                "name": "mcleod@spaceweb.nl",
                "displayName": "Bart McLeod",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11844",
                    "filename": "Tooltip.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2009-03-28T13:17:30.000+0000",
                    "size": 1829,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11844\/Tooltip.php"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10291",
                    "id": 10291,
                    "description": "Mini Release",
                    "name": "1.7.7",
                    "userReleaseDate": "16\/Mar\/09",
                    "archived": false,
                    "releaseDate": "2009-03-16",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29793",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "Zend_Form_Decorator_Tooltip proposal attached.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2009-03-28T13:17:36.000+0000",
                    "updated": "2009-03-28T13:17:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29931",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "Added two unit tests in TestImage.php and TestSubmit.php. These also cover Reset and Button, as these inherit from Submit.\n\nAdded new Zend_Form_Decorator_Tooltip and load it in both Submit and Image in loadDefaultDecorators().\n\nAll is in svn now as I have not received any negative feedback on this from the community.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2009-04-04T06:58:17.000+0000",
                    "updated": "2009-04-04T06:58:17.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29932",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "What is left to do now is add a line to the manual telling that the title is now being translated on buttons.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2009-04-04T07:00:02.000+0000",
                    "updated": "2009-04-04T07:00:02.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6151\/transitions"
}