{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4344",
    "key": "ZF-4344",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend\\Validate\\File\\Extension.php Warning: Invalid argument supplied for foreach()"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4344\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-09-22T13:08:05.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                "name": "ahmedshaikhm",
                "displayName": "Ahmed Shaikh Memon",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-09-21T19:02:46.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-09-22T13:08:05.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I am using ZF's svn snapshot version 11473;\n\nI am trying to create 4 file upload form-elements with different numbers, for example;\n\n\t\t$image_2 = new Zend_Form_Element_File('image_2');\n\t\t$image_2->setLabel('Upload an image # 2')\n\t\t\t\t->setRequired(false)\n\t\t\t\t->setDestination('E:\\apache2triad\\htdocs\\xxxx\\public_html\\images\\products')\n\t\t\t\t->addValidator('Extension', false, 'jpg,png,gif'); \/\/ only JPEG, PNG, and GIFs\n\n\t\t$image_3 = new Zend_Form_Element_File('image_3');\n\t\t$image_3->setLabel('Upload an image # 3')\n\t\t\t\t->setRequired(false)\n\t\t\t\t->setDestination('E:\\apache2triad\\htdocs\\xxxx\\public_html\\images\\products')\n\t\t\t\t->addValidator('Extension', false, 'jpg,png,gif'); \/\/ only JPEG, PNG, and GIFs\n\nbut results in warning, as follows;\n\nWarning: Invalid argument supplied for foreach() in E:\\apache2triad\\htdocs\\xxxx\\library\\Zend\\Validate\\File\\Extension.php on line 128\n\n=======\nMy observation is that;\nZend_Validate_File_Extension:\nWhen I put foreach loop in the is_string($extension) check the warning dis-appears\n\nWorking Code in Zend_Validate_File_Extension:\n        $extensions = $this->getExtension(true);\n        if (is_string($extension)) {\n\t\t\t$extension = explode(',', $extension);\n\t\t\tforeach ($extension as $content) {\n\t\t\t\tif (empty($content) || !is_string($content)) {\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\n\t\t\t\t$extensions[] = trim($content);\n\t\t\t}\n        }\n\nHowever, I am not sure if this is the cause of the issue. please look into this issue."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4344\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11549",
                    "filename": "Extension.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "created": "2008-09-22T04:53:33.000+0000",
                    "size": 5666,
                    "mimeType": "application\/vnd.google-earth.kml+xml",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11549\/Extension.php"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11548",
                    "filename": "Extension.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "created": "2008-09-22T04:50:19.000+0000",
                    "size": 5514,
                    "mimeType": "application\/vnd.google-earth.kml+xml",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11548\/Extension.php"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10321",
                    "id": 10321,
                    "name": "Zend_Validate_File",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24604",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Please attach always the component which makes the problem \"Zend_Validate_File\" and not \"Zend_Form\" in this case.\n\nOtherwise the solution can be delayed for several weeks as the component author does not know that it exists.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-09-21T23:48:47.000+0000",
                    "updated": "2008-09-21T23:48:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24605",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "body": "This is the file from latest SVN Snapshot r11473",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "created": "2008-09-22T04:50:23.000+0000",
                    "updated": "2008-09-22T04:50:23.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24606",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "body": "The attached file contains Modified function addExtension() of class Zend_Validate_File_Extension;",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "created": "2008-09-22T04:53:33.000+0000",
                    "updated": "2008-09-22T04:53:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24611",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I did not mean that you must attach the file.\n\nYou have attached this issue to Zend_Form as component.\nBut you wrote yourself that the problem is in Zend_Validate_File_Extension.\n\nYou should always attach issues to the correct component, in this case Zend_Validate_File and not Zend_Form",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-09-22T09:31:00.000+0000",
                    "updated": "2008-09-22T09:31:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24613",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "You seem to be using an outdates revision of ZF.\n\nLine 128 is only a \"if\" clause.\nAny related warning can only be throwed in line 127.\nAlso API doc states that only string and array is allowed as parameter.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-09-22T11:13:04.000+0000",
                    "updated": "2008-09-22T11:13:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24615",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "body": "Oh sorry for posting with wrong attachment, I will take care of this thing from next time, thanks.\n\nI just checked the svn repo and found that the Zend_Validate_File_Extension is now on rev 11474, the issue is still there, the same \"Warning: Invalid argument supplied for foreach() in E:\\apache2triad\\htdocs\\xxxx\\library\\Zend\\Validate\\File\\Extension.php on line 127\"\n\nAnd you are right at line 127 its under Zend\\Validate\\File\\Extension.php \nforeach ($extension as $content) {\n\nAnd I am passing the string, in the form;\n->addValidator('Extension', false, 'jpg,png,gif'); \/\/ only JPEG, PNG, and GIFs\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "created": "2008-09-22T11:32:07.000+0000",
                    "updated": "2008-09-22T11:32:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24616",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Can you add a var_dump() before 127 to see what is given as input ?\nYour code and the returned error do not fit. Our unittests are checking exact your input without giving a notice.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-09-22T11:51:26.000+0000",
                    "updated": "2008-09-22T11:51:26.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24618",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "body": "Ok I got the bug, its basically under Zend_File_Transfer_Adapter_Abstract's function addValidator\n\nPlease take a look at the function definition of Zend_File_Transfer_Adapter_Abstract::addValidator and then Zend_Form_Element_File::addValidator\n\nBasically options-array is not being passed properly to the Zend_File_Transfer_Adapter_Abstract::addValidator, Zend_File_Transfer_Adapter_Abstract::addValidator expects the options to be given as second argument, while they are being coming in third argument.\n\nWill you move the issue to Zend_File_Transfer_Adapter_Abstract or should I do it myself?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "created": "2008-09-22T12:07:53.000+0000",
                    "updated": "2008-09-22T12:07:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24619",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "body": "the above mentioned issue in Zend_File_Transfer_Adapter_Abstract is causing the value being passed as boolean as oppose to expected string or array in Zend_Validate_File_Extension::addExtension()\n\nSpecifically look at following lines in Zend_File_Transfer_Adapter_Abstract::addValidator \n\n            $class     = $this->getPluginLoader(self::VALIDATE)->load($validator);\n            $validator = new $class($options);\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "created": "2008-09-22T12:10:31.000+0000",
                    "updated": "2008-09-22T12:10:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24620",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Sorry... but you must be using a outdated version of ZF.\n\nZend_Form_Element_File reads:\n{code}\n    public function addValidator($validator, $breakChainOnFailure = false, $options = array())\n    {\n        $adapter = $this->getTransferAdapter();\n        $adapter->addValidator($validator, $breakChainOnFailure, $options);\n{code}\n\nAs you mentioned 3rd option is the options array as you gave it in your example code.\n\nNow Zend_File_Transfer_Abstract:\n{code}\n    public function addValidator($validator, $breakChainOnFailure = false, $options = null, $files = null)\n    {\n        if ($validator instanceof Zend_Validate_Interface) {\n            $name = get_class($validator);\n        } elseif (is_string($validator)) {\n            $name      = $this->getPluginLoader(self::VALIDATE)->load($validator);\n            $validator = new $name($options);\n{code}\n\nAs you see also here the 3rd parameter are the options and the last line assigns the options as first parameter while constructing a new validator.\n\nNow Zend_Validate_File_Extension:\n{code}\n    public function __construct($extension, $case = false)\n    {\n        $this->_case = (boolean) $case;\n        $this->setExtension($extension);\n{code}\n\nAs you see the first parameter, the extensions are the options you gave in your initial call.\n\nWhen your Zend_File_Transfer_Abstract accepts the options as second parameter you MUST use a old revision as this has changed a few days ago. And I am speaking of the actual trunk since r11430.\n\nPlease check out a complete new revision to get rid of the false file.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-09-22T12:26:49.000+0000",
                    "updated": "2008-09-22T12:26:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24621",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "body": "Hi T, thanks for following up on this. I just got rev 11474, and the Zend_File_Transfer_Abstract file is fixed.\n\nI dont know what happened, I just svn updated the zend code repo last night, either developers are fast 'n furios at Zend or there was some issue in getting fresh svn code drops.\n\nAnyways, day is safe now.\n\nThanks,",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ahmedshaikhm",
                        "name": "ahmedshaikhm",
                        "displayName": "Ahmed Shaikh Memon",
                        "active": true
                    },
                    "created": "2008-09-22T12:37:04.000+0000",
                    "updated": "2008-09-22T12:37:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24622",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "As all three classes are from me, no other makes commits on those (I would have seen this), and the mentioned classes are in this version since 19.Sept I expect a svn problem.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-09-22T13:05:24.000+0000",
                    "updated": "2008-09-22T13:05:24.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4344\/transitions"
}