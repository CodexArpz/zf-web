{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8038",
    "key": "ZF-8038",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Filter_LocalizedToNormalized performs in a non-intuitive way"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8038\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10370",
                    "id": 10370,
                    "description": "Mini Release",
                    "name": "1.9.4",
                    "userReleaseDate": "13\/Oct\/09",
                    "archived": false,
                    "releaseDate": "2009-10-13",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-10-09T02:44:19.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=electricowl",
                "name": "electricowl",
                "displayName": "Ian Lewis",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-10-09T02:27:14.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-10-09T05:36:55.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "dates",
                "design",
                "filter",
                "numbers",
                "redesign"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend_Filter_LocalizedToNormalized does not behave in an intuitive manner.\n\nExample 1\nWhen passing in a value such as 23,555.0 the value returned is 23555.0 which is acceptable.\n\nExpected\n-------------\nCommas are stripped out\n\nExample 2\nWhen passing in a malformed numeric value from a form such as 23.05.1 the class returns a date.\n\nExpected:\n-------------\ni) Return value should be 23.05 with extra characters removed. \n\nii) Alternatively the class should be configurable to return a value with all but the first decimal point removed. 23.051\n\nConclusion\n==========\nThe fact that the class returns unexpected data makes it unsafe to use when validating Numeric or Date data.\n\nThe class should either be removed from the framework or redesigned to remove the inherently confused design issues.\n\n\n\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8038\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10320",
                    "id": 10320,
                    "description": "Minor Release",
                    "name": "1.9.0",
                    "userReleaseDate": "31\/Jul\/09",
                    "archived": false,
                    "releaseDate": "2009-07-31",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10350",
                    "id": 10350,
                    "description": "Mini Release",
                    "name": "1.9.1",
                    "userReleaseDate": "11\/Aug\/09",
                    "archived": false,
                    "releaseDate": "2009-08-11",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10361",
                    "id": 10361,
                    "description": "Mini Release",
                    "name": "1.9.2",
                    "userReleaseDate": "25\/Aug\/09",
                    "archived": false,
                    "releaseDate": "2009-08-25",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10362",
                    "id": 10362,
                    "description": "Mini Release",
                    "name": "1.9.3",
                    "userReleaseDate": "22\/Sep\/09",
                    "archived": false,
                    "releaseDate": "2009-09-22",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10013",
                    "id": 10013,
                    "name": "Zend_Filter",
                    "description": "methods for filtering data",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35135",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "When you need to validate numbers or dates then use Validators.\nFilters are not Validators, and they should not  be used with unvalidated content.\n\nWhen you give a localized value to this filter then it will be normalized.\nAnd when the value is detected as localized date, then you will get a normalized date in return.\n\nUse Zend_Validate_Float\/Int\/Digits to get sure if the value is a number.\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-10-09T02:43:55.000+0000",
                    "updated": "2009-10-09T02:43:55.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35136",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=electricowl",
                        "name": "electricowl",
                        "displayName": "Ian Lewis",
                        "active": true
                    },
                    "body": "The response misses the point completely.\n\nNo attempt was made to use the class as a validator - it is supposed to be a Filter. \n\nThe Zend Filters make modifications to the data and the modifications occur Before Validation.\n\nIf a value is normalized it should be passed in as a number and returned as a number. This class looks at the format of the data passed in and then makes some assumptions based on that structure.\n\nThis means that the user will receive an unexpected response when passing in numeric data from a form that has to be filtered. \n\nThe data is not being normalised it is being interpreted, modified and cast to a different form. This is wrong and it is a bug.\n\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=electricowl",
                        "name": "electricowl",
                        "displayName": "Ian Lewis",
                        "active": true
                    },
                    "created": "2009-10-09T03:03:33.000+0000",
                    "updated": "2009-10-09T03:03:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35137",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rjt_zygous",
                        "name": "rjt_zygous",
                        "displayName": "Richard Turner",
                        "active": true
                    },
                    "body": "\"Filters are not Validators, and they should not be used with unvalidated content.\"\n\nActually, they definitely should be used on unvalidated content:\n\nFrom the ZF Docs site (http:\/\/framework.zend.com\/manual\/en\/zend.form.elements.html#zend.form.elements.filters):\n    It's often useful and\/or necessary to perform some normalization on input prior to validation ... [and] run your validations on what remains to ensure the submission is valid. ... These operations may be performed using Zend_Filter.\n\nOne of the major uses of Zend_Filter is to filter-out unwanted stuff, like commas in numbers, before validation. Zend_Validate_Digits will fail if there's a comma in the number, which is why one should run the number through a Zend_Filter first.\n\nThere's no way a filter should return a Zend_Date, or any other complex object - it should return what it's given with some stuff stripped-out, that's all.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rjt_zygous",
                        "name": "rjt_zygous",
                        "displayName": "Richard Turner",
                        "active": true
                    },
                    "created": "2009-10-09T03:25:10.000+0000",
                    "updated": "2009-10-09T03:25:10.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35138",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "{quote}\nOne of the major uses of Zend_Filter is to filter-out unwanted stuff, like commas in numbers, before validation.\n{quote}\n\nExactly this is done.\nBut filters do not only \"Filter out\"... they can also be used to filter content in a way where you apply somthing and it is changed according to specified rules. And this is done within Zend_Filter_LocalizedToNormalized. An algorithm is processed which changes the content.\n\nSee for example the Compress filters... nothing is filtered out, but a defined algorithm is processed on the content.\n\nBtw: Zend_Filter does not return Zend_Date or any objects. Please inform yourself before throwing out conclusions on issues which other persons have filled.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-10-09T04:23:10.000+0000",
                    "updated": "2009-10-09T04:23:10.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35139",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "And regarding false input and validation.\n\nWhen the above noted false input is filtered it will return a normalized date because of the 2 \".\" seperators.\nWhen you would process a validation on Digits or Int or Float then the value would not pass validation.\n\nSo even if validation is done afterwards, all would work as expected, because the false input will not pass as number. It is returned as normalized date and not as normalized number... so the behaviour is correct when validation would have been applied.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-10-09T04:30:26.000+0000",
                    "updated": "2009-10-09T04:37:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35140",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=electricowl",
                        "name": "electricowl",
                        "displayName": "Ian Lewis",
                        "active": true
                    },
                    "body": "<quote>\nZend_Filter does not return Zend_Date or any objects\n<\/quote>\n\nNo it returns an array which is just as bad. The input data is a string from a form which is then 'interpreted' and depending on the results of this it the returns either a number or an array containing date information.\n ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=electricowl",
                        "name": "electricowl",
                        "displayName": "Ian Lewis",
                        "active": true
                    },
                    "created": "2009-10-09T04:37:19.000+0000",
                    "updated": "2009-10-09T04:37:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35141",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=electricowl",
                        "name": "electricowl",
                        "displayName": "Ian Lewis",
                        "active": true
                    },
                    "body": "Case\n---------\nThis is an input for a numeric field\nWe'll ignore the fact that  'precision => 2' effectively hints that the value will be a number.\n\n$oColourInput = new Zend_Form_Element_Text($sColourRateName, array(\n    'decorators' => $this->aDecoratorsElementInlineNoLabel,\n        'filters'    => array(\n             new Zend_Filter_LocalizedToNormalized(array('precision' => 2))\n         ),\n         'validators' => array(new Zend_Validate_Float())\n    )\n );\n\n<quote>\nWhen the above noted false input is filtered it will return a normalized date because of the 2 \".\" seperators.\nWhen you would process a validation on Digits or Int or Float then the value would not pass validation.\n<\/quote>\n\nEffectively you are suggesting a workaround here because validation will fail because the Digits\/Int\/Float classes will fail when passed an array.\n\nIn the long run it would be far better to have separate classes for normalising inputs from number or date fields. It is extremely disconcerting to have input of one type 'automagically' converted to another.\n\n\nRe. <quote>Please inform yourself before throwing out conclusions on issues which other persons have filled.<\/quote>\nPersonally I welcome comments from anyone with programming knowhow and experience\n\n\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=electricowl",
                        "name": "electricowl",
                        "displayName": "Ian Lewis",
                        "active": true
                    },
                    "created": "2009-10-09T05:36:49.000+0000",
                    "updated": "2009-10-09T05:36:49.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8038\/transitions"
}