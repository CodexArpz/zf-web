{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10046",
    "key": "ZF-10046",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Rename Filter not working correctly if abbreviated form used"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10046\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10480",
                    "id": 10480,
                    "description": "Mini Release",
                    "name": "1.10.7",
                    "userReleaseDate": "28\/Jul\/10",
                    "archived": false,
                    "releaseDate": "2010-07-28",
                    "released": true
                }
            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                "name": "anybody",
                "displayName": "Julian Pustkuchen",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-06-24T01:31:06.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-01-12T09:25:44.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Please notice that there seems to be a heavy bug if you try to use the \"rename\" filter on each file before \"receive\" (to prevent problems with files being uploaded that have identical the same name (but don't have to be the same file)):\r\n\r\nRegister a filter object instead of the 3-parameter-style to make it work, as following:\r\n\r\n{code}\r\n<?php\r\n[...]\r\n\r\n\/\/Dateien individuell umbenennen, sonst gibt es Probleme mit gleichnamigen Dateien.\r\n\t\t$files = $parFileTransfer->getFileInfo();\r\n\t\t\/\/Achtung, Dateien sind an dieser Stelle noch tempor\u00e4r!\r\n\t\t$i = 0;\r\n\t\tforeach($files as $key => $fileInfo){\t\r\n\t\t\tif(!$fileInfo['name']==''){\r\n\t\t\t\t\/\/Jede Datei in ein eigenes, zuf\u00e4lliges Verzeichnis verschieben um Namenskonflikte zu verhindern.\r\n\t\t\t\t$parFileTransfer->addFilter(\r\n\t\t\t\t\tnew Zend_Filter_File_Rename(\r\n\t\t\t\t\t\tarray(\t'source'\t=>\t$fileInfo['tmp_name'],\r\n\t\t\t\t\t\t\t\t'target'\t=>\t$i.$key)\r\n\t\t\t\t\t)\r\n\t\t\t\t);\r\n\t\t\t\t$i++;\r\n\t\t\t}\r\n\t\t}\r\n\r\n[...]\r\n?>\r\n{code}\r\n<-- Result absolutely OK!\r\n\r\n---\r\nThe following did not identify the files correctly, even if it should! Result was, that all files were named the same (identity seems to be set wrong in rename). The rename filters were wrongly applied on all files though.\r\n\r\nDO NOT USE (this part):\r\n\r\n{code}\r\n<?php\r\n[...]\r\n$parFileTransfer->addFilter('Rename', $i.$key, $fileInfo['tmp_name']);\r\n[...]\r\n?>\r\n{code}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10046\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/4",
                "name": "Reopened"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10460",
                    "id": 10460,
                    "description": "Mini Release",
                    "name": "1.10.5",
                    "userReleaseDate": "26\/May\/10",
                    "archived": false,
                    "releaseDate": "2010-05-26",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10320",
                    "id": 10320,
                    "name": "Zend_File_Transfer",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41171",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "body": "Changed code stlyle",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "created": "2010-06-24T01:32:29.000+0000",
                    "updated": "2010-06-24T01:32:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41173",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "body": "Well, as I found out, there is another problem:\r\n\r\nZend_File_Transfer_Adapter_Abstract can only handle one filter of each type, which is a problem if you have to act on file basis, not on general upload basis:\r\n\r\nIn \"addFilter\" this is being done by: \"$this->_filters[$class] = $filter;\"\r\n\r\nBut it should be a construction like: \"$this->_filters[$class][] = $filter;\" to act on file basis.\r\n\r\nThe current implementation only uses the last added filter, which is not the true meaning of \"addFilter\", but of \"setFilter\" or something like this.\r\n\r\nAs described above you have to fix this with no doubt, because else you are never able to upload files named same!!! (not even using this workaround!!) So I expect this as HIGHLY CRITICAL!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "created": "2010-06-24T02:27:09.000+0000",
                    "updated": "2010-06-24T02:27:09.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41174",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "body": "Changed priority because this bug affects general functionality of uploading same named files and the code doesn't work as expected\/documented!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "created": "2010-06-24T02:30:30.000+0000",
                    "updated": "2010-06-24T02:30:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41207",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Degrading priority.\r\n\r\nThe given example implies that the used code is wrong.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-06-27T07:39:15.000+0000",
                    "updated": "2010-06-27T07:39:15.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41208",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Using the temporary name instead of the file element does not work when you use the code given within the manual. This works only when you have another workflow which is not officially documented.\r\n\r\nYou did not point out when $parFileTransfer should be.\r\nYou did not point out how you create the form.\r\nYou did not point out how you receive the files.\r\n\r\nThe actual example can not be verified. Please add some code which can be reproduced to see where you have problems.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-06-27T07:46:35.000+0000",
                    "updated": "2010-06-27T07:46:35.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41214",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "body": "Firstofall, thank you for your quick reply.\r\n\r\nPlease give me a working example, how to handle a file upload with files having the same name.\r\nIn my oppinion it is just not possible using Zend_File_Transfer and that's really bad, isn't it?\r\n\r\nIf you were able to add several rename filters on file basis, not just one on upload basis, you could use my workaround, but because only the last rename filter can be used (override in ZF as described above) this doesn't work.\r\n\r\nI think it is easier if you try to find a solution for the \"same file name\"-problem yourself, perhaps you will have the same problems. If not, it would be nice if you could add your solution to the documentation and post ist here, because this is a major problem in my eyes.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "created": "2010-06-27T13:09:44.000+0000",
                    "updated": "2010-06-27T13:09:44.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41444",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I think you are misunderstanding what issues are.\r\n\r\nCreating an issue does not mean that you get your code fixed and developed an solution because you don't know how it works.\r\n\r\nIt is not my work to show you how you can reproduce your problem.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-07-12T12:05:49.000+0000",
                    "updated": "2010-07-12T12:05:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41445",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Closing as not reproduceable with the given example",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-07-12T12:06:55.000+0000",
                    "updated": "2010-07-12T12:06:55.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41446",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "body": "So just two last questions, which I hope you will answer: \r\nDon't you think that it is bad, that with this Component you are not able to upload two files with the same name at once?\r\n\r\nDon't you think that it is bad, that there can only be one filter for each type even if the function is called addFilter (which is misleading)?\r\n\r\nAnd please don't say I don't know how it works, thats not true. If you had a look yourself, you would know.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "created": "2010-07-12T12:23:59.000+0000",
                    "updated": "2010-07-12T12:23:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49480",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=netroby",
                        "name": "netroby",
                        "displayName": "netroby",
                        "active": true
                    },
                    "body": "following code should work for multiple files upload.\r\n\r\n\r\n{code:php}\r\n $target_path =  '\/var\/www\/uploads\/';\r\n            $adapter = new Zend_File_Transfer_Adapter_Http();\r\n            $adapter->addValidator('Size', false, 102400);\r\n            $adapter->addValidator('IsImage', false, array(\r\n                    'gif',\r\n                    'jpeg',\r\n                    'png'\r\n            ));\r\n\r\n            $files = $adapter->getFileInfo();\r\n            foreach ($files as $file => $info) {\r\n                if ($info['name'] != '') {\r\n                    if ($adapter->isValid($file)) {\r\n                        \/\/generate new filename , you can using random hash filename, output 32acb74d.jpg\r\n                        $newFileName = $this->_getNewFileName($info);\r\n                        $adapter->clearFilters()->addFilter(new Zend_Filter_File_Rename( array(\r\n                                'source' => $info['tmp_name'],\r\n                                'target' => $target_path . $newFileName,\r\n                                'overwrite' => TRUE\r\n                        )));\r\n                        if (!$adapter->receive($file)) {\r\n                            $this->_uploadFailed($adapter);\r\n                        }\r\n                        $this->_addEnvPhoto($this->_getDisplayUrl() . '\/' . $newFileName, $info);\r\n                    }\r\n                }\r\n            }\r\n            Zend_Debug::dump($adapter->getFileInfo());\r\n            Zend_Debug::dump($adapter->getFilters());\r\n            exit();\r\n\r\n{code}\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=netroby",
                        "name": "netroby",
                        "displayName": "netroby",
                        "active": true
                    },
                    "created": "2012-01-12T09:21:42.000+0000",
                    "updated": "2012-01-12T09:21:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49481",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=netroby",
                        "name": "netroby",
                        "displayName": "netroby",
                        "active": true
                    },
                    "body": "This issue like to say :\r\n\r\n\r\nwhen using Zend_File_Transfer  handle multiple files uploads, we do not know how to move uploads files to right directory.\r\n\r\n\r\nby document, seems we could using Zend_Filter_File_Rename , but it seems not working correctly.\r\n\r\n\r\nwould you please show me a short code snippet , handle multiple files upload, move upload files to right target directory?  (using ZendFramwork, Zend_File, Zend_Filter and etc)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=netroby",
                        "name": "netroby",
                        "displayName": "netroby",
                        "active": true
                    },
                    "created": "2012-01-12T09:25:44.000+0000",
                    "updated": "2012-01-12T09:25:44.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10046\/transitions"
}