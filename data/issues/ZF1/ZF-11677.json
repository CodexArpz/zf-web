{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11677",
    "key": "ZF-11677",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "CLONE - Zend_Application_Resource_Multidb with CacheManager doesn't cache"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11677\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/4",
                "name": "Incomplete"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-06-10T10:48:13.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eistrati",
                "name": "eistrati",
                "displayName": "Eugene Istrati",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-08-16T20:26:02.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-06-10T10:48:13.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "cache",
                "multidb",
                "zend"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I have configured Multidb with CacheManager as per documentation (see below). No errors in logs, full access to filesystem, everything should work like charm, the only problem is that no cache is created...\r\n\r\n{code}\r\n;1) CacheManager configuration:\r\nresources.cachemanager.database.frontend.name = Core\r\nresources.cachemanager.database.frontend.customFrontendNaming = false\r\nresources.cachemanager.database.frontend.options.lifetime = 7200\r\nresources.cachemanager.database.frontend.options.automatic_serialization = true\r\nresources.cachemanager.database.backend.name = File\r\nresources.cachemanager.database.backend.customBackendNaming = false\r\nresources.cachemanager.database.backend.options.cache_dir = APPLICATION_PATH \"\/..\/temp\/cache\"\r\nresources.cachemanager.database.frontendBackendAutoload = false\r\n\r\n;2) Multidb configuration:\r\nresources.multidb.defaultMetadataCache = \"database\"\r\n\r\nresources.multidb.db1.adapter = \"pdo_mysql\"\r\nresources.multidb.db1.host = \"localhost\"\r\nresources.multidb.db1.username = \"webuser\"\r\nresources.multidb.db1.password = \"XXXX\"\r\nresources.multidb.db1.dbname = \"db1\"\r\nresources.multidb.db1.default = true\r\n\r\nresources.multidb.db2.adapter = \"pdo_pgsql\"\r\nresources.multidb.db2.host = \"example.com\"\r\nresources.multidb.db2.username = \"dba\"\r\nresources.multidb.db2.password = \"notthatpublic\"\r\nresources.multidb.db2.dbname = \"db2\"\r\n{code}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11677\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "cache",
                "multidb",
                "zend"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                "name": "ramon",
                "displayName": "Ramon Henrique Ornelas",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10880",
                    "id": 10880,
                    "description": "Mini Release",
                    "name": "1.11.9",
                    "userReleaseDate": "14\/Jul\/11",
                    "archived": false,
                    "releaseDate": "2011-07-14",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10460",
                    "id": 10460,
                    "name": "Zend_Application_Resource",
                    "description": "Plugin resources for Zend_Application",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47980",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eistrati",
                        "name": "eistrati",
                        "displayName": "Eugene Istrati",
                        "active": true
                    },
                    "body": "Why this issue was closed? It is not fixed at all... I am expecting caching files to be created in APPLICATION_PATH \"\/..\/temp\/cache\", but instead it does nothing!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eistrati",
                        "name": "eistrati",
                        "displayName": "Eugene Istrati",
                        "active": true
                    },
                    "created": "2011-08-16T20:26:15.000+0000",
                    "updated": "2011-08-16T20:26:15.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47981",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                        "name": "ramon",
                        "displayName": "Ramon Henrique Ornelas",
                        "active": true
                    },
                    "body": "And I'm expected information more detailed, something this line see http:\/\/tinyurl.com\/HowToReportABug.\r\nAlso I wonder what was your error for the reproduction https:\/\/gist.github.com\/1129015, *Please try reproduced with this*, but I need of a response of your reproduction.\r\n\r\n\r\nGreetings\r\nRamon\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                        "name": "ramon",
                        "displayName": "Ramon Henrique Ornelas",
                        "active": true
                    },
                    "created": "2011-08-16T21:38:08.000+0000",
                    "updated": "2011-08-16T21:38:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47984",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eistrati",
                        "name": "eistrati",
                        "displayName": "Eugene Istrati",
                        "active": true
                    },
                    "body": "THIS IS THE SCRIPT THAT I HAVE RUN ON MY ENVIRONMENT:\r\n\r\n<?php\r\n\/\/@see ZF-10543\r\n\r\n\/\/ Set default timezone\r\ndate_default_timezone_set('America\/New_York');\r\n\r\n\/\/ Define path to application directory\r\ndefined('APPLICATION_PATH')\r\n\t|| define('APPLICATION_PATH', realpath(dirname(__FILE__) . '\/application'));\r\n\r\n\/\/ Define application environment\r\ndefined('APPLICATION_ENV')\r\n\t|| define('APPLICATION_ENV', (getenv('APPLICATION_ENV') ? getenv('APPLICATION_ENV') : 'production'));\r\n\r\n\/\/ Ensure library\/ is on include_path\r\nset_include_path(implode(PATH_SEPARATOR, array(\r\n\trealpath(APPLICATION_PATH . '\/..\/library'),\r\n\tget_include_path(),\r\n)));\r\n\r\nrequire_once 'Zend\/Loader\/Autoloader.php';\r\nZend_Loader_Autoloader::getInstance();\r\n\r\n$application = new Zend_Application('production', '.\/application\/configs\/application.ini');\r\n$application->getBootstrap()\r\n            ->setContainer(Zend_Registry::getInstance())\r\n            ->bootstrap();\r\n\r\n_setupTable();\r\n_asserts();\r\n\r\nfunction _setupTable()\r\n{\r\n    global $db1, $db2;\r\n\r\n    $sql = 'CREATE TABLE zf11636(issue integer PRIMARY KEY);';\r\n    $multiDB = Zend_Registry::get('multidb');\r\n\r\n    $db1 = $multiDB->getDb('db1');\r\n    $db2 = $multiDB->getDb('db2');\r\n\r\n    _dropTable();\r\n\r\n    $db1->query($sql);\r\n    $db2->query($sql);\r\n}\r\n\r\nfunction _asserts()\r\n{\r\n    global $db1, $db2;\r\n\r\n    $cacheManager = Zend_Registry::get('cachemanager');\r\n    $cache = $cacheManager->getCache('database');\r\n\r\n    $tableDb1 = new Zend_Db_Table(array('db' => $db1, 'name' => 'zf11636'));\r\n    $tableDb2 = new Zend_Db_Table(array('db' => $db2, 'name' => 'zf11636'));\r\n\r\n    \/\/ caching metadata\r\n    $cache->clean(Zend_Cache::CLEANING_MODE_ALL);\r\n    $tableDb1->info(Zend_Db_Table::COLS);\r\n    $tableDb2->info(Zend_Db_Table::COLS);\r\n\r\n    assert_options(ASSERT_ACTIVE, 1);\r\n    assert_options(ASSERT_WARNING, 1);\r\n    assert(Zend_Db_Table::getDefaultMetadataCache() == $cache);\r\n    assert(4 == iterator_count(new RecursiveDirectoryIterator(\".\/temp\/cache\")));\r\n\r\n    $cache->clean(Zend_Cache::CLEANING_MODE_ALL);\r\n    _dropTable();\r\n}\r\n\r\nfunction _dropTable()\r\n{\r\n    global $db1, $db2;\r\n    try {\r\n        $db1->query('DROP TABLE zf11636');\r\n    } catch (Exception $e) {\r\n\r\n    }\r\n\r\n    try {\r\n        $db2->query('DROP TABLE zf11636');\r\n    } catch (Exception $e) {\r\n\r\n    }\r\n}\r\n\r\n\r\nTHIS IS THE OUTPUT THAT I AM SEEING:\r\n\r\nWarning: assert(): Assertion failed in C:\\Eugene\\localhost\\Billing\\testing.php on line 70\r\n\r\nCall Stack:\r\n    0.0098     357832   1. {main}() C:\\Eugene\\localhost\\Billing\\testing.php:0\r\n    0.2185    5536704   2. _asserts() C:\\Eugene\\localhost\\Billing\\testing.php:34\r\n    0.2543    5545536   3. assert() C:\\Eugene\\localhost\\Billing\\testing.php:70",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eistrati",
                        "name": "eistrati",
                        "displayName": "Eugene Istrati",
                        "active": true
                    },
                    "created": "2011-08-17T15:25:16.000+0000",
                    "updated": "2011-08-17T15:25:16.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48005",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                        "name": "ramon",
                        "displayName": "Ramon Henrique Ornelas",
                        "active": true
                    },
                    "body": "@Eugene Thanks by your response ;).\r\nI did change in script https:\/\/gist.github.com\/1129015 added constant *DIR_CACHE*, change to your directory cache.\r\nThe expected of your feedback ;).\r\n\r\nSince already thank you.\r\nGreetings\r\nRamon\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                        "name": "ramon",
                        "displayName": "Ramon Henrique Ornelas",
                        "active": true
                    },
                    "created": "2011-08-19T02:05:51.000+0000",
                    "updated": "2011-08-19T02:05:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48034",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eistrati",
                        "name": "eistrati",
                        "displayName": "Eugene Istrati",
                        "active": true
                    },
                    "body": "Sure! Please give me couple of days as I'm now traveling and will be back soon...",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eistrati",
                        "name": "eistrati",
                        "displayName": "Eugene Istrati",
                        "active": true
                    },
                    "created": "2011-08-21T16:50:53.000+0000",
                    "updated": "2011-08-21T16:50:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48036",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=intiilapa",
                        "name": "intiilapa",
                        "displayName": "Beno\u00eet Durand",
                        "active": true
                    },
                    "body": "Please use tag code : this improves the reading.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=intiilapa",
                        "name": "intiilapa",
                        "displayName": "Beno\u00eet Durand",
                        "active": true
                    },
                    "created": "2011-08-21T19:00:57.000+0000",
                    "updated": "2011-08-21T19:00:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48045",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eistrati",
                        "name": "eistrati",
                        "displayName": "Eugene Istrati",
                        "active": true
                    },
                    "body": "Same thing:\r\n\r\n{code}\r\nWarning: assert(): Assertion failed in C:\\Eugene\\localhost\\Billing\\testing.php on line 72\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eistrati",
                        "name": "eistrati",
                        "displayName": "Eugene Istrati",
                        "active": true
                    },
                    "created": "2011-08-22T20:55:49.000+0000",
                    "updated": "2011-08-22T20:55:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49162",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                        "name": "ramon",
                        "displayName": "Ramon Henrique Ornelas",
                        "active": true
                    },
                    "body": "Sorry the delay to response. But I was really busy.\r\nYou can verify the dir_cache is writable (is_writable) or simulate in another enviroment to verify the diff (if this fine work).\r\n\r\nGreetings\r\nRamon ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                        "name": "ramon",
                        "displayName": "Ramon Henrique Ornelas",
                        "active": true
                    },
                    "created": "2011-11-22T09:22:46.000+0000",
                    "updated": "2011-11-22T09:22:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51053",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                        "name": "ramon",
                        "displayName": "Ramon Henrique Ornelas",
                        "active": true
                    },
                    "body": "Need of more information about last comment.\r\nCase persist this problem feel free to reopen ;).\r\n\r\nGreetings,\r\nRamon",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                        "name": "ramon",
                        "displayName": "Ramon Henrique Ornelas",
                        "active": true
                    },
                    "created": "2012-06-10T10:48:13.000+0000",
                    "updated": "2012-06-10T10:48:13.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11677\/transitions"
}