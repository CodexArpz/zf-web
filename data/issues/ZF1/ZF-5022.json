{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5022",
    "key": "ZF-5022",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Soap_Autodiscover throws SoapFault VersionMismatch"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5022\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10270",
                    "id": 10270,
                    "description": "Mini Release",
                    "name": "1.7.1",
                    "userReleaseDate": "01\/Dec\/08",
                    "archived": false,
                    "releaseDate": "2008-12-01",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-11-25T07:44:52.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=emartinez",
                "name": "emartinez",
                "displayName": "Erick Martinez",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-11-21T09:12:06.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-12-21T05:48:50.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I have the following class used to set up the zend soap server:\n\n<code>\n<?php\n\/**\n * Webservice_Lmpbec\n * \n * \n * \n *\n *\/\nclass Webservice_Lmpbec\n{\n\/*    \/**\n     * Zend_Db_Adapter\n     *\n     * @var Zend_Db_Adapter_Abstract\n     *\/\n    private $_zendDb;\n    \/**\n     * Input Data\n     *\n     * @var Webservice_Cldatac\n     *\/\n    private $cldatac;\n    \/**\n     * Output Data\n     *\n     * @var Webservice_Clbec\n     *\/\n    private $clbec;\n    \/**\n     * Error de validaci\u00f3n\n     *\n     * @var array\n     *\/\n    private $error;\n    \n    \/**\n     * Constructor for this class\n     * \n     * sets up the Db connection\n     *\n     *\/\n    function __construct ()\n    {\n        $config = Zend_Registry::get('config');\n        $this->_zendDb = Zend_Db::factory($config->database);\n        $this->clbec = new Webservice_Clbec();\n    }\n    \n    \/**\n     * fetchBec\n     * \n     * Recieves client info including CID and\n     * checks if already registered on the local DB\n     * if so return BEC else registers the client and returns his\n     * BEC id\n     *\n     * @param Webservice_Cldatac $input\n     * @return Webservice_Clbec\n     *\/\n    public function fetchBec(Webservice_Cldatac  $input)\n    {\n        $this->setCldatac($input);\n        \n        $this->clbec->fecha = date('d\/m\/Y');\n        $this->clbec->hora  = date('H:i:s');\n        $this->clbec->referencia = $this->cldatac->referencia;\n        \n        if (!$this->authenticate() || !$this->validaData()){\n            $this->clbec->respuesta = 'FAILED';\n            $this->clbec->cd_respuesta = 1;\n            $this->clbec->bec = '';\n        } else {\n            $this->clbec->respuesta = 'OK';\n            $this->clbec->cd_respuesta = 0;\n            $this->clbec->bec = '655765';\n        }\n        \n        return $this->clbec;\n    }\n    \n    private function validaData()\n    {\n        $emailValidator = new Zend_Validate_EmailAddress();\n        $dateValidator = new Zend_Validate_Date('Y-m-d');      \n        \n        $valid = true;\n        \n        if($this->cldatac->apaterno == ''){\n            $this->clbec->cd_error = 4;\n            $this->clbec->nb_error = 'Apaterno es un campo obligatorio.';\n            $valid = false;          \n        } elseif ($this->cldatac->nombre == '') {\n            $this->clbec->cd_error = 4;\n            $this->clbec->nb_error = 'El nombre es un campo obligatorio';\n            $valid = false;\n        } elseif ($this->cldatac->cid == ''){\n            $this->clbec->cd_error = 3;\n            $this->clbec->nb_error = 'CID es un campo obligatorio';\n        } elseif (!$emailValidator->isValid($this->cldatac->email)) {\n            $this->clbec->cd_error = 5;\n            $this->clbec->nb_error = 'Direcci\u00f3n email inv\u00e1lida';\n            $valid = false;\n        } elseif (!$dateValidator->isValid($this->cldatac->fnyear.'-'.$this->cldatac->fnmonth.'-'.$this->cldatac->fnday)) {\n            $this->clbec->cd_error = 6;\n            $this->clbec->nb_error = 'Fecha de nacimiento inv\u00e1lida';\n            $valid = false;\n        }\n        \n        return $valid;\n    }\n    \n    \/**\n     * Webservice authentication\n     *\n     * @param string $user\n     * @param string $pass\n     * @return boolean\n     *\/\n    private function authenticate()\n    {\n        $sql = \"SELECT * FROM ws_user WHERE ws_user = ? AND ws_password = SHA1(?)\";\n        $result = $this->_zendDb->fetchAll($sql,array($this->cldatac->user,$this->cldatac->pass));\n        \n        if(count($result) == 1){\n            return true;\n        } else {\n            $this->clbec->nb_error = 'Usuario o contrase\u00f1a inv\u00e1lidos';\n            $this->clbec->cd_error = 1;\n            return false;\n        }\n    }\n    \n    \/**\n     * Check if client exists in DB\n     *\n     * @return boolean\n     *\/\n    private function clientExists()\n    {\n        $sql  =\t\"SELECT * FROM cliente \" .\n        \t    \"WHERE ( cliente_pnombre = ? \" .\n                \"AND cliente_snombre = ? \" .\n                \"AND cliente_apaterno = ? \" .\n                \"AND cliente_amaterno = ? ) \" .\n                \"OR ( cliente_email = ? ) \" . \n                \"LIMIT 1\";\n\t\t$result = $this->_zendDb->fetchAll(\n\t\t    $sql,\n\t\t    array(\n\t\t        $this->cldatac->nombre,\n\t\t        $this->cldatac->snombre,\n\t\t        $this->cldatac->apaterno,\n\t\t        $this->cldatac->amaterno,\n\t\t        $this->cldatac->email,\n\t\t    )\n\t\t);\n\t\t\n\t\tif (count($result) == 1){\n\t\t    return true;\n\t\t} else {\n\t\t    return false;\n\t\t}\n    }\n    \n    \/**\n     * getBec\n     * \n     * Returns Client BEC from an existent client\n     *\n     * @return string\n     *\/\n    private function getBec()\n    {\n        $sql  =\t\"SELECT cliente_bec FROM cliente \" .\n        \t    \"WHERE ( cliente_pnombre = ? \" .\n                \"AND cliente_snombre = ? \" .\n                \"AND cliente_apaterno = ? \" .\n                \"AND cliente_amaterno = ? ) \" .\n                \"OR ( cliente_email = ? ) \" . \n                \"LIMIT 1\";\n\t\t$bec = $this->_zendDb->fetchOne(\n\t\t    $sql,\n\t\t    array(\n\t\t        $this->cldatac->nombre,\n\t\t        $this->cldatac->snombre,\n\t\t        $this->cldatac->apaterno,\n\t\t        $this->cldatac->amaterno,\n\t\t        $this->cldatac->email,\n\t\t    )\n\t\t);\n\t\t\n\t\treturn $bec;\n    }\n    \n    \/**\n     * @return Webservice_Cldatac\n     *\/\n    private function getCldatac ()\n    {\n        return $this->cldatac;\n    }\n    \/**\n     * @param Webservice_Cldatac $cldatac\n     *\/\n    private function setCldatac (Webservice_Cldatac $cldatac)\n    {\n        $this->cldatac = $cldatac;\n    }\n    \/**\n     * @return Webservice_Clbec\n     *\/\n    private function getClbec ()\n    {\n        return $this->clbec;\n    }\n    \/**\n     * @param Webservice_Clbec $clbec\n     *\/\n    private function setClbec (Webservice_Clbec $clbec)\n    {\n        $this->clbec = $clbec;\n    }\n\n\n}\n\n<\/code>\n\nWhich makes use of Webservice_Clbec and Webservice_Cldatac to be translated as complexTypes by Autodiscovery. WSDL seems ok actually pretty much the same as one generated by nusoap server class. Finally, when I instantiate Zend_Soap_Client or SoapClient and call the method fetchBec the following exception is thrown:\n\nFatal error: Uncaught SoapFault exception: [VersionMismatch] Wrong Version in C:\\Users\\sivemax01\\Zend\\workspaces\\DefaultWorkspace\\library\\Zend\\Soap\\Client.php:887 Stack trace: #0 [internal function]: SoapClient->__call('fetchBec', Array) #1 C:\\Users\\sivemax01\\Zend\\workspaces\\DefaultWorkspace\\library\\Zend\\Soap\\Client.php(887): Zend_Soap_Client_Common->fetchBec(Array) #2 [internal function]: Zend_Soap_Client->__call(Array, Array) #3 C:\\Users\\sivemax01\\Zend\\workspaces\\DefaultWorkspace\\lmp\\html\\client.php(70): Zend_Soap_Client->fetchBec('fetchBec', Array) #4 {main} thrown in C:\\Users\\sivemax01\\Zend\\workspaces\\DefaultWorkspace\\library\\Zend\\Soap\\Client.php on line 887\n\nI am using xampp 1.6.8 on Windows Vista which comes with php 5.2.6. I tried disabling php_soap.dll but useless, I also tested this code on a centos server using php 5.2.1 but still similar error.\n\nI even tried a simpler class with no db adapters, no complex types:\n\n<code>\n<?php\nclass myclass {\n\n    public function method($input)\n   {\n        return $input\n    }\n\n}\n<\/code>\n\nObviously adding phpdoc but still same error, I guess this means something is wrong with my server configuration but I don't know what. Any Ideas?\n\n\nErick Martinez\n\n** Update\n\nI\u00b4ve been trying to use SoapServer and SoapClient in the same way (Zend_Soap_Server and Zend_Soap_Client rely on them as I understand) with excactly the same error: Wrong Version, so it seem is not a Zend_Framework Issue but rather a php one, still I can't figure out what is causing the problem or if anyone has succeeded implementing the SoapServer, under which configuration.\n\nWhen executed over CENTOS php 5.2.5 I get some DTD fault (SOAP can't manage DTD or something) , hmm...\n\nWeird thing is I have been working with nusoap and works like a charm, even when I use SoapClient to instanciate some methods. I wish this could be fixed I kind of liked the Zend_Soap API, it seems more modular.\n\n\nComment\n\nI see what you say, thing is I generate what it seems to be a correct WSDL then I pass the uri of the WSDL as the first parameter to the Zend_Soap_Server or else I save the generated WSDL (I can even use an IDE to edit it diagramatically) but when I instantiate Zend_Soap_Client and , if I specify the uri of the WSDL the fault message is presented or if I specify the uri of the server (which I don't understand what's the use if you are working id wsdl mode and soapclient constructor takes wsdl uri as first parameter and makes no use of the uri\/location parameter) a fault message with \"Can't read WSDL file \" is presented. Maybe I am missing something...\n\n-- Update 2008\/11\/23\n\nI fixed this, you were right, I was using this wrong: I had separated files one for WSDL and one for the server so I guess this was the problem (that and a bad SQL...). You are right may be Auto discover should include server, maybe you could use it by default and deactivate it with a construct parameter. Anyway it would be useful to have this information on the official documentation.\n\nThank you"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5022\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                "name": "beberlei",
                "displayName": "Benjamin Eberlei",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10260",
                    "id": 10260,
                    "description": "Minor Release",
                    "name": "1.7.0",
                    "userReleaseDate": "17\/Nov\/08",
                    "archived": false,
                    "releaseDate": "2008-11-17",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10097",
                    "id": 10097,
                    "name": "Zend_Soap_Server",
                    "description": "A server to respond to SOAP requests.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26597",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "body": "I think you are using it wrong.\n\nZend_Soap_AutoDiscover is NOT a server. It only generates the WSDL File. What you have to do is specifiy the WSDL with AutoDiscover somewhere and then use Zend_Soap_Server and give the WSDL uri as the first parameter. The AutoDiscover has to generate the correct location of the Zend_Soap_Server.\n\nI have written a tutorial that describes the steps to get Soap Server + AutoDiscover to work at server.php and server.php?wsdl repsectivly:\n\nhttp:\/\/www.whitewashing.de\/blog\/articles\/65\n\nMaybe Zend_Soap_AutoDiscover should be integrated with Zend_Soap_Server in a Tiein component, since it somehow happens frequently, that people misunderstand the AutoDiscover component a little bit. Perhaps the manual is unclear on this issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "created": "2008-11-23T05:25:44.000+0000",
                    "updated": "2008-11-23T05:25:44.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26614",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ciaranmcnulty",
                        "name": "ciaranmcnulty",
                        "displayName": "Ciaran McNulty",
                        "active": true
                    },
                    "body": "I've just found this bug after having the same issue - I'd suggest it was a documentation bug more than anything else.\n\nIt would be nice if it was possible to inject a SOAP endpoint URL into the generated WSDL somehow?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ciaranmcnulty",
                        "name": "ciaranmcnulty",
                        "displayName": "Ciaran McNulty",
                        "active": true
                    },
                    "created": "2008-11-24T01:20:59.000+0000",
                    "updated": "2008-11-24T01:20:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26655",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "body": "this is possible using the setUri function of both autodiscover and wsdl classes.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "created": "2008-11-24T15:11:07.000+0000",
                    "updated": "2008-11-24T15:11:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26679",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "body": "I a version to come, AutoDiscover and Soap Server should be integrated more tightly but now i just added a note into the manual which will be inserted into 1.7.1 release manual.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "created": "2008-11-25T07:44:51.000+0000",
                    "updated": "2008-11-25T07:44:51.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5022\/transitions"
}