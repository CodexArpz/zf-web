{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3423",
    "key": "ZF-3423",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Validate_Float doesn't work with local than doesn't have a dot as decimal separator"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField",
            "value": {
                "timeestimate": 0,
                "timespent": 60
            }
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3423\/votes",
                "votes": 3,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10241",
                    "id": 10241,
                    "description": "Minor Release",
                    "name": "1.8.0",
                    "userReleaseDate": "30\/Apr\/09",
                    "archived": false,
                    "releaseDate": "2009-04-30",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-12-19T04:02:42.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=pengu",
                "name": "pengu",
                "displayName": "J\u00e9r\u00e9my Lajotte",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-06-09T14:10:58.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-12-19T04:02:41.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "The php function strval use the decimal point character that is defined in the script's locale (category LC_NUMERIC), so depending on the local set in PHP.\n\nFor instance, strval(1.2) return \"1,2\"  in \"fr_FR.utf8\" locale.\n\nSo basicaly the isValid() function of the Zend_Validate_Float class does this :\n\n{code}\n        $locale = localeconv();\n        \n        $valueFiltered = str_replace($locale['thousands_sep'], '', $valueString);\n        $valueFiltered = str_replace($locale['decimal_point'], '.', $valueFiltered);\n        if (strval(floatval($valueFiltered)) != $valueFiltered) {\n          \/* only true if the $locale['thousands_sep'] is already '' and $locale['decimal_point'] is already '.' *\/\n{code}\nHere, the code replace the locale decimal point by '.' and remove the locale thousand separator and then compare this string to the same string, convertred to float and displayed using that same locale decimal point and locale thousand separator ...  well, the only chance for this to work is if the locale decimal point IS already a '.' and the locale thousand separator is ''.\n\n\nI think this should be enough to test if a value is a float : \n\n{code:title=Zend_Validate_Float, line 68 }\nif (false===ereg('^[0-9]*\\.[0-9]+$', $valueFiltered)){\n  \/* not a float *\/\n}\n{code}\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/2",
                "name": "Critical"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3423\/watchers",
                "isWatching": false,
                "watchCount": 6
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/worklog\/21677",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3423",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=raistlin",
                        "name": "raistlin",
                        "displayName": "Adam Kusmierz",
                        "active": true
                    },
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=raistlin",
                        "name": "raistlin",
                        "displayName": "Adam Kusmierz",
                        "active": true
                    },
                    "comment": "",
                    "created": "2008-09-10T15:22:24.000+0000",
                    "updated": "2008-09-10T15:22:24.000+0000",
                    "started": "2008-09-10T15:21:00.000+0000",
                    "minutesSpent": 60
                }
            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-4000",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4000",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11531",
                    "filename": "Zend_Validate.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=raistlin",
                        "name": "raistlin",
                        "displayName": "Adam Kusmierz",
                        "active": true
                    },
                    "created": "2008-09-10T15:21:17.000+0000",
                    "size": 538,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11531\/Zend_Validate.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-4059",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4059",
                    "type": {
                        "name": "Sub-Task",
                        "direction": "OUTBOUND"
                    }
                }
            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10181",
                    "id": 10181,
                    "description": "Mini Release",
                    "name": " 1.5.2",
                    "userReleaseDate": "15\/May\/08",
                    "archived": true,
                    "releaseDate": "2008-05-15",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10140",
                    "id": 10140,
                    "name": "Zend_Validate",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22291",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Attention:\nYou should also take in account that users may have set Zend_Locale to a different locale than the one from setlocale (setlocale is not threadsave).\n\nSo we could have system set to french and user setting arabic.\nValidate should be able also to verify such.\n\nEasiest solution:\nAllow a locale to be set\nUse Zend_Locale to normalize the value.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-06-10T11:34:18.000+0000",
                    "updated": "2008-06-10T11:34:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24430",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=raistlin",
                        "name": "raistlin",
                        "displayName": "Adam Kusmierz",
                        "active": true
                    },
                    "body": "This should be resolve this issue. It matches old value with converted from string to float and again to string old value.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=raistlin",
                        "name": "raistlin",
                        "displayName": "Adam Kusmierz",
                        "active": true
                    },
                    "created": "2008-09-10T15:21:18.000+0000",
                    "updated": "2008-09-10T15:21:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27156",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "The patch does not work when the user is using Zend_Form with an application locale.\nInput could be \"1,2\" even it system locale is set to \"en\" because the application locale is set to \"fr\".\n\nThe validation would still fail.\nTherefor this fix does not solve the problem, only part of it.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-12-09T00:45:15.000+0000",
                    "updated": "2008-12-09T00:45:15.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27198",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=raistlin",
                        "name": "raistlin",
                        "displayName": "Adam Kusmierz",
                        "active": true
                    },
                    "body": "And what with this:\nhttp:\/\/framework.zend.com\/issues\/secure\/attachment\/11531\/Zend_Validate.patch\n?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=raistlin",
                        "name": "raistlin",
                        "displayName": "Adam Kusmierz",
                        "active": true
                    },
                    "created": "2008-12-10T12:25:00.000+0000",
                    "updated": "2008-12-10T12:25:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27199",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "This is the same patch which I commented... there is no difference.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-12-10T12:56:50.000+0000",
                    "updated": "2008-12-10T12:56:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27213",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=snefit",
                        "name": "snefit",
                        "displayName": "Sven Franke",
                        "active": true
                    },
                    "body": "Hi,\n\nI use this 'solution'. Maybe it isn't a correct one but it works for me in the application.\n\n{noformat}\n<?php\n\nclass Application_Validate_Float extends Zend_Validate_Float {\n    \n    const NOT_FLOAT = 'notFloat';\n\n    \/**\n     * Message templates.\n     * \n     * @var array\n     *\/\n    protected $_messageTemplates = array(\n        self::NOT_FLOAT => \"'%value%' does not appear to be a float\"\n    );\n\n    \/**\n     * Locale\n     *\n     * @var Zend_Locale\n     *\/    \n    protected $_locale;\n    \n    \/**\n     * Constructor\n     *\n     * @param string|Zend_Locale|null $locale\n     *\/\n    public function __construct($locale = null) {\n        \n        $this->setLocale($locale);\n        \n    }\n    \n    \n    \/**\n     * Returns the locale option\n     *\n     * @return string|Zend_Locale|null\n     *\/\n    public function getLocale()\n    {\n        return $this->_locale;\n    }\n\n    \/**\n     * Sets the locale option\n     *\n     * @param  string|Zend_Locale $locale\n     * @return Zend_Validate_Date provides a fluent interface\n     *\/\n    public function setLocale($locale = null)\n    {\n        if ($locale === null) {\n            $this->_locale = null;\n            return $this;\n        }\n\n        require_once 'Zend\/Locale.php';\n        if (!Zend_Locale::isLocale($locale, true, false)) {\n            if (!Zend_Locale::isLocale($locale, false, false)) {\n                require_once 'Zend\/Validate\/Exception.php';\n                throw new Zend_Validate_Exception(\"The locale '$locale' is no known locale\");\n            }\n\n            $locale = new Zend_Locale($locale);\n        }\n\n        $this->_locale = (string) $locale;\n        return $this;\n    }\n    \n    \n    \/**\n     * Defined by Zend_Validate_Interface\n     *\n     * Returns true if and only if $value is a floating-point value\n     *\n     * @param  string $value\n     * @return boolean\n     *\/\n    public function isValid($value)\n    {\n        $valueString = (string) $value;\n\n        $this->_setValue($valueString);\n\n\/\/        \/\/ ORIGINAL FROM ZEND_FLOAT (ZF 1.7.0)\n\/\/        $locale = localeconv();\n\/\/\n\/\/        $valueFiltered = str_replace($locale['thousands_sep'], '', $valueString);\n\/\/        $valueFiltered = str_replace($locale['decimal_point'], '.', $valueFiltered);\n\/\/ \n\/\/        if (strval(floatval($valueFiltered)) != $valueFiltered) {\n\/\/            $this->_error();\n\/\/            return false;\n\/\/        }\n\n        \/\/ Locale aware.\n        if(!Zend_Locale_Format::isFloat($value, array('locale' => $locale))) { \n            $this->_error(); \n            return false; \n        }\n        \n        return true;\n    }\n    \n}\n?>\n{noformat}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=snefit",
                        "name": "snefit",
                        "displayName": "Sven Franke",
                        "active": true
                    },
                    "created": "2008-12-10T23:12:05.000+0000",
                    "updated": "2008-12-10T23:12:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27224",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Yes, this solution is the right direction.\nIt can be used as workaround and shows what I said to be the solution.\n\nThere are only part details which will be changed by me.\n\nThanks Sven :-)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-12-11T06:46:36.000+0000",
                    "updated": "2008-12-11T06:46:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27472",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "New feature added with r13372",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-12-19T04:02:38.000+0000",
                    "updated": "2008-12-19T04:02:38.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3423\/transitions"
}