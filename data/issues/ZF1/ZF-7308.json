{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7308",
    "key": "ZF-7308",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Dojo_Form requires an id or name attribute to be initialized properly in programmatic mode"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7308\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mgordon",
                "name": "mgordon",
                "displayName": "Max Gordon",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-07-19T06:29:45.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-08-01T10:46:01.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "Null_value",
                "NumberSpinner",
                "Submit_Form",
                "Zend_Dojo",
                "Zend_Dojo_Form"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "It seems that the NumbersSpinner issue might be a dojo-issue, I've posted this ticket: http:\/\/bugs.dojotoolkit.org\/ticket\/9643\r\n\r\nThis leaves the issue with the dojo form not being connected to the form when using Zend_Dojo_View_Helper_Dojo::setUseProgrammatic();\r\n\r\nI've debugged and found the cause being that the form can't be without an id or name attrib:\r\n{code:title=The JavaScript part created for initialising the form}\r\n<script type=\"text\/javascript\">\r\n\/\/<![CDATA[\r\ndojo.require(\"dijit.form.NumberSpinner\");\r\n    dojo.require(\"dijit.form.Form\");\r\n    dojo.require(\"dojo.parser\");\r\ndojo.addOnLoad(function() {\r\n    dojo.forEach(zendDijits, function(info) {\r\n        var n = dojo.byId(info.id);\r\n        if (null != n) {\r\n            dojo.attr(n, dojo.mixin({ id: info.id }, info.params));\r\n        }\r\n    });\r\n    dojo.parser.parse();\r\n});\r\nvar zendDijits = [{\"id\":\"number\",\"params\":{\"constraints\":\"{\\\"min\\\":0,\\\"max\\\":4,\\\"places\\\":1,\\\"pattern\\\":\\\"##0.## cm\\\"}\",\"smallDelta\":1,\"largeDelta\":10,\"required\":\"true\",\"dojoType\":\"dijit.form.NumberSpinner\"}},{\"id\":null,\"params\":{\"dojoType\":\"dijit.form.Form\"}}];\r\n\/\/]]>\r\n\r\n<\/script>\r\n{code}\r\n\r\nThe error is due to this part: *{\"id\":null,\"params\":{\"dojoType\":\"dijit.form.Form\"}}*. The id cannot be null since the dojo.byId then can't find the form.\r\n\r\nMy suggestion is to: \r\n{code:title=Zend_Dojo_Form add a getName() function}\r\n    public function getName(){\r\n    \t$name = parent::getName();\r\n    \tif($name === null){\r\n    \t\t$name = __CLASS__ . \"_timestamp_\" .time();\r\n    \t}\r\n    \treturn $name;\r\n    }\r\n{code}\r\n\r\nThe alternative is to throw an exception or warning when not providing a Zend_Dojo_Form with an id or name. Another possibility that applies to my specific code is to use the ini-file data as name of the form:\r\n{code}\r\ndemo.test_element_form.method = \"post\"\r\ndemo.test_element_form.class = \"zend_form\"\r\n{code}\r\n\r\nWhere the form name obviously is \"test_element_form\".\r\n\r\nOriginal bug report:\r\nA Zend_Dojo_Form isn't submittable if a NumberSpinner element is set to null, pressing the submit button gives no response. After some searching I found this comment on Dojo's homepage about the required vale that explains this odd behavior: ??Defaults to true in NumberSpinner because the arrows won't work otherwise.??\r\n\r\nSee http:\/\/dojotoolkit.org\/book\/dojo-book-0-9\/part-2-dijit\/form-validation-specialized-input\/number-spinner for details\r\n\r\nSuggestion:\r\n- *Improve doc* - add a comment about this in the docs\r\n- *Disable false* - disable the required false option for this element"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/5",
                "name": "Trivial"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7308\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13873",
                    "filename": "Zend_Dojo_Form.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=swaagie",
                        "name": "swaagie",
                        "displayName": "Martijn Swaagman",
                        "active": true
                    },
                    "created": "2011-04-25T08:28:24.000+0000",
                    "size": 962,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13873\/Zend_Dojo_Form.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10320",
                    "id": 10320,
                    "description": "Minor Release",
                    "name": "1.9.0",
                    "userReleaseDate": "31\/Jul\/09",
                    "archived": false,
                    "releaseDate": "2009-07-31",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10311",
                    "id": 10311,
                    "name": "Zend_Dojo",
                    "description": "Dojo integration with Zend Framework",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/33034",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mgordon",
                        "name": "mgordon",
                        "displayName": "Max Gordon",
                        "active": true
                    },
                    "body": "Just noticed that this seems to be an on-and-off issue, I've been able to use the NumberSpinner in forms created from ini-files without any issues and without being forced to add a required.\n\nMy latest situation where this problem reappears is when I have a form created from ini-files where there are subforms with the NumberSpinners in them. This is all a little strange, hard to understand - probably a dojo error since the submit button doesn't respond.\n\nHere is an example of my current code:\n{code:title=Ini-file}\n[followup3]\n; general form metainformation\ndemo.followup3.method = \"post\"\ndemo.followup3.class = \"zend_form\"\n\n; initials element\ndemo.followup3.elements.initials.type = \"TextBox\"\ndemo.followup3.elements.initials.options.label = \"Initials\"\ndemo.followup3.elements.initials.options.name = \"initials\"\ndemo.followup3.elements.initials.options.required = true\ndemo.followup3.elements.initials.options.prefixPath.validate.prefix = \"Max_Validate\"\ndemo.followup3.elements.initials.options.prefixPath.validate.path = \"Max\/Validate\/\"\ndemo.followup3.elements.initials.options.prefixPath.validate.type = \"validate\"\ndemo.followup3.elements.initials.options.validators.checkDemoInitials = \"checkDemoInitials\"\ndemo.followup3.elements.initials.options.validators.alnum.validator = \"alnum\"\ndemo.followup3.elements.initials.options.validators.strlen.validator = \"StringLength\"\ndemo.followup3.elements.initials.options.validators.strlen.options.min = \"1\"\ndemo.followup3.elements.initials.options.validators.strlen.options.max = \"10\"\n\n; followup3_date element\ndemo.followup3.elements.followup_date.type = \"DateTextBox\"\ndemo.followup3.elements.followup_date.options.label = \"Followup date\"\ndemo.followup3.elements.followup_date.options.name = \"followup_date\"\ndemo.followup3.elements.followup_date.validators.date.validator = \"date\"\n\n; submit element\ndemo.followup3.elements.submit.type = \"submit\"\ndemo.followup3.elements.submit.name = \"save\"\n\n[followup3_eq5d]\n; general form metainformation\ndemo.followup3_eq5d.method = \"post\"\ndemo.followup3_eq5d.class = \"zend_form\"\n\n; mobility element\ndemo.followup3_eq5d.elements.mobility.type = \"RadioButton\"\ndemo.followup3_eq5d.elements.mobility.options.label = \"Mobility\"\ndemo.followup3_eq5d.elements.mobility.options.name = \"mobility\"\ndemo.followup3_eq5d.elements.mobility.options.multiOptions.1 = \"I have no problems in walkning about\"\ndemo.followup3_eq5d.elements.mobility.options.multiOptions.2 = \"I have some problems in walking about\"\ndemo.followup3_eq5d.elements.mobility.options.multiOptions.3 = \"I am confined to bed\"\n\n; current_health_state element\ndemo.followup3_eq5d.elements.current_health_state.type = \"NumberSpinner\"\ndemo.followup3_eq5d.elements.current_health_state.options.label = \"Health state\"\ndemo.followup3_eq5d.elements.current_health_state.options.name = \"current_health_state\"\ndemo.followup3_eq5d.elements.current_health_state.options.places = 0\ndemo.followup3_eq5d.elements.current_health_state.options.min = \"0\"\ndemo.followup3_eq5d.elements.current_health_state.options.max = \"100\"\ndemo.followup3_eq5d.elements.current_health_state.options.smallDelta = \"1\"\ndemo.followup3_eq5d.elements.current_health_state.options.largeDelta = \"10\"\n; the filtering below is for getting a null if the value is empty - for some reason it doesn't do that for me\n; without some extra filtering\ndemo.followup3_eq5d.elements.current_health_state.options.prefixPath.filter.prefix = \"Max_Filter\"\ndemo.followup3_eq5d.elements.current_health_state.options.prefixPath.filter.path = \"Max\/Filter\/\"\ndemo.followup3_eq5d.elements.current_health_state.options.prefixPath.filter.type = \"filter\"\ndemo.followup3_eq5d.elements.current_health_state.options.filters.setNull = \"setNull\"\n\n; submit element\ndemo.followup3_eq5d.elements.submit.type = \"submit\"\ndemo.followup3_eq5d.elements.submit.name = \"save\"\n{code}\n\nThen some code\n{code:title=Create the form from ini-file}\n\nZend_Loader::loadClass('Zend_Dojo_Form');\n$form  = new Zend_Dojo_Form();\n$form->setMethod('post');\n$form->setAttribs(array(\n            'name'  => 'masterForm',\n\t\t\t'method' => 'post',\n));\n\n$form->setDecorators(\narray(\n\t'FormElements',\n\tarray('TabContainer',\n\t\tarray(\n\t\t'id' => 'tabContainer',\n\t\t'style' => 'width: auto; max-width: 800px; height: 600px',\n\t\t'dijitParams' => array(\n\t\t\t'tabPosition' => 'top'\n\t\t))\n\t),\n\t'DijitForm',\n));\n\n...stuff...\n\nZend_Loader::loadClass(\"Zend_Dojo_Form_SubForm\");\nforeach ($this->view->group_tables[$group_name] as $table_name) {\n\t$config = new Zend_Config_Ini($config_file_name, $table_name);\n\t$new_subform= new Zend_Dojo_Form_SubForm($config->$study_name->$table_name);\n\t$new_subform->setAttribs(\n\t\tarray(\n\t\t\t'name'   => $table_name,\n\t\t\t'legend' => $this->view->all_table_key_names[$table_name],\n\t\t\t'dijitParams' => array(\n\t\t\t\t'title' => $this->view->all_table_key_names[$table_name],\n\t\t\t),\n\t\t\t'class' => 'zend_form'\n\t\t)\n\t);\n\n\t$data = $model->getSubjectArray($subject_id, $table_name);\n\t$new_subform->setDefaults($data);\n\t$form->addSubForm($new_subform, $table_name);\n}\n{code}\n\nI've tried to remove the unnecessary stuff but if it's still unreadable (or due to that) then tell me to re-post.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mgordon",
                        "name": "mgordon",
                        "displayName": "Max Gordon",
                        "active": true
                    },
                    "created": "2009-07-29T16:07:18.000+0000",
                    "updated": "2009-07-29T16:07:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/33095",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mgordon",
                        "name": "mgordon",
                        "displayName": "Max Gordon",
                        "active": true
                    },
                    "body": "The reason for the tabbed and non-tabbed issue seems to be related to the the Zend_Dojo_View_Helper_Dojo::setUseDeclarative()\/setUseProgrammatic():\n- With declarative use the onSubmit event is connected \n- With programmatic use the onSubmit event is only connected when I use a form in a tabbed manner as above\n\nThe problem with NumberSpinner is connected to the onSubmit event so even though part of the mystery is solved the main problem remains",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mgordon",
                        "name": "mgordon",
                        "displayName": "Max Gordon",
                        "active": true
                    },
                    "created": "2009-07-31T05:33:53.000+0000",
                    "updated": "2009-07-31T05:33:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/33160",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mgordon",
                        "name": "mgordon",
                        "displayName": "Max Gordon",
                        "active": true
                    },
                    "body": "Sorry for the somewhat messy bug report, hopefully it is now much clearer what needs to be done.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mgordon",
                        "name": "mgordon",
                        "displayName": "Max Gordon",
                        "active": true
                    },
                    "created": "2009-08-03T10:53:38.000+0000",
                    "updated": "2009-08-03T10:53:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/42008",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=georgy",
                        "name": "georgy",
                        "displayName": "Georgy Turevich",
                        "active": true
                    },
                    "body": "It is important issue. Because Zend_Dojo_Form's without \"name\" works differently in programmatic and declarative modes",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=georgy",
                        "name": "georgy",
                        "displayName": "Georgy Turevich",
                        "active": true
                    },
                    "created": "2010-08-19T02:00:11.000+0000",
                    "updated": "2010-08-19T02:00:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46028",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=swaagie",
                        "name": "swaagie",
                        "displayName": "Martijn Swaagman",
                        "active": true
                    },
                    "body": "ID is enforced during construct, orginal solution to override the Zend_Form::getName method was unstable. Creating two forms quickly after each other could result in duplicate Id's. In addition, the return value of getName() would not be consistent. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=swaagie",
                        "name": "swaagie",
                        "displayName": "Martijn Swaagman",
                        "active": true
                    },
                    "created": "2011-04-25T08:28:24.000+0000",
                    "updated": "2011-04-25T08:28:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46031",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=swaagie",
                        "name": "swaagie",
                        "displayName": "Martijn Swaagman",
                        "active": true
                    },
                    "body": "Patch is only partial, since IE (atleast 9) will still submit the form even though it is empty\/not validated correctly.. setting the name attribute in addition to the ID did not resolve this",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=swaagie",
                        "name": "swaagie",
                        "displayName": "Martijn Swaagman",
                        "active": true
                    },
                    "created": "2011-04-25T11:43:39.000+0000",
                    "updated": "2011-04-25T11:43:39.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46289",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "The provided solution seemed like the incorrect place to do this; if the form name is passed in or changed later, it can cause issues. The more appropriate location seemed to be during decoration, and as such, I've added some code to the DijitForm decorator to generate a name if none is present.\r\n\r\nThe relevant commit is r23932; please check. If it works, let me know so I can merge it to the release branch; if not, please indicate what's failing -- e.g., if the generation of the dijit.form.Form ID is missing, etc.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2011-05-02T19:56:55.000+0000",
                    "updated": "2011-05-02T19:56:55.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7308\/transitions"
}