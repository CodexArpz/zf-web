{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8988",
    "key": "ZF-8988",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend Mail Transport SMTP set sender email address"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8988\/votes",
                "votes": 4,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10501",
                    "id": 10501,
                    "description": "Mini Release",
                    "name": "1.11.1",
                    "userReleaseDate": "30\/Nov\/10",
                    "archived": false,
                    "releaseDate": "2010-11-30",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-11-22T14:52:22.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=souldude",
                "name": "souldude",
                "displayName": "Stefan Straakenbroek",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-01-28T04:35:44.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-10-19T15:03:22.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "File: \/Zend\/Mail\/Transport\/Smtp.php\r\nLine: 207\r\n\r\nIn the smtp transport the from address is set with the following function:\r\n\r\n\/\/ Set sender email address\r\n$this->_connection->mail($this->_mail->getFrom());\r\n\r\nWhen sending a mail to an unknown user with a valid host. In most cased the headers will be read and the Return-Path header will be used to return the mail.\r\n\r\nWhen sending a mail to a non-existing host. The smtp server will return the mail to the from address given in the smpt transport. The header has not been read.\r\n\r\nIn my opinion the sender email address must be set with the following function, so the bounce addresses goes to the return path.\r\n\r\n\/\/ Set sender email address\r\n$this->_connection->mail($this->_mail->getReturnPath());\r\n\r\nWhich automatically fallback in the from address if return path is not set.\r\n\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/1",
                "name": "Blocker"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8988\/watchers",
                "isWatching": false,
                "watchCount": 4
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                "name": "mjh_ca",
                "displayName": "Marc Hodgins",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-7008",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7008",
                    "type": {
                        "name": "Dependency",
                        "direction": "OUTBOUND",
                        "description": "depends on"
                    }
                },
                {
                    "issueKey": "ZF-10528",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10528",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13426",
                    "filename": "ZF-8988.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2010-11-06T02:39:46.000+0000",
                    "size": 4031,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13426\/ZF-8988.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10420",
                    "id": 10420,
                    "description": "Minor Release",
                    "name": "1.11.0",
                    "userReleaseDate": "02\/Nov\/10",
                    "archived": false,
                    "releaseDate": "2010-11-02",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10018",
                    "id": 10018,
                    "name": "Zend_Mail",
                    "description": "high-level utility to build MIME-compliant messages and send using a mail transport adapter",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38098",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ilanr",
                        "name": "ilanr",
                        "displayName": "Ilan Rivers",
                        "active": true
                    },
                    "body": "Funny that this was created yesterday. I recently had the same problem on a project I am working on. This should really be as simple as changing the function that is called. Hope that this fix can be included in the next mini release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ilanr",
                        "name": "ilanr",
                        "displayName": "Ilan Rivers",
                        "active": true
                    },
                    "created": "2010-01-29T01:40:54.000+0000",
                    "updated": "2010-01-29T01:40:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38176",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=souldude",
                        "name": "souldude",
                        "displayName": "Stefan Straakenbroek",
                        "active": true
                    },
                    "body": "I saw the issue ZF-7008 but that one is using the php mail function:\r\n\r\n\"Sending mail with an additional command line parameter.\"\r\n\r\nIn my case i use the SMTP transport.\r\n\r\n$transport = new Zend_Mail_Transport_Smtp('mail.example.com');\r\n\r\nBecause of that, i cannot use the function described in zend manual:\r\n\r\n$transport = new Zend_Mail_Transport_Sendmail('-freturn_to_me@example.com');\r\n\r\n\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=souldude",
                        "name": "souldude",
                        "displayName": "Stefan Straakenbroek",
                        "active": true
                    },
                    "created": "2010-02-01T01:03:11.000+0000",
                    "updated": "2010-02-01T01:03:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39599",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "body": "I also agree that the MAIL FROM should be able to be overridable (either as a transport option or by interpretting the $mail->getReturnPath).\r\n\r\nThis is commonly used to forward bounces to another email address for processing, whilst allowing manually replied messages go back to the From address.\r\n\r\nThe Reply-To header isn't an option in these cases, as the bounce address might have additional information such as user id to be used to identify the non-existant email address for automatic unsubscription, and unnessary for the receiver to see the information (which clients seeing Reply-To, will also display the From).\r\n\r\nSince sendmail supports setting this return path, please can the smtp class?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "created": "2010-03-27T06:26:19.000+0000",
                    "updated": "2010-03-27T06:26:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39623",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "body": "Please read http:\/\/www.ietf.org\/rfc\/rfc2821.txt regarding Return-Path\r\n\r\n#ZF-195 originally added this feature\r\n\r\n#ZF-8273 was incorrect, it was not a bug, and was what broke #ZF-195 and caused this issue.\r\n\r\nThe Return-Path is what is set in transit by the MAIL FROM, and any Return-Path header sent to Smtp is stripped. The From mail header gives the user the friendly reply address even when MAIL FROM is different.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "created": "2010-03-28T13:11:54.000+0000",
                    "updated": "2010-03-28T13:11:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40283",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "body": "To clarify, I believe this is a regression bug caused by ZF-8273 breaking Smtp Return-Path support, affecting ZF 1.9.6 onwards. (edited to correct version number)\r\n\r\nHere is a patch to fix it.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "created": "2010-04-28T13:40:01.000+0000",
                    "updated": "2010-04-28T13:41:26.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40287",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "body": "I was asked on irc to include a unit test for this, so I've added a test to the SmtpTest, and included a mock SMTP protocol class needed for it, which fails before the patch and succeeds after.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "created": "2010-04-28T15:17:13.000+0000",
                    "updated": "2010-04-28T15:17:13.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40908",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "body": "Sorry, I have been inactive since last April.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "created": "2010-06-09T00:24:16.000+0000",
                    "updated": "2010-06-09T00:24:16.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/42851",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "body": "Agreed, the behavior introduced by ZF-8273 is incorrect.  The RFC 2821 states that both the MAIL FROM and the Return-Path header should be the same value:\r\n\r\n{noformat}\r\nThe first step in the procedure is the MAIL command.\r\n\r\n      MAIL FROM:<reverse-path> [SP <mail-parameters> ] <CRLF>\r\n{noformat}\r\n... and ...\r\n{noformat}\r\n The time stamp line and the return path line are formally defined as\r\n   follows:\r\n\r\nReturn-path-line = \"Return-Path:\" FWS Reverse-path <CRLF>\r\n{noformat}\r\n\r\nAndy, there are a couple of problems with your proposed patch.  It doesn't run unless the TESTS_ZEND_MAIL_SMTP_ENABLED constant is set to true, which isn't necessary because this can be tested offline.  Also the calls to addBcc(), addCc(), etc, aren't necessary to test this.\r\n\r\nSo, I'm attaching a simplified patch which includes a test that runs by default.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2010-11-06T02:39:47.000+0000",
                    "updated": "2010-11-06T02:39:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43266",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "body": "Applied to trunk in r23423, merged to 1.11 release branch in r23424",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2010-11-22T14:52:22.000+0000",
                    "updated": "2010-11-22T14:52:22.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48741",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=steffen",
                        "name": "steffen",
                        "displayName": "Steffen Weber",
                        "active": true
                    },
                    "body": "The same bug exists in Zend Framework 2.0 Beta 1. Could you please fix it there, too?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=steffen",
                        "name": "steffen",
                        "displayName": "Steffen Weber",
                        "active": true
                    },
                    "created": "2011-10-19T15:03:22.000+0000",
                    "updated": "2011-10-19T15:03:22.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8988\/transitions"
}