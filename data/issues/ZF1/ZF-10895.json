{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10895",
    "key": "ZF-10895",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Chain router issue"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10895\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=motig",
                "name": "motig",
                "displayName": "Motig Lazarex",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-01-03T05:25:11.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-01-03T05:41:53.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "{code}\r\n$langChain = new Zend_Controller_Router_Route_Chain();\r\n$langChain->chain(new Zend_Controller_Router_Route(\r\n                    ':lang',\r\n                    array('lang' => \"cs\",\r\n                    array('lang' => \"(en|de)\")\r\n        ))->chain(new Zend_Controller_Router_Route(\r\n                    '\/:controller\/:action\/*',\r\n                    array(\r\n                       'module' => 'frontend',\r\n                       'controller' => 'index',\r\n                       'action' => 'index'\r\n                    )\r\n        ));\r\n{code}\r\n\r\nThis chain will correctly recognize every URL that is related to it (eg: localhost\/en or localhost\/de or localhost\/en\/controller_name etc.).\r\nThe routers in chain are always successfuly recognized but when the URL contains only the language part (_eg. localhost\/en or localhost\/de), the request object has NOT set the \"controller\" field to default (which is \"index\"), the \"controller\" field is empty instead. Therefore, the request is undispatchable.\r\n\r\nI've been exploring the Zend code a bit and i've found this:\r\n\r\nIn the class Zend_Controller_Router_Route_Chain line 102\r\n{code}$res = $route->match($match, true);{code}\r\nThis line is inside foreach which browses all the routes in chain. For the second route in chain, the $match variable contains false because of the function substr in the same cycle.\r\n\r\nIn Zend_Controller_Router_Route, line 291\r\n\r\n{code}$return = $values + $this->_wildcardData + $this->_defaults;{code}\r\n...results in an array with \"module\" and \"action\" correctly set to default values, but \"controller\" is set to empty for some reason. \r\n\r\nI think (but i'm probably wrong) that in Zend_Controller_Router_Route, line 219\r\n{code}\r\nif ($path !== '') \/\/...\r\n{code}\r\nthe $path here is a boolean with a value \"false\" but the condition asks only for the empty string. Inside this block, the $value array has its field \"controller\" (probably wrongly) set to an empty value."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10895\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dasprid",
                "name": "dasprid",
                "displayName": "Ben Scholzen",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10520",
                    "id": 10520,
                    "description": "Mini Release",
                    "name": "1.11.2",
                    "userReleaseDate": "30\/Dec\/10",
                    "archived": false,
                    "releaseDate": "2010-12-30",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10490",
                    "id": 10490,
                    "name": "Zend_Controller_Router",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43894",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=motig",
                        "name": "motig",
                        "displayName": "Motig Lazarex",
                        "active": true
                    },
                    "body": "The workaround for this issue is easy though...just added .... {code}if($request->getControllerName() == \"\") $request->setControllerName (\"index\");{code} ... to the bootstrap.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=motig",
                        "name": "motig",
                        "displayName": "Motig Lazarex",
                        "active": true
                    },
                    "created": "2011-01-03T05:41:52.000+0000",
                    "updated": "2011-01-03T05:41:52.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10895\/transitions"
}