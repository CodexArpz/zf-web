{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7323",
    "key": "ZF-7323",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Validate_Hostname not properly validating .com & .net hostnames."
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7323\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10320",
                    "id": 10320,
                    "description": "Minor Release",
                    "name": "1.9.0",
                    "userReleaseDate": "31\/Jul\/09",
                    "archived": false,
                    "releaseDate": "2009-07-31",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-07-20T13:19:09.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                "name": "guice",
                "displayName": "Philip",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-07-20T11:29:17.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-07-21T11:59:23.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "emailaddress",
                "hostname",
                "validate",
                "validation",
                "zend_validate_hostname"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Initially caught through an issue with email validation through Zend_Validate_EmailAddress, I've discovered that the root of the issue happens to be Zend_Validate_Hostname not properly validating hostnames. It's allowing hostnames such as ya#hoo.com and p!ace.com validate.\n\nI've tested this with .com, .net, .org, .it and .ly domain names. .com and .net are the only ones that claims \"ya#hoo\" to be valid, which makes sense given my explanation of possible cause below.\n\nSample code:\nrequire_once ('Zend\/Loader\/Autoloader.php');\n$al = Zend_Loader_Autoloader::getInstance();\n\n$host = 'ya#hoo.com';\n$validator = new Zend_Validate_Hostname();\n\nif ( $validator->isValid($host)) {\n   echo \"Valid\";\n} else {\n   echo \"Invalid\";\n}\n\nExpected Results: Invalid\nActual Results: Valid\n\nPossible issue:\nWithin Zend_Validate_Hostname during the $domainParts validation, \"ya#hoo\" is actually passing the $regexKey 5 (index 5 under $regexChars) validation (which is far too long to past in here) on line number 497 in Zend\/Validate\/Hostname.php. The regex itself is over 8k characters long, and a little daunting... I think I'll yield this to the original creator of that regex.\n\nEdit: Update to issue;\nThese values, in their entirety (including the local-part and the @ sign), are validating as valid hostnames: 'place@y*ahoo.com',  'place@ya&hoo.com'"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7323\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10340",
                    "id": 10340,
                    "description": "Mini Release",
                    "name": "1.8.4",
                    "userReleaseDate": "23\/Jun\/09",
                    "archived": false,
                    "releaseDate": "2009-06-23",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10140",
                    "id": 10140,
                    "name": "Zend_Validate",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32739",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "body": "Aren't those valid hostnames with IDN?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "created": "2009-07-20T11:32:15.000+0000",
                    "updated": "2009-07-20T11:32:15.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32742",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "body": "I'm sure the original authors can shed more light on this. I did my research before posting this, and all I could find is RFC 1035 stating a domain is any combination of letters (A-z), digits (0-9), and hyphen (-).\n\nAre there more RFCs out there that define the domain differently under other situations?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "created": "2009-07-20T11:45:27.000+0000",
                    "updated": "2009-07-20T11:45:27.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32743",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "body": "It's also worth noting these domains are validating as \"Valid\" as well:\n'place@yah&oo.com';\n'place@y*ahoo.com';",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "created": "2009-07-20T11:47:08.000+0000",
                    "updated": "2009-07-20T11:47:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32744",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "body": "Added a couple additional values that are validating as \"Valid\" hostnames.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "created": "2009-07-20T11:50:28.000+0000",
                    "updated": "2009-07-20T11:50:28.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32750",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Then take a look at RFC-3490, RFC-3491, RFC-3492, and the COM registrar:\nhttp:\/\/www.verisign.com\/domain-name-services\/domain-name-registries\/idn-domain-names\/index.html\n\nSince 2002 also non-english characters are allowed.\nRFC-1035 is outdated since more than 7 years.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-07-20T12:33:12.000+0000",
                    "updated": "2009-07-20T12:33:12.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32752",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "body": "Okay, my analytical hat is on.\n\nI'm looking over the RFCs and I'm still not seeing how it would allow non-word characters within domain names.\nRFC-3490 still references 1034 and 1035. To my knowledge on RFCs, if an RFC still references a 7 year old RFC, it's still up to date. Only when an RFC is deemed obsolete is it \"invalid.\" I don't see 1035 or 1034 being deemed obsolete anywhere. \n\nRFC-3490 is also about unicode mapping. It's domain name application layer that converts unicode domains into ascii counter-parts to allow them to be used within the current DNS structure, defined in 4343, referencing 1034 and 1035 for domain name make-up.\n\nNow, I understand that the ZFW can't exactly just take a unicode domain name and convert it into its ascii counter-part, through VeriSign, it would appear. But that shouldn't stop ZFW from blocking non-valid already ascii based domain names.\n\nEverything I'm reading still says that \"place@ya*hoo.com\" is an invalid domain name. Am I still missing something here?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "created": "2009-07-20T13:22:34.000+0000",
                    "updated": "2009-07-20T13:22:34.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32753",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Search at Verisign for the supported charset tables within COM and NET domains.\nIn fact Verisign as main COM registrar allows the usage of IDN characters since 2001\/2.\n\nThis means that also domain-names like \"My\u00c9r\u00e2t\u00e0.com\" are supported which would be denied by RFC-1035.\nNote that IDN support extends RFC-1035.\n\nAs several TLDs do not accept IDN the \"old\" RFC is still active for them.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-07-20T13:53:38.000+0000",
                    "updated": "2009-07-20T13:53:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32760",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "body": "I see how \"My\u00c9r\u00e2t\u00e0.com\" would be denied within RFC-1035. That's where RFC-3490 comes in. RFC-3490 defines the mapping of \"My\u00c9r\u00e2t\u00e0.com\" to \"xn--myrt-3nak1c.com\" (that's exact mapping, btw) which is supported within RFC-1035. That's what I see RFC-3490 being used for. It technically doesn't define additional character sets for domain names. It defines how to convert the extended characters sets to the ASCII character set to be used within the current DNS systems, under RFC-1034\/5.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "created": "2009-07-20T14:47:11.000+0000",
                    "updated": "2009-07-20T14:47:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32763",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "There is one big difference...\n\nIn your browser you will probably add \"My\u00c9r\u00e2t\u00e0.com\" and not \"xn--myrt-3nak1c.com\".\nOr do you think that user will be able to convert from IDN to punycode manually ?\n\nYour browser does the IDN to punycode conversion internally in the background. But this does not mean that the validator has to work this way.\n\nFor simplicity, and usability it accepts all characters which are also accepted by IANA and their TLD registrars.\n\nChanging this as you propose, to deny all non-RFC 1034 chars means also to deny all IDN hostnames.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-07-20T15:25:11.000+0000",
                    "updated": "2009-07-20T15:25:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32765",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "body": "You are right. I'm not suggesting to deny unicode domains, but merely suggesting an additional check. \"place@ya&hoo.com\" is clearly an invalid domain per RFC 1034\/5, and not superceeded by 3490. \n\nWould a potiential solution be first checking to see if the domain part, or domain as a whole, is ASCII or unicode and then perform the validations specific to that? I seem to recall dscussions somewhere about determining whether a string is Unicode or ASCII at one point in time. I do not recall if that was possible or not.   ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "created": "2009-07-20T16:07:54.000+0000",
                    "updated": "2009-07-20T16:07:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32770",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "No this would be no solution.\n\nChars like \"\u00e4\", \"\u00fc\", \"\u00df\" are not accepted by RFC1034 but are still valid ASCII codes.\nAdditionally you can't expect that a user gives a IDN domain coded in Unicode.\n\nAlso this whole discussion is useless as the mentioned chars \"#\", \"@\" and so on are NOT accepted for hostnames within the next minor release.\n\nYou may have noted that this issue is marked as FIXED and not as WON'T FIX or NOT REPRODUCABLE.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-07-21T00:31:36.000+0000",
                    "updated": "2009-07-21T00:31:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32793",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "body": "Point taken. My apologies, I did forget about the extended-ascii character set. I'll look for the fix in the next release. Is there a place I can browse to see the actual patch fix? So that I may implemented it my side (as it's actually affecting some public sites of ours when users type in \"place@#yahoo.com\" by accident). I thought there would be a patch tagged with this issue, but I don't see it.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guice",
                        "name": "guice",
                        "displayName": "Philip",
                        "active": true
                    },
                    "created": "2009-07-21T08:00:38.000+0000",
                    "updated": "2009-07-21T08:00:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32800",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "As always all changes are available within SVN. See the wiki for details.\nPatches are only created by users when they don't have SVN access and want others to add their patch to ZF.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-07-21T11:59:18.000+0000",
                    "updated": "2009-07-21T11:59:18.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7323\/transitions"
}