{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9319",
    "key": "ZF-9319",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Locale does not carry rounding up to units"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9319\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10440",
                    "id": 10440,
                    "description": "Mini Release",
                    "name": "1.10.3",
                    "userReleaseDate": "01\/Apr\/10",
                    "archived": false,
                    "releaseDate": "2010-04-01",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-03-14T05:03:14.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=judgej",
                "name": "judgej",
                "displayName": "Jason Judge",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-03-03T16:20:21.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-03-14T05:03:14.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I found this while analysing a bug in Magento - currency values were not displaying correctly. Values were occasionally being display one unit (one Pound) lower than they should be. The following code fragment demonstrates the problem:\r\n\r\nrequire_once(\"Zend\/Loader.php\");\r\nrequire_once(\"Zend\/Locale\/Format.php\");\r\nforeach(array(3.99, 3.994, 3.995, 3.999, 4.00) as $value) {\r\n\t$rounded = round($value, 2);\r\n\t$formatted = Zend_Locale_Format::toNumber($value, array('precision' => 2));\r\n\techo \"Value=$value Rounded=$rounded Formatted=$formatted \";\r\n\tif ((float)$rounded == (float)$formatted) {\r\n\t\techo \"PASS<br \/>\";\r\n\t} else {\r\n\t\techo \"** FAIL **<br \/>\";\r\n\t}\r\n}\r\n\r\nThis displays the following output:\r\n\r\nValue=3.99 Rounded=3.99 Formatted=3.99 PASS\r\nValue=3.994 Rounded=3.99 Formatted=3.99 PASS\r\nValue=3.995 Rounded=4 Formatted=3.00 ** FAIL **\r\nValue=3.999 Rounded=4 Formatted=3.00 ** FAIL **\r\nValue=4 Rounded=4 Formatted=4.00 PASS\r\n\r\nNote that when 0.995 is rounded up, the unit is not carried forward beyond the decimal point. Looking at the code, the number part above and below the decimal point is formatted separately, with the integer part done first, and the decimal part done second (losing the unit if it overflows).\r\n\r\nMagento uses Zend 8.something (8.5?) but this error is still present in Zend 10.2 (which is where the above results came from)."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9319\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10410",
                    "id": 10410,
                    "description": "Security release",
                    "name": "1.8.5",
                    "userReleaseDate": "11\/Jan\/10",
                    "archived": false,
                    "releaseDate": "2010-01-11",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10430",
                    "id": 10430,
                    "description": "Mini Release",
                    "name": "1.10.2",
                    "userReleaseDate": "24\/Feb\/10",
                    "archived": false,
                    "releaseDate": "2010-02-24",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10073",
                    "id": 10073,
                    "name": "Zend_Locale",
                    "description": "Zend_Locale is a basic wrapper for all I18N and L10N issues for the Zend Framework. It provides the userbasically with access to translation functionality. It can handle different source file types for translation.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38975",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "This is no failure.\r\nFrom the API doc:\r\n\r\n\"     * The 'precision' option of a value is used to truncate or stretch extra digits. -1 means not to touch the extra digits.\"\r\n\r\nFor rounding you need to use Zend_Locale_Math::round()",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-03-04T11:23:40.000+0000",
                    "updated": "2010-03-04T11:23:40.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38976",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=judgej",
                        "name": "judgej",
                        "displayName": "Jason Judge",
                        "active": true
                    },
                    "body": "Could you explain that specification? I'm not sure how \"truncate or stretch extra digits\" can be interpreted to mean \"3.995 should be formatted as 3.00\", and even if it did, exactly what use such a transform is. At a stretch I would accept \"truncate to a precision of 2\" to mean 3.995 is formatted as 3.99. But 3.00 - surely not.\r\n\r\nThis method is actually called in a long chain from Magento to format monetary values, and goes via the Zend_Currency methods, so whether Zend_Format or Zend_Math is used to format that currency, is pretty much out of the hands of the application. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=judgej",
                        "name": "judgej",
                        "displayName": "Jason Judge",
                        "active": true
                    },
                    "created": "2010-03-04T11:56:07.000+0000",
                    "updated": "2010-03-04T11:56:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38978",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=judgej",
                        "name": "judgej",
                        "displayName": "Jason Judge",
                        "active": true
                    },
                    "body": "I would also be interested to know what tests are performed for this boundary condition. If any, is it accepted that 3.994 be formatted as \"3.99\" and 3.995 be formatted as \"3.00\"? If no tests are run, then can some be set up so people are very clear that this is the expected functionality?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=judgej",
                        "name": "judgej",
                        "displayName": "Jason Judge",
                        "active": true
                    },
                    "created": "2010-03-04T11:59:38.000+0000",
                    "updated": "2010-03-04T11:59:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39221",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Implemented using precision without format with r21493",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-03-14T05:03:14.000+0000",
                    "updated": "2010-03-14T05:03:14.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9319\/transitions"
}