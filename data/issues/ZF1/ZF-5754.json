{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5754",
    "key": "ZF-5754",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "ArrayOfTypeComplex does not allow recursive types"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5754\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10272",
                    "id": 10272,
                    "description": "Mini Release",
                    "name": "1.7.5",
                    "userReleaseDate": "16\/Feb\/09",
                    "archived": false,
                    "releaseDate": "2009-02-16",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-02-12T15:42:59.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                "name": "qzervaas",
                "displayName": "Quentin Zervaas",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-02-11T17:11:33.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-02-12T15:45:57.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Since the fix of job #5604, it's not possible to have recursive types.\n\nThe following code fails in ZF 1.7.4 (Fatal error: Maximum function nesting level of '100' reached, aborting!)\n\n{code}\n<?php\n    ini_set('include_path', dirname(__FILE__) . '\/1.7.4');\n\n    require_once('Zend\/Soap\/AutoDiscover.php');\n    require_once('Zend\/Soap\/Wsdl\/Strategy\/ArrayOfTypeComplex.php');\n\n    class WebservicesTestClass\n    {\n        \/**\n         * @var WebservicesTestClass[]\n         *\/\n        public $children = array();\n    }\n\n    class WebservicesTest\n    {\n        \/**\n         * @return WebservicesTestClass[]\n         *\/\n        public function test()\n        {\n            return array();\n        }\n    }\n\n    $auto = new Zend_Soap_AutoDiscover('Zend_Soap_Wsdl_Strategy_ArrayOfTypeComplex');\n    $auto->setClass('WebservicesTest');\n    $auto->handle();\n?>\n{code} \n\nNote however when working in <= 1.7.3pl1, the type is incorrectly returned in the WSDL as WebservicesTestClass[] rather than ArrayOfWebservicesTestClass"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5754\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                "name": "beberlei",
                "displayName": "Benjamin Eberlei",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-5604",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5604",
                    "type": {
                        "name": "Related",
                        "direction": "OUTBOUND",
                        "description": "is related to"
                    }
                },
                {
                    "issueKey": "ZF-5766",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5766",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11745",
                    "filename": "DefaultComplexType2.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                        "name": "qzervaas",
                        "displayName": "Quentin Zervaas",
                        "active": true
                    },
                    "created": "2009-02-11T17:31:37.000+0000",
                    "size": 2806,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11745\/DefaultComplexType2.php"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10280",
                    "id": 10280,
                    "description": "Mini Release",
                    "name": "1.7.4",
                    "userReleaseDate": "02\/Feb\/09",
                    "archived": false,
                    "releaseDate": "2009-02-02",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10098",
                    "id": 10098,
                    "name": "Zend_Soap_Wsdl",
                    "description": "Class for accessing SOAP WSDL documents.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28774",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                        "name": "qzervaas",
                        "displayName": "Quentin Zervaas",
                        "active": true
                    },
                    "body": "Further testing indicates that if not specifying the types as arrays, it also fails in older versions\n\nSample code:\n\n{code}\n<?php\n    ini_set('include_path', dirname(__FILE__) . '\/1.7.3');\n\n    require_once('Zend\/Soap\/AutoDiscover.php');\n    require_once('Zend\/Soap\/Wsdl\/Strategy\/ArrayOfTypeComplex.php');\n\n    class WebservicesTestClass\n    {\n        \/**\n         * @var WebservicesTestClass\n         *\/\n        public $child;\n    }\n\n    class WebservicesTest\n    {\n        \/**\n         * @return WebservicesTestClass\n         *\/\n        public function test()\n        {\n            return array();\n        }\n    }\n\n    $auto = new Zend_Soap_AutoDiscover('Zend_Soap_Wsdl_Strategy_ArrayOfTypeComplex');\n    $auto->setClass('WebservicesTest');\n    $auto->handle();\n?>\n{\/code}\n\nThe Zend_Soap_Wsdl_Strategy_DefaultComplexType->addComplexType() method needs to check what types are currently being added since it won't yet be available in $this->getContext()->getTypes()",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                        "name": "qzervaas",
                        "displayName": "Quentin Zervaas",
                        "active": true
                    },
                    "created": "2009-02-11T17:21:31.000+0000",
                    "updated": "2009-02-11T17:21:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28775",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                        "name": "qzervaas",
                        "displayName": "Quentin Zervaas",
                        "active": true
                    },
                    "body": "The following patch solves the issue:\n\n{code title=Zend\/Soap\/Wsdl\/Strategy\/DefaultComplexType.php}\n24a25,26\n>     protected static $_processing = array();\n> \n32a35,40\n>         if (in_array($type, self::$_processing)) {\n>             return;\n>         }\n> \n>         self::$_processing[$type] = $type;\n> \n65a74\n>         unset(self::$_processing[$type]);\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                        "name": "qzervaas",
                        "displayName": "Quentin Zervaas",
                        "active": true
                    },
                    "created": "2009-02-11T17:29:41.000+0000",
                    "updated": "2009-02-11T17:29:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28776",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                        "name": "qzervaas",
                        "displayName": "Quentin Zervaas",
                        "active": true
                    },
                    "body": "This file contains my changes to Zend\/Soap\/Wsdl\/Strategy\/DefaultComplexType.php",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                        "name": "qzervaas",
                        "displayName": "Quentin Zervaas",
                        "active": true
                    },
                    "created": "2009-02-11T17:31:42.000+0000",
                    "updated": "2009-02-11T17:31:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28792",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "body": "confirmed! i'll look into it for the next mini release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "created": "2009-02-12T11:10:49.000+0000",
                    "updated": "2009-02-12T11:10:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28795",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "body": "your patch prevents recursion from happening, but it doesnt fix the bug. Your nested value is empty because you return nothing from the function.\n\nActually in the current implementation recursion objects is not even possible i think. I am changing this to throw an exception.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "created": "2009-02-12T14:45:14.000+0000",
                    "updated": "2009-02-12T14:45:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28796",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "body": "Fix in trunk and merged back into 1.7 release branch.\n\nThrow an Exception on possible infinite recursion now.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "created": "2009-02-12T14:56:24.000+0000",
                    "updated": "2009-02-12T14:56:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28797",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                        "name": "qzervaas",
                        "displayName": "Quentin Zervaas",
                        "active": true
                    },
                    "body": "This doesn't really solve my issue... why should it not be possible to recurse into itself?\n\nCan you not just change my implementation slightly to return \"tns:$type\" rather than just return?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                        "name": "qzervaas",
                        "displayName": "Quentin Zervaas",
                        "active": true
                    },
                    "created": "2009-02-12T15:00:21.000+0000",
                    "updated": "2009-02-12T15:00:21.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28802",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "body": "well if you require recursion, then you might need to stop somewhere. but wsdl types are rather strict, so how would you do that? The current ArrayOfTypeComplex does not support minOccurs which is the only way to handle this situation according to http:\/\/stackoverflow.com\/questions\/148988\/recursion-in-xsd-schemas (i couldnt find it in the XSD doc, its dull to read).\n\nI will have to look into it for the future, but i can't support this right now because if have to test it further.\n\nSo long the infinite recursion protection will be added.\n\nWould that be ok?\n\nThe problem with returning tns:$type is, it might be the wrong name.\n\nBack to your recursive example, how does it \"stop\" when you return \"tns:$type\" anyways? Doesnt SOAP then require an infinite stream of objects in your definition?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "created": "2009-02-12T15:28:53.000+0000",
                    "updated": "2009-02-12T15:28:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28807",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "body": "closed the issue by fault, now resolved.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "created": "2009-02-12T15:42:59.000+0000",
                    "updated": "2009-02-12T15:42:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28808",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                        "name": "qzervaas",
                        "displayName": "Quentin Zervaas",
                        "active": true
                    },
                    "body": "Fair enough. I thought you could effectively \"end the recursion\" by returning a null object.\n\nIs it worth creating a new feature request in this tracker to support such functionality?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=qzervaas",
                        "name": "qzervaas",
                        "displayName": "Quentin Zervaas",
                        "active": true
                    },
                    "created": "2009-02-12T15:45:56.000+0000",
                    "updated": "2009-02-12T15:45:56.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5754\/transitions"
}