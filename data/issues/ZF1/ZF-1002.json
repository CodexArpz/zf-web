{
    "expand": "html",
    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1002",
    "key": "ZF-1002",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Document deleting\/updating problem"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1002\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10022",
                    "id": 10022,
                    "description": "Beta Release; all components feature complete for 1.0",
                    "name": "0.9.0",
                    "userReleaseDate": "17\/Mar\/07",
                    "archived": true,
                    "releaseDate": "2007-03-17",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2007-03-06T17:51:43.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                "name": "alexander",
                "displayName": "Alexander Veremyev",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2007-03-02T01:01:13.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2007-07-05T14:43:53.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Problem was originally reported by Uros in FW-General - http:\/\/www.nabble.com\/Zend_Search_Lucene---updating-documents-tf3325986s16154.html#a9246813\n-------------------------------------------\ni'm trying to find what may be a problem when updating documents. For now I\ndon't have a clue. Here is my scenario.\n\n1. open index\n1.1 also add setMaxBufferedDocs(1) and setMaxMergeDocs(1)\n2. find by document_id (this is indexed)\n3. if found delete this document\n4. create document from data\n5. add document to index\n6. commit\n7. unset index\n\nIf I open index with luke I see that document stored. Then I update some\nother, maybe same document. \nAnd here is the problem. When searching for document_id document is not\nfound (it's also not found when\nsearching on front page) so document is added with previous one. \n\nIf I call optimize it helps, but I have two same documents in index. If I\nupdate it again both of them gets deleted and then add one document.\n\nIs there something I'm doing wrong?\n-------------------------------------------\n\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1002\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                "name": "alexander",
                "displayName": "Alexander Veremyev",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-955",
                    "issue": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-955",
                    "type": {
                        "name": "Duplicate",
                        "direction": "OUTBOUND",
                        "description": "duplicates"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10021",
                    "id": 10021,
                    "description": "Preview release; DB, Filter, Log",
                    "name": "0.8.0",
                    "userReleaseDate": "21\/Feb\/07",
                    "archived": true,
                    "releaseDate": "2007-02-21",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/component\/10021",
                    "id": 10021,
                    "name": "Zend_Search_Lucene",
                    "description": "pure PHP robust, general purpose text search engine",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/13160",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=peter_vg",
                        "name": "peter_vg",
                        "displayName": "Peter Van Garderen",
                        "active": true
                    },
                    "body": "I am not sure if this is related specifically to this ticket but I am experiencing a similar problem. \n\nAfter converting from Zend_Lucene_Search 0.2 to 0.8 I can't delete\/update a specific document because it is no longer possible to get a search hit on fields that store numeric characters. Of course, I use my application's unique identifiers, assigned to a Keyword field in my index documents, to pick specific documents out of the Zend index. I have tried converting the identifier field from an integer to a string value before adding it as an index document field, changing the document field type from Keyword to Text, changing the name of the field, and changing the document field encoding to ISO iso-8859-1 from utf-8. All to no avail. \n\nThe numeric value in the identifier field is, in fact, stored in the index. I can search on it and get a hit using Luke. Also, when I retrieve a document from the index using a Zend Search hit on another field (e.g. Title, Description), I can retrieve and display the corresponding identifier field value. I just can't get a hit on it using Zend Search queries (e.g. $hit = $index->find('my_identifier_field:'.$numeric_query_value). \n\nI see in the documentation that using the Zend Search Query API is recommended for application-generated Keyword fields such as my_identifier_field. However, I can't determine from the documentation how to match a Query Term to a specific index document field, which is necessary to ensure a match to a unique value in order to retrieve a specific document from the index.\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=peter_vg",
                        "name": "peter_vg",
                        "displayName": "Peter Van Garderen",
                        "active": true
                    },
                    "created": "2007-03-06T13:53:51.000+0000",
                    "updated": "2007-03-06T13:53:51.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/13164",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "body": "It looks like it's the same problem.\n\n0.8 doesn't search for specified term if it has not entry in terms dictionary of the first index segment.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "created": "2007-03-06T15:49:43.000+0000",
                    "updated": "2007-03-06T15:49:43.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/13165",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "body": "So it affects for unique fields first of all.\n\nThis already fixed.\n\nPlease take current SVN version or latest [Nightly Snapshot|http:\/\/framework.zend.com\/download\/snapshot].\n\nPS Please let me know if it helps or doesn't help.\n",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "created": "2007-03-06T15:52:24.000+0000",
                    "updated": "2007-03-06T15:52:24.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/13167",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=peter_vg",
                        "name": "peter_vg",
                        "displayName": "Peter Van Garderen",
                        "active": true
                    },
                    "body": "Hi Alexander,\n\nYes, I noticed that there was more discussion on this in the forum and that you had posted a fix. I downloaded and installed the latest snapshot (20070306-3762). I rebuilt the index from scratch. Unfortunately, I am still experiencing the exact same problem. \n\nWhat do you mean by \"0.8 doesn't search for specified term if it has not entry in terms dictionary of the first index segment\"? Is this something I can fix by the way that I am indexing or querying the documents or is this something that you need address in a code revision?\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=peter_vg",
                        "name": "peter_vg",
                        "displayName": "Peter Van Garderen",
                        "active": true
                    },
                    "created": "2007-03-06T16:06:09.000+0000",
                    "updated": "2007-03-06T16:06:09.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/13172",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "body": "1. Zend Search Query API comment:\nTerms contain field information. So, to prepare term query you should do the following:\n--------------------------\n$query = new Zend_Search_Lucene_Search_Query_Term(\n                             new Zend_Search_Lucene_Index_Term($numeric_query_value, 'my_identifier_field'));\n--------------------------\n\n2. Have you set the same analyzer before search request?\nQuery parser uses default analyzer to transform parsed lexemes into terms. Default analyzer skips numbers, so your numeric ids may be reduced to empty string.\n\n3. If second step doesn't help. Could you attach to the issue or send me (alexander.v@zend.com) your index and give an example of your query?\n",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "created": "2007-03-06T16:19:59.000+0000",
                    "updated": "2007-03-06T16:19:59.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/13174",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=peter_vg",
                        "name": "peter_vg",
                        "displayName": "Peter Van Garderen",
                        "active": true
                    },
                    "body": "BINGO! When I use the Term Query as you've shown in step 1 I am getting hits on my numeric field. \n\nI was using the default query parser previously which, as you point out, uses the default analyzer which skips numbers. \n\nThanks so much for your quick response Alexander!",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=peter_vg",
                        "name": "peter_vg",
                        "displayName": "Peter Van Garderen",
                        "active": true
                    },
                    "created": "2007-03-06T16:42:10.000+0000",
                    "updated": "2007-03-06T16:42:10.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/13177",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=peter_vg",
                        "name": "peter_vg",
                        "displayName": "Peter Van Garderen",
                        "active": true
                    },
                    "body": "I did realize from reading the documentation that a Term Query was the recommended approach but, as I noted earlier, I was confused by the documentation which did not indicate that you could match the Term Query to a specific document field. Perhaps the example in the documentation in section '22.5.2. Term Query' should be revised to read:\n\n    $term  = new Zend_Search_Lucene_Index_Term('my_query_term', 'index_document_field_name');\n    $query = new Zend_Search_Lucene_Search_Query_Term($term);\n    $hits  = $index->find($query);",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=peter_vg",
                        "name": "peter_vg",
                        "displayName": "Peter Van Garderen",
                        "active": true
                    },
                    "created": "2007-03-06T16:51:35.000+0000",
                    "updated": "2007-03-06T16:51:35.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/13180",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "body": "Super! :)\n\nI do agree, that it should be described more clear in a documentation.\nI've just made necessary changes.\n\nThank you for the report!\n\nPS If you want query parser to include numbers into search, you should switch default analyzer. Use:\n--------------------------------------\nZend_Search_Lucene_Analysis_Analyzer::setDefault(\n    new Zend_Search_Lucene_Analysis_Analyzer_Common_TextNum_CaseInsensitive());\n--------------------------------------\nor\n--------------------------------------\nZend_Search_Lucene_Analysis_Analyzer::setDefault(\n    new Zend_Search_Lucene_Analysis_Analyzer_Common_TextNum());\n--------------------------------------\nor\n--------------------------------------\nZend_Search_Lucene_Analysis_Analyzer::setDefault(\n    new Zend_Search_Lucene_Analysis_Analyzer_Common_Utf8Num());\n--------------------------------------\n",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "created": "2007-03-06T17:49:45.000+0000",
                    "updated": "2007-03-06T17:49:45.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/13181",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "body": "Is duplicate of [ZF-955|http:\/\/framework.zend.com\/issues\/browse\/ZF-955].\nFixed.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "created": "2007-03-06T17:51:43.000+0000",
                    "updated": "2007-03-06T17:51:43.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/13182",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=peter_vg",
                        "name": "peter_vg",
                        "displayName": "Peter Van Garderen",
                        "active": true
                    },
                    "body": "Sorry for starting what turned out to be a discussion thread in your issue tracker. I probably should have used the forum to post my original problem. Anyway, I do appreciate the help.\n\nRE: switching default analyzer. I have switched to using the Utf8Num() analyzer as per your suggestion. Query Parser does now include numbers. That's cool because now it picks up dates that I had in general text fields. I can also continue to use my application's default searchbox to retrieve documents by id by using the identifier field in the basic query term which is handy.\n\nI decided to use Utf8Num() as my default analyzer because I want to index numbers and because I will be internationalizing my application and expect to have to index a variety of scripts. However, Utf8Num() appears to be an extension of the Common() analyzer and not the Utf8() analyzer. How is Utf8Num() different from TextNum() and from Utf8()?",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=peter_vg",
                        "name": "peter_vg",
                        "displayName": "Peter Van Garderen",
                        "active": true
                    },
                    "created": "2007-03-06T18:43:59.000+0000",
                    "updated": "2007-03-06T18:43:59.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/13183",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "body": "Not a problem :) Please also feel free to mail me directly or post it to ZF mailing lists.\n\n\"Num\" versions of analyzers are not derived from non-num versions. They are alternative implementations.\n\nUtf8Num treats digits as parts of terms.\nUtf8 analyzers have some limitations. First of all they treats all non-ascii characters as letters (part of terms) and use ctype_... functions for ascii subset.\nOther thing is that Utf8 analyzers don't have case insensitive versions.\nPlease take a look at documentation - [UTF-8 compatible text analyzer|http:\/\/framework.zend.com\/manual\/en\/zend.search.charset.html#zend.search.charset.utf_analyzer]. You can find there more detailed description and workaround if you want to make search  case insensitive ",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "created": "2007-03-07T01:55:38.000+0000",
                    "updated": "2007-03-07T01:55:38.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1002\/transitions"
}