{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6273",
    "key": "ZF-6273",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Controller_Plugin_ErrorHandler record 2 times in Zend_Controller_Plugin_Broker"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6273\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-07-14T08:18:22.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=woow",
                "name": "woow",
                "displayName": "Dri Tremblay",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-04-11T10:47:49.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-07-14T08:18:22.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "Zend_Controller_Plugin_Broker"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "1.\nThe plugin Zend_Controller_Plugin_ErrorHandler record 2 times\n\n\nindex.php\n...\n$frontController = Zend_Controller_Front::getInstance();\n$frontController->registerPlugin(new Initialisation() );\n$frontController->dispatch(); \n\n\nInitialisation.php\n...\n\t\t$plugin = new Zend_Controller_Plugin_ErrorHandler();\n\t\t$plugin->setErrorHandlerModule('commun')\n\t\t       ->setErrorHandlerController('error')\n\t\t       ->setErrorHandlerAction('error');\n\t\t$this->_front->registerPlugin($plugin);\n...\n\nThe method registerPlugin of Zend_Controller_Plugin_Broker is called 4 times.\n1 - registerPlugin(Initialization, null)\n2 - registerPlugin(Zend_Controller_Plugin_ErrorHandler, 100)\n3 - registerPlugin(Zend_Layout_Controller_Plugin_Layout, 99)\n4 - registerPlugin(Zend_Controller_Plugin_ErrorHandler, null)\n\nIn the Zend_Controller_Plugin_Broker array_search (line 54) return false if want to register\nthe second time Zend_Controller_Plugin_ErrorHandler.\n\nWhen there is a problem (Example: no controller), my controller error (common module)\nis not known but rather uses ZF module by default.\n\nDump after the fourth call (Zend_Debug:: dump ($ this-> getPlugins ())):\n\narray(4) {\n  [0] => object(Initialisation)#4 (13) {\n    [\"_config:private\"] => object(Zend_Config_Ini)#5 (9) {\n      [\"_nestSeparator:protected\"] => string(1) \".\"\n      [\"_skipExtends:protected\"] => bool(false)\n      [\"_allowModifications:protected\"] => bool(false)\n      [\"_index:protected\"] => int(0)\n      [\"_count:protected\"] => int(7)\n    .....\n  [99] => object(Zend_Layout_Controller_Plugin_Layout)#27 (4) {\n    [\"_layoutActionHelper:protected\"] => object(Zend_Layout_Controller_Action_Helper_Layout)#28 (4) {\n      [\"_frontController:protected\"] => object(Zend_Controller_Front)#1 (11) {\n        [\"_baseUrl:protected\"] => NULL\n        [\"_controllerDir:protected\"] => NULL\n        [\"_dispatcher:protected\"] => object(Zend_Controller_Dispatcher_Standard)#16 (11) {\n    .....\n  [100] => object(Zend_Controller_Plugin_ErrorHandler)#10 (7) {\n    [\"_errorModule:protected\"] => NULL\n    [\"_errorController:protected\"] => string(5) \"error\"\n    [\"_errorAction:protected\"] => string(5) \"error\"\n    [\"_isInsideErrorHandlerLoop:protected\"] => bool(false)\n    [\"_exceptionCountAtFirstEncounter:protected\"] => int(0)\n    [\"_request:protected\"] => object(Zend_Controller_Request_Http)#13 (14) {\n      [\"_paramSources:protected\"] => array(2) {\n        [0] => string(4) \"_GET\"\n        [1] => string(5) \"_POST\"\n      }\n      [\"_requestUri:protected\"] => string(56) \"....\"\n      [\"_baseUrl:protected\"] => NULL\n      [\"_basePath:protected\"] => NULL\n      [\"_pathInfo:protected\"] => string(0) \"\"\n      [\"_params:protected\"] => array(0) {\n      }\n      [\"_aliases:protected\"] => array(0) {\n      }\n      [\"_dispatched:protected\"] => bool(false)\n      [\"_module:protected\"] => NULL\n      [\"_moduleKey:protected\"] => string(6) \"module\"\n      [\"_controller:protected\"] => NULL\n      [\"_controllerKey:protected\"] => string(10) \"controller\"\n      [\"_action:protected\"] => NULL\n      [\"_actionKey:protected\"] => string(6) \"action\"\n    }\n    [\"_response:protected\"] => object(Zend_Controller_Response_Http)#14 (8) {\n      [\"_body:protected\"] => array(0) {\n      }\n      [\"_exceptions:protected\"] => array(0) {\n      }\n      [\"_headers:protected\"] => array(0) {\n      }\n      [\"_headersRaw:protected\"] => array(0) {\n      }\n      [\"_httpResponseCode:protected\"] => int(200)\n      [\"_isRedirect:protected\"] => bool(false)\n      [\"_renderExceptions:protected\"] => bool(false)\n      [\"headersSentThrowsException\"] => bool(true)\n    }\n  }\n  [3] => object(Zend_Controller_Plugin_ErrorHandler)#32 (7) {\n    [\"_errorModule:protected\"] => string(6) \"commun\"\n    [\"_errorController:protected\"] => string(5) \"error\"\n    [\"_errorAction:protected\"] => string(5) \"error\"\n    [\"_isInsideErrorHandlerLoop:protected\"] => bool(false)\n    [\"_exceptionCountAtFirstEncounter:protected\"] => int(0)\n    [\"_request:protected\"] => NULL\n    [\"_response:protected\"] => NULL\n  }\n}\n\n\n------------------------------------------------------------------------------------------------------------\n2.\nIt works when I put the plugin Zend_Controller_Plugin_ErrorHandler in\nmy index.php and that I removed in initialisation.php\n\nThe method registerPlugin of Zend_Controller_Plugin_Broker is called 3 times.\n1 - registerPlugin (Zend_Controller_Plugin_ErrorHandler, null)\n2 - registerPlugin (Initialization, null)\n3 - registerPlugin (Zend_Layout_Controller_Plugin_Layout, 99)\n\nindex.php\n...\n$frontController = Zend_Controller_Front::getInstance();\n\n$plugin = new Zend_Controller_Plugin_ErrorHandler();\n$plugin->setErrorHandlerModule('commun')\n\t       ->setErrorHandlerController('error')\n\t       ->setErrorHandlerAction('error');\n$frontController->registerPlugin($plugin);\n\n$frontController->registerPlugin(new Initialisation() );\n$frontController->dispatch(); \n\n\nI want to be able to register the plugin Zend_Controller_Plugin_ErrorHandler\nin my plugin initialization and not be forced to put it in index.php\n\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6273\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                "name": "bate",
                "displayName": "Marco Kaiser",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10300",
                    "id": 10300,
                    "description": "Mini Release",
                    "name": "1.7.8",
                    "userReleaseDate": "30\/Mar\/09",
                    "archived": false,
                    "releaseDate": "2009-03-30",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10011",
                    "id": 10011,
                    "name": "Zend_Controller",
                    "description": "front controller, including router and dispatcher",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30088",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "My French is rusty; would it be possible to get an English translation so I can be sure I understand the issue report correctly?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2009-04-11T13:18:01.000+0000",
                    "updated": "2009-04-11T13:18:01.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30100",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=woow",
                        "name": "woow",
                        "displayName": "Dri Tremblay",
                        "active": true
                    },
                    "body": "My English is not very good. I tried to translate into English this issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=woow",
                        "name": "woow",
                        "displayName": "Dri Tremblay",
                        "active": true
                    },
                    "created": "2009-04-13T06:08:40.000+0000",
                    "updated": "2009-04-13T06:08:40.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47510",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "body": "this should be possible with application.ini and all features available in 1.11",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "created": "2011-07-14T08:18:22.000+0000",
                    "updated": "2011-07-14T08:18:22.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6273\/transitions"
}