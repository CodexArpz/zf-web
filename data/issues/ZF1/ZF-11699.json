{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11699",
    "key": "ZF-11699",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Loader::isReadable creates incorrect paths and then throws warnings"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11699\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-11-03T00:53:32.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=akzincdig",
                "name": "akzincdig",
                "displayName": "Ashley Kitson",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-08-25T16:11:52.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-11-03T00:53:32.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "In vhost file for site I have\r\nphp_admin_value open_basedir \"\/opt\/fed\/lib:\/opt\/fed\/options:\/usr\/share\/pear:\/usr\/share\/php\"\r\n\r\nI add include paths for \r\n\/opt\/fed\/lib     ( Zend and Company Core libs )\r\n\/opt\/fed\/options\/library  ( application specific library )\r\n\r\ninclude path already has  \/usr\/share\/pear and \/usr\/share\/php\r\n\r\nIf I run site with PHP error reporting set to include warnings I get a load of them on the page.\r\n\r\nhere is one:\r\nWarning: is_readable(): open_basedir restriction in effect.\r\nFile(\/usr\/share\/pear\/\/opt\/fed\/lib\/FED\/Application\/Resource\/Frontcontroller.php)\r\nis not within the allowed path(s):\r\n(\/opt\/fed\/lib:\/opt\/fed\/options:\/usr\/share\/pear:\/usr\/share\/php) in\r\n\/opt\/fed\/lib\/Zend\/Loader.php on line 198 Warning: is_readable():\r\nopen_basedir restriction in effect.\r\n\r\nThe culprit is at about  L198 of Zend_Loader and I see a couple of things happening\r\na\/ the $file = $path . '\/' . $filename; on L197 is creating rubbish paths.  In the above example\r\n\/usr\/share\/pear\/  is part of include paths\r\n\/opt\/fed\/lib is part of include paths and in the open_basedir directive\r\nL197 (irrespective of the fact that it is creating a none existant path, is not taking care to strip any trailing slashes from $path.\r\n\r\nI saw the comments in another ticket about not being able to use PHP5.3 functionality for the V1.X branch and understand that but wouldn't it be better to put \r\nif (file_exists($path)) ....\r\nat L198 to prevent teh is_readable() warnings.?\r\n\r\n\r\n\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11699\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10880",
                    "id": 10880,
                    "description": "Mini Release",
                    "name": "1.11.9",
                    "userReleaseDate": "14\/Jul\/11",
                    "archived": false,
                    "releaseDate": "2011-07-14",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10001",
                    "id": 10001,
                    "name": "Zend_Loader",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48063",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "file_exists() doesn't tell us if we can actually read it. is_readable() tells us both -- that it exists, and that we can read it. If we did first a file_exists(), we'd be doing two I\/O stat calls, which would introduce a performance bottleneck.\r\n\r\nAs for open_basedir warnings, that's next to impossible for us to account for at a framework level, and in fact its utility has been hotly debated even amongst PHP internals developers; the only real solutions have to be application-specific.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2011-08-25T18:29:03.000+0000",
                    "updated": "2011-08-25T18:29:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48364",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=akzincdig",
                        "name": "akzincdig",
                        "displayName": "Ashley Kitson",
                        "active": true
                    },
                    "body": "I understand the point about file_exists vs is_readable and I\/O.  However, there are two issues here:\r\n\r\n1\/ as per my example, L197 is testing for rubbish paths being generated in the class, and will therefore fail for open_basedir - so if that was fixed the problem would be resolved\r\n\r\n2\/ not using open_basedir is not an option for some installations. In this particular case, a major European telecom, is insisting we use it.\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=akzincdig",
                        "name": "akzincdig",
                        "displayName": "Ashley Kitson",
                        "active": true
                    },
                    "created": "2011-09-07T11:53:31.000+0000",
                    "updated": "2011-09-07T11:53:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48367",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "I completely understand your issues. However, making the changes you suggest _will_ break existing behavior (I know, because we've done it in the past) and _will_ introduce a performance degradation (again, I know, because we've done it in the past). Changing it in the framework is simply not an option.\r\n\r\nThis is one case where I'd suggest monkey-patching the Zend_Loader class in your install to suit your specific needs. You can easily do so by copying it elsewhere, modifying the method, and ensuring that the path to your patched class is early in your include_path.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2011-09-07T13:13:33.000+0000",
                    "updated": "2011-09-07T13:13:33.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11699\/transitions"
}