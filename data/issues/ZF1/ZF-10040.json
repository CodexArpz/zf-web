{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10040",
    "key": "ZF-10040",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Controller_Request_Http setBaseUrl loosely detect baseUrl in request Uri"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10040\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-11-18T08:39:45.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=patbator",
                "name": "patbator",
                "displayName": "Patrick Barroca",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-06-23T05:49:24.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-11-18T10:00:27.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Context :\r\nIn a ZF application following this structure :\r\n{noformat}DOCUMENT_ROOT\/\r\n |- application\/\r\n |- public\/\r\n   |- index.php\r\n |- library\/\r\n |- .htaccess{noformat} \r\n\r\n.htaccess rewrites all non-matching real files to public\/index.php\r\n\r\nhttp:\/\/localhost\/publicite generate the following request Zend_Controller_Request_Http :\r\n\r\n{noformat}object(Zend_Controller_Request_Http)#8 (14) {\r\n  [\"_paramSources:protected\"]=>\r\n  array(2) {\r\n    [0]=>\r\n    string(4) \"_GET\"\r\n    [1]=>\r\n    string(5) \"_POST\"\r\n  }\r\n  [\"_requestUri:protected\"]=>\r\n  string(10) \"\/publicite\"\r\n  [\"_baseUrl:protected\"]=>\r\n  string(7) \"\/public\"\r\n  [\"_basePath:protected\"]=>\r\n  NULL\r\n  [\"_pathInfo:protected\"]=>\r\n  string(3) \"ite\"\r\n  [\"_params:protected\"]=>\r\n  array(0) {\r\n  }\r\n  [\"_aliases:protected\"]=>\r\n  array(0) {\r\n  }\r\n  [\"_dispatched:protected\"]=>\r\n  bool(false)\r\n  [\"_module:protected\"]=>\r\n  NULL\r\n  [\"_moduleKey:protected\"]=>\r\n  string(6) \"module\"\r\n  [\"_controller:protected\"]=>\r\n  NULL\r\n  [\"_controllerKey:protected\"]=>\r\n  string(10) \"controller\"\r\n  [\"_action:protected\"]=>\r\n  NULL\r\n  [\"_actionKey:protected\"]=>\r\n  string(6) \"action\"\r\n}{noformat} \r\n\r\nExpected :\r\n{noformat}object(Zend_Controller_Request_Http)#8 (14) {\r\n  [\"_paramSources:protected\"]=>\r\n  array(2) {\r\n    [0]=>\r\n    string(4) \"_GET\"\r\n    [1]=>\r\n    string(5) \"_POST\"\r\n  }\r\n  [\"_requestUri:protected\"]=>\r\n  string(10) \"\/publicite\"\r\n  [\"_baseUrl:protected\"]=>\r\n  string(7) \"\"\r\n  [\"_basePath:protected\"]=>\r\n  NULL\r\n  [\"_pathInfo:protected\"]=>\r\n  string(3) \"\/publicite\"\r\n  [\"_params:protected\"]=>\r\n  array(0) {\r\n  }\r\n  [\"_aliases:protected\"]=>\r\n  array(0) {\r\n  }\r\n  [\"_dispatched:protected\"]=>\r\n  bool(false)\r\n  [\"_module:protected\"]=>\r\n  NULL\r\n  [\"_moduleKey:protected\"]=>\r\n  string(6) \"module\"\r\n  [\"_controller:protected\"]=>\r\n  NULL\r\n  [\"_controllerKey:protected\"]=>\r\n  string(10) \"controller\"\r\n  [\"_action:protected\"]=>\r\n  NULL\r\n  [\"_actionKey:protected\"]=>\r\n  string(6) \"action\"\r\n}{noformat}\r\n\r\nIn setBaseUrl the code\r\n{code}\r\nif (0 === strpos($requestUri, dirname($baseUrl))) {\r\n    \/\/ directory portion of $baseUrl matches\r\n    $this->_baseUrl = rtrim(dirname($baseUrl), '\/');\r\n    return $this;\r\n}\r\n{code}\r\nprevents any request Uri starting with dirname($baseUrl) to work."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/1",
                "name": "Blocker"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10040\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dragonbe",
                "name": "dragonbe",
                "displayName": "Michelangelo van Dam",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10470",
                    "id": 10470,
                    "description": "Mini Release",
                    "name": "1.10.6",
                    "userReleaseDate": "22\/Jun\/10",
                    "archived": false,
                    "releaseDate": "2010-06-22",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10011",
                    "id": 10011,
                    "name": "Zend_Controller",
                    "description": "front controller, including router and dispatcher",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43076",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dragonbe",
                        "name": "dragonbe",
                        "displayName": "Michelangelo van Dam",
                        "active": true
                    },
                    "body": "Ran a couple of tests with this issue (see r23359). Only saw something going weird when $request->setBasePath() wasn't set, so set it with setBasePath()",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dragonbe",
                        "name": "dragonbe",
                        "displayName": "Michelangelo van Dam",
                        "active": true
                    },
                    "created": "2010-11-18T08:39:45.000+0000",
                    "updated": "2010-11-18T08:39:45.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43082",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=patbator",
                        "name": "patbator",
                        "displayName": "Patrick Barroca",
                        "active": true
                    },
                    "body": "Well, I've checked what you have tried to test in r23359 and this make me believe that I may have been not sufficiently accurate in my description of the context.\r\n\r\nIn my example with the url http:\/\/localhost\/publicite I try to match this route \"\/:%siteCode%\/:%pageCode%\/*\".\r\nWe use a page code and a site code to decide in a customized router which page of which website from our CMS to display.\r\n\r\nHere \u00abpublicite\u00bb is such a page code.\r\nSo rewrite rule load public\/index.php as there is no physical file nor directory called \u00abpublicite\u00bb in our DOCUMENT_ROOT.\r\npublic\/index.php simply includes ..\/application\/bootstrap.php that instantiate the front controller and the dispatching takes place.\r\nThen our customized router is instantiated and its match() method is called with the request.\r\nIn my example the request our router receive has a truncated pathInfo \u00abite\u00bb that is \u00abpublicite\u00bb in which the common part with the physical dirname of index.php (public) is wiped out.\r\n\r\nWe have never wanted \u00abpublicite\u00bb to become a prefix, it's a request parameter.\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=patbator",
                        "name": "patbator",
                        "displayName": "Patrick Barroca",
                        "active": true
                    },
                    "created": "2010-11-18T10:00:21.000+0000",
                    "updated": "2010-11-18T10:00:21.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10040\/transitions"
}