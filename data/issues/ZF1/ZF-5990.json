{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5990",
    "key": "ZF-5990",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "getFileName returns wrong file name (for form with 2 elements: file and file_two)"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5990\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10241",
                    "id": 10241,
                    "description": "Minor Release",
                    "name": "1.8.0",
                    "userReleaseDate": "30\/Apr\/09",
                    "archived": false,
                    "releaseDate": "2009-04-30",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-03-12T15:42:25.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbwdevries",
                "name": "jbwdevries",
                "displayName": "Johan B.W. de Vries",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-03-11T04:25:34.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-03-12T15:42:25.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "Zend_File_Transfer_Adapter_Abstract",
                "getFileName"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I added two times a  Zend_Form_Element_File, one with the name 'file', the other with the name 'file_two'. When asking the Zend_Transfer_Adapter for getFileName('file'), I get an array with both elements (fair enough; though I still find this weird). However, when asking for getFileName(), it returns the following:\n\n{code}var_export($adapter->getFileName());\narray (\n  'file_two' => 'D:\\\\tmp\\\\php\\\\uploads\\\\size-256.txt',\n  'file' => 'Array\\\\size-1024.txt',\n)\n{code}\n\n(\"D:\\tmp\\php\\uploads\\\" being my upload_tmp_dir).\n\nProblem is, of course, the second element, which has 'Array' instead of the directory. This is because when asking for getDestination($file) (which getFileName does), it returns an array with both elements:\n\n{code}var_export($adapter->getDestination['file']);\narray (\n  'file_two' => 'D:\\\\tmp\\\\php\\\\uploads',\n  'file' => 'D:\\\\tmp\\\\php\\\\uploads',\n)\n{code}\nI've tested with 1.7.6 as well as the SVN version from http:\/\/framework.zend.com\/svn\/framework\/standard\/trunk\/library\/Zend\/ (revision 142740).\n\nYou can, of course, make the name yourself with getFileInfo(), concatenating the destination, a DIRECTORY_SEPARATOR and the name. However, from what I see, that file doesn't exist either.\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5990\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10290",
                    "id": 10290,
                    "description": "Mini Release",
                    "name": "1.7.6",
                    "userReleaseDate": "02\/Mar\/09",
                    "archived": false,
                    "releaseDate": "2009-03-02",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10320",
                    "id": 10320,
                    "name": "Zend_File_Transfer",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29395",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "The reason is that \"_\" is used as seperator for SubForms...\nTherefor it looks internally which other file elements are also within the \"file\" SubForm\n\"file_1\", \"file_2\" and so on... and returns them all.\n\nSimply use another seperator because \"_\" is also used overall the complete framework as directory seperator, and within several other places.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-11T08:15:16.000+0000",
                    "updated": "2009-03-11T08:15:16.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29397",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbwdevries",
                        "name": "jbwdevries",
                        "displayName": "Johan B.W. de Vries",
                        "active": true
                    },
                    "body": "Isn't the underscore like _the_ most used separator for form element names? Mostly because those names match columns in a database somewhere? Maybe it's an option to make the separator configurable?\n\nAnd regardless of what's behind it, shouldn't getFileName() return proper results, even if it means returning files from subforms? From what I gather, the Zend_File_Transfer_Adapter_Abstract deals with all uploaded files anyhow.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbwdevries",
                        "name": "jbwdevries",
                        "displayName": "Johan B.W. de Vries",
                        "active": true
                    },
                    "created": "2009-03-11T08:32:02.000+0000",
                    "updated": "2009-03-11T08:32:02.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29398",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "body": "I agree with Johan, this should be resolved, one way or another.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "created": "2009-03-11T08:49:23.000+0000",
                    "updated": "2009-03-11T08:49:23.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29400",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Please dont discuss here useless things. :-)\nIf I would not have seen this as issue I would already have closed it.\nI just wanted to give a quick solution as we can only fix this for the next release which is earliest in 6 weeks.\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-11T08:56:33.000+0000",
                    "updated": "2009-03-11T08:56:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29410",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I just tried to verify your results but I am not able to get them.\n\nAccording to your first comment where you were irritated there is one thing you are missing:\nOf course the adapter returns ALWAYS all files when you don't give a name to it.\nBut when you use it according to the manual there is no failure and it works like a charm:\n{code}\n$form->file->getFileName();\n{code}\n\nAccording to your  second note about what you coded I tried to reproduce it but I had no luck:\nMy testcode\n\n{code}\nrequire_once('Zend\/Loader.php');\nZend_Loader::registerAutoload();\n\nprint \"<pre>\";\n$request = new Zend_Controller_Request_Http();\n\n\/\/ setup the form\n$form = new Zend_Form();\n$form->setMethod(Zend_Form::METHOD_POST)\n     ->setAttrib('enctype', Zend_Form::ENCTYPE_MULTIPART);\n\n$form = new Zend_Form();\n$element  = new Zend_Form_Element_File('file');\n$element2 = new Zend_Form_Element_File('file_two');\n\n$form->addElement($element);\n$form->addElement($element2);\n$form->setAttrib('enctype', 'multipart\/form-data');\n$form->addElement('submit', 'Submit');\n\n\/\/ check the form\nif($request->isPost()) {\n    $formData = $request->getPost();\n    if($form->isValid($formData)) {\n        $adapter = $form->file->getTransferAdapter();\n        $file = $adapter->getFileName();\n        echo \"FORM VALID: \";var_dump($file);\n    } else {\n        print \"\\nMESSAGES:\";\n        print_r($form->getMessages());\n    }\n}\nprint \"<\/pre>\";\n?>\n\n<html>\n<head>\n<title>Test<\/title>\n<\/head>\n<body>\n<?php echo $form->render(new Zend_View());?>\n<\/body>\n<\/html>\n{code}\n\nMy result was:\n{code}\narray\n  'file' => string 'C:\\3rdParty\\php\\tmp\\Header.gif' (length=40)\n  'file_two' => string 'C:\\3rdParty\\php\\tmp\\Header_2.jpg' (length=46)\n{code}\n\nI used trunk but 14274, as 142740 will be in about 10 years or so.\nIf you can rework my code that it reproduces your behaviour, then it can be fixed.\nOtherwise I am asuming that you have mixed the installations and are using an old or broken version for your trunk test.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-11T11:46:11.000+0000",
                    "updated": "2009-03-11T11:46:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29428",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbwdevries",
                        "name": "jbwdevries",
                        "displayName": "Johan B.W. de Vries",
                        "active": true
                    },
                    "body": "I've tinkered around with your example, couldn't (at first) find the problem. However; if you change the order of the elements:\n\nFrom:\n{code}\n$form->addElement($element);\n$form->addElement($element2);\n{code}\n\nTo:\n{code}\n$form->addElement($element2);\n$form->addElement($element);\n{code}\n\nThe bug surfaces, using either Zend 1.7.6 or revision 14274.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbwdevries",
                        "name": "jbwdevries",
                        "displayName": "Johan B.W. de Vries",
                        "active": true
                    },
                    "created": "2009-03-12T00:54:02.000+0000",
                    "updated": "2009-03-12T00:54:02.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29429",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbwdevries",
                        "name": "jbwdevries",
                        "displayName": "Johan B.W. de Vries",
                        "active": true
                    },
                    "body": "Purely cosmetics; used the {code} tag to display the results better.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbwdevries",
                        "name": "jbwdevries",
                        "displayName": "Johan B.W. de Vries",
                        "active": true
                    },
                    "created": "2009-03-12T00:56:55.000+0000",
                    "updated": "2009-03-12T00:56:55.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29430",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbwdevries",
                        "name": "jbwdevries",
                        "displayName": "Johan B.W. de Vries",
                        "active": true
                    },
                    "body": "\"Purely cosmetics;\" -> I meant I update the issue summary, it looked weird without the code tags.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jbwdevries",
                        "name": "jbwdevries",
                        "displayName": "Johan B.W. de Vries",
                        "active": true
                    },
                    "created": "2009-03-12T00:58:53.000+0000",
                    "updated": "2009-03-12T00:58:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29443",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Fixed with r14287.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-12T15:42:20.000+0000",
                    "updated": "2009-03-12T15:42:20.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5990\/transitions"
}