{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5535",
    "key": "ZF-5535",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Db_Table does not work with IBM DB\/2"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5535\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/3",
                "name": "Duplicate"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-05-18T00:01:16.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=michael.mest",
                "name": "michael.mest",
                "displayName": "Michael Mest",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-01-13T07:39:21.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-12-08T07:54:48.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "db2"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I try to use Zend_Db_Table with DB\/2.\r\n\r\nMy Table class looks like this:\r\n\r\n{code}\r\nclass Mitarbeiter extends Zend_Db_Table_Abstract{\r\n \tprotected $_name = 'mitarbeiter';\r\n \tprotected $_schema = 'orga';\r\n \tprotected $_primary = 'id';\r\n \tprotected $_referenceMap = array(\r\n \t\t'Anrede' => array(\r\n \t\t\t'columns'=>'anrede',\r\n \t\t\t'refTableClass' => 'Anrede',\r\n \t\t\t'refColumns' => 'id')\r\n \t\t);\r\n }\r\n{code}\r\n\r\nWhen I run a simple select, i should get the following SQL-Statement:\r\n{code}\r\n\"SELECT * FROM orga.mitarbeiter\" but instead I get \"SELECT mitarbeiter.* FROM orga.mitarbeiter\"\r\n{code}\r\n\r\nThis kind of SELECT-Statement is not allowed in DB\/2.\r\n\r\nIt would work, if the name of user which is connected to the database is the same that the table schema and u omit the schema name. The result of that would be a statement like\r\n\r\n{code}\r\n\"SELECT mitarbeiter.* FROM mitarbeiter\"\r\n{code}\r\n\r\nI have to add one more Information:\r\n\r\nThe Statement:\r\n{code}\r\n\"SELECT orga.mitarbeiter.* FROM orga.mitarbeiter\"\r\n{code}\r\n would work too. It's just necessary that the \"Column-Prefix\" is the same, as the \"Table-Part\" of the From-Clause"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5535\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                "name": "satoruyoshida",
                "displayName": "Satoru Yoshida",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-4553",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4553",
                    "type": {
                        "name": "Duplicate",
                        "direction": "OUTBOUND",
                        "description": "duplicates"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10270",
                    "id": 10270,
                    "description": "Mini Release",
                    "name": "1.7.1",
                    "userReleaseDate": "01\/Dec\/08",
                    "archived": false,
                    "releaseDate": "2008-12-01",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10271",
                    "id": 10271,
                    "description": "Mini Release",
                    "name": "1.7.2",
                    "userReleaseDate": "23\/Dec\/08",
                    "archived": false,
                    "releaseDate": "2008-12-23",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10133",
                    "id": 10133,
                    "name": "Zend_Db_Table",
                    "description": "Lightweight OO interface to database tables and rowsets.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28712",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htran@cssb.mb.ca",
                        "name": "htran@cssb.mb.ca",
                        "displayName": "huy tran",
                        "active": true
                    },
                    "body": "I too ran into this problem with the Zend_Db_Table class for DB2.  Just like the ticket's description said by appending the schema name to the tablename.columnname the problem resolve.  So basically your sql statement will look something like this\nSELECT schema.table.column FROM schema.table;\nOR \nSELECT schema.table.* FROM schema.table;\n\nAfter muckling around with the ZF i've decided to abstract a couple of classes to make this possible.\n1. I've created a new directory structure within the ZF architecture library folder like below\n    library\n      ZendExt\n         DB\n           Table\n2. Under the Table folder i added two new php files, Abstract.php and Select.php\nThe code for\n\n----------Abstract.php-----------\n\n<?php\nclass ZendExt_Db_Table_Abstract extends Zend_Db_Table_Abstract\n{\n    \/\/this class abstract the db_table from the Zend library\n    \/\/this allows us to append the schema name to the front of the column name.\n    \/\/Eg: SELECT SCHEMANAME.TABLENAME.COLUMNNAME FROM TABLENAME;\n    public function select()\n    {\n        require_once 'ZendExt\/Db\/Table\/Select.php';\n        return new ZendExt_Db_Table_Select($this);\n    }    \n}\n?>\n\n---------------------------\n\n------------Select.php-------------\n<?php\nclass ZendExt_Db_Table_Select extends Zend_Db_Table_Select {\n\n    \/\/Override function _renderColumns\n    protected function _renderColumns($sql)\n    {\n        if (!count($this->_parts[self::COLUMNS])) {\n            return null;\n        }\n\n        $columns = array();\n        foreach ($this->_parts[self::COLUMNS] as $columnEntry) {\n            list($correlationName, $column, $alias) = $columnEntry;\n            if ($column instanceof Zend_Db_Expr) {\n                $columns[] = $this->_adapter->quoteColumnAs($column, $alias, true);\n            } else {\n                if ($column == self::SQL_WILDCARD) {\n                    $column = new Zend_Db_Expr(self::SQL_WILDCARD);\n                    $alias = null;\n                }\n                if (empty($correlationName)) {\n                    $columns[] = $this->_adapter->quoteColumnAs($column, $alias, true);\n                } else {\n                \t\/*\n         \t\t\t* @todo: \n         \t\t\t* By: Huy Tran\n         \t\t\t* Date: 20080206\n         \t\t\t* Description: This code here is for DB2 compatibility. This allow the appendtion of the schema to the front of the column name.\n         \t\t\t* Eg. Select SELECT WEBSTUFF.ALIAS.ALNAME, WEBSTUFF.ALIAS.ALSID FROM WEBSTUFF.ALIAS \n  \t\t\t\t\t*\/\n                \t\n                \t$schema\t= $this->_parts[self::FROM][$correlationName][\"schema\"];\n                    $columns[] = $this->_adapter->quoteColumnAs(array($schema.'.'.$correlationName, $column), $alias, true);                \t\n                }\n            }\n        }\n\n        return $sql .= ' ' . implode(', ', $columns);\n    }\n    \n}\n?>\n\n-----------------------------------\n\n3. I then update the first 2 lines in my model from the DBTable folder to the following\n\nrequire_once 'Zend\/Db\/Table\/Abstract.php';\n\nclass Model_DbTable_Alias extends Zend_Db_Table_Abstract \n\n\nTO\n\nrequire_once 'ZendExt\/Db\/Table\/Abstract.php';\n\nclass Model_DbTable_Alias extends ZendExt_Db_Table_Abstract \n\n\n4. And thats it.  The whole purpose of this abstraction is to update the _renderColumns function within the Zend_Db_Table_Select to prepend the schema name to the column name.\n\nOf course this is a temporary solution until Zend comes up with a fix.  But so far this fix has allow me to fix the problem described in the ticket.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htran@cssb.mb.ca",
                        "name": "htran@cssb.mb.ca",
                        "displayName": "huy tran",
                        "active": true
                    },
                    "created": "2009-02-09T11:50:30.000+0000",
                    "updated": "2009-02-09T11:50:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31097",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=yoshida@zend.co.jp",
                        "name": "yoshida@zend.co.jp",
                        "displayName": "old of Satoru Yoshida",
                        "active": true
                    },
                    "body": "It seems to duplicate ZF-4553",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=yoshida@zend.co.jp",
                        "name": "yoshida@zend.co.jp",
                        "displayName": "old of Satoru Yoshida",
                        "active": true
                    },
                    "created": "2009-05-18T00:00:23.000+0000",
                    "updated": "2009-05-18T00:00:23.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5535\/transitions"
}