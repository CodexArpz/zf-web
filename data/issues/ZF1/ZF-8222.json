{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8222",
    "key": "ZF-8222",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "isDispatchable does not formatClassName for class_exists - neccessary for when prefixDefaultModule is true"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/11",
                "name": "Patch",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8222\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10460",
                    "id": 10460,
                    "description": "Mini Release",
                    "name": "1.10.5",
                    "userReleaseDate": "26\/May\/10",
                    "archived": false,
                    "releaseDate": "2010-05-26",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-04-28T11:57:49.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=devosc",
                "name": "devosc",
                "displayName": "devosc",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-11-04T21:59:43.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-04-28T11:57:49.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "{quote}\r\nclass Zend_Controller_Dispatcher_Standard\r\n{\r\n    public function isDispatchable(Zend_Controller_Request_Abstract $request)\r\n    {\r\n        $className = $this->getControllerClass($request);\r\n        if (!$className) {\r\n            return false;\r\n        }\r\n\r\n        if (class_exists($className, false)) {\r\n            return true;\r\n        }\r\n{quote}\r\n\r\nWhen prefixDefaultModule is true, $className needs to be formatted via formatClassName otherwise the module name is not prefixed and so the class will not exist - which for example when forwarding to another action causes Zend_Loader::isReadable to always be executed.\r\n\r\nAlternative code\r\n{quote}\r\nclass Zend_Controller_Dispatcher_Standard\r\n{\r\n    public function isDispatchable(Zend_Controller_Request_Abstract $request)\r\n    {\r\n        $className = $this->getControllerClass($request);\r\n        if (!$className) {\r\n            return false;\r\n        }\r\n\r\n        $class = $this->getParam('prefixDefaultModule')\r\n                        ? ucfirst($this->formatClassName($this->_curModule, $className))\r\n                            : $className;\r\n\r\n        if (class_exists($class, false)) {\r\n            return true;\r\n        }\r\n{quote}\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8222\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13017",
                    "filename": "0001-fixed-ZF-8222-and-added-unit-tests-for-it.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=evan.pro",
                        "name": "evan.pro",
                        "displayName": "Evan Coury",
                        "active": true
                    },
                    "created": "2010-04-19T18:10:28.000+0000",
                    "size": 4660,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13017\/0001-fixed-ZF-8222-and-added-unit-tests-for-it.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10380",
                    "id": 10380,
                    "description": "Mini Release",
                    "name": "1.9.5",
                    "userReleaseDate": "27\/Oct\/09",
                    "archived": false,
                    "releaseDate": "2009-10-27",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10011",
                    "id": 10011,
                    "name": "Zend_Controller",
                    "description": "front controller, including router and dispatcher",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39523",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=evan.pro",
                        "name": "evan.pro",
                        "displayName": "Evan Coury",
                        "active": true
                    },
                    "body": "I can definitely confirm this issue.\r\n\r\nOne way to illustrate the problem is to set prefixDefaultModule to true and simply define a controller class for your default module somewhere (prefix it with the module name since we've set prefixDefaultModule) and give it a default action. Make sure you put the controller file somewhere not typical (so it cannot be autoloaded), and just require_once() it in yourself. Then try requesting that controller, and you'll get a invalid controller exception. \r\n\r\nAlso, Devosc's fix works great to mitigate this issue, without any adverse effects either.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=evan.pro",
                        "name": "evan.pro",
                        "displayName": "Evan Coury",
                        "active": true
                    },
                    "created": "2010-03-24T13:31:42.000+0000",
                    "updated": "2010-03-24T13:31:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40139",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=evan.pro",
                        "name": "evan.pro",
                        "displayName": "Evan Coury",
                        "active": true
                    },
                    "body": "See the attached patch which includes a fix, as well as a unit test with assertions to prove the issue. Patch is in GIT format, so you may have to use git-apply. Also, it is relative from \/framework\/standard\/trunk.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=evan.pro",
                        "name": "evan.pro",
                        "displayName": "Evan Coury",
                        "active": true
                    },
                    "created": "2010-04-19T18:10:29.000+0000",
                    "updated": "2010-04-19T18:10:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40140",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=evan.pro",
                        "name": "evan.pro",
                        "displayName": "Evan Coury",
                        "active": true
                    },
                    "body": "Also, note that my patch is not the same fix as devosc has proposed. Upon looking closer, his fix does not completely solve the underlying issue, as his will only solve the issue for the default module, but any other modules will still experience the issue. The unit test I wrote above illustrates this, as simply running formatClassName() if the _prefixDefaultModule_ parameter is true will not pass the test. You have to also say \"or if the requested module is not the default module\", since all controllers for non-default modules must have a prefix.\r\n\r\nPerhaps a more accurate title for this issue might be: \"isDispatchable does not formatClassName for class_exists - necessary for when prefixDefaultModule is true *OR* the request is for a non-default module\"",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=evan.pro",
                        "name": "evan.pro",
                        "displayName": "Evan Coury",
                        "active": true
                    },
                    "created": "2010-04-19T18:35:13.000+0000",
                    "updated": "2010-04-19T18:35:13.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40276",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Patch reviewed and applied to trunk and 1.10 release branch -- thanks!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2010-04-28T11:57:49.000+0000",
                    "updated": "2010-04-28T11:57:49.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8222\/transitions"
}