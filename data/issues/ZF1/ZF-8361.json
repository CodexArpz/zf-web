{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8361",
    "key": "ZF-8361",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Date's subDate() not returning correct value"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8361\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10360",
                    "id": 10360,
                    "description": "Minor Release",
                    "name": "1.10.0",
                    "userReleaseDate": "27\/Jan\/10",
                    "archived": false,
                    "releaseDate": "2010-01-27",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-11-20T09:25:22.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=travisp",
                "name": "travisp",
                "displayName": "Travis Pew",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-11-20T07:56:27.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-11-20T09:59:24.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I'm not certain I'm using it correctly, but it seems that subDate() is returning the wrong value.\r\n\r\n{code}\r\n        $dayOne = new Zend_Date('12\/22\/2009', 'MM\/dd\/yyyy');\r\n        $dayTwo = new Zend_Date('12\/25\/2009', 'MM\/dd\/yyyy');\r\n\r\n        var_dump($dayOne->getIso()); \/\/prints: string '2009-12-22T00:00:00-06:00' (length=25)\r\n        var_dump($dayTwo->getIso()); \/\/prints: string '2009-12-25T00:00:00-06:00' (length=25)\r\n\r\n        $dateDiff = $dayTwo->subDate($dayOne);\r\n        var_dump($dateDiff->getIso()); \/\/prints: string '-1-12-06T00:00:00-0600' (length=22)\r\n\tvar_dump($dateDiff->get(Zend_Date::DAY_OF_YEAR)); \/\/prints: string '339' (length=3)\r\n{code}\r\n\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8361\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10380",
                    "id": 10380,
                    "description": "Mini Release",
                    "name": "1.9.5",
                    "userReleaseDate": "27\/Oct\/09",
                    "archived": false,
                    "releaseDate": "2009-10-27",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10072",
                    "id": 10072,
                    "name": "Zend_Date",
                    "description": "Zend_Date is the basic library for the handling of all date, time and calendar-related issues.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36290",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I don't know what you want to archive but running the first example you gave I see no failure:\r\n\r\n{code}\r\n$dayOne = new Zend_Date('12\/22\/2009', 'MM\/dd\/yyyy');\r\n$dayTwo = new Zend_Date('12\/25\/2009', 'MM\/dd\/yyyy');\r\n{code}\r\nNow we have\r\nONE = 22.Dec.2009\r\nTWO = 25.Dec.2009\r\n\r\n{code}\r\nvar_dump($dayOne->getIso()); \/\/prints: string '2009-12-22T00:00:00-06:00' (length=25)\r\nvar_dump($dayTwo->getIso()); \/\/prints: string '2009-12-25T00:00:00-06:00' (length=25)\r\n{code}\r\n\r\n{code}\r\n$dateDiff = new Zend_Date($dayTwo->subDate($dayOne));\r\n{code}\r\n\r\nNow you substract ONE from TWO\r\nwhich means:\r\nDAY: 25 - 22 = 3\r\nMONTH: 12 - 12 = 0\r\nYEAR: 2009 - 2009 = 0\r\n\r\nSo the calculation would be 3.0.0\r\nAs there is no month 0 the month is corrected to 12 of previous year\r\nThis means 3.Dec.-1.\r\nBecause you also took timezone into account and because the months differ between their days (30 <> 31) we have the result you got.\r\n\r\n{code}\r\nvar_dump($dateDiff->getIso()); \/\/prints: string '-1-12-05T18:00:00-0600' (length=21)\r\n{code}\r\n\r\nAs described before\r\n\r\n{code}\r\nvar_dump($dateDiff->get(Zend_Date::DAY_OF_YEAR)); \/\/prints: 338\r\n{code}\r\n\r\nWell... the 5.Dec of the year -1 before christ is the day 338 of this year.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-11-20T08:26:53.000+0000",
                    "updated": "2009-11-20T08:26:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36292",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "The question is:\r\n\r\n\"What do you want to do\"",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-11-20T08:32:00.000+0000",
                    "updated": "2009-11-20T08:32:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36294",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=travisp",
                        "name": "travisp",
                        "displayName": "Travis Pew",
                        "active": true
                    },
                    "body": "My goal was to get an accurate difference in days between two days. Calculating this manually with sub() (or by substracting timestamps) and dividing by 86400 will not take into account DST, for example.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=travisp",
                        "name": "travisp",
                        "displayName": "Travis Pew",
                        "active": true
                    },
                    "created": "2009-11-20T08:40:27.000+0000",
                    "updated": "2009-11-20T08:40:27.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36301",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "But substracting a date from another date will not return the difference.\r\nThis returns of course only another date.\r\n\r\nTimestamps do take DST and timezone into account.\r\n\r\nFrom the mailinglist\/manual\/API:\r\n{code}\r\n$one = new Zend_Date($date1);\r\n$two = new Zend_Date($date2);\r\n\r\n$one->subDate($two);\r\n$days = $one->getDayOfYear();\r\n{code}\r\n\r\nBut works only when the dates do not differ more than one year.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-11-20T09:24:53.000+0000",
                    "updated": "2009-11-20T09:24:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36302",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Closing as non-issue.\r\nsubDate works as expected.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-11-20T09:25:22.000+0000",
                    "updated": "2009-11-20T09:25:22.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36314",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=travisp",
                        "name": "travisp",
                        "displayName": "Travis Pew",
                        "active": true
                    },
                    "body": "Thomas, your code appears similar to mine (I took my code from a post you made to the mailing list about a year ago) and does not seem to work for 12\/22\/2009 and 12\/25\/2009 or a number of other dates less than one year.\r\n\r\nIf I set:\r\n{code}\r\n        $one = new Zend_Date('12\/22\/2009', 'MM\/dd\/yyyy');\r\n        $two = new Zend_Date('12\/25\/2009', 'MM\/dd\/yyyy');\r\n        $two->subDate($one);\r\n        $days = $two->getDayOfYear();\r\n{code}\r\nWhich returns a value of 339 when I print $days->get(Zend_Date::DAY_OF_YEAR);\r\n\r\nSample values of $days:\r\n12\/25\/2009 - 12\/24\/2009 = 1969-12-03T18:00:00-06:00 (335)\r\n12\/25\/2009 - 11\/25\/2009 = 1969-01-02T18:00:00-06:00 (0)\r\n12\/25\/2009 - 10\/25\/2009 = 1969-02-01T18:00:00-06:00 (30)\r\nThe values are off by a month.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=travisp",
                        "name": "travisp",
                        "displayName": "Travis Pew",
                        "active": true
                    },
                    "created": "2009-11-20T09:59:24.000+0000",
                    "updated": "2009-11-20T09:59:24.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8361\/transitions"
}