{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10300",
    "key": "ZF-10300",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Label gets translated twice"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10300\/votes",
                "votes": 7,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/3",
                "name": "Duplicate"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-12-01T12:26:31.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stahlstift",
                "name": "stahlstift",
                "displayName": "Markus Lanz",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-08-12T03:21:46.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-12-01T12:26:31.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "For Example the message 'my.namespace.country.germany' will translate to 'Deutschland' and then it tries to translate 'Deutschland' again.\r\n\r\nAs far as I debugged the problem is relativ easy to solve:\r\n\r\nUpdate:\r\nAlso Zend_Form_Element_Submit uses the already translated Label\r\n\r\n{code:title=Zend_Form_Element|borderStyle=solid}\r\n\/**\r\n     * Retrieve element label\r\n     *\r\n     * @return string\r\n     *\/\r\n    public function getLabel()\r\n    {\r\n        $translator = $this->getTranslator();\r\n        if (null !== $translator) {\r\n            return $translator->translate($this->_label);\r\n        }\r\n\r\n        return $this->_label;\r\n    }\r\n{code}\r\n\r\n{code:title=Zend_Form_Decorator_Label|borderStyle=solid}\r\n\/**\r\n     * Get label to render\r\n     *\r\n     * @return void\r\n     *\/\r\n    public function getLabel()\r\n    {\r\n        if (null === ($element = $this->getElement())) {\r\n            return '';\r\n        }\r\n\r\n        $label = $element->getLabel();\r\n        $label = trim($label);\r\n\r\n        if (empty($label)) {\r\n            return '';\r\n        }\r\n\r\n        if (null !== ($translator = $element->getTranslator())) {\r\n            $label = $translator->translate($label);\r\n        }\r\n\r\n        $optPrefix = $this->getOptPrefix();\r\n        $optSuffix = $this->getOptSuffix();\r\n        $reqPrefix = $this->getReqPrefix();\r\n        $reqSuffix = $this->getReqSuffix();\r\n        $separator = $this->getSeparator();\r\n\r\n        if (!empty($label)) {\r\n            if ($element->isRequired()) {\r\n                $label = $reqPrefix . $label . $reqSuffix;\r\n            } else {\r\n                $label = $optPrefix . $label . $optSuffix;\r\n            }\r\n        }\r\n\r\n        return $label;\r\n    }\r\n{code}\r\n\r\n{code:title=Zend_Form_Element_Submit|borderStyle=solid}\r\n    \/**\r\n     * Return label\r\n     *\r\n     * If no label is present, returns the currently set name.\r\n     *\r\n     * If a translator is present, returns the translated label.\r\n     *\r\n     * @return string\r\n     *\/\r\n    public function getLabel()\r\n    {\r\n        $value = parent::getLabel();\r\n\r\n        if (null === $value) {\r\n            $value = $this->getName();\r\n        }\r\n\r\n        if (null !== ($translator = $this->getTranslator())) {\r\n            return $translator->translate($value);\r\n        }\r\n\r\n        return $value;\r\n    }\r\n{code}\r\n\r\nAs you can see getLabel() from Zend_Form_Element will translate the string and getLabel() from Zend_Form_Element_Decorator translates the already translated string again"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10300\/watchers",
                "isWatching": false,
                "watchCount": 6
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                "name": "alab",
                "displayName": "Christian Albrecht",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-8694",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8694",
                    "type": {
                        "name": "Duplicate",
                        "direction": "OUTBOUND",
                        "description": "duplicates"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10480",
                    "id": 10480,
                    "description": "Mini Release",
                    "name": "1.10.7",
                    "userReleaseDate": "28\/Jul\/10",
                    "archived": false,
                    "releaseDate": "2010-07-28",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10490",
                    "id": 10490,
                    "description": "Mini Release",
                    "name": "1.10.8",
                    "userReleaseDate": "25\/Aug\/10",
                    "archived": false,
                    "releaseDate": "2010-08-25",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41956",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stahlstift",
                        "name": "stahlstift",
                        "displayName": "Markus Lanz",
                        "active": true
                    },
                    "body": "A simple fix would be to remove the translation of getLabel() from the decorator, which is also in my opinion a sideeffect.\r\n\r\nA fecorator should decorate...",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stahlstift",
                        "name": "stahlstift",
                        "displayName": "Markus Lanz",
                        "active": true
                    },
                    "created": "2010-08-12T03:26:22.000+0000",
                    "updated": "2010-08-12T03:26:22.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41957",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Detaching Zend_Translate from the affected components.\r\n\r\nThe problem is not related to Zend_Translate as it translates whatever Zend_Form gives to be translated. There is no way for Zend_Translate to know if that string, which is given, is already translated, or if it's just an untranslated source string.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-08-12T04:01:03.000+0000",
                    "updated": "2010-08-12T04:01:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/42381",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=excuvator",
                        "name": "excuvator",
                        "displayName": "Saman Darougheh",
                        "active": true
                    },
                    "body": "agree with markus - its simply the decorator that is overtaking irrelevant functions. He should decorate, not *change* content.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=excuvator",
                        "name": "excuvator",
                        "displayName": "Saman Darougheh",
                        "active": true
                    },
                    "created": "2010-09-27T05:31:56.000+0000",
                    "updated": "2010-09-27T05:31:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/42382",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=excuvator",
                        "name": "excuvator",
                        "displayName": "Saman Darougheh",
                        "active": true
                    },
                    "body": "as i cannot edit my comment: \r\n\r\n#1 remove translating from decorator\r\n#2 move the conditional translation inside submit-element (ll 80-82 inside the $value === null condition before (ll76-78). ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=excuvator",
                        "name": "excuvator",
                        "displayName": "Saman Darougheh",
                        "active": true
                    },
                    "created": "2010-09-27T05:35:53.000+0000",
                    "updated": "2010-09-27T05:35:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/42754",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fctst",
                        "name": "fctst",
                        "displayName": "Tobias Stanzel",
                        "active": true
                    },
                    "body": "i run over the same problem, when i wrote a tool to list all untranslated id for me.\r\n\r\nImho the decorator should not change but decorate the content, so removing the translation from it makes sense. The translation is done by the element allready",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fctst",
                        "name": "fctst",
                        "displayName": "Tobias Stanzel",
                        "active": true
                    },
                    "created": "2010-10-27T05:33:14.000+0000",
                    "updated": "2010-10-27T05:33:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47205",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adelius",
                        "name": "adelius",
                        "displayName": "Daniel Schroeren",
                        "active": true
                    },
                    "body": "i stumbled upon this issue while i was writing a custom Zend_Translate_Adapter which is able to organize the translations in my db and uses the logging to collect missing translations.\r\nfixed this issue as described above.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adelius",
                        "name": "adelius",
                        "displayName": "Daniel Schroeren",
                        "active": true
                    },
                    "created": "2011-06-16T12:24:01.000+0000",
                    "updated": "2011-06-16T12:24:01.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49204",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Duplicate of ZF-8694.   A fix has been proposed there.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2011-12-01T12:26:31.000+0000",
                    "updated": "2011-12-01T12:26:31.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10300\/transitions"
}