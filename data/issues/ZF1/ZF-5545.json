{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5545",
    "key": "ZF-5545",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Undefined offset notice in Search\/Lucene\/Search\/Query\/MultiTerm.php"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5545\/votes",
                "votes": 11,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10490",
                    "id": 10490,
                    "description": "Mini Release",
                    "name": "1.10.8",
                    "userReleaseDate": "25\/Aug\/10",
                    "archived": false,
                    "releaseDate": "2010-08-25",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-07-29T15:08:31.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tl_cld",
                "name": "tl_cld",
                "displayName": "Thomas L\u00f8cke",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-01-14T06:15:38.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-08-20T11:05:34.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "When doing a search using boolean operators and more than one search terms:\r\n\r\n+PHP +Zend\r\n\r\nOr\r\n\r\nPHP AND Zend\r\n\r\nA PHP notice is thrown:  PHP Notice:  Undefined offset:  2511 in \/path\/to\/Zend\/Search\/Lucene\/Search\/Query\/MultiTerm.php on line 467\r\n\r\nPlease note that the number 2511 changes for each \"hit\". The first notice has the lowest number, and the last notice the highest number.\r\n\r\nI've not been able to spot any problems relating to this notice, other than the fact that it's quite annoying to look at in the errorlog."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/2",
                "name": "Critical"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5545\/watchers",
                "isWatching": false,
                "watchCount": 11
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                "name": "alexander",
                "displayName": "Alexander Veremyev",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-7789",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7789",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                },
                {
                    "issueKey": "ZF-5554",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5554",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10270",
                    "id": 10270,
                    "description": "Mini Release",
                    "name": "1.7.1",
                    "userReleaseDate": "01\/Dec\/08",
                    "archived": false,
                    "releaseDate": "2008-12-01",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10271",
                    "id": 10271,
                    "description": "Mini Release",
                    "name": "1.7.2",
                    "userReleaseDate": "23\/Dec\/08",
                    "archived": false,
                    "releaseDate": "2008-12-23",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10361",
                    "id": 10361,
                    "description": "Mini Release",
                    "name": "1.9.2",
                    "userReleaseDate": "25\/Aug\/09",
                    "archived": false,
                    "releaseDate": "2009-08-25",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10021",
                    "id": 10021,
                    "name": "Zend_Search_Lucene",
                    "description": "pure PHP robust, general purpose text search engine",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29479",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cancausecancer",
                        "name": "cancausecancer",
                        "displayName": "Carl Simons",
                        "active": true
                    },
                    "body": "I just received same error. It looks like it's a problem with my data. \n\nNotice: Undefined offset: 39996 in Z:\\Search\\Lucene\\Search\\Query\\MultiTerm.php on line 467\n\nMy table has 50 rows, some row's data (because of encoding and hyphenations) seem to have characters which aren't representable or convertible to any latin characters, I'm not sure if that is a prob, but anyways,\n\nHere is an example of my search, the # is actually a Danish character, O with a slash thru it, but because of encoding probs, shows up as >> :\n\nKoffe S#rensen A\n\nIn search\/query\/Boolean.php I did a print_r($this -> _subqueries) and here are some highlights:\n\n-----------------------------------------------------\n-----------------------------------------------------\n [_terms:private] => Array\n                (\n                    [0] => Zend_Search_Lucene_Index_Term Object\n                        (\n                            [field] => name\n                            [text] => rensen\n                        )\n\n                    [1] => Zend_Search_Lucene_Index_Term Object\n                        (\n                            [field] => name\n                            [text] => s\n                        )\n\n                    [2] => Zend_Search_Lucene_Index_Term Object\n                        (\n                            [field] => name\n                            [text] => a\n                        )\n\n                )\n\n-----------------------------------------------------\n-----------------------------------------------------\n\n [_termInfoCache:private] => Array\n                                                        (\n                                                            [name\ufffds] => \n                                                            [name\ufffdrensen] => \n                                                            [name\ufffdkoffe] => \n                                                            [name\ufffda] => Zend_Search_Lucene_Index_TermInfo Object\n                                                                (\n                                                                    [docFreq] => 4\n                                                                    [freqPointer] => 0\n                                                                    [proxPointer] => 0\n                                                                    [skipOffset] => 0\n                                                                    [indexPointer] => \n                                                                )\n\n                                                        )\n\n-----------------------------------------------------\n-----------------------------------------------------\n\nI don't get this error when I do the same search with data from the same table that is all normal latin chars. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cancausecancer",
                        "name": "cancausecancer",
                        "displayName": "Carl Simons",
                        "active": true
                    },
                    "created": "2009-03-14T10:03:39.000+0000",
                    "updated": "2009-03-14T10:03:39.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29772",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=garth.gillespie",
                        "name": "garth.gillespie",
                        "displayName": "Garth Gillespie",
                        "active": true
                    },
                    "body": "I'm seeing this too with 1.7.7.  Upgrading from 1.6.2 - so indexes were created in 1.6.2.  On a site where there is likely non-latin UTF-8 content in the index I see this - where content is strictly latin characters I'm not seeing it.  Does this mean a switch in the analyzer to utf8 and i have to compile in the php mb library (which so far I have avoided)? ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=garth.gillespie",
                        "name": "garth.gillespie",
                        "displayName": "Garth Gillespie",
                        "active": true
                    },
                    "created": "2009-03-27T12:55:38.000+0000",
                    "updated": "2009-03-27T12:55:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29777",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=garth.gillespie",
                        "name": "garth.gillespie",
                        "displayName": "Garth Gillespie",
                        "active": true
                    },
                    "body": "more information\n\na development server where this works does have mbstring compiled into php.  this error appears on the production server without mbstring.  also downloaded 1.7.0 and the same error appears there - so this was introduced between 1.6.2 and 1.7.0.\n\ni looked at the index with Luke and the Undefined offset numbers correspond to the Doc. Id in Luke.\n\nEach time it throws the 'Notice' warning the result corresponding to the Doc Id is not returned.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=garth.gillespie",
                        "name": "garth.gillespie",
                        "displayName": "Garth Gillespie",
                        "active": true
                    },
                    "created": "2009-03-27T14:55:58.000+0000",
                    "updated": "2009-03-27T14:55:58.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29781",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=garth.gillespie",
                        "name": "garth.gillespie",
                        "displayName": "Garth Gillespie",
                        "active": true
                    },
                    "body": "new php with or without mbstring didn't make a difference on existing index",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=garth.gillespie",
                        "name": "garth.gillespie",
                        "displayName": "Garth Gillespie",
                        "active": true
                    },
                    "created": "2009-03-27T16:54:50.000+0000",
                    "updated": "2009-03-27T16:54:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29782",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=garth.gillespie",
                        "name": "garth.gillespie",
                        "displayName": "Garth Gillespie",
                        "active": true
                    },
                    "body": "last thing I can think of for the day - this happens when searching both multiple terms in the same field as well as a separate single terms in two different fields.\n\nie.\n\ncontent:foo AND content:bar = error\n\ntitle:foo AND content:bar = error\n\ncontent:bar = ok ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=garth.gillespie",
                        "name": "garth.gillespie",
                        "displayName": "Garth Gillespie",
                        "active": true
                    },
                    "created": "2009-03-27T17:05:46.000+0000",
                    "updated": "2009-03-27T17:05:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29787",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=garth.gillespie",
                        "name": "garth.gillespie",
                        "displayName": "Garth Gillespie",
                        "active": true
                    },
                    "body": "Is this related to ZF-5554?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=garth.gillespie",
                        "name": "garth.gillespie",
                        "displayName": "Garth Gillespie",
                        "active": true
                    },
                    "created": "2009-03-27T23:39:51.000+0000",
                    "updated": "2009-03-27T23:39:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30367",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gzumaglini",
                        "name": "gzumaglini",
                        "displayName": "Gianluca Zumaglini",
                        "active": true
                    },
                    "body": "quick hack for this issue, checks if [$termId][$docId] isset in _termsFreqs array.\n\nreplace codeblock starting at line 472 in MultiTerm.php with this block ...\n\n{code}\nif (isset($this->_termsFreqs[$termId][$docId])) {\t\t\t\n\t$score += $reader->getSimilarity()->tf($this->_termsFreqs[$termId][$docId]) *\n\t$this->_weights[$termId]->getValue() *\n\t$reader->norm($docId, $term->field);\t\t\t\t\t  \n}\nelse {\n\t$score += $this->_weights[$termId]->getValue() *\n\t$reader->norm($docId, $term->field);\n}\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gzumaglini",
                        "name": "gzumaglini",
                        "displayName": "Gianluca Zumaglini",
                        "active": true
                    },
                    "created": "2009-04-24T07:16:04.000+0000",
                    "updated": "2009-04-24T07:16:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36709",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coudenysj",
                        "name": "coudenysj",
                        "displayName": "Jachim Coudenys",
                        "active": false
                    },
                    "body": "The issue is still occuring in version 1.9.2.\r\n\r\nThe snippet of Gianluca Zumaglini is indeed 'fixing' the notice and actually displaying the results again, but I don't know why the {{$this->_termsFreqs}} becomes empty.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coudenysj",
                        "name": "coudenysj",
                        "displayName": "Jachim Coudenys",
                        "active": false
                    },
                    "created": "2009-12-04T07:14:37.000+0000",
                    "updated": "2009-12-04T07:14:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39286",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=hying",
                        "name": "hying",
                        "displayName": "Hying",
                        "active": true
                    },
                    "body": "Hi,\r\ntill version 1.10.2, the $docsFilter initialized in line 343 of MultiTerm.php is used a second time in line 352. This second usage reduce the objects in this instance. \r\nThe same $docsFilter instance is later used in the funktion termDocs of the class SegmentInfo and reduce the results calling somthing like  \"if (isset($filter[$docId])) {\"\r\n\r\nAdding \"$docsFilter = new Zend_Search_Lucene_Index_DocsFilter();\" in line 351 of MultiTerm.ph resolves the problem.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=hying",
                        "name": "hying",
                        "displayName": "Hying",
                        "active": true
                    },
                    "created": "2010-03-16T10:09:48.000+0000",
                    "updated": "2010-03-16T10:09:48.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41785",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "body": "Fixed.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "created": "2010-07-29T15:08:33.000+0000",
                    "updated": "2010-07-29T15:08:33.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5545\/transitions"
}