{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8087",
    "key": "ZF-8087",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Error within unit testing with PHPUnit - Zend_Db_Table_Exception: No adapter found for [...]"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8087\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10480",
                    "id": 10480,
                    "description": "Mini Release",
                    "name": "1.10.7",
                    "userReleaseDate": "28\/Jul\/10",
                    "archived": false,
                    "releaseDate": "2010-07-28",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-07-01T10:28:35.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=skiller",
                "name": "skiller",
                "displayName": "Constantin Ehrenstein",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-10-17T12:21:03.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-07-01T10:28:35.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I am using TDD with Zend Framework.\r\n\r\nI've set up tests for every component of my application. Within testing, I am using an SQLite database that replaces the live database.\r\n\r\nWith 1.8.4, all went well.\r\n\r\nWith 1.9, I am getting random errors during testing, for example the following:\r\n\r\n7) ModelTechnologyMapperTest::testFetchAll\r\nZend_Db_Table_Exception: No adapter found for Default_Model_DbTable_Technologies\r\n\r\n\/Users\/skiller\/PHP Projects\/skiller\/library\/Zend\/Db\/Table\/Abstract.php:754\r\n\/Users\/skiller\/PHP Projects\/skiller\/library\/Zend\/Db\/Table\/Abstract.php:739\r\n\/Users\/skiller\/PHP Projects\/skiller\/library\/Zend\/Db\/Table\/Abstract.php:268\r\n\/Users\/skiller\/PHP Projects\/skiller\/application\/models\/TechnologyMapper.php:17\r\n\/Users\/skiller\/PHP Projects\/skiller\/application\/models\/TechnologyMapper.php:32\r\n\/Users\/skiller\/PHP Projects\/skiller\/application\/models\/TechnologyMapper.php:52\r\n\/Users\/skiller\/PHP Projects\/skiller\/tests\/application\/models\/TechnologyMapperTest.php:86\r\n\r\nThe strange thing is that other tests for model classes in the same test suite don't yield such errors although they share the exact same database and configuration parameters.\r\n\r\nSince some tests work and some don't, I suspect a problem with the correct initiation sequence within the extended ZF\/PHPUnit framework."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8087\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                "name": "ramon",
                "displayName": "Ramon Henrique Ornelas",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10361",
                    "id": 10361,
                    "description": "Mini Release",
                    "name": "1.9.2",
                    "userReleaseDate": "25\/Aug\/09",
                    "archived": false,
                    "releaseDate": "2009-08-25",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10362",
                    "id": 10362,
                    "description": "Mini Release",
                    "name": "1.9.3",
                    "userReleaseDate": "22\/Sep\/09",
                    "archived": false,
                    "releaseDate": "2009-09-22",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10370",
                    "id": 10370,
                    "description": "Mini Release",
                    "name": "1.9.4",
                    "userReleaseDate": "13\/Oct\/09",
                    "archived": false,
                    "releaseDate": "2009-10-13",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10012",
                    "id": 10012,
                    "name": "Zend_Db",
                    "description": "interfaces, APIs, and adapters for various third-party data stores",
                    "isAssigneeTypeValid": false
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10133",
                    "id": 10133,
                    "name": "Zend_Db_Table",
                    "description": "Lightweight OO interface to database tables and rowsets.",
                    "isAssigneeTypeValid": false
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10312",
                    "id": 10312,
                    "name": "Zend_Test_PHPUnit",
                    "description": "PHPUnit test scaffolding for ZF MVC applications",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35363",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "body": "Could you please provide any code with which we can reproduce this problem?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "created": "2009-10-17T12:29:02.000+0000",
                    "updated": "2009-10-17T12:29:02.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35365",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=skiller",
                        "name": "skiller",
                        "displayName": "Constantin Ehrenstein",
                        "active": true
                    },
                    "body": "(I hope this is rendered readably by JIRA)\r\n\r\nphpunit.xml (in tests\/):\r\n{code}<?xml version=\"1.0\" encoding=\"utf-8\"?>\r\n<phpunit bootstrap=\".\/application\/bootstrap.php\" colors=\"true\">\r\n\t<testsuite name=\"skillerSite\">\r\n\t\t<directory>.\/<\/directory>\r\n\t<\/testsuite>\r\n\t<filter>\r\n\t\t<whitelist>\r\n\t\t\t<directory suffix=\".php\">..\/application<\/directory>\r\n\t\t\t<exclude>\r\n\t\t\t\t<directory suffix=\".phtml\">..\/application<\/directory>\r\n\t\t\t\t<file>..\/application\/Bootstrap.php<\/file>\r\n\t\t\t\t<file>..\/application\/controllers\/ErrorController.php<\/file>\r\n\t\t\t<\/exclude>\r\n\t\t<\/whitelist>\r\n\t<\/filter>\r\n\t<logging>\r\n\t\t<log type=\"coverage-html\" target=\".\/log\/report\" charset=\"utf-8\"\r\n\t\t\tyui=\"true\" highlight=\"true\" lowUpperBound=\"50\" highLowerBound=\"80\" \/>\r\n\t\t<log type=\"textdox\" target=\".\/log\/textdox.html\" \/>\r\n\t<\/logging>\r\n<\/phpunit>\r\n{code}\r\n\r\nin application.ini:\r\n\r\n{code}---8<--- snip ---8<---\r\n[production]\r\nphpSettings.display_startup_errors = 0\r\nphpSettings.display_errors = 0\r\nphpSettings.date.default.timezone = \"Europe\/Vienna\"\r\nincludePaths.library = APPLICATION_PATH \"\/..\/library\"\r\nbootstrap.path = APPLICATION_PATH \"\/Bootstrap.php\"\r\nbootstrap.class = \"Bootstrap\"\r\nresources.frontController.controllerDirectory = APPLICATION_PATH \"\/controllers\"\r\nresources.layout.layoutPath = APPLICATION_PATH \"\/layouts\/scripts\"\r\nresources.view[] =\r\n---8<--- snip ---8<---\r\n\r\n---8<--- snip ---8<---\r\n[testing : production]\r\nphpSettings.display_startup_errors = 1\r\nphpSettings.display_errors = 1\r\nresources.db.adapter = \"Pdo_Sqlite\"\r\nresources.db.params.dbname = APPLICATION_PATH \"\/..\/data\/db\/sitedata-testing.db\"\r\n\r\n[development : production]\r\nphpSettings.display_startup_errors = 1\r\nphpSettings.display_errors = 1\r\n;resources.db.adapter = \"Pdo_Mysql\"\r\n;resources.db.params.host = \"localhost\"\r\n---8<--- snip ---8<---\r\n{code}\r\n\r\nin tests\/TechnologyMapperTest.php\r\n\r\n{code}<?php\r\nclass ModelTechnologyMapperTest extends ControllerTestCase {\r\n\r\n\t\/**\r\n\t * @var Default_Model_TechnologyMapper\r\n\t *\/\r\n\tprotected $_mapper;\r\n\r\n\tpublic function setUp() {\r\n\t\t$this->_mapper = new Default_Model_TechnologyMapper();\r\n\t}\r\n\r\n\tpublic function tearDown() {\r\n\t\t$this->_mapper->getDbTable()\r\n\t\t\t->delete(array(\"order_index = ?\" => -101));\r\n\t\t$this->_mapper->getDbTable()\r\n\t\t\t->delete(array(\"order_index = ?\" => -100));\r\n\t}\r\n\r\n\tpublic function testDbTableProperty() {\r\n\t\t$this->assertClassHasAttribute(\"_dbTable\", \"Default_Model_TechnologyMapper\");\r\n\t}\r\n---8<--- snip ---8<---\r\n{code}\r\n\r\nin application\/models\/TechnologyMapper.php:\r\n\r\n{code}<?php\r\nclass Default_Model_TechnologyMapper {\r\n\t\/**\r\n\t * The database table object\r\n\t *\r\n\t * @var Default_Model_DbTable_Technologies\r\n\t *\/\r\n\tprotected $_dbTable;\r\n\r\n\t\/**\r\n\t * Set the table object\r\n\t * @param $dbTable\r\n\t * @return Default_Model_TechnologyMapper\r\n\t *\/\r\n\tpublic function setDbTable($dbTable) {\r\n\t\tif (is_string ( $dbTable )) {\r\n\t\t\t$dbTable = new $dbTable ( );\r\n\t\t}\r\n\t\tif (! $dbTable instanceof Zend_Db_Table_Abstract) {\r\n\t\t\tthrow new Exception ( \"Invalid table data gateway provider\" );\r\n\t\t}\r\n\t\t$this->_dbTable = $dbTable;\r\n\t\treturn $this;\r\n\t}\r\n\r\n\t\/**\r\n\t * Get the table object\r\n\t * @return Default_Model_DbTable_Technologies\r\n\t *\/\r\n\tpublic function getDbTable() {\r\n\t\tif (null === $this->_dbTable) {\r\n\t\t\t$this->setDbTable ( \"Default_Model_DbTable_Technologies\" );\r\n\t\t}\r\n\t\treturn $this->_dbTable;\r\n\t}\r\n\r\n\t\/**\r\n\t * Save a technology\r\n\t * @param Default_Model_Technology $tech\r\n\t * @return Default_Model_TechnologyMapper\r\n\t *\/\r\n\tpublic function save(Default_Model_Technology &$tech) {\r\n\t\t$data = array(\r\n\t\t\t\"id\"\t\t\t=> $tech->getId(),\r\n\t\t\t\"name\"\t\t\t=> $tech->getName(),\r\n\t\t\t\"class_name\"\t=> $tech->getClassName(),\r\n\t\t\t\"order_index\"\t=> $tech->getOrderIndex(),\r\n\t\t);\r\n\t\tif (null === $tech->getId()) {\r\n\t\t\tunset($data[\"id\"]);\r\n\t\t\t$data[\"created\"] = time();\r\n\t\t\t$tech->setId($this->getDbTable()->insert($data));\r\n\t\t}\r\n\t\telse {\r\n\t\t\t$data[\"modified\"] = time();\r\n\t\t\t$this->getDbTable()->update($data, array(\"id = ?\" => $data[\"id\"]));\r\n\t\t}\r\n\t\treturn $this;\r\n\t}\r\n\r\n\tpublic function fetchAll() {\r\n\t\t$resultSet = $this->getDbTable()\r\n\t\t\t->select()\r\n\t\t\t->order(array(\"order_index\", \"name\"))\r\n\t\t\t->query()\r\n\t\t\t->fetchAll();\r\n\t\t$entries = array();\r\n\t\tforeach ($resultSet as $row) {\r\n\t\t\t$entry = new Default_Model_Technology();\r\n\t\t\t$entry->setId($row[\"id\"])\r\n\t\t\t\t->setName($row[\"name\"])\r\n\t\t\t\t->setClassName($row[\"class_name\"])\r\n\t\t\t\t->setOrderIndex($row[\"order_index\"]);\r\n\t\t\t$entries[] = $entry;\r\n\t\t}\r\n\t\treturn $entries;\r\n\t}\r\n}\r\n{code}\r\n\r\nin application\/models\/DbTable\/Technologies.php:\r\n\r\n{code}<?php\r\nclass Default_Model_DbTable_Technologies extends Zend_Db_Table_Abstract {\r\n\t\/**\r\n\t * table name\r\n\t * @var strings\r\n\t *\/\r\n\tprotected $_name = \"technologies\";\r\n}\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=skiller",
                        "name": "skiller",
                        "displayName": "Constantin Ehrenstein",
                        "active": true
                    },
                    "created": "2009-10-17T12:57:35.000+0000",
                    "updated": "2009-10-17T12:57:35.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35366",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=skiller",
                        "name": "skiller",
                        "displayName": "Constantin Ehrenstein",
                        "active": true
                    },
                    "body": "tests\/application\/ControllerTestCase.php:\r\n\r\n{code}<?php\r\nclass ControllerTestCase extends Zend_Test_PHPUnit_ControllerTestCase {\r\n\r\n\t\/**\r\n\t * @var Zend_Application\r\n\t *\/\r\n\tprotected $_application;\r\n\r\n\t\/**\r\n\t * Prepares the environment before running a test.\r\n\t *\/\r\n\tpublic function setUp() {\r\n\t\t$this->bootstrap = array($this, \"appBootstrap\" );\r\n\t\tparent::setUp();\r\n\t}\r\n\r\n\tpublic function appBootstrap() {\r\n\t\t$this->_application = new Zend_Application( APPLICATION_ENV, APPLICATION_PATH . \"\/configs\/application.ini\" );\r\n\t\t$this->_application->bootstrap();\r\n\t}\r\n}\r\n\r\n{code}\r\n\r\n\r\nOh, and the tests\/application\/bootstrap.php file for unit testing:\r\n\r\n{code}<?php\r\nerror_reporting(E_ALL | E_STRICT);\r\ndate_default_timezone_set(\"Europe\/Vienna\");\r\n\r\ndefined(\"APPLICATION_PATH\")\r\n\t|| define(\"APPLICATION_PATH\", realpath(dirname(__FILE__) . \"\/..\/..\/application\"));\r\ndefined(\"APPLICATION_ENV\")\r\n\t|| define(\"APPLICATION_ENV\", (getenv(\"APPLICATION_ENV\") ? getenv(\"APPLICATION_ENV\") : \"testing\"));\r\nset_include_path(implode(PATH_SEPARATOR, array(\r\n\tget_include_path(),\r\n\trealpath(APPLICATION_PATH . \"\/..\/library\"),\r\n\t\"\/usr\/local\/share\/pear\",\r\n)));\r\nrequire_once 'Zend\/Loader\/Autoloader.php';\r\nrequire_once 'Zend\/Application\/Module\/Autoloader.php';\r\n\/**\r\n * @var Zend_Application_Module_Autoloader\r\n *\/\r\n$autoloader = new Zend_Application_Module_Autoloader(array(\r\n\t\"namespace\" => \"Default\",\r\n\t\"basePath\" => APPLICATION_PATH\r\n));\r\nrequire_once 'ControllerTestCase.php';{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=skiller",
                        "name": "skiller",
                        "displayName": "Constantin Ehrenstein",
                        "active": true
                    },
                    "created": "2009-10-17T13:01:47.000+0000",
                    "updated": "2009-10-17T13:01:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41293",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                        "name": "ramon",
                        "displayName": "Ramon Henrique Ornelas",
                        "active": true
                    },
                    "body": "@Constantin Ehrenstein\r\n\r\nIn class ModelTechnologyMapperTest (tests\/TechnologyMapperTest.php).\r\nMissing, *parent::setUp()*.\r\n\r\n{code}\r\n<?php\r\nclass ModelTechnologyMapperTest extends ControllerTestCase\r\n{\r\n\r\n    \/**\r\n     * @var Default_Model_TechnologyMapper\r\n     *\/\r\n    protected $_mapper;\r\n\r\n    public function setUp() {\r\n        parent::setUp(); \/\/ add\r\n        $this->_mapper = new Default_Model_TechnologyMapper();\r\n    }\r\n\r\n    public function tearDown() {\r\n        $this->_mapper->getDbTable()\r\n            ->delete(array(\"order_index = ?\" => -101));\r\n        $this->_mapper->getDbTable()\r\n            ->delete(array(\"order_index = ?\" => -100));\r\n    }\r\n\r\n    public function testDbTableProperty() {\r\n        $this->assertClassHasAttribute(\"_dbTable\", \"Default_Model_TechnologyMapper\");\r\n    }\r\n}\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ramon",
                        "name": "ramon",
                        "displayName": "Ramon Henrique Ornelas",
                        "active": true
                    },
                    "created": "2010-07-01T10:27:58.000+0000",
                    "updated": "2010-07-01T10:27:58.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8087\/transitions"
}