{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10839",
    "key": "ZF-10839",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Subclasses of HeadMeta view helper could implement new meta types more easily by refactoring a single preg_match() pattern into a protected member."
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10839\/votes",
                "votes": 2,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=papayasoft",
                "name": "papayasoft",
                "displayName": "David Weinraub",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-12-16T23:07:43.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-02-13T21:03:34.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "A recent question on StackOverflow asked about how to make the HeadMeta view helper output a tag like:\r\n\r\n&lt;meta property=\"mykey\" content=\"myvalue\"&gt;\r\n\r\nEssentially, adding a new \"property\" as a new type of meta key.\r\n\r\nThe solution - subclassing HeadMeta - is straight-forward enough:\r\n\r\n1. Modify the preg_match pattern used in the __call() method\r\n2. Override the protected member $_keyTypes\r\n3. Override the protected method _normalizeType(). \r\n\r\nBut the preg_match pattern used in Zend_View_Helper_HeadMeta::__call() method is inline. To override it, the subclass ends up duplicating nearly the entire __call method, simply to change the pattern from:\r\n\r\n'\/^(?P<action>set|(pre|ap)pend|offsetSet)(?P<type>Name|HttpEquiv)$\/'\r\n\r\nto \r\n\r\n'\/^(?P<action>set|(pre|ap)pend|offsetSet)(?P<type>Name|HttpEquiv|Property)$\/'\r\n\r\nIt would be easier if this pattern were refactored out into a protected member. Then subclass would only have to override the protected member rather than duplicate so much of the parent's__call() method.\r\n\r\nJust a thought... \r\n\r\nThanks and cheers! ;-)"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10839\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10501",
                    "id": 10501,
                    "description": "Mini Release",
                    "name": "1.11.1",
                    "userReleaseDate": "30\/Nov\/10",
                    "archived": false,
                    "releaseDate": "2010-11-30",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10026",
                    "id": 10026,
                    "name": "Zend_View",
                    "description": "View portion of the ZF MVC",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43634",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=papayasoft",
                        "name": "papayasoft",
                        "displayName": "David Weinraub",
                        "active": true
                    },
                    "body": "I have a patch (based on what I currently see in trunk, r23526) that implements the change:\r\n\r\n# This patch file was generated by NetBeans IDE\r\n# It uses platform neutral UTF-8 encoding and \\n newlines.\r\n--- Base (BASE)\r\n+++ Locally Modified (Based On LOCAL)\r\n@@ -42,6 +42,7 @@\r\n     protected $_typeKeys     = array('name', 'http-equiv', 'charset');\r\n     protected $_requiredKeys = array('content');\r\n     protected $_modifierKeys = array('lang', 'scheme');\r\n+    protected $_callPattern  = '\/^(?P<action>set|(pre|ap)pend|offsetSet)(?P<type>Name|HttpEquiv)$\/';\r\n \r\n     \/**\r\n      * @var string registry key\r\n@@ -125,7 +126,7 @@\r\n      *\/\r\n     public function __call($method, $args)\r\n     {\r\n-        if (preg_match('\/^(?P<action>set|(pre|ap)pend|offsetSet)(?P<type>Name|HttpEquiv)$\/', $method, $matches)) {\r\n+        if (preg_match($this->_callPattern, $method, $matches)) {\r\n             $action = $matches['action'];\r\n             $type   = $this->_normalizeType($matches['type']);\r\n             $argc   = count($args);\r\n\r\nBut I confess to being such a noob that I'm not sure that I even created\/submitted the patch right. And I regret that I do not have unit-testing for the framework all set up on my dev environment. Please be kind. ;-)\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=papayasoft",
                        "name": "papayasoft",
                        "displayName": "David Weinraub",
                        "active": true
                    },
                    "created": "2010-12-16T23:14:00.000+0000",
                    "updated": "2010-12-16T23:14:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43635",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=papayasoft",
                        "name": "papayasoft",
                        "displayName": "David Weinraub",
                        "active": true
                    },
                    "body": "I obviously botched the patch submission. Obviously needed some wiki markup. D'oh.\r\n\r\nTrying again. As before, patch relative to r23526:\r\n\r\n{noformat}\r\n# This patch file was generated by NetBeans IDE\r\n# It uses platform neutral UTF-8 encoding and \\n newlines.\r\n--- Base (BASE)\r\n+++ Locally Modified (Based On LOCAL)\r\n@@ -42,6 +42,7 @@\r\n     protected $_typeKeys     = array('name', 'http-equiv', 'charset');\r\n     protected $_requiredKeys = array('content');\r\n     protected $_modifierKeys = array('lang', 'scheme');\r\n+    protected $_callPattern  = '\/^(?P<action>set|(pre|ap)pend|offsetSet)(?P<type>Name|HttpEquiv)$\/';\r\n \r\n     \/**\r\n      * @var string registry key\r\n@@ -125,7 +126,7 @@\r\n      *\/\r\n     public function __call($method, $args)\r\n     {\r\n-        if (preg_match('\/^(?P<action>set|(pre|ap)pend|offsetSet)(?P<type>Name|HttpEquiv)$\/', $method, $matches)) {\r\n+        if (preg_match($this->_callPattern, $method, $matches)) {\r\n             $action = $matches['action'];\r\n             $type   = $this->_normalizeType($matches['type']);\r\n             $argc   = count($args);\r\n\r\n{noformat}\r\n\r\nAaah, well that's a little better. ;-)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=papayasoft",
                        "name": "papayasoft",
                        "displayName": "David Weinraub",
                        "active": true
                    },
                    "created": "2010-12-16T23:21:33.000+0000",
                    "updated": "2010-12-16T23:21:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43873",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=papayasoft",
                        "name": "papayasoft",
                        "displayName": "David Weinraub",
                        "active": true
                    },
                    "body": "Correct spelling error in the title.  (In the title, for crying out loud! I need to be more careful)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=papayasoft",
                        "name": "papayasoft",
                        "displayName": "David Weinraub",
                        "active": true
                    },
                    "created": "2010-12-30T21:37:36.000+0000",
                    "updated": "2010-12-30T21:37:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44365",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chris.lu",
                        "name": "chris.lu",
                        "displayName": "Weber Chris",
                        "active": true
                    },
                    "body": "There is a method \"appendProperty\" in the headMeta helper that could be used for this\r\nLink to documentation that shows an example: http:\/\/framework.zend.com\/manual\/en\/zend.view.helpers.html#zend.view.helpers.initial.headmeta\r\n\r\nUnfotunatly it doesn't work because the helper only allows this for xhtml1_rdfa doctypes, if you want to use it on your html5 website because for example you want to include the facebook iLike button you should extend the headMeta helper and override the _isValid Method\r\n\r\ni replaced those lines:\r\n\r\n{code}\r\n        \/\/ <meta property= ... \/> is only supported with doctype RDFa\r\n        if (!$this->view->doctype()->isRdfa()\r\n            && $item->type === 'property') {\r\n            return false;\r\n        }\r\n{code}\r\n\r\nwith these lines:\r\n\r\n{code}\r\n        \/\/ <meta property= ... \/> is only supported with doctype RDFa and doctype HTML5\r\n        if (!$this->view->doctype()->isRdfa() && $item->type === 'property' &&\r\n            !$this->view->doctype()->isHtml5() && $item->type === 'property') {\r\n            return false;\r\n        }\r\n{code}\r\n\r\nyou could use this code:\r\n\r\n{code}\r\n\r\nclass myHeadMeta extends Zend_View_Helper_HeadMeta {\r\n\r\n    \/**\r\n     * Determine if item is valid\r\n     *\r\n     * @param  mixed $item\r\n     * @return boolean\r\n     *\/\r\n    protected function _isValid($item)\r\n    {\r\n        if ((!$item instanceof stdClass)\r\n            || !isset($item->type)\r\n            || !isset($item->modifiers))\r\n        {\r\n            return false;\r\n        }\r\n\r\n        if (!isset($item->content)\r\n        && (! $this->view->doctype()->isHtml5()\r\n        || (! $this->view->doctype()->isHtml5() && $item->type !== 'charset'))) {\r\n            return false;\r\n        }\r\n\r\n        \/\/ <meta property= ... \/> is only supported with doctype RDFa\r\n        if (!$this->view->doctype()->isRdfa() && $item->type === 'property' &&\r\n            !$this->view->doctype()->isHtml5() && $item->type === 'property') {\r\n            return false;\r\n        }\r\n\r\n        return true;\r\n    }\r\n\r\n}\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chris.lu",
                        "name": "chris.lu",
                        "displayName": "Weber Chris",
                        "active": true
                    },
                    "created": "2011-02-13T11:44:25.000+0000",
                    "updated": "2011-02-13T11:45:15.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44367",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=papayasoft",
                        "name": "papayasoft",
                        "displayName": "David Weinraub",
                        "active": true
                    },
                    "body": "Well, I'm clearly a total bonehead. I was looking at an earlier version.\r\n\r\n[Side note: Pleased to see that the implementation of \"appendProperty()\" is pretty much as I was suggesting: per modification of the regex in the \"__call()\" method.]\r\n\r\nStill, I guess this resolves the issue, eh?\r\n\r\nThanks and cheers!\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=papayasoft",
                        "name": "papayasoft",
                        "displayName": "David Weinraub",
                        "active": true
                    },
                    "created": "2011-02-13T21:03:18.000+0000",
                    "updated": "2011-02-13T21:03:18.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10839\/transitions"
}