{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7736",
    "key": "ZF-7736",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Re-design of Highlight Term gathering by use of a  temporary in-memory Indexer (patch)"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/2",
                "name": "New Feature",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7736\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=corvuscorax",
                "name": "corvuscorax",
                "displayName": "Corvus Corax",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-08-31T09:06:00.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-11-21T08:11:22.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "bugfix",
                "error",
                "highlight",
                "highlighting",
                "index",
                "indexer",
                "memory",
                "patch",
                "temp"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Search result highlighting in ZEND Lucene is a problem.\n\nThe way Lucene gathers to be highlighted strings, by cascading through internal _highlightMatches() methods in all the different Zend_Search_Lucene_Search_Query_... classes, often re-tokenizing the entire to be highlighted text, is very slow, error prone, and usually duplicates code from the rewrite() methods in the same classes.\n\nThis method of doing things is also is a blocker for some nifty features I did with other patches, dealing with multi-token ability (among th cool features related to stem and synonym searches that are listed in the current code behind @todo: lines) since they require calls to the rewrite() method of newly created sub queries, which is no problem when coming from a rewrite() method, but does not work within  _highlightMatches() due to the unavailability of an indexer.\n\nNo longer !\n\nThis patch re-designs how highlighting terms are gathered, simply using rewrite()->getQueryTerms().\n\nTo be able to rewrite in the first place, the to be highlighted text needs to be stored in an index.\nWhile in 99.99% of all cases those texts would be in the main search index, the class definition calls for the highlight function to be index independent.\n\nRightfully so :)\n\nTherefore I wrote a \"dummy index class\", which implements the whole Zend_Search_Lucene_Interface, but does not write to a real Lucene index on disk, instead stores an index simulated by PHP assotiative arrays in memory.\n\nclass Zend_Search_Lucene_TempIndex\n\nI gave Query->highlightMatches an optional 5th parameter to supply a different index to be used in rewrite(). Without that, the TempIndex is instantiated, the to be highlighted document added with ->addDocument, and then used for rewrite().\n\nThen I removed all the _highlightMatches() functions from all Query Classes ;)\n\nRegards\n\nCorvus Corax\n\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/2",
                "name": "Critical"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7736\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/4",
                "name": "Reopened"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User"
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-7738",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7738",
                    "type": {
                        "name": "Dependency",
                        "direction": "INBOUND",
                        "description": "is dependecy of"
                    }
                },
                {
                    "issueKey": "ZF-7519",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7519",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12178",
                    "filename": "TempIndexHighlighting.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=corvuscorax",
                        "name": "corvuscorax",
                        "displayName": "Corvus Corax",
                        "active": true
                    },
                    "created": "2009-08-31T09:06:45.000+0000",
                    "size": 49572,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12178\/TempIndexHighlighting.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10360",
                    "id": 10360,
                    "description": "Minor Release",
                    "name": "1.10.0",
                    "userReleaseDate": "27\/Jan\/10",
                    "archived": false,
                    "releaseDate": "2010-01-27",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10021",
                    "id": 10021,
                    "name": "Zend_Search_Lucene",
                    "description": "pure PHP robust, general purpose text search engine",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34186",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=corvuscorax",
                        "name": "corvuscorax",
                        "displayName": "Corvus Corax",
                        "active": true
                    },
                    "body": "While reading ZF-2598 I just noticed that it might be necessary to use a different analyzer for indexing of the to-be highlighted text and for rewrite()-ing the search query to get the highlighting tokens.\n\nWould it make sense to give $query->highlightMatches() an additional parameter to override the analyzer used to tokenize the html string?\n\nWhat do you think? Would be an easy enough change to this patch.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=corvuscorax",
                        "name": "corvuscorax",
                        "displayName": "Corvus Corax",
                        "active": true
                    },
                    "created": "2009-09-02T08:23:02.000+0000",
                    "updated": "2009-09-02T08:23:02.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/52467",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "body": "Bulk change of all issues last updated before 1st January 2010 as \"Won't Fix\".\r\n\r\nFeel free to re-open and provide a patch if you want to fix this issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "created": "2012-11-20T20:52:49.000+0000",
                    "updated": "2012-11-20T20:52:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/52914",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=corvuscorax",
                        "name": "corvuscorax",
                        "displayName": "Corvus Corax",
                        "active": true
                    },
                    "body": "Bug has been closed by default in \"Bulk change\". However patch is already attached to bug, what has been missing is a maintainer",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=corvuscorax",
                        "name": "corvuscorax",
                        "displayName": "Corvus Corax",
                        "active": true
                    },
                    "created": "2012-11-21T08:11:22.000+0000",
                    "updated": "2012-11-21T08:11:22.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7736\/transitions"
}