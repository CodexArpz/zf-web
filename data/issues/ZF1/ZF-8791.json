{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8791",
    "key": "ZF-8791",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Error: Pdf file syntax error. 'startxref' keyword expected. Offset - 0x2180."
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8791\/votes",
                "votes": 2,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10470",
                    "id": 10470,
                    "description": "Mini Release",
                    "name": "1.10.6",
                    "userReleaseDate": "22\/Jun\/10",
                    "archived": false,
                    "releaseDate": "2010-06-22",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-05-27T06:11:08.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gkamp",
                "name": "gkamp",
                "displayName": "Gerrit Kamp",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-01-12T12:21:54.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-05-27T12:43:06.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend_Pdf_Parser gives an error on line 440: $this->_stringParser->readLexeme();\r\n\r\nThe parser works fine on my local Windows XP development machine, but it crashes on my Ubuntu 8.04 Linux server. The code is exactly identical on both machines, and so is the PDF file that I am loading with Zend_Pdf::load().\r\n\r\nThe error stack is below:\r\n\r\nError: Pdf file syntax error. 'startxref' keyword expected. Offset - 0x2180.\r\n\r\n#0 \/home\/mvm_stevens\/www_mvm\/library\/Zend\/Pdf.php(303): Zend_Pdf_Parser->__construct('\/home\/mvm_steve...', Object(Zend_Pdf_ElementFactory_Proxy), true)\r\n#1 \/home\/mvm_stevens\/www_mvm\/library\/Zend\/Pdf.php(253): Zend_Pdf->__construct('\/home\/mvm_steve...', NULL, true)\r\n#2 \/home\/mvm_stevens\/www_mvm\/application\/models\/Report\/Pdf.php(15): Zend_Pdf::load('\/home\/mvm_steve...')\r\n#3 \/home\/mvm_stevens\/www_mvm\/application\/controllers\/ReportsController.php(102): Report_Pdf->loadTemplate('10_slf_mon1_tem...')\r\n#4 \/home\/mvm_stevens\/www_mvm\/application\/controllers\/ReportsController.php(38): ReportsController->createReport(Array)\r\n#5 \/home\/mvm_stevens\/www_mvm\/library\/Zend\/Controller\/Action.php(513): ReportsController->initialrepAction()\r\n#6 \/home\/mvm_stevens\/www_mvm\/library\/Zend\/Controller\/Dispatcher\/Standard.php(289): Zend_Controller_Action->dispatch('initialrepActio...')\r\n#7 \/home\/mvm_stevens\/www_mvm\/library\/Zend\/Controller\/Front.php(946): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))\r\n#8 \/home\/mvm_stevens\/www_mvm\/application\/bootstrap.php(56): Zend_Controller_Front->dispatch()\r\n#9 \/home\/mvm_stevens\/www_mvm\/index.php(11): Bootstrap->runApp()\r\n#10 {main}\r\n\r\nI outcommented the lines 440 until 453 in Parser.php and echoed the content of $data to the browser, to see if the PDF file is properly read with the 'fread' function, and the output almost identical. The Ubuntu machine seems to recognize more characters. For example, the Windows version showed the following as the 2nd line:\r\n%\ufffd\ufffd\ufffd\ufffd\r\nand Ubuntu showed:\r\n%\u00e2\u00e3\u00cf\u00d3\r\n\r\nAnybody any ideas what is going on or what I can do to get the Ubuntu server load these PDF files?\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8791\/watchers",
                "isWatching": false,
                "watchCount": 7
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                "name": "padraic",
                "displayName": "P\u00e1draic Brady",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13050",
                    "filename": "Zend_Pdf_StringParser.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                        "name": "htbaa",
                        "displayName": "Christiaan Kras",
                        "active": true
                    },
                    "created": "2010-05-02T23:53:41.000+0000",
                    "size": 760,
                    "mimeType": "text\/x-diff",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13050\/Zend_Pdf_StringParser.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10390",
                    "id": 10390,
                    "description": "Mini Release",
                    "name": "1.9.6",
                    "userReleaseDate": "24\/Nov\/09",
                    "archived": false,
                    "releaseDate": "2009-11-24",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10020",
                    "id": 10020,
                    "name": "Zend_Pdf",
                    "description": "pure PHP manipulation engine for composing PDFs",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37711",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaib",
                        "name": "kaib",
                        "displayName": "Kai Bielenberg",
                        "active": true
                    },
                    "body": "I had the same issue. The problem in my case was that i configure mbstring.func_overload to use mbstring functions instead of the normal string functions. Try something like this to see if this is also your problem:\r\n\r\nini_set('mbstring.internal_encoding', 'ASCII');\r\n$pdf = Zend_Pdf::load('my.pdf');\r\nini_set('mbstring.internal_encoding', 'UTF-8');",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaib",
                        "name": "kaib",
                        "displayName": "Kai Bielenberg",
                        "active": true
                    },
                    "created": "2010-01-15T02:52:38.000+0000",
                    "updated": "2010-01-15T02:52:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38482",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=miko",
                        "name": "miko",
                        "displayName": "Michael Kofler",
                        "active": true
                    },
                    "body": "mbstring setting didn't help for me\r\n\r\nPDF handling worked flawless both with zf 1.5.1 (ubuntu 8.04) and zf 1.9.4 (ubuntu 9.10); \r\n\r\nzend 10.1 on ubuntu 8.04 did not work (error as described above), so I went back to 1.5.1 on this machine",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=miko",
                        "name": "miko",
                        "displayName": "Michael Kofler",
                        "active": true
                    },
                    "created": "2010-02-16T06:33:14.000+0000",
                    "updated": "2010-02-16T06:33:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38519",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nicolascormier",
                        "name": "nicolascormier",
                        "displayName": "Nicolas CORMIER",
                        "active": true
                    },
                    "body": "Exact same issue as Michael...\r\n\r\nUbuntu 8.04.3 and Zend 10.1",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nicolascormier",
                        "name": "nicolascormier",
                        "displayName": "Nicolas CORMIER",
                        "active": true
                    },
                    "created": "2010-02-17T17:07:38.000+0000",
                    "updated": "2010-02-17T17:07:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38580",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=yaroslav.golovach",
                        "name": "yaroslav.golovach",
                        "displayName": "Yaroslav Golovach",
                        "active": true
                    },
                    "body": "I've encountered the same problem on one domain hosting based on linux. I tried zf 1.5.1 and some versions between 1.5.1 and 10.1 but nothing helped. Zf 1.5.1 displayed another problem than \"'startxref' keyword expected\" (I haven't written it down) but it also failed.\r\n\r\nAfter some investigation I discovered that code at line 440 $this->_stringParser->readLexeme() is actually expected to read 'startxhref' word from pdf file. But in fact it reads 'startxhre' (without 'f' at the end) so exception is thrown.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=yaroslav.golovach",
                        "name": "yaroslav.golovach",
                        "displayName": "Yaroslav Golovach",
                        "active": true
                    },
                    "created": "2010-02-19T08:45:32.000+0000",
                    "updated": "2010-02-19T08:45:32.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39164",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quintinventer",
                        "name": "quintinventer",
                        "displayName": "Quintin Venter",
                        "active": true
                    },
                    "body": "We had a similar issue. \r\n\r\nOn my Windows machine running Zend 1.9.6 and Php 5.2.8 it all worked fine. We then rolled it out to our live systems where it only works on one of the two Ubuntu machines.\r\n\r\nI was tasked with figuring out what is happening here. We found that our one system is runnin PHP 5.2.4 and the other is running 5.2.5 both with Zend 1.9.6.\r\n\r\nThe one running 5.2.5 is working fine but the one with 5.2.4 is giving us the problems.\r\n\r\nI then had a look at the StringParser.php. In there you will find that Zend 1.9.6 checks for \\f as one of the white space characters. This is not supported in version 5.2.4 yet (http:\/\/php.net\/ChangeLog-5.php). So I had to go do a version check and adjust the data parser.\r\n\r\nYou want to go to line 267 and replace it with the following block of code:\r\n\r\n$compare = \"\";\r\nif ( version_compare( phpversion(), '5.2.5' ) >= 0 ) { \/\/ this version added support for the escaped form feed character\r\n      $compare = \"()<>[]{}\/%\\x00\\t\\n\\f\\r \";\r\n} else {\r\n      $compare = \"()<>[]{}\/%\\x00\\t\\n\\r \";\r\n}\r\n\r\n$this->offset += strcspn($this->data, $compare, $this->offset); \r\n\r\nHope this solves your problem.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quintinventer",
                        "name": "quintinventer",
                        "displayName": "Quintin Venter",
                        "active": true
                    },
                    "created": "2010-03-11T08:05:50.000+0000",
                    "updated": "2010-03-11T08:05:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39165",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=yaroslav.golovach",
                        "name": "yaroslav.golovach",
                        "displayName": "Yaroslav Golovach",
                        "active": true
                    },
                    "body": "Thanks a lot, Quintin.\r\n\r\nYour fix works great :).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=yaroslav.golovach",
                        "name": "yaroslav.golovach",
                        "displayName": "Yaroslav Golovach",
                        "active": true
                    },
                    "created": "2010-03-11T08:38:17.000+0000",
                    "updated": "2010-03-11T08:38:17.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39667",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                        "name": "htbaa",
                        "displayName": "Christiaan Kras",
                        "active": true
                    },
                    "body": "Could this be fixed and backported to 1.9.7 (1.9.8 perhaps?) as the minimum requirement for ZF is PHP 5.2.4 and not PHP 5.2.5.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                        "name": "htbaa",
                        "displayName": "Christiaan Kras",
                        "active": true
                    },
                    "created": "2010-03-31T02:12:58.000+0000",
                    "updated": "2010-03-31T02:12:58.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40348",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                        "name": "htbaa",
                        "displayName": "Christiaan Kras",
                        "active": true
                    },
                    "body": "This is a serious showstopper. Could this PLEASE be fixed ASAP so we don't have to patch StringParser.php ourselves? This fix is here, please apply it.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                        "name": "htbaa",
                        "displayName": "Christiaan Kras",
                        "active": true
                    },
                    "created": "2010-05-02T23:45:01.000+0000",
                    "updated": "2010-05-02T23:45:01.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40349",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                        "name": "htbaa",
                        "displayName": "Christiaan Kras",
                        "active": true
                    },
                    "body": "This patch applies to Zend_Pdf_StringParser of ZendFramework 1.10.4",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                        "name": "htbaa",
                        "displayName": "Christiaan Kras",
                        "active": true
                    },
                    "created": "2010-05-02T23:53:50.000+0000",
                    "updated": "2010-05-02T23:53:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40677",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                        "name": "htbaa",
                        "displayName": "Christiaan Kras",
                        "active": true
                    },
                    "body": "I'm sorry for spamming this issue, but could this fix be applied before the next mini-release?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                        "name": "htbaa",
                        "displayName": "Christiaan Kras",
                        "active": true
                    },
                    "created": "2010-05-25T04:11:38.000+0000",
                    "updated": "2010-05-25T04:11:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40723",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "Sorry for the delay guys, I'm not a Zend_Pdf maintainer but I noticed your Devzone comment ;). Ask, and thou shalt receive! So I reviewed the patch. Fix looks good so I've applied it in r22311. Worth noting, there are always devs around on our regular bug hunt days - if there are other patches anyone needs applying you can grab us on IRC at those times for assistance.\r\n\r\nWill apply this to the release branch soon for next mini-release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2010-05-27T06:11:08.000+0000",
                    "updated": "2010-05-27T06:11:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40725",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                        "name": "htbaa",
                        "displayName": "Christiaan Kras",
                        "active": true
                    },
                    "body": "Thanks for resolving this, much appreciated.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                        "name": "htbaa",
                        "displayName": "Christiaan Kras",
                        "active": true
                    },
                    "created": "2010-05-27T06:48:45.000+0000",
                    "updated": "2010-05-27T06:48:45.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40726",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quintinventer",
                        "name": "quintinventer",
                        "displayName": "Quintin Venter",
                        "active": true
                    },
                    "body": "Thanks a mil.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quintinventer",
                        "name": "quintinventer",
                        "displayName": "Quintin Venter",
                        "active": true
                    },
                    "created": "2010-05-27T06:57:54.000+0000",
                    "updated": "2010-05-27T06:57:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40740",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mkliewe",
                        "name": "mkliewe",
                        "displayName": "Michael Kliewe",
                        "active": true
                    },
                    "body": "Thank you for applying it, Padraic.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mkliewe",
                        "name": "mkliewe",
                        "displayName": "Michael Kliewe",
                        "active": true
                    },
                    "created": "2010-05-27T12:43:06.000+0000",
                    "updated": "2010-05-27T12:43:06.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8791\/transitions"
}