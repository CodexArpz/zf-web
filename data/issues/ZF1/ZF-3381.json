{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3381",
    "key": "ZF-3381",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Incorrect month definition using 'setDate' method"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField",
            "value": {
                "timeestimate": 0,
                "timespent": 180
            }
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3381\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10240",
                    "id": 10240,
                    "description": "Minor Release",
                    "name": "1.6.0",
                    "userReleaseDate": "02\/Sep\/08",
                    "archived": false,
                    "releaseDate": "2008-09-02",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-06-05T03:38:49.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arthurpro",
                "name": "arthurpro",
                "displayName": "Art Pro",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-06-04T04:52:27.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-09-02T10:38:58.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I'm using setDate method to parse date to get unix timestamp as follows:\n{color:green}$date->setDate('6\/1\/2008', 'M\/d\/Y');{color}\nIt works fine on some linux platforms but has a bug on others.\nIf I want to parse a date with month set to one which has number of days less than 31 it adds 1 to month number.\nSay, if I parse '2\/10\/2008', '4\/15\/2008', '6\/22\/2008' it always returns timestamp with month set to 3, 5, 7 accordingly.\nI've got a solution for this bug. I've made a little modification to 'Zend_Date' class, '_date' method.\nThere are three lines which set the date in three steps as follows:\n{color:green}$date->set($parsed['year'], Zend_Date::YEAR);\n$date->set($parsed['month'], Zend_Date::MONTH);\n$date->set($parsed['day'], Zend_Date::DAY);{color}\nThe order of the last two lines should be changed to fix the bug as follows:\n{color:green}$date->set($parsed['year'], Zend_Date::YEAR);{color}\n{color:red}$date->set($parsed['day'], Zend_Date::DAY);\n$date->set($parsed['month'], Zend_Date::MONTH);{color}\nThe first line sets date to the defined year, month 12 and day 31. The second sets date to the defined day and the last sets date to the defined month.\nWe cannot set month before day because when we set year it sets default day number to 31. Then if we set month which has 30 days (April, June...) it switches month to the next one (May, July...) and day number to 1.\n\nPlease fix this in official release."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3381\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/worklog\/21603",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3381",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "comment": "Bug hunting, fixed timezone problems for special dates within xxxDates methods.",
                    "created": "2008-06-05T03:39:37.000+0000",
                    "updated": "2008-06-05T03:39:37.000+0000",
                    "started": "2008-06-05T03:38:00.000+0000",
                    "minutesSpent": 180
                }
            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10181",
                    "id": 10181,
                    "description": "Mini Release",
                    "name": " 1.5.2",
                    "userReleaseDate": "15\/May\/08",
                    "archived": true,
                    "releaseDate": "2008-05-15",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10072",
                    "id": 10072,
                    "name": "Zend_Date",
                    "description": "Zend_Date is the basic library for the handling of all date, time and calendar-related issues.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22112",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Where is your problem ?\nCan you give us a example with code which shows the problem ? What you get, what you expected, the release, php version, os and so on...\nWhy should setting the 1.June respond in such a problem as you described ?\n\n\nBut: When you set 31.February you will ALWAYS get the 2 or 3rd May.\nThis is no failure but expected behaviour and documented within the manual.\nI believe there is an option where you can switch off the overlapping for months.\n\n\nWhen you set a impossible date, Zend_Date will always automatically correct this.\nAs your change introduces problems with existing code it will not be added to trunk.\n\nWhat would you expect to get returned when you set a 32.Feburary ?? ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-06-04T05:09:03.000+0000",
                    "updated": "2008-06-04T05:09:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22113",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arthurpro",
                        "name": "arthurpro",
                        "displayName": "Art Pro",
                        "active": true
                    },
                    "body": "PHP Version 5.2.4, Zend Framework 1.0.2 and 1.5.2 (both), Linux 2.6.24.5-g-r17 #1 SMP\nExact test case is\n{color:red}$date = new Zend_Date();\n$date->setDate('6\/1\/2008', 'M\/d\/Y');\nprint $date->toString('M\/d\/Y');\n\/\/ retruns \"7\/1\/2008\" and same problem with other months which have less than 31 days{color}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arthurpro",
                        "name": "arthurpro",
                        "displayName": "Art Pro",
                        "active": true
                    },
                    "created": "2008-06-04T05:29:39.000+0000",
                    "updated": "2008-06-04T05:29:39.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22114",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I am not able to reproduce your behaviour with trunk.\nWhen you are willing to test I would recommend that you\n\n * install the trunk release (9600 or higher)\n * run this example:\n{code}\n$date = new Zend_Date();\nprint \"\\n\".$date->getIso();\n$date->setDate('6\/1\/2008', 'M\/d\/Y');\nprint \"\\n\".$date->getIso();\n{code}\n\n * when it fails please return the output\n * additionally run and return the output of the following:\n{code}\nprint_r (Zend_Locale_Format::getDate('6\/1\/2008', array('date_format' => 'M\/d\/Y', 'format_type' => 'iso'));\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-06-04T05:52:42.000+0000",
                    "updated": "2008-06-04T05:52:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22116",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arthurpro",
                        "name": "arthurpro",
                        "displayName": "Art Pro",
                        "active": true
                    },
                    "body": "Updated to revision 9605. The problem is still there.\nHere is my code:\n{noformat}<pre>\n<?\nrequire_once('.\/Zend\/Date.php');\n\n$date = new Zend_Date();\nprint \"\\n\".$date->getIso();\n$date->setDate('6\/1\/2008', 'M\/d\/Y');\nprint \"\\n\".$date->getIso();\nprint \"\\n\\n\";\nprint_r(Zend_Locale_Format::getDate('6\/1\/2008', array('date_format' => 'M\/d\/Y', 'format_type' => 'iso')));\n?>\n{noformat}\n\nAnd here is return:\n{noformat}2008-06-04T08:27:02-05:00\n2008-07-01T08:27:02-05:00\n\nArray\n(\n    [date_format] => M\/d\/Y\n    [locale] => \n    [month] => 6\n    [day] => 1\n    [year] => 2008\n)\n{noformat}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arthurpro",
                        "name": "arthurpro",
                        "displayName": "Art Pro",
                        "active": true
                    },
                    "created": "2008-06-04T06:30:57.000+0000",
                    "updated": "2008-06-04T06:30:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22117",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Ok... now it gets durty :-)\n\nDate.php:\nline 2924: add \"print \"\\n\".$date->getIso();\" below.\nAlso below 2925, 2926, 2927 and 2928\n\nAlso output me your locale $locale from line 2924.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-06-04T06:38:54.000+0000",
                    "updated": "2008-06-04T06:38:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22119",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arthurpro",
                        "name": "arthurpro",
                        "displayName": "Art Pro",
                        "active": true
                    },
                    "body": "Output is now\n{noformat}\n2008-06-04T09:02:33-05:00\n1969-12-31T18:00:00-06:00\n$locale = en_US\n2008-12-31T18:00:00-06:00\n2008-07-01T18:00:00-05:00\n2008-07-01T18:00:00-05:00\nTuesday, July 1, 2008\n2008-07-01T09:02:33-05:00\n\nArray\n(\n    [date_format] => M\/d\/Y\n    [locale] => \n    [month] => 6\n    [day] => 1\n    [year] => 2008\n)\n{noformat}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arthurpro",
                        "name": "arthurpro",
                        "displayName": "Art Pro",
                        "active": true
                    },
                    "created": "2008-06-04T07:04:06.000+0000",
                    "updated": "2008-06-04T07:04:06.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22131",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Ok... problem found.\n\nPlease change line 2924 so it looks like this:\n{code}\n            $date = new self(0, self::TIMESTAMP, $locale);\n            $date->setTimezone('UTC');\n{code}\n\nThis should fix your problem.\nPlease test it and give me the result.\n\nThanks...",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-06-04T11:53:03.000+0000",
                    "updated": "2008-06-04T11:53:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22143",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arthurpro",
                        "name": "arthurpro",
                        "displayName": "Art Pro",
                        "active": true
                    },
                    "body": "Yes, this fixes the bug:\n{noformat}2008-06-05T04:18:35-05:00\n1970-01-01T00:00:00+00:00\n$locale = en_US\n2008-01-01T00:00:00+00:00\n2008-06-01T00:00:00+00:00\n2008-06-01T00:00:00+00:00\nSunday, June 1, 2008\n2008-06-01T04:18:35-05:00\n\nArray\n(\n    [date_format] => M\/d\/Y\n    [locale] => \n    [month] => 6\n    [day] => 1\n    [year] => 2008\n){noformat}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arthurpro",
                        "name": "arthurpro",
                        "displayName": "Art Pro",
                        "active": true
                    },
                    "created": "2008-06-05T02:20:55.000+0000",
                    "updated": "2008-06-05T02:20:55.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22144",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "The fix has been added with r9612",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-06-05T03:38:25.000+0000",
                    "updated": "2008-06-05T03:38:25.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23956",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "Updating for the 1.6.0 release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-09-02T10:38:58.000+0000",
                    "updated": "2008-09-02T10:38:58.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3381\/transitions"
}