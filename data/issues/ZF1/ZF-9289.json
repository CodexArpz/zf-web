{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9289",
    "key": "ZF-9289",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Filter_Input incorrect generation of validation errors"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/11",
                "name": "Patch",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9289\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10880",
                    "id": 10880,
                    "description": "Mini Release",
                    "name": "1.11.9",
                    "userReleaseDate": "14\/Jul\/11",
                    "archived": false,
                    "releaseDate": "2011-07-14",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-07-13T19:48:56.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                "name": "erangalp",
                "displayName": "Eran Galperin",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-02-27T20:59:38.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-10-13T17:09:36.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend_Filter_Input has incorrect behavior for handling custom error messages configured via the 'messages' meta-command and applying a 'presence' meta-command on a field validator declaration. This issue extends ZF-8446 and covers additional erroneous behavior.\r\n\r\nUsing the following sample code:\r\n\r\n{code:java}\r\n<?php\r\n\/\/ .. Require framework classes ..\r\n\r\n$data = array(\r\n  \"title\" => \"\",\r\n  \"project_id\" => \"\",\r\n  \"reporter_id\" => \"18\",\r\n  \"assigned_id\" => \"0\",\r\n  \"type\" => \"1\",\r\n  \"priority\" => \"2\",\r\n  \"tags\" => \"\",\r\n  \"description\" => \"\",\r\n  \"reproduce\" => \"\"\r\n);\r\n\r\n$validators = array(\r\n    'title' => array('NotEmpty','messages' => 'Please enter issue title'),\r\n    'description' => array('NotEmpty','messages' => 'Please enter issue description'),\r\n    'reproduce' => array('NotEmpty','presence' => 'optional'),\r\n    'browsers' => array('NotEmpty','presence' => 'optional'),\r\n    'os' => array('NotEmpty','presence' => 'optional'),\r\n    'status' => array('Digits','presence' => 'optional'),\r\n    'type' => 'Digits',\r\n    'priority' => 'Digits',\r\n    'project_id' => array('Digits','messages' => 'Please select project'),\r\n    'reporter_id' => array('Digits','messages' => 'Please select issue reporter'),\r\n    'assigned_id' => array('NotEmpty','presence' => 'optional','allowEmpty' => true)\r\n);\r\n\r\n$options = array('presence' => 'required','missingMessage' => \"Please fill the required field '%field%'\");\r\n$input = new Zend_Filter_Input(null,$validators,$data,$options);\r\n\r\n$input -> isValid();\r\necho '<pre>';\r\nvar_dump($input -> getMessages());\r\necho '<\/pre>';\r\n{code}\r\n\r\nThe expected output: (works in ZF 1.7.6)\r\n{code}\r\narray(3) {\r\n  [\"title\"]=> array(1) {\r\n    [\"isEmpty\"]=>\r\n    string(24) \"Please enter issue title\"\r\n  }\r\n  [\"description\"]=> array(1) {\r\n    [\"isEmpty\"]=>\r\n    string(30) \"Please enter issue description\"\r\n  }\r\n  [\"project_id\"]=> array(1) {\r\n    [\"stringEmpty\"]=>\r\n    string(21) \"Please select project\"\r\n  }\r\n}\r\n{code}\r\n\r\nThe actual output: (1.10 trunk)\r\n{code}\r\narray(4) {\r\n  [\"title\"] => array(1) {\r\n    [\"isEmpty\"] => string(24) \"Please enter issue title\"\r\n  }\r\n  [\"description\"] => array(1) {\r\n    [\"isEmpty\"] => string(30) \"Please enter issue description\"\r\n  }\r\n  [\"reproduce\"] => array(1) {\r\n    [\"isEmpty\"] => string(30) \"Please enter issue description\"\r\n  }\r\n  [\"project_id\"] => array(1) {\r\n    [\"isEmpty\"] => string(30) \"Please enter issue description\"\r\n  }\r\n}\r\n{code}\r\n\r\nThe last two returned messages are incorrect and an error message is returned for a valid field ('reproduce'), which has a 'presence' => 'optional' modifier (which works for some of the other fields). Zend_Filter_Input message handling has been buggy for several major revisions (since the 1.7 version), might be worth to see where it went wrong."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9289\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                "name": "mcleod@spaceweb.nl",
                "displayName": "Bart McLeod",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-11819",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11819",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                },
                {
                    "issueKey": "ZF-11142",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11142",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13827",
                    "filename": "Input.php.patch2",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-04-12T11:36:57.000+0000",
                    "size": 1474,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13827\/Input.php.patch2"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13830",
                    "filename": "Input.php.patch3",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-04-13T11:31:53.000+0000",
                    "size": 1804,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13830\/Input.php.patch3"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13828",
                    "filename": "InputTest.php.patch2",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-04-12T11:36:57.000+0000",
                    "size": 2310,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13828\/InputTest.php.patch2"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13831",
                    "filename": "InputTest.php.patch3",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-04-13T11:31:53.000+0000",
                    "size": 3961,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13831\/InputTest.php.patch3"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10540",
                    "id": 10540,
                    "description": "Mini Release",
                    "name": "1.11.4",
                    "userReleaseDate": "03\/Mar\/11",
                    "archived": false,
                    "releaseDate": "2011-03-03",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10180",
                    "id": 10180,
                    "name": "Zend_Filter_Input",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39252",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Regarding \"reproduce\":\r\nThe error is correct and not wrong.\r\n\r\nYou defined that \"reproduce\" is optional, but when it's available it has to be \"NotEmpty\"... as the field \"reproduce\" is available the validator checks if it's not empty... but it is empty, and therefor the error is returned also for the field \"reproduce\".",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-03-15T13:55:12.000+0000",
                    "updated": "2010-03-15T13:55:12.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39258",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "body": "Yes, you are correct, my mistake. However, the error returned is not correct (it uses the 'messages' definition from another field)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "created": "2010-03-15T17:10:36.000+0000",
                    "updated": "2010-03-15T17:10:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40284",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "body": "Is there any progress on this? this component still can't be used reliably in current versions of the framework",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "created": "2010-04-28T14:39:49.000+0000",
                    "updated": "2010-04-28T14:39:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45630",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "I added a related issue, if you go there, you will find a patch that solves the problem with the wrong error message.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-03-27T20:57:05.000+0000",
                    "updated": "2011-03-27T20:57:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45631",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "I changed it from bug to patch, because you can find a patch in the related issue. If Ralph nor Thomas finds the time to review the patch, I will commit it very soon.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-03-27T20:58:39.000+0000",
                    "updated": "2011-03-27T20:58:39.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45635",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "The fix is in svn now.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-03-28T10:10:56.000+0000",
                    "updated": "2011-03-28T10:10:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45638",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "body": "Thanks Bart.\r\nThis fix almost fixes the problem - it does restore the default error message and prevents overwriting. There is another problem that is fleshed out now that this is fixed and might deserve a separate issue report - if you declare a validator in the chain that has hidden dependencies (many validators also apply the 'NotEmpty' validator - 'Digits' for example), the 'messages' meta-command is again ignored and the default of the dependencies is used instead.\r\n\r\nSo if I have something like:\r\n\r\n{code:java}\r\n$validators = array(\r\n    'status' => array('Digits','messages' => 'Please select your status')\r\n);\r\n{code}\r\n\r\nIf 'status' has an empty value, I will get the 'NotEmpty' default message  - \r\n{quote}You must give a non-empty value for field 'status'{quote}\r\n\r\nInstead of the error message defined in the 'messages' meta-command. On the other hand if I specify the 'NotEmpty' validator explicitly\r\n\r\n{code:java}\r\n$validators = array(\r\n    'status' => array('NotEmpty','Digits','messages' => 'Please select your status')\r\n);\r\n{code}\r\n\r\nI can now control the error message returned by an empty value. I think it's fair to say this is not the expected behavior (and it's undocumented)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "created": "2011-03-28T10:57:59.000+0000",
                    "updated": "2011-03-28T10:59:16.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45640",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "Thanks for your fast feedback Eran.\r\n\r\nI think I disagree with you here. In your first example of your last comment: If you want to yield the message 'Please select your status', you should provide an invalid digit, such as 'a'. In that case, the Digits validator should trigger the custom message that you supplied. If instead, you supply nothing, I think it is reasonable that Zend_Filter_Input resorts to the default message for empty values that are required.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-03-28T12:09:02.000+0000",
                    "updated": "2011-03-28T12:09:02.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45641",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "body": "I would argue that an empty string is still not a digit. This behavior is not expected - it took me a while to figure out I could override it by adding manually the 'NotEmpty' validator, and I imagine others would have the same problem (though it seems that Zend_Filter_Input is not in common use). Ideally, I could configure the 'Digits' validator to avoid the 'NotEmpty' check, but since it is not the case I'd expect it to use my custom error instead of providing a default override for something I didn't require.\r\n\r\nIt seems like a case of trying to reuse classes where it's not needed - the 'Digits' validator (and others) could have performed the check for an empty string internally and returned the custom error message attached to that validator. Instead it uses the 'NotEmpty' validator which is both unexpected and complicates matters regarding error messages.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "created": "2011-03-28T12:57:13.000+0000",
                    "updated": "2011-03-28T12:57:13.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45654",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "I think I get your point to some extend, although I must admit that I myself do not use Zend_Filter_Input in my daily work. By fixing this bug I gained some understanding of the component, but I am not the designer or owner of the component.\r\n\r\nWhat I understand from your last comment is that you would want every validator to check for not empty by itself and not let Zend_Filter_Input interfere with that. The obvious advantages of that approach would be that Zend_Filter_Input could be simpler internally, while becoming more predictable externally at the same time.\r\n\r\nApart from that I personnaly find that intermixing metacommands and validators is not a great feature. It takes us away from the initial Keep It Simple approach that should be typical of Zend Framework components.\r\n\r\nHowever: simplifying this would likely break BC.\r\n\r\nI am willing to take a second look at this, but I think you should create a separate issue for that and inform me of that.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-03-29T07:00:34.000+0000",
                    "updated": "2011-03-29T07:00:34.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45658",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "body": "I'm not necessarily saying that each validator should check if it receives a non-empty string - just that if it does, it should be internally. Personally, I don't expect 'Digits' to fail on an empty string - if I want to check for non-empty values, I would add a 'NotEmpty' validator to the chain. The current behavior is not obvious and hard to override unless you know its kinks (like I unfortuntely already do).\r\n\r\nI'll just mention that I'm still using an old version of Zend_Filter_Input that works perfectly (I think it's ver. 1.6). Not sure what happened to it since ver. 1.7, but it has become much harder to generate correct error output from it.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "created": "2011-03-29T08:42:36.000+0000",
                    "updated": "2011-03-29T08:42:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45660",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "Thanks again for your feedback. Could you specify exactly what in this particular case 'perfectly' would mean to you in terms of expected behavior and based on which part of the manual (please add citation) you base the expectation.\r\n\r\nI would like to make sure that if I change the behavior of Zend_Filter_Input in any way, this change would meet your expectations and that those expectations are based on documented behavior, rather than on how an older version of the component used to behave.\r\n\r\nThe old behavior may have been accidental and now that you have become used to it, you regard it as perfect? I am not saying this is the case, I just want to make sure that I really understand your use case and the meaning of expected and perfect in this context. Because I do not frequently use the component I do not yet have a feel for what natural or expected behavior would be in this particular case.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-03-29T08:55:57.000+0000",
                    "updated": "2011-03-29T08:55:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45662",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "body": "First I'd like to thank you Bart, for pursuing this issue. I'd given up that it would be fixed since it seems efforts are geared towards ZF 2.0.\r\n\r\nI went over the source again (haven't looked at it for a while) to understand exactly what is the problem. I think I have it better defined now -\r\nZend_Filter_Input has the 'allowEmpty' meta-command set to false by default. This causes a 'NotEmpty' check to be made for each validator by default, even if it's not explicitly defined in the validation chain. This check is made using the 'NotEmpty' validator before the defined validator is run, overriding error messages defined for the validator in question.\r\n\r\nThis is mentioned briefly in the manual as well (under the ALLOW_EMPTY meta-command), but the way it's described leads you to believe that the 'NotEmpty' check would be made only if no validators are defined for the field in question.\r\n\r\nSo what I'd expect in this case is one of two things - \r\n* Either the ALLOW_EMPTY meta-command should be set to true by default as not to add validation checks not defined by the developer\r\n* Or the defined validator runs before the 'NotEmpty' check allowing it to output its own error messages. In the case of the 'Digits' validator mentioned previously, it does have an internal check for a non-empty value and would have returned the defined error message (expected behavior). I would add that in my opinion it should return custom error message defined for the validator even if it uses the 'NotEmpty' validator internally.\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "created": "2011-03-29T10:06:52.000+0000",
                    "updated": "2011-03-29T10:07:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45663",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "body": "Another thing that I wanted to add - part of the problem with the 'allowEmpty' meta-command is that it overrides defined 'NotEmpty' validators in the chain. I'd expect it to apply only if there are no such validators defined.\r\n\r\n{code}\r\n$data = array('name' => '');\r\n\r\n$validators = array(\r\n    'name' => 'NotEmpty'\r\n);\r\n\r\n$options = array('allowEmpty' => true);\r\n$filter = new Zend_Filter_Input(null,$validators,$data,$options);\r\n\r\nif($filter -> isValid()) {\r\n\/\/Validation passes, even though we have an explicit 'NotEmpty' validator defined\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "created": "2011-03-29T10:40:28.000+0000",
                    "updated": "2011-03-29T10:40:28.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45664",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "This is a complicated subject. What is troubling me is that there is still a mix in the expectations you describe, between what is documented and what you find is reasonable.\r\n\r\nFrom a performance perspective, it is wise to run the NotEmpty validators before any others, because if they break the chain, then the more expensive validations do not have to run. It is still easy to add a message for the not empty situation by adding a notempty validator.\r\n\r\nI agree that if setting AllowEmpty to true for the overall chain, this should not apply if you explicitly add a NotEmpty validator nor if you explicitly use the metacommand 'presence' => 'required' for a specific validation rule. This should only affect the fact that by default, everything has to be present.\r\n\r\nAgain, these bugs or improvements should be in separate issues, so that they can be managed seperately, by people that understand the specific issue, this will also help people to add comments where appropriate.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-03-29T11:06:16.000+0000",
                    "updated": "2011-03-29T11:06:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45858",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "I am reopening the issue, because I looked into to the issue with ALLOW_EMPTY and I agree with Eran, that even if each field is allowed empty by default, we should still disallow them to be empty if a NotEmpty validator is found in the ruleset. \n\nI fixed this issue and will attach patches. The patches will wait for your evaluation for a few days. After this time, they will be committed into svn if no one has complained.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-04-12T11:34:44.000+0000",
                    "updated": "2011-04-12T11:34:44.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45859",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "Attached two patches, with a patch2 extension. Do not worry about the extension.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-04-12T11:36:57.000+0000",
                    "updated": "2011-04-12T11:36:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45864",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "The previous patches still had a problem: the bug would persist if you would use a string 'NotEmpty' instead of a Zend_Validate_NotEmpty instance. I supplied new patches, with a patch3 extension that fix this issue. You no longer need the *.patch2",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-04-13T11:31:53.000+0000",
                    "updated": "2011-04-13T11:31:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45870",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "I will commit the resolution as it is in the *.patch3 files.\n\nThomas, I think my previous fix didn't make it into the 1.11.5 release. How should I go about to get fixes into the next mini release?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-04-14T20:29:09.000+0000",
                    "updated": "2011-04-14T20:29:09.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45873",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "body": "I've tested it and clears all of the use-cases I previously had problems with. I really appreciate your help on this, Bart",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erangalp",
                        "name": "erangalp",
                        "displayName": "Eran Galperin",
                        "active": true
                    },
                    "created": "2011-04-14T21:59:16.000+0000",
                    "updated": "2011-04-14T21:59:16.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45882",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Check if the fix is within branch.\nIf it is then it will be automatically integrated in the next release.\n\nAdditionally I am reopening this issue for integration within ZF2.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2011-04-16T20:49:23.000+0000",
                    "updated": "2011-04-16T20:49:23.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47353",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "Was this merged to the release 1.11 branch?\r\n\r\nAlso, you can close this if it has been and follow ZF2-27 for integration in 2.x.\r\n\r\n-ralph",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2011-07-05T14:08:07.000+0000",
                    "updated": "2011-07-05T14:08:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47473",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "None of my fixes have been merged it seems. Is this something I should do myself? I had the (wrong?) idea that the component owner would take care of such responsible work, but I am willing to track my fixes back and merge all of them.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-07-12T17:13:28.000+0000",
                    "updated": "2011-07-12T17:13:28.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47491",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Bart:\r\nCan you please merge your changes to branch, add the svn release as note and then close this issue.\r\nZF2 will be done by another issue in this case.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2011-07-13T09:24:57.000+0000",
                    "updated": "2011-07-13T09:24:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47492",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "Merged all fixes for Zend_Filter_Input and unit test into 1.11 branch",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-07-13T11:06:07.000+0000",
                    "updated": "2011-07-13T11:06:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47493",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "Merged into 1.11 branch",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-07-13T11:06:24.000+0000",
                    "updated": "2011-07-13T11:06:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47499",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Bart:\r\nWhich svn release?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2011-07-13T19:43:57.000+0000",
                    "updated": "2011-07-13T19:43:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47500",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Fixing assignment as Bart did the work",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2011-07-13T19:47:48.000+0000",
                    "updated": "2011-07-13T19:47:48.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47501",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "body": "this specific fix was in svn release 23861\r\nfurther fixes (different issue) in 23862, which is the version I merged into the 1.11 branch",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mcleod@spaceweb.nl",
                        "name": "mcleod@spaceweb.nl",
                        "displayName": "Bart McLeod",
                        "active": true
                    },
                    "created": "2011-07-13T20:06:56.000+0000",
                    "updated": "2011-07-13T20:06:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48065",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Added to ZF2 with GH-273\r\nPlease note that there are still known issues with the provided patch within ZF1 which have been solved within ZF2 by Matthew",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2011-08-25T19:12:48.000+0000",
                    "updated": "2011-08-25T19:12:48.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9289\/transitions"
}