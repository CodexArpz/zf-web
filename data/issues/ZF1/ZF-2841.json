{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2841",
    "key": "ZF-2841",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Cache_Frontend_Page and Redirector : add header redirect saving support to Zend_Cache_Frontend_Page"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2841\/votes",
                "votes": 2,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10240",
                    "id": 10240,
                    "description": "Minor Release",
                    "name": "1.6.0",
                    "userReleaseDate": "02\/Sep\/08",
                    "archived": false,
                    "releaseDate": "2008-09-02",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-05-24T14:34:38.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                "name": "quazardous",
                "displayName": "David Berlioz",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-03-10T10:03:00.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-09-02T10:38:59.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "snapshot : 8205\n\nI m using Zend_Cache_Frontend_Page and Redirector (action helper).\n\nthe first time a page is generated, the redirection (gotoRouteAndExit) goes fine, but when the page is called from the cache, \"of course\" the header 'redirect' is not present...\n\nIt will be interesting to add more header support to Zend_Cache_Frontend_Page and of course redirection headers.\n\nbest regards"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2841\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                "name": "fab",
                "displayName": "Fabien MARTY",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11301",
                    "filename": "frontend-page.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gspeicher",
                        "name": "gspeicher",
                        "displayName": "Geoff Speicher",
                        "active": true
                    },
                    "created": "2008-05-22T12:36:54.000+0000",
                    "size": 1401,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11301\/frontend-page.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11320",
                    "filename": "Page.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "created": "2008-06-05T01:18:07.000+0000",
                    "size": 13342,
                    "mimeType": "application\/x-httpd-php5",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11320\/Page.php"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10028",
                    "id": 10028,
                    "name": "Zend_Cache",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21191",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "body": "I agree with you\n\nWe will work on this part soon",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "created": "2008-04-19T03:26:34.000+0000",
                    "updated": "2008-04-19T03:26:34.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21866",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gspeicher",
                        "name": "gspeicher",
                        "displayName": "Geoff Speicher",
                        "active": true
                    },
                    "body": "Other important headers (Expires, for example) are also not preserved. This effectively prevents you from caching a far-future expiring document (YSlow recommendation #3).\n\nIs there any good reason not to preserve every response header for cached pages (possibly by default)?  I cannot think of a situation where a cached copy of a document would be expected to have different headers than the original.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gspeicher",
                        "name": "gspeicher",
                        "displayName": "Geoff Speicher",
                        "active": true
                    },
                    "created": "2008-05-21T07:01:09.000+0000",
                    "updated": "2008-05-21T07:01:09.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21872",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "body": "I just commited into SVN trunk a new option in Frontend_Page backend :\n\n{code}\n     * ====> (array) memorize_headers :\n     * - an array of strings corresponding to some HTTP headers name. Listed headers\n     *   will be stored with cache datas and \"replayed\" when the cache is hit\n{code}\n\nCan you try it ?\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "created": "2008-05-21T10:47:38.000+0000",
                    "updated": "2008-05-21T10:47:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21891",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gspeicher",
                        "name": "gspeicher",
                        "displayName": "Geoff Speicher",
                        "active": true
                    },
                    "body": "This patch fixes two issues in rev 9496:\n\n1. correctly spell \"strtolower\"\n2. don't truncate header contents that contains a colon\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gspeicher",
                        "name": "gspeicher",
                        "displayName": "Geoff Speicher",
                        "active": true
                    },
                    "created": "2008-05-22T12:36:54.000+0000",
                    "updated": "2008-05-22T12:36:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21892",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "body": "your patch is added to my source tree (thanks)\n\nSVN is down but I will commit it soon",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "created": "2008-05-22T12:58:13.000+0000",
                    "updated": "2008-05-22T12:58:13.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21916",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "body": "fixed in SVN trunk",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "created": "2008-05-24T14:34:37.000+0000",
                    "updated": "2008-05-24T14:34:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21948",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gspeicher",
                        "name": "gspeicher",
                        "displayName": "Geoff Speicher",
                        "active": true
                    },
                    "body": "works for me, thanks.  (i didn't test it for \"redirect\" which is what this issue was primarily meant to address, so maybe the original author could verify that this works for him as well.)\n\nmight still be nice to have a \"standard\" set of preserved headers, or at least a well-documented set of headers that are generally desirable to preserve.  cache troubleshooting is bad enough without having to locate issues related to unexpected\/varying HTTP response headers...\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gspeicher",
                        "name": "gspeicher",
                        "displayName": "Geoff Speicher",
                        "active": true
                    },
                    "created": "2008-05-26T18:36:41.000+0000",
                    "updated": "2008-05-26T18:36:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22093",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "body": "hi,\n\nGreat job ;p\n\njust one thing : the way it's implemented (split header on ':') makes impossible to deal 404 header (in ex) ...\n\nbest regard",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "created": "2008-06-03T01:02:53.000+0000",
                    "updated": "2008-06-03T01:02:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22094",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "body": "re-hi,\n\nfor the default set of header, maybe a \"keep all headers\" option would do it...",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "created": "2008-06-03T01:07:19.000+0000",
                    "updated": "2008-06-03T01:07:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22100",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "body": "can you provide an example ?\n\n{{{code}}}\n\nto send a 404 header, you don't use this :\n\nheader(\"Status: 404 Not Found\"); \n\n?\n\n{{{code}}}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "created": "2008-06-03T10:16:06.000+0000",
                    "updated": "2008-06-03T10:16:06.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22104",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "body": "hi,\n\na quick search on g***** says :\n\nheader(\"HTTP\/1.0 404 Not Found\");\n\nand ...\n\nheader(\"Status: 404 Not Found\"); \n\nthe 2nd form seams to have some compatibility issue\n\nhttp:\/\/bugs.php.net\/bug.php?id=32122\n\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "created": "2008-06-03T23:46:45.000+0000",
                    "updated": "2008-06-03T23:46:45.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22109",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "body": "hi,\n\nsorry for me it does not work.\n\nI m in MVC mode and the headers are never stored !\n\n[code]\n    public function _flush($data)\n    {\n        if ($this->_cancel) {\n            return $data;\n        }\n        $contentType = null;\n        $storedHeaders = array();\n         header('Pragma: public');\n        if (headers_sent()) {\n\/\/never here because the headers are not sent....\n        \t$buffer.='sent';\n            $headersList = headers_list();\n            foreach($this->_specificOptions['memorize_headers'] as $key=>$headerName) {\n            \t$buffer.='m='.$headerName.';';\n               foreach ($headersList as $headerSent) {\n                \t$buffer.=$headerSent.'-';\n      \n                    $tmp = split(':', $headerSent);\n                    $headerSentName = trim(array_shift($tmp));\n                    if (strolower($headerName) == strtolower($headerSentName)) {\n                        $headerSentValue = trim(implode(':', $tmp));\n                        $storedHeaders[] = array($headerSentName, $headerSentValue);\n                    }\n\n                }\n            }\n        }\n        $array = array(\n            'data' => $data,\n            'headers' => $storedHeaders\n        );\n        $this->save($array);\n        return $data;\n    }\n[\/code]\n\nand if I can put an advise :\nlooping on the headers to store and over looping on the header sent is a lack of time.\nif you want to store 10 headers and if they are 20 headers sent you loop 200 times... it's 180 too many.\n\n1st step :\ncreate a temporary array of wanted header in strtolower format\n\n2nd step : loop over header list (without checking if it's sent or not) \nif(eregi('^([^:])[:]', $headerLine, $regs) )\n$headerSentName=strtolower($regs[1]);\nelse {  \/* special cases *\/ }\nand check with in_array in the wanted header ()...\n\nand storing the whole header is easyer than all the split stuff.... (and maybe there can be multiple occurencies one special header)\n\nbest regard\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "created": "2008-06-04T03:45:33.000+0000",
                    "updated": "2008-06-04T03:45:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22115",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gspeicher",
                        "name": "gspeicher",
                        "displayName": "Geoff Speicher",
                        "active": true
                    },
                    "body": "Regarding HTTP Status header: the problem applies only to PHP3 (at least according to the link you provided).  Clearly PHP3 is not supported by Zend Framework and we should therefore prefer \"Status: 404 Not Found\" to the alternative.\n\nRegarding your MVC example not working: it's a chicken and egg problem.  You have to manually construct the list of headers you want to preserve.  I too originally thought it would be nice to have the ability to automatically store all of the headers using headers_list(), but after giving it some thought I don't know if it's a good idea.  There are some headers that should usually not be stored, such as Date, Server, X-Powered-By, and Set-Cookie, to name a few.\n\nRegarding inefficiency of the nested loop in the implementation: you're absolutely correct.  One way to improve it without using eregi() is to first iterate over _specificOptions['memorize_headers'] to force keys to lowercase, then iterate over headersList, and for each header do the split + strtolower() and use array_key_exists() to check for the key in _specificOptions['memorize_headers'].  I don't think there is any way to send multiple occurrences of a header, as PHP is advertised to replace rather than append.  I would make and post a patch but svn is down and I don't have up-to-date sources...\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gspeicher",
                        "name": "gspeicher",
                        "displayName": "Geoff Speicher",
                        "active": true
                    },
                    "created": "2008-06-04T06:13:36.000+0000",
                    "updated": "2008-06-04T06:13:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22141",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "body": "I ve found multiple occurrencies of Cache-Control: ...\n\nI think it's not the goal of the cache layer to add header rules. The cache layer must just mimic the page engine...\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "created": "2008-06-05T01:14:56.000+0000",
                    "updated": "2008-06-05T01:14:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22142",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "body": "here is what works with me.... (9566 on snapshot).\n\nit's ereg free and uses explode in place of split... and it stores the whole header ;p\n\nmaybe it could be improved with an ereg pattern filter in place of just a fixed string match...\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=quazardous",
                        "name": "quazardous",
                        "displayName": "David Berlioz",
                        "active": true
                    },
                    "created": "2008-06-05T01:18:08.000+0000",
                    "updated": "2008-06-05T01:18:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23961",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "Updating for the 1.6.0 release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-09-02T10:38:59.000+0000",
                    "updated": "2008-09-02T10:38:59.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2841\/transitions"
}