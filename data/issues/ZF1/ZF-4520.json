{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4520",
    "key": "ZF-4520",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Convenience class for creating Set-Cookie HTTP headers"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4520\/votes",
                "votes": 32,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10510",
                    "id": 10510,
                    "description": "Minor Release",
                    "name": "1.12.0",
                    "userReleaseDate": "27\/Aug\/12",
                    "archived": false,
                    "releaseDate": "2012-08-27",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10160",
                    "id": 10160,
                    "description": "Major Release",
                    "name": "Next Major Release",
                    "archived": false,
                    "released": false
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-05-09T15:27:41.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-10-08T05:16:20.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-05-09T15:27:41.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Currently in ZF MVC applications, cookie management is still handled via the superglobal $_COOKIE; we provide no means to simplify or abstract this -- which is leading to issues when attempting to test applications that make use of cookies.\r\n\r\nThe Response object needs the following methods:\r\n* addCookie()\r\n* addCookies()\r\n* setCookies()\r\n* getCookie()\r\n* getCookies()\r\n* removeCookie()\r\n* clearCookies()"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4520\/watchers",
                "isWatching": false,
                "watchCount": 28
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "FixForZF1.12",
                "state:patch-ready-for-review",
                "zf-caretaker-adamlundrigan",
                "zf-crteam-review"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                "name": "adamlundrigan",
                "displayName": "Adam Lundrigan",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/15070",
                    "filename": "bf2a50.png",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-08T03:20:56.000+0000",
                    "size": 143678,
                    "mimeType": "image\/png",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/15070\/bf2a50.png",
                    "thumbnail": "http:\/\/fw02.zend.com\/issues\/secure\/thumbnail\/15070\/_thumb_15070.png"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11695",
                    "filename": "CookiesToMVCResponse.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=doctorrock83",
                        "name": "doctorrock83",
                        "displayName": "julien PAULI",
                        "active": true
                    },
                    "created": "2009-01-03T04:23:16.000+0000",
                    "size": 4390,
                    "mimeType": "text\/x-diff",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11695\/CookiesToMVCResponse.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11702",
                    "filename": "Zend_Controller_Response_Http.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=doctorrock83",
                        "name": "doctorrock83",
                        "displayName": "julien PAULI",
                        "active": true
                    },
                    "created": "2009-01-14T15:04:58.000+0000",
                    "size": 4220,
                    "mimeType": "text\/x-diff",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11702\/Zend_Controller_Response_Http.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/14721",
                    "filename": "ZF-4520_v1.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2011-11-04T18:52:27.000+0000",
                    "size": 26813,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/14721\/ZF-4520_v1.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/14966",
                    "filename": "ZF-4520_v2.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-03-14T22:16:18.000+0000",
                    "size": 34869,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/14966\/ZF-4520_v2.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/15069",
                    "filename": "ZF-4520_v3.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-08T03:19:34.000+0000",
                    "size": 39872,
                    "mimeType": "text\/x-diff",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/15069\/ZF-4520_v3.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10011",
                    "id": 10011,
                    "name": "Zend_Controller",
                    "description": "front controller, including router and dispatcher",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27743",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=doctorrock83",
                        "name": "doctorrock83",
                        "displayName": "julien PAULI",
                        "active": true
                    },
                    "body": "A patch has been uploaded.\n\nIt is just a begining throwing ideas : CookieJar needs to be refactored\nInspired from Zend_Http_Response.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=doctorrock83",
                        "name": "doctorrock83",
                        "displayName": "julien PAULI",
                        "active": true
                    },
                    "created": "2009-01-03T04:23:19.000+0000",
                    "updated": "2009-01-03T04:23:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28184",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "This patch looks really good. If you can supply unit tests as well, please go ahead and commit directly to trunk; if not, let me know so I can get it on my backlog.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2009-01-14T10:33:19.000+0000",
                    "updated": "2009-01-14T10:33:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28219",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=doctorrock83",
                        "name": "doctorrock83",
                        "displayName": "julien PAULI",
                        "active": true
                    },
                    "body": "Zend_Http_CookieJar patch provided at r13641.\nFor Zend_Controller_Response_Http cookie handling, I suggest one thing :\n\nZend_Controller_* in HTTP environment (response and request object) should have a bridge to use Zend_Http_* stuff.\nThat makes more dependencies, and that' not very good, anyway, that could improve code reuse.\n\nThink about that :\n{code}\n\/\/ Zend_Controller_Front\npublic function cookieFactory($name, $value, $expires = null, $path = null)\n    {\n        $request = $this->getRequest();\n        if (!$request instanceof Zend_Controller_request_Http) { \n            throw new Zend_Controller_Exception('Cookie can only be generated in HTTP environment');\n        }\n        return new Zend_Http_Cookie($name, $value, $request->getHttpHost() , $expires, $path, $request->isSecure());\n    }\n\n\/\/ somewhere else\n$response->setCookie(Zend_Controller_Front::getInstance()->cookieFactory('foo','bar');\n\/\/ or, from an action, providing a method in HTTP environement :\n$this->setResponseCookie('foo', 'bar');\n\/\/ or again, (see the second patch)\n$response->setCookie('foo','bar'); \/\/ uses ZC_Front idea to generate a cookie\n{code}\n\nAnd then refactor Zend_Controller_Response_Http from the first patch idea to the one attached as the second patch to that comment",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=doctorrock83",
                        "name": "doctorrock83",
                        "displayName": "julien PAULI",
                        "active": true
                    },
                    "created": "2009-01-14T15:04:35.000+0000",
                    "updated": "2009-01-14T15:04:35.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28220",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=doctorrock83",
                        "name": "doctorrock83",
                        "displayName": "julien PAULI",
                        "active": true
                    },
                    "body": "Second idea of patch attached",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=doctorrock83",
                        "name": "doctorrock83",
                        "displayName": "julien PAULI",
                        "active": true
                    },
                    "created": "2009-01-14T15:05:00.000+0000",
                    "updated": "2009-01-14T15:05:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38092",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lcf",
                        "name": "lcf",
                        "displayName": "Alexander Steshenko",
                        "active": true
                    },
                    "body": "It's been a while since the last comment, but I'd like to continue the discussion on this issue.\r\n\r\nThe idea of making front controller aware of the cookies is kinda wrong of course because it's protocol specific and has nothing to do with it, but, we still need an easy way to set cookies.\r\n\r\nNow, people usually do setcookies(), and I don't like it at all, because it is out of the Response object context. It breaks the OOP design.\r\n\r\nWhat I do know (it might look ugly, but I still prefer this way) is:\r\n\r\n{code}\r\n        \/\/ Setting page cookie header\r\n        $expires = new Zend_Date();\r\n        $expires->addSecond($pageCookieLifetime);\r\n\r\n        \/\/ And here we go:\r\n        $this->getResponse()->setHeader('Set-Cookie',\r\n            'page=' . $page->getCode() . '; '\r\n            . 'expires=' . $expires->get(Zend_Date::COOKIE) . '; '\r\n            . 'path=\/'\r\n        );\r\n{code}\r\n\r\nand besides that there shouldn't be many cookies set, it is still uncomfortable.\r\n\r\nI *could* use an instance of Zend_Http_Cookie and it would be much more comfortable (and, probably enough for me) but I *can't* do so, because of current state of Zend_Http_Cookie::__toString method:\r\n\r\n{code}\r\n    \/**\r\n     * Get the cookie as a string, suitable for sending as a \"Cookie\" header in an\r\n     * HTTP request\r\n     *\r\n     * @return string\r\n     *\/\r\n    public function __toString()\r\n    {\r\n        return $this->name . '=' . urlencode($this->value) . ';';\r\n    }\r\n{code}\r\n\r\nwhich _does not_ include path, domain, expires parts. Why? I'd suggest to add them as the easiest and the fastest what we can do.\r\n\r\nThough would be nice to have this part of the framework (Cookie, CookieJar) fully refactored.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lcf",
                        "name": "lcf",
                        "displayName": "Alexander Steshenko",
                        "active": true
                    },
                    "created": "2010-01-28T10:02:20.000+0000",
                    "updated": "2010-01-28T10:02:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38548",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaioptera",
                        "name": "kaioptera",
                        "displayName": "SP",
                        "active": true
                    },
                    "body": "This is a very simple feature that would be great to have but seems to be languishing in the home stretch for some reason. Can it be resolved or reassigned to someone who will close it out?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaioptera",
                        "name": "kaioptera",
                        "displayName": "SP",
                        "active": true
                    },
                    "created": "2010-02-18T11:32:51.000+0000",
                    "updated": "2010-02-18T11:32:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38708",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=keilnoth",
                        "name": "keilnoth",
                        "displayName": "Eric Jeker",
                        "active": true
                    },
                    "body": "I implemented the solution to a local *_Controller_Response_Http class but changed the _sendCookies() method to avoid the Zend_Http_Cookie::__toString() :\r\n\r\n{noformat}\r\n     \/**\r\n      * Appends the cookies in the cookiejar\r\n      * to raw headers\r\n      *\r\n      *\/\r\n     protected function _sendCookies()\r\n     {\r\n         if (!$this->_cookieJar->isEmpty()) {\r\n             $cookies = $this->_cookieJar->getAllCookies();\r\n             \r\n             foreach ($cookies as $cookie)  {\r\n                 setcookie( $cookie->getName(),\r\n                            $cookie->getValue(),\r\n                            $cookie->getExpiryTime(),\r\n                            $cookie->getPath(),\r\n                            $cookie->getDomain(),\r\n                            $cookie->isSecure());\r\n             }\r\n         }\r\n     }\r\n{noformat}\r\n\r\nShall I create a new issue for the Zend_Http_Cookie::__toString() which is described as suitable for HTTP but is not ? The Zend_Http_Cookie class does not include a isHttpOnly() method that could be useful to completely define the cookie.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=keilnoth",
                        "name": "keilnoth",
                        "displayName": "Eric Jeker",
                        "active": true
                    },
                    "created": "2010-02-24T02:35:56.000+0000",
                    "updated": "2010-02-24T02:35:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39975",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mithras",
                        "name": "mithras",
                        "displayName": "Jurian Sluiman",
                        "active": true
                    },
                    "body": "This issue op open for a while and many people would like to have this feature implemented. As far as I have read the comments and patches, two things cross my mind:\r\n\r\n1) Two patches are provided, both patching the same class and both having the same changes to the api. Their difference is the inner working. Which one is the best and can the other be removed? As far as I can see the Zend_Controller_Response_Http.patch is the most preferred to use.\r\n\r\n2) Whilst the patch uses Zend_Http_Cookie and Zend_Http_CookieJar, in the comments it's argued it's not possible to use them because of a problem with Zend_Http_Cookie::__toString().\r\nThe patch shows it uses Zend_Http_CookieJar::getAllCookies() together with Zend_Http_CookieJar::COOKIE_STRING_CONCAT which makes it possible to use the return string in a http header. So I can conclude it's now possible to set cookies OOP style with the Reponse object, using a Zend_Http_Cookie?\r\n\r\nIf all I said is true, the only step required to implement this, is providing unit tests? ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mithras",
                        "name": "mithras",
                        "displayName": "Jurian Sluiman",
                        "active": true
                    },
                    "created": "2010-04-15T12:07:44.000+0000",
                    "updated": "2010-04-15T12:07:44.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40902",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=danker",
                        "name": "danker",
                        "displayName": "Duncan Anker",
                        "active": true
                    },
                    "body": "I have just stumbled across this issue, having spent a joyous few hours discovering that it's not possible to unit test cookie setting.\r\n\r\nI don't believe that patching the response object is the correct thing to do here.\r\n\r\n1) It relies on changing what is supposed to be standard functionality so moving code across platforms would cause it to mysteriously break (never a good thing when you've just moved from development to staging and want to impress your client). Even if the patch is committed to the trunk, it may cause problems if anyone has sub-classed it. That includes the ripple-down effect into the HttpTestCase.\r\n\r\n2) It's marginally better to inherit than patch, although this has the same caveats with respect to sub-classes.\r\n\r\n3) It's too much responsibility. The response object shouldn't be managing cookies.\r\n\r\n4) SetCookie is really just a convenience function to generate the Set-Cookie header. The response object already knows how to send headers, and you wouldn't patch it to provide support for opensocial, firephp, or anything else that may send custom headers.\r\n\r\nIt seems to be a better approach would be to pass the response to the cookie jar and have it set the headers. Or, given that there is already a cookie jar, some kind of mediating object which handles it.\r\n\r\n\r\nOn the subject of the Zend_Http_Cookie implementation, I'm guessing that the short-comings of the __toString() magic method are because it is intended to be used client-side, and clients send only name-value pairs to the server. I can see the logic in that decision, though there probably does need to be some kind of convenience accessor for the entire cookie as required server-side. The other problem I note with it, though only a minor one, is that there is no support for the http_only flag.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=danker",
                        "name": "danker",
                        "displayName": "Duncan Anker",
                        "active": true
                    },
                    "created": "2010-06-08T17:26:58.000+0000",
                    "updated": "2010-06-08T17:26:58.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41357",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=djvirgen",
                        "name": "djvirgen",
                        "displayName": "Hector Virgen",
                        "active": true
                    },
                    "body": "Duncan, I'd have to disagree in that Set-Cookie is not a \"custom\" header since it's part of the HTTP spec.\r\n\r\nhttp:\/\/www.w3.org\/Protocols\/rfc2109\/rfc2109\r\n\r\nIt's more similar to sending redirect headers than it is to sending FirePHP headers. If it's part of the spec and used often, I don't see why it shouldn't be supported by Zend_Controller_Response. \r\n\r\nI wouldn't go so far as to say that the Response would be managing cookies, but rather managing headers (including writing cookies but not reading them). Reading cookies should be managed by Zend_Controller_Request.\r\n\r\nPerhaps an action helper would be the easiest way to manage cookies, which reads cookies from the request and writes cookies to the response. This should make it unit-testable while keeping things organized.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=djvirgen",
                        "name": "djvirgen",
                        "displayName": "Hector Virgen",
                        "active": true
                    },
                    "created": "2010-07-06T13:31:26.000+0000",
                    "updated": "2010-07-06T13:31:26.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48977",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "The main issue with {{Zend_Http_Cookie}} and {{Zend_Http_CookieJar}} is that the are designed almost exclusively for {{Zend_Http_Client}}, and so they only provide methods (mainly __toString) to construct \"Cookie\" header values.  Those classes don't provide methods for creating \"Set-Cookie\" header values.  Perhaps we could backport ZF2's {{Zend\\Http\\Header\\SetCookie}} for this purpose? \r\n\r\nOnce Set-Cookie header value generation is in place, you should easily be able to do something like this from the action controller:\r\n{code}\r\n$this->getResponse()->setHeader('Set-Cookie', new Zend_Http_Header_SetCookie('foo', 'bar', 'example.com'));\r\n{code}\r\n\r\nAs for using cookie values in an action controller, {{Zend_Controller_Request_Http}} does provide a {{getCookie}} method:\r\n{code}\r\n$fooCookieValue = $this->getRequest()->getCookie('foo');\r\n{code}\r\nIs this what you are looking for?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2011-11-03T18:45:50.000+0000",
                    "updated": "2011-11-04T17:30:34.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48995",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "I've attached a patch for a prototype implementation of my previous suggestion (Zend_Http_Header_SetCookie):  !ZF\\-4520_v1.patch!\r\n\r\nUsage Test Case:\r\n{code}\r\npublic function testCanSendSetCookieHeaderUsingProvidedHeaderClass()\r\n{\r\n    $resp = new Zend_Controller_Response_HttpTestCase();\r\n\t\r\n    $cookie = new Zend_Http_Header_SetCookie();\r\n    $cookie->setName('foo')\r\n            ->setValue('bar')\r\n            ->setDomain('example.com')\r\n            ->setHttponly(true);\r\n    $resp->setHeader('Set-Cookie', $cookie->getFieldValue());\r\n\t\r\n    $headers = $resp->sendHeaders();\r\n    $this->assertEquals('Set-Cookie: foo=bar; Domain=example.com; HttpOnly', $headers['set-cookie']);\r\n}\r\n{code}\r\n\r\nReal-World Usage:  (also showing short-hand notation)\r\n{code}\r\n\/\/ From within action controller (Short-hand)\r\n$this->getResponse()->setHeader('Set-Cookie', new Zend_Http_Header_SetCookie('foo','bar','example.com',NULL,NULL,NULL,true));\r\n{code}\r\n\r\nThe {{Zend_Http_Header_SetCookie}} is based on {{Zend\\Http\\Header\\SetCookie}} from ZF2 master, though I suspect that one isn't the most up-to-date implementation as it has some issues (not all set*() methods are fluent, httpOnly is not handled, etc).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2011-11-04T18:52:12.000+0000",
                    "updated": "2011-11-04T18:52:12.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49999",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "It's been more than four months since I made the above suggestion.  If this is something which can be included in ZF 1.12, I can backport the latest {{Zend\\Http\\Header\\SetCookie}} from ZF2 to complete my initial patch.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-03-12T12:21:24.000+0000",
                    "updated": "2012-03-12T12:21:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50007",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Adam -- go for it. Deadline for new features is 23 March 2012; as long as you have it ready by then, it can go in.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2012-03-12T13:45:50.000+0000",
                    "updated": "2012-03-12T13:45:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50043",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Added update version of patch (ZF\\-4520_v2.patch)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-03-14T22:16:19.000+0000",
                    "updated": "2012-03-14T22:16:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50044",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "My new patch backports the latest Zend\\Http\\Header\\SetCookie and it's tests from ZF2, plus some additional tests.  I have some more questions before I proceed:\r\n\r\n1. Should I add the convenience methods to the response object, as outlined in the issue description?  There was some concern in comments above that this would give too much responsibility to the response object.\r\n\r\n2. I believe that the SetCookie implementation in ZF2 still falls victim to ZF2-169.  The fromString method assumes that any key not matching one of the pre-defined key names is the name\/value pair, but the cookie RFCs state that only the first K=V pair can be the cookie name\/value.  I'll whip up a reproduce test case and if my research and hunch are both correct i'll send a ZF2 PR. \r\n\r\nOnce my patch has been reviewed and OKed i'll add the necessary manual page entry\/entries. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-03-14T22:24:05.000+0000",
                    "updated": "2012-03-14T22:24:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50497",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "#2 above has been resolved.  Once I get a chance to whip up a manual page entry for the new code I will commit it all to SVN. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-06T13:04:59.000+0000",
                    "updated": "2012-05-06T13:04:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50518",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Updated patch\r\n\r\n* Rearranged the order of constructor arguments to match PHP's setcookie()\r\n* Added a unit test to ensure {{__toString}} method output is compatible with {{Zend_Controller_Response_Http::setRawHeader}}\r\n* Added a manual page section showing how to use the new class (in {{Zend_Controller-Response.xml}})",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-08T03:19:34.000+0000",
                    "updated": "2012-05-08T03:19:34.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50519",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Screengrab of manual page section\r\n!bf2a50.png!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-08T03:20:57.000+0000",
                    "updated": "2012-05-08T03:21:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50534",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Are there any comments on or concerns with this approach?  Are there any additional use cases that could be covered that I've missed?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-08T22:49:05.000+0000",
                    "updated": "2012-05-08T22:49:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50552",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Adam -- looks good. Go ahead and push to trunk.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2012-05-09T13:15:26.000+0000",
                    "updated": "2012-05-09T13:15:26.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50555",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Fixed in trunk (1.12.0): r24783",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-09T15:27:41.000+0000",
                    "updated": "2012-05-09T15:27:41.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4520\/transitions"
}