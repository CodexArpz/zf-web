{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9345",
    "key": "ZF-9345",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "\"Unknows Definition\" error when sending simple untyped objects"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9345\/votes",
                "votes": 3,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ericheimburg",
                "name": "ericheimburg",
                "displayName": "Eric Heimburg",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-03-05T17:27:26.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-02-04T12:45:34.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I upgraded to PHP 5.3.2 and Zend Framework 1.10.2 at the same time. Afterwards, a simple AMF call that used to work no longer does. When passing several untyped arrays (\"Object\" types from Flex) to the PHP function, the result is the following exception, which makes no sense to me:\r\n\r\n<b>Fatal error<\/b>:  Uncaught exception 'Zend_Amf_Exception' with message 'Unknows Definition reference: 0' in C:\\svn\\zend\\ZendFramework-1.10.2-minimal\\library\\Zend\\Amf\\Parse\\Amf3\\Deserializer.php:304\r\nStack trace:\r\n#0 C:\\svn\\zend\\ZendFramework-1.10.2-minimal\\library\\Zend\\Amf\\Parse\\Amf3\\Deserializer.php(106): Zend_Amf_Parse_Amf3_Deserializer-&gt;readObject()\r\n#1 C:\\svn\\zend\\ZendFramework-1.10.2-minimal\\library\\Zend\\Amf\\Parse\\Amf0\\Deserializer.php(293): Zend_Amf_Parse_Amf3_Deserializer-&gt;readTypeMarker()\r\n#2 C:\\svn\\zend\\ZendFramework-1.10.2-minimal\\library\\Zend\\Amf\\Parse\\Amf0\\Deserializer.php(130): Zend_Amf_Parse_Amf0_Deserializer-&gt;readAmf3TypeMarker()\r\n#3 C:\\svn\\zend\\ZendFramework-1.10.2-minimal\\library\\Zend\\Amf\\Parse\\Amf0\\Deserializer.php(217): Zend_Amf_Parse_Amf0_Deserializer-&gt;readTypeMarker()\r\n#4 C:\\svn\\zend\\ZendFramework-1.10.2-minimal\\library\\Zend\\Amf\\Parse\\Amf0\\Deserializer.php(106): Zend_Amf_Parse_Amf0_Deserializer-&gt;readArray()\r\n#5 C:\\svn\\zend\\ZendFramework-1.10.2-minimal\\library\\Zend\\Amf\\Request.php(173): Zend_Amf_Parse_Amf0_Deseria in <b>C:\\svn\\zend\\ZendFramework-1.10.2-minimal\\library\\Zend\\Amf\\Request.php<\/b> on line <b>176<\/b><br \/>\r\n\r\n\r\nI will attach a skeleton PHP sample that exhibits the behavior. The calling code is a Flex function that looks like so:\r\n\r\n\t\tpublic function login(username:String, password:String):void\r\n\t\t{\r\n\t\t\tvar session:Object = new Object();\r\n\t\t\tsession['code'] = _sessionID;\r\n\t\t\t\r\n\t\t\tvar loginInfo:Object = new Object();\r\n\t\t\tloginInfo['username'] = username;\r\n\t\t\tloginInfo['password'] = SHA1.encrypt(_authSalt+password);\r\n\t\t\t\r\n\t\t\tvar everything:Object = new Object();\r\n\t\t\teverything['session_info'] = session;\r\n\t\t\teverything['login_method'] = \"password\";\r\n\t\t\teverything['login_blob'] = loginInfo;\r\n\t\t\t\r\n\t\t\tvar responder:Responder = new Responder(onLogin, onNetworkingError);\r\n\t\t\t_conn.call(\"XCRpcProtocol_AMF.login\", responder, session, \"password\", loginInfo);\r\n\t\t}\r\n\r\n\r\nIn this example case it is called with both parameters set to \"\". I will attach the binary input (saved from Charles proxy) in case you have a method of importing it directly, to simplify repro. Thanks!"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9345\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wadearnold",
                "name": "wadearnold",
                "displayName": "Wade Arnold",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12834",
                    "filename": "example.as",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ericheimburg",
                        "name": "ericheimburg",
                        "displayName": "Eric Heimburg",
                        "active": true
                    },
                    "created": "2010-03-05T17:34:18.000+0000",
                    "size": 639,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12834\/example.as"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12833",
                    "filename": "input.bin",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ericheimburg",
                        "name": "ericheimburg",
                        "displayName": "Eric Heimburg",
                        "active": true
                    },
                    "created": "2010-03-05T17:31:15.000+0000",
                    "size": 136,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12833\/input.bin"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12832",
                    "filename": "test.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ericheimburg",
                        "name": "ericheimburg",
                        "displayName": "Eric Heimburg",
                        "active": true
                    },
                    "created": "2010-03-05T17:31:10.000+0000",
                    "size": 947,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12832\/test.php"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10430",
                    "id": 10430,
                    "description": "Mini Release",
                    "name": "1.10.2",
                    "userReleaseDate": "24\/Feb\/10",
                    "archived": false,
                    "releaseDate": "2010-02-24",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10350",
                    "id": 10350,
                    "name": "Zend_Amf",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39021",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ericheimburg",
                        "name": "ericheimburg",
                        "displayName": "Eric Heimburg",
                        "active": true
                    },
                    "body": "test.php is a very simple example that does nothing much. (I am sure you will need to change the include path, I was making sure that the correct Zend library was getting used.) \r\n\r\ninput.bin is the binary data that is generated by the Flex client application, which causes the error.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ericheimburg",
                        "name": "ericheimburg",
                        "displayName": "Eric Heimburg",
                        "active": true
                    },
                    "created": "2010-03-05T17:31:15.000+0000",
                    "updated": "2010-03-05T17:31:15.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39022",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ericheimburg",
                        "name": "ericheimburg",
                        "displayName": "Eric Heimburg",
                        "active": true
                    },
                    "body": "The code snippet I pasted originally got malformed; here it is again as example.as. Not actually runnable, but it's pretty understandable (as it doesn't do much).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ericheimburg",
                        "name": "ericheimburg",
                        "displayName": "Eric Heimburg",
                        "active": true
                    },
                    "created": "2010-03-05T17:34:19.000+0000",
                    "updated": "2010-03-05T17:34:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44283",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=emeyex",
                        "name": "emeyex",
                        "displayName": "Max Wagner",
                        "active": true
                    },
                    "body": "Same exact exception and callstack. Using ZendFramework 1.11.3, PHP 5.3.2. In my case, it's only when I add a third argument to my PHP function, and only when that third argument is an object (can pass string and int fine).\r\n\r\nin PHP service:\r\nfunction failsToGetCalledFromAS3($tableName, $rowAsObject, $whereExpression)\r\n{\r\n  return TRUE;\r\n}\r\n\r\nfrom AS3:\r\nconnection.gateway.call(\"DevDb.failsToGetCalledFromAS3\",new Responder(onResponse,onFault),tableName,row,{someValue:\"128\"});\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=emeyex",
                        "name": "emeyex",
                        "displayName": "Max Wagner",
                        "active": true
                    },
                    "created": "2011-02-04T11:56:36.000+0000",
                    "updated": "2011-02-04T11:56:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44284",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=emeyex",
                        "name": "emeyex",
                        "displayName": "Max Wagner",
                        "active": true
                    },
                    "body": "The obvious workaround I guess is just to pass all parameters to RPCs as a single array of arguments, and extract them inside my own functions. Seems a little ghetto but it works so far.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=emeyex",
                        "name": "emeyex",
                        "displayName": "Max Wagner",
                        "active": true
                    },
                    "created": "2011-02-04T12:45:33.000+0000",
                    "updated": "2011-02-04T12:45:33.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9345\/transitions"
}