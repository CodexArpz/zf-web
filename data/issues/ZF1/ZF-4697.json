{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4697",
    "key": "ZF-4697",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Bug in PluginLoader breaks two Zend_View UnitTests"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4697\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10430",
                    "id": 10430,
                    "description": "Mini Release",
                    "name": "1.10.2",
                    "userReleaseDate": "24\/Feb\/10",
                    "archived": false,
                    "releaseDate": "2010-02-24",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-02-23T09:06:10.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                "name": "sidhighwind",
                "displayName": "Jon Whitcraft",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-10-23T19:27:16.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-04-09T06:51:13.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "The two view tests that it breaks are \n\nViewTests.php -> testGetHelperPath() and testGetFilterPath()\n\nThe problem comes in with this code in the PluginLoader load() Method\n\n{code}\nif (class_exists($className, false)) {\n    $found = true;\n    break;\n}\n{code}\n\nWith the break it takes it out of the loop and never creates the $loadFile variable which sets the path to the class.\n\nIf you comment out this if statement everything is fine..\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/customFieldOption\/10037",
                "value": "   Must Have"
            }
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4697\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11610",
                    "filename": "PluginLoader.php.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "created": "2008-10-23T19:27:40.000+0000",
                    "size": 2457,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11610\/PluginLoader.php.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12736",
                    "filename": "zf4697.r21037.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tech13",
                        "name": "tech13",
                        "displayName": "Michael Rehbein",
                        "active": false
                    },
                    "created": "2010-02-12T10:40:33.000+0000",
                    "size": 2484,
                    "mimeType": "text\/x-diff",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12736\/zf4697.r21037.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10252",
                    "id": 10252,
                    "description": "Minor Preview Release",
                    "name": "1.7 Preview Release",
                    "userReleaseDate": "13\/Oct\/08",
                    "archived": true,
                    "releaseDate": "2008-10-13",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10001",
                    "id": 10001,
                    "name": "Zend_Loader",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25378",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "body": "Attached is the patch to fix this.  If you want me to fix it then I will.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "created": "2008-10-23T19:27:42.000+0000",
                    "updated": "2008-10-23T19:27:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25761",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "body": "BTW It produces one unit tests error and one unit tests failure now:\n\n{panel}\n8) testGetHelperPath(Zend_ViewTest)\nstrpos(): Empty delimiter\n{panel}\n\n{panel}\n12) testGetFilterPath(Zend_ViewTest)\nFailed asserting that two strings are equal.\nexpected string <\/home\/cawa\/ZendFramework\/svn\/framework\/trunk\/tests\/Zend\/View\/_stubs\/FilterDir1\/Foo.php>\ndifference      <??????????????????????????????????????????????????????????????????????????????????????>\ngot string      <>\n{panel}\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "created": "2008-11-06T08:23:33.000+0000",
                    "updated": "2008-11-06T08:23:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26579",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "This appears to be resolved in current trunk.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-11-22T09:13:41.000+0000",
                    "updated": "2008-11-22T09:13:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26934",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "body": "OK I found how this bug is being produced.\n\nIf you call a helper by doing $mhc = new My_Helpers_Custom() before calling it from the helperBroker it produces the error.\n\nI'm going to setup a test page and submit it for testing.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "created": "2008-12-03T14:51:36.000+0000",
                    "updated": "2008-12-03T14:51:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35192",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "body": "Update to remove the Fix Version since this is not fixed.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "created": "2009-10-13T16:42:29.000+0000",
                    "updated": "2009-10-13T16:42:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35206",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "All unit tests for Zend_View are running fine currently. What OS, PHP version, and ZF version are you seeing the issue on?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2009-10-14T05:03:59.000+0000",
                    "updated": "2009-10-14T05:03:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35220",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "body": "Matthew,\r\n\r\nThis issue was submitted almost a year ago and I don't think it's valid any more.  I forget what version of PHP I ran this on but it was for the 1.7.0 PR release.\r\n\r\nI think this can be closed an a Non-Issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sidhighwind",
                        "name": "sidhighwind",
                        "displayName": "Jon Whitcraft",
                        "active": true
                    },
                    "created": "2009-10-14T14:07:08.000+0000",
                    "updated": "2009-10-14T14:07:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38424",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tech13",
                        "name": "tech13",
                        "displayName": "Michael Rehbein",
                        "active": false
                    },
                    "body": "Found a test case that shows the bug.\r\nAlso created a patch to correct it.\r\nWill attach patch next.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tech13",
                        "name": "tech13",
                        "displayName": "Michael Rehbein",
                        "active": false
                    },
                    "created": "2010-02-12T10:38:25.000+0000",
                    "updated": "2010-02-12T10:38:25.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38425",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tech13",
                        "name": "tech13",
                        "displayName": "Michael Rehbein",
                        "active": false
                    },
                    "body": "Patch:\r\n - adds a unit test for this issue\r\n - uses reflection to get which path the class was loaded from if it is already loaded\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tech13",
                        "name": "tech13",
                        "displayName": "Michael Rehbein",
                        "active": false
                    },
                    "created": "2010-02-12T10:40:33.000+0000",
                    "updated": "2010-02-12T10:40:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38677",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "I'm reluctant to use this patch, as Reflection introduces substantial overhead -- and with something used as widely as the PluginLoader, this will have a lot of impact. In looking at your test case and patch, I discovered that we already have the code you describe: in getClassPath(). Since this is a method only used on-demand (not in every request), it makes sense to simply leverage this. Once I looked at that, I realized that I found the flaw: it was in how the $loadFile was detected and cached. I simply removed the logic to cache that information, and subsequently all tests, including your new one, pass.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2010-02-23T09:04:00.000+0000",
                    "updated": "2010-02-23T09:04:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38678",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Patch applied (with revisions) to trunk and 1.10 release branch.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2010-02-23T09:06:10.000+0000",
                    "updated": "2010-02-23T09:06:10.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38740",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=hendri.smit",
                        "name": "hendri.smit",
                        "displayName": "Hendri Smit",
                        "active": true
                    },
                    "body": "The changes made to the PluginLoader make my application crash Apache.\r\nI can't really point my finger on it but if add a simple isset() there is no problem :S\r\n\r\n{code: title=Zend_Loader_PluginLoader}\r\n...\r\n        if ($this->_useStaticRegistry) {\r\n            self::$_staticLoadedPlugins[$this->_useStaticRegistry][$name]     = $className;\r\n            isset($className);\r\n        } else {\r\n            $this->_loadedPlugins[$name]     = $className;\r\n        }\r\n...\r\n{code}\r\n\r\nAny thoughts?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=hendri.smit",
                        "name": "hendri.smit",
                        "displayName": "Hendri Smit",
                        "active": true
                    },
                    "created": "2010-02-25T06:48:44.000+0000",
                    "updated": "2010-02-25T06:48:44.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38745",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "@Hendri Actually, no thoughts. The lines you quote were never changed. I actually simply modified the load() method _not_ to store the class filename; instead, it's only retrieved on-demand when you use getClassFile().\r\n\r\nCan you provide a reproduce case that demonstrates the behavior? The ZF site itself is using 1.10.2, and we're not experiencing any crashes at this time.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2010-02-25T07:37:52.000+0000",
                    "updated": "2010-02-25T07:37:52.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39905",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=hendri.smit",
                        "name": "hendri.smit",
                        "displayName": "Hendri Smit",
                        "active": true
                    },
                    "body": "@Matthew There was probably something wrong with my Apache installation",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=hendri.smit",
                        "name": "hendri.smit",
                        "displayName": "Hendri Smit",
                        "active": true
                    },
                    "created": "2010-04-09T06:51:13.000+0000",
                    "updated": "2010-04-09T06:51:13.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4697\/transitions"
}