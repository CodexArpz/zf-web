{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3791",
    "key": "ZF-3791",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Add file upload testing"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/2",
                "name": "New Feature",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3791\/votes",
                "votes": 9,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=pooh",
                "name": "pooh",
                "displayName": "Steven Brown",
                "active": false
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-07-29T07:05:55.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-03-15T01:16:42.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "The testing system should allow for testing of file uploads, a cURL style syntax might be useful ('@filename.jpg')"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3791\/watchers",
                "isWatching": false,
                "watchCount": 8
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "zf-caretaker-adamlundrigan",
                "zf-crteam-review"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-11197",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11197",
                    "type": {
                        "name": "Related",
                        "direction": "OUTBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11763",
                    "filename": "zf-3791.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=giorgiosironi",
                        "name": "giorgiosironi",
                        "displayName": "Giorgio Sironi",
                        "active": true
                    },
                    "created": "2009-02-18T05:44:08.000+0000",
                    "size": 3677,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11763\/zf-3791.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10050",
                    "id": 10050,
                    "description": "Minor Release Candidate",
                    "name": "1.6.0RC2",
                    "userReleaseDate": "11\/Aug\/08",
                    "archived": true,
                    "releaseDate": "2008-08-11",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10312",
                    "id": 10312,
                    "name": "Zend_Test_PHPUnit",
                    "description": "PHPUnit test scaffolding for ZF MVC applications",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26671",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=giorgiosironi",
                        "name": "giorgiosironi",
                        "displayName": "Giorgio Sironi",
                        "active": true
                    },
                    "body": "Actually, the Zend_File_Transfer component use a pair of *_uploaded_file() functions that are not mockable. My proposal is to add a unitTesting public property to Zend_File_Transfer like the one in Zend_Session. When property is set, the component can use rename() instead of move_uploaded_file() for example. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=giorgiosironi",
                        "name": "giorgiosironi",
                        "displayName": "Giorgio Sironi",
                        "active": true
                    },
                    "created": "2008-11-25T04:27:01.000+0000",
                    "updated": "2008-11-25T04:27:01.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28920",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=giorgiosironi",
                        "name": "giorgiosironi",
                        "displayName": "Giorgio Sironi",
                        "active": true
                    },
                    "body": "Patch proposal. Verified under zf 1.7.5 and it does not break tests of Zend\/File, Zend\/Test and Zend\/Validate folder.\nAfter adding this patch, an user can mock $_FILES array in controller testcases.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=giorgiosironi",
                        "name": "giorgiosironi",
                        "displayName": "Giorgio Sironi",
                        "active": true
                    },
                    "created": "2009-02-18T05:44:12.000+0000",
                    "updated": "2009-02-18T05:44:12.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29553",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "body": "Great idea, Giorgi. Thanks for sharing the patch!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "created": "2009-03-18T14:12:20.000+0000",
                    "updated": "2009-03-18T14:12:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29560",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "This patch is problematic.\nIt breaks actual coding standard by adding methods\/constants only for testing. In the last 2 years I was said several times that a class should not have methods\/constants which are for testing purposes only.\n\nIt also allows to break behaviour and function of the base component which means that all further additions will not work as they should.\n\nAlso to note:\nTesting the upload itself would mean to test if the webserver works but this in not possible and also not necessary. Testing a upload works in 2 steps... first look if the form you receive contains the correct values. And second if all parts after the upload itself work correct. Both can be done without changing behaviour.\nThe process itself, which you patched, is part of the server upload and can not be tested.\n\nTake a look at the actual testbed within trunk to see how this can be archived.\n\nYou should also keep in mind that this component is not about using HTTP upload, it is about using file transfer mechanism, this includes not only also download but additionally also other protocols. And here this patch would disallow functionallity.\n\nAs developer of this component I have to warn about integration of this patch into the core.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-18T14:59:10.000+0000",
                    "updated": "2009-03-18T14:59:10.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29573",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=giorgiosironi",
                        "name": "giorgiosironi",
                        "displayName": "Giorgio Sironi",
                        "active": true
                    },
                    "body": "Hey hey - not saying it has to be included. It's here for developers like me and Till that need a quick way to falsificate upload for testing. If in Zend_Test there would be a $this->request->setPost()->addFile() I will be happy to use it, but I have subclassing of Zend_Form_Element_File where the code path from preleving from $_FILES to automatically create a entity in the database linked to the physical file has to be covered by testing in some way.\n\nRegarding coding standards, well:\nclass Zend_Session extends Zend_Session_Abstract\n{\n    \/**\n     * Whether or not Zend_Session is being used with unit tests\n     *\n     * @internal\n     * @var bool\n     *\/\n    public static $_unitTestEnabled = false;\n..it's the same hack used to bypass session_*() functions, the equivalent of *_uploaded_file().\n\nA possible solution is providing a way to inject transfer adapter in form elements via factory in registry\/service locator\/dependency injection container\/whatever, like it's done with the request object (that permits me to set a header like X-Requested-With to simluate an ajax call, without having to modify $_SERVER superglobal array, equivalent of $_FILES).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=giorgiosironi",
                        "name": "giorgiosironi",
                        "displayName": "Giorgio Sironi",
                        "active": true
                    },
                    "created": "2009-03-19T03:14:04.000+0000",
                    "updated": "2009-03-19T03:14:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29581",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Just because other classes do not conform the coding practice does not mean that it will become coding standard for other components ;-)\n\nWhat I said is still true: There is another way of testing, so such a change is not necessary for the core itself beside of the problem it would integrate.\n\nBtw: You can change the attached transfer adapter within the file form element since it has been released. So it's also possible to create a own mock adapter. That's what I meant as I said \"look at the existing testbed of the core\".\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-19T04:26:05.000+0000",
                    "updated": "2009-03-19T04:26:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29584",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Thomas -- I'm not sure who's perpetuating that the coding standards do not allow adding methods\/constants only for use with testing, but it's surely not me, and it flies in the face of some of the very practices we try to evangalize. ZF applications should be easy to test, and currently there are a few areas that are actually quite difficult -- this is one.\n\nThe patch looks good and solves a problem related to testing ZF applications. If you do not apply it, I will.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2009-03-19T05:51:03.000+0000",
                    "updated": "2009-03-19T05:51:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29587",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Matthew: Do what you think you must do. You know that I am not fetching issues which are attached to another person when I am not the main lead of this component. And I am not related to Zend_Test nor have I done anything in past with it.\n\nRelated to coding practice (not standard):\nI was said several times in past from the dev-team that I am not allowed to add methods and constants in public visibility which are only for testing purposes. This was before your time mainly by gavin and others in 2006 and 2007.\n\nAlso to note:\nThe patch itself is errorous as it breaks behaviour in case of testing. It does not work correct when the file is optional. I have to warn that the component will then behave different when being tested (and I am not speaking of the file being moved or not). Applying a correct solution would be better in my eyes.\nAlso for the upload progress we added protected solutions and not public ones.\n\nI don't know details of Zend_Test, only of Zend_File_Transfer, but in my eyes a new option would be better, as it's not visible to IDEs due to being part of the adapters options array. Also the validator should and can be solved differently. There is no need to add a new dependency to Zend_File.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-19T06:41:36.000+0000",
                    "updated": "2009-03-19T06:41:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29595",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=giorgiosironi",
                        "name": "giorgiosironi",
                        "displayName": "Giorgio Sironi",
                        "active": true
                    },
                    "body": "After checkout of 1.7 branch and applying, I see that the patch does not broke current behaviour (Zend\/File\/AllTests.php). However, I have found only an AbstractTest.php that tests the abstract adapter and not the Http one. I can add a pair of test cases and produce a new patch with correct behaviour on optional files, but where I should insert them?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=giorgiosironi",
                        "name": "giorgiosironi",
                        "displayName": "Giorgio Sironi",
                        "active": true
                    },
                    "created": "2009-03-19T13:07:33.000+0000",
                    "updated": "2009-03-19T13:07:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29599",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=giorgiosironi",
                        "name": "giorgiosironi",
                        "displayName": "Giorgio Sironi",
                        "active": true
                    },
                    "body": "I have done a checkout of the trunk and found the HttpTest there, now I'll try.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=giorgiosironi",
                        "name": "giorgiosironi",
                        "displayName": "Giorgio Sironi",
                        "active": true
                    },
                    "created": "2009-03-19T14:36:39.000+0000",
                    "updated": "2009-03-19T14:36:39.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39423",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=najcik",
                        "name": "najcik",
                        "displayName": "Tomasz Cichecki",
                        "active": true
                    },
                    "body": "The design is broken as you depend on a static dependency and prohibit to override the behaviour. A good solution would allow developers to inject the dependency themselves in a testing environment or at least monkey-patch it somehow but in this case and in case of PHP in general the Runkit extension is the only solution.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=najcik",
                        "name": "najcik",
                        "displayName": "Tomasz Cichecki",
                        "active": true
                    },
                    "created": "2010-03-21T10:21:15.000+0000",
                    "updated": "2010-03-21T10:21:15.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50048",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "If we extracted {{Zend_File_Transfer_Adapter_AbstractTest_MockAdapter}} from {{tests\/Zend\/File\/Transfer\/Adapter\/AbstractTest.php}} into a separate class, {{Zend_File_Transfer_Adapter_MockAdapter}} or something similar, would this solve the problem at hand?  I think the problem outlined here is very similar (if not the same as) ZF-11197",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-03-15T01:15:33.000+0000",
                    "updated": "2012-03-15T01:15:33.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3791\/transitions"
}