{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8441",
    "key": "ZF-8441",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Wrong count of records when using DISTINCT in paginator's select object"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8441\/votes",
                "votes": 2,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/11080",
                    "id": 11080,
                    "description": "Mini Release",
                    "name": "1.11.12",
                    "userReleaseDate": "22\/Jun\/12",
                    "archived": false,
                    "releaseDate": "2012-06-22",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-12-08T12:19:50.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                "name": "cypher",
                "displayName": "Andris Causs",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-12-02T04:18:41.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-12-08T12:19:50.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I have a Zend_Db_Select object that does several one-to-many joins on multiple tables. I am passing that select object to view's \"paginationControl\" helper. The number of rows I get is, for example, 5 but the paginator control's \"totalItemCount\" property says 11.\r\n\r\nHere is some example code:\r\n\r\nZend_Db_Select generation in the controller action\r\nNote ->distinct()\r\n{code}\r\n$select = $c->getAdapter()->select()->distinct();\r\n$select->from(array('c' => 'table0'), array(\r\n\t'*',\r\n));\r\n$select->joinLeft(array('t' => 'table1'),\r\n\t'c.id = t.id',\r\n\tarray()\r\n);\r\n$select->joinLeft(array('f' => 'table2'),\r\n\t'c.id = f.id',\r\n\tarray()\r\n);\r\n{code}\r\n\r\n\r\nThen I assign the paginator object to the view:\r\n{code}\r\n$paginator = Zend_Paginator::factory($select);\r\n$paginator->setCurrentPageNumber($page);\r\n$paginator->setItemCountPerPage(10);\r\n$this->view->items = $paginator;\r\n{code}\r\n\r\n\r\nAfter that I'm printing the paginator in the view like this:\r\n{code}\r\n$params = array(...);\r\nprint $this->paginationControl($this->items, Options::PAGINATOR_STYLE, '_pagination.phtml', $params);\r\n{code}\r\n\r\n\r\nAnd just in case, here's how the counts in the _pagination.phtml are printed:\r\n{code}\r\nprint 'Showing ' . $this->firstItemNumber . ' - ' . $this->lastItemNumber . ' of ' . $this->totalItemCount . ' results (' . $this->itemCountPerPage . ' per page)';\r\n{code}\r\n\r\n\r\nThe output is: \"Showing 1 - 5 of 11 results (10 per page)\"\r\n\r\nTo summarize it all - the amount of row objects in the paginator is correct but totalItemCount is not."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8441\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                "name": "bate",
                "displayName": "Marco Kaiser",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12443",
                    "filename": "ContractsController.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "created": "2009-12-02T05:24:40.000+0000",
                    "size": 1202,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12443\/ContractsController.php"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12442",
                    "filename": "tables.sql",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "created": "2009-12-02T05:24:30.000+0000",
                    "size": 939,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12442\/tables.sql"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12441",
                    "filename": "view.phtml",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "created": "2009-12-02T05:24:30.000+0000",
                    "size": 304,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12441\/view.phtml"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12440",
                    "filename": "_pagination.phtml",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "created": "2009-12-02T05:24:30.000+0000",
                    "size": 2041,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12440\/_pagination.phtml"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10362",
                    "id": 10362,
                    "description": "Mini Release",
                    "name": "1.9.3",
                    "userReleaseDate": "22\/Sep\/09",
                    "archived": false,
                    "releaseDate": "2009-09-22",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10370",
                    "id": 10370,
                    "description": "Mini Release",
                    "name": "1.9.4",
                    "userReleaseDate": "13\/Oct\/09",
                    "archived": false,
                    "releaseDate": "2009-10-13",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10380",
                    "id": 10380,
                    "description": "Mini Release",
                    "name": "1.9.5",
                    "userReleaseDate": "27\/Oct\/09",
                    "archived": false,
                    "releaseDate": "2009-10-27",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10390",
                    "id": 10390,
                    "description": "Mini Release",
                    "name": "1.9.6",
                    "userReleaseDate": "24\/Nov\/09",
                    "archived": false,
                    "releaseDate": "2009-11-24",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10315",
                    "id": 10315,
                    "name": "Zend_Paginator",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36621",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "body": "Can you add a ->distinct() to your select?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "created": "2009-12-02T04:25:48.000+0000",
                    "updated": "2009-12-02T04:25:48.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36622",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "body": "Yes. If you \"print $select\" the result will be:\r\nSELECT DISTINCT c.* FROM table0 AS c LEFT JOIN table1 AS t ON c.id = t.id LEFT JOIN table2 AS f ON c.id = f.id;\r\n\r\nAlso, here's a link to the documentation:\r\nhttp:\/\/framework.zend.com\/manual\/en\/zend.db.select.html#zend.db.select.building.distinct",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "created": "2009-12-02T04:31:43.000+0000",
                    "updated": "2009-12-02T04:31:43.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36623",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "body": "I think this isnt a bug. you have to provide example table structure and data. I havnt reproducted it with my Data here.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "created": "2009-12-02T04:50:31.000+0000",
                    "updated": "2009-12-02T04:50:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36624",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "body": "OK, let's say you've got two tables:\r\ntable0:\r\nid | field_a | field_b | field_c\r\n\r\ntable1:\r\nid | field_d\r\n\r\nthe contents could be like this:\r\ntable0:\r\n1 | a | a | a\r\n2 | b | b | b\r\n3 | c | c | c\r\n\r\ntable1:\r\n1 | x\r\n1 | y\r\n1 | z\r\n2 | p\r\n2 | q\r\n3 | f\r\n3 | g\r\n3 | h\r\n\r\nSo, if you do\r\nSELECT t0.* FROM table0 AS t0\r\nLEFT JOIN table1 AS t1 ON t0.id = t1.id;\r\n...you will get 8 rows just because there are 8 rows in table1.\r\n\r\nWhat I infact need is to get unique rows from table0, hence I need to add DISTINCT:\r\nSELECT DISTINCT t0.* FROM table0 AS t0\r\nLEFT JOIN table1 AS t1 ON t0.id = t1.id;\r\n\r\nIn this case you get 3 rows.\r\n\r\nNow, I pass this object to Zend_Paginator::factory() it creates the paginator object.\r\nWhen I do\r\nforeach ($paginator as $item) {}\r\nit will print 4 rows, which is correct but when I print the page numbers it says that there are 8 items.\r\nThat is the bug that I'm trying to describe.\r\n\r\nSorry, I can't supply you any specific table structures as it's an internal company project.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "created": "2009-12-02T05:06:29.000+0000",
                    "updated": "2009-12-02T05:06:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36625",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "body": "Can you please attach to this issue your partial view paginator rendering script, a sql dump and other details so that it is more easier to reproduct that all? :)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "created": "2009-12-02T05:09:57.000+0000",
                    "updated": "2009-12-02T05:09:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36626",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "body": "Sorry, there's a typo - instead of \"it will print 4 rows\" it should say \"it will print 3 rows\".",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "created": "2009-12-02T05:13:59.000+0000",
                    "updated": "2009-12-02T05:13:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36653",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "body": "Just a quick update.\r\n\r\nHere is the output of my $select->__toString() (Zend_Db_Select that I pass to the paginator):\r\n{code}\r\nSELECT DISTINCT c.* FROM ctr_details AS c\r\nLEFT JOIN ctr_tags AS t ON c.contract_id = t.contract_id\r\nLEFT JOIN ctr_files AS f ON c.contract_id = f.contract_id\r\nGROUP BY c.contract_id\r\n{code}\r\n\/\/ I added $select->group('c.contract_id') thinking that it might group all the rows when counting\r\n\r\nAnd here is the output of $paginator->getAdapter()->getCountSelect()->__toString():\r\n{code}\r\nSELECT COUNT(1) AS `zend_paginator_row_count` FROM ctr_details AS c\r\nLEFT JOIN ctr_tags AS t ON c.contract_id = t.contract_id\r\nLEFT JOIN ctr_files AS f ON c.contract_id = f.contract_id\r\n{code}\r\n\r\nAs you can see GROUP BY is gone as well.\r\n\r\nThe problem seems to be in Zend_Paginator_Adapter_DbSelect::getCountSelect().",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "created": "2009-12-03T03:07:43.000+0000",
                    "updated": "2009-12-03T03:07:43.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36658",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "body": "OK, found a dirty workaround for those that stumble upon this page and want a quick fix.\r\nAs you probably know there's a function in Zend_Paginator_Adapter_DbSelect called setRowCount ().\r\nIt allows you to specify a custom Zend_Db_Select object to use in counting the rows.\r\n\r\nThis is what I did:\r\n{code}\r\n$select = $c->getAdapter()->select()->distinct();\r\n$select_count = $c->getAdapter()->select();\r\n\r\n\/\/ generate the select object\r\n$select->from(array('c' => $c->getTableName()), array(\r\n\t'*',\r\n));\r\n$select->joinLeft(array('t' => $t->getTableName()),\r\n\t'c.contract_id = t.contract_id',\r\n\tarray()\r\n);\r\n$select->joinLeft(array('f' => $f->getTableName()),\r\n\t'c.contract_id = f.contract_id',\r\n\tarray()\r\n);\r\n\r\n\/\/ generate the count select object\r\n$select_count->from(array('c' => $c->getTableName()), array(\r\n\tnew Zend_Db_Expr('COUNT(DISTINCT c.contract_id) AS ' . Zend_Paginator_Adapter_DbSelect::ROW_COUNT_COLUMN),\r\n));\r\n$select_count->joinLeft(array('t' => $t->getTableName()),\r\n\t'c.contract_id = t.contract_id',\r\n\tarray()\r\n);\r\n$select_count->joinLeft(array('f' => $f->getTableName()),\r\n\t'c.contract_id = f.contract_id',\r\n\tarray()\r\n);\r\n\r\n\/\/ ...\r\n\r\n$adapter = new Zend_Paginator_Adapter_DbSelect($select);\r\n$adapter->setRowCount($select_count);\r\n\r\n$paginator = new Zend_Paginator($adapter);\r\n\r\n$this->view->contracts = $paginator;\r\n{code}\r\n\r\nI know it's not the coolest approach but at least it works.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cypher",
                        "name": "cypher",
                        "displayName": "Andris Causs",
                        "active": true
                    },
                    "created": "2009-12-03T03:32:12.000+0000",
                    "updated": "2009-12-03T03:32:12.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37469",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ikr",
                        "name": "ikr",
                        "displayName": "Ivan Krechetov",
                        "active": true
                    },
                    "body": "I seem to have a similar problem using Zend_Paginator_Adapter_DbSelect. <?php echo $this->totalItemCount ?> in my control.phtml is always 10, even though there are 50 pages with 10 items each.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ikr",
                        "name": "ikr",
                        "displayName": "Ivan Krechetov",
                        "active": true
                    },
                    "created": "2010-01-07T01:13:24.000+0000",
                    "updated": "2010-01-07T01:13:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37470",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ikr",
                        "name": "ikr",
                        "displayName": "Ivan Krechetov",
                        "active": true
                    },
                    "body": "Correction: it's not always 10 for me, on the last page it's 8. So, looks like totalItemCount has actually the value of currentItemCount.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ikr",
                        "name": "ikr",
                        "displayName": "Ivan Krechetov",
                        "active": true
                    },
                    "created": "2010-01-07T01:22:28.000+0000",
                    "updated": "2010-01-07T01:22:28.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37472",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ikr",
                        "name": "ikr",
                        "displayName": "Ivan Krechetov",
                        "active": true
                    },
                    "body": "Forget my comments. Found a bug in my code.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ikr",
                        "name": "ikr",
                        "displayName": "Ivan Krechetov",
                        "active": true
                    },
                    "created": "2010-01-07T02:52:04.000+0000",
                    "updated": "2010-01-07T02:52:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40799",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "body": "i tested it and i cannot reproduce your bug, i fixed some lines of code in Zend_Paginator, please test with the latest code and if still exists please reopen.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bate",
                        "name": "bate",
                        "displayName": "Marco Kaiser",
                        "active": true
                    },
                    "created": "2010-05-31T01:04:36.000+0000",
                    "updated": "2010-05-31T01:04:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40802",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=norm2782",
                        "name": "norm2782",
                        "displayName": "Jurrien Stutterheim",
                        "active": true
                    },
                    "body": "Marco,\r\n\r\nIf the issue cannot be reproduced, please do not \"fix some lines of code\". If there is an issue with those lines, consider opening a new issue. Also, please mention the revision numbers :)\r\n\r\nCheers,\r\n\r\nJurri\u00ebn",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=norm2782",
                        "name": "norm2782",
                        "displayName": "Jurrien Stutterheim",
                        "active": true
                    },
                    "created": "2010-05-31T01:18:29.000+0000",
                    "updated": "2010-05-31T01:18:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49246",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chrismacp",
                        "name": "chrismacp",
                        "displayName": "Chris MacPherson",
                        "active": true
                    },
                    "body": "I can confirm I am seeing the same results when I perform a query with joins that needs a distinct on one table.\r\n\r\nMy original query looks like this : \r\n\r\n{noformat}\r\nSELECT DISTINCT `t1`.* \r\nFROM `table1` AS `t1` \r\nINNER JOIN `table2` AS `t2` ON t1.columna = t2.columna\r\nLEFT JOIN `table3` AS `t3` ON t2.columnb = t3.columnb\r\n{noformat}\r\n\r\nInside the dBSelect adapter, at line 260, if I perform __toString() on $this->_countSelect I get the following:\r\n{noformat}\r\nSELECT COUNT(1) AS `zend_paginator_row_count` \r\nFROM `table1` AS `t1` \r\nINNER JOIN `table2` AS `t2` ON t1.columna = t2.columna\r\nLEFT JOIN `table3` AS `t3` ON t2.columnb = t3.columnb\r\n{noformat}\r\n\r\nThis is returning an incorrect count due to the lack of the distinct statement which is need due to multiple rows being created during the join process.\r\n\r\nI think it would be hard for the method to dynamically get around this issue and so the solution for me is to alter the check at line 217 to pick up my situation and do the count around a sub-query as it does in other situations. Although probably not the most efficient way to count the rows, it does provide the correct result. With the code I am working on it would be difficult to provide a dynamically created custom query just for the count. \r\n\r\nI basically just check there is only one column part and that is uses a wildcard. This then makes the adapter and paginator work perfectly for my query.\r\n\r\nMy change\r\n{noformat}\r\nIndex: Zend\/Paginator\/Adapter\/DbSelect.php\r\n===================================================================\r\n--- Zend\/Paginator\/Adapter\/DbSelect.php (revision 43843)\r\n+++ Zend\/Paginator\/Adapter\/DbSelect.php (working copy)\r\n@@ -215,7 +215,8 @@\r\n              * than one group, or if the query has a HAVING clause, then take\r\n              * the original query and use it as a subquery os the COUNT query.\r\n              *\/\r\n-            if (($isDistinct && count($columnParts) > 1) || count($groupParts) > 1 || !empty($havingParts)) {\r\n+            if (($isDistinct && ((count($columnParts) == 1 && $columnParts[0][1] == Zend_Db_Select::SQL_WILDCARD) \r\n+                 || count($columnParts) > 1)) || count($groupParts) > 1 || !empty($havingParts)) {\r\n                 $rowCount->reset(Zend_Db_Select::ORDER);\r\n                 $rowCount = $db->select()->from($rowCount);\r\n             } else if ($isDistinct) {\r\n{noformat}\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chrismacp",
                        "name": "chrismacp",
                        "displayName": "Chris MacPherson",
                        "active": true
                    },
                    "created": "2011-12-08T12:02:13.000+0000",
                    "updated": "2011-12-08T12:02:13.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8441\/transitions"
}