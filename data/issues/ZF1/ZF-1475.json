{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1475",
    "key": "ZF-1475",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "DB2: Support parameter and result binding"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1475\/votes",
                "votes": 2,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/11183",
                    "id": 11183,
                    "description": "Minor Release",
                    "name": "Next Minor Release",
                    "archived": false,
                    "released": false
                }
            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                "name": "bkarwin",
                "displayName": "Bill Karwin",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2007-06-01T14:00:00.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2013-02-10T16:44:27.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Please implement logic in Zend_Db_Statement_Db2 to support the methods:\r\n- bindParam()\r\n- bindValue()\r\n- bindColumn()"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/6",
                "name": "N\/A"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1475\/watchers",
                "isWatching": false,
                "watchCount": 4
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/10000",
                "name": "Postponed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                "name": "ralph",
                "displayName": "Ralph Schindler",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-3072",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3072",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                },
                {
                    "issueKey": "ZF-1440",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1440",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/10522",
                    "filename": "Db2.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ledezma",
                        "name": "ledezma",
                        "displayName": "Salvador Ledezma",
                        "active": true
                    },
                    "created": "2007-06-04T22:52:47.000+0000",
                    "size": 10757,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/10522\/Db2.php"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/10523",
                    "filename": "Db2Test.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ledezma",
                        "name": "ledezma",
                        "displayName": "Salvador Ledezma",
                        "active": true
                    },
                    "created": "2007-06-04T22:53:44.000+0000",
                    "size": 4666,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/10523\/Db2Test.php"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/10524",
                    "filename": "TestCommon.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ledezma",
                        "name": "ledezma",
                        "displayName": "Salvador Ledezma",
                        "active": true
                    },
                    "created": "2007-06-04T22:54:30.000+0000",
                    "size": 30765,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/10524\/TestCommon.php"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10023",
                    "id": 10023,
                    "description": "Release Candidate 1",
                    "name": "1.0.0 RC1",
                    "userReleaseDate": "28\/May\/07",
                    "archived": true,
                    "releaseDate": "2007-05-28",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10190",
                    "id": 10190,
                    "name": "Zend_Db_Adapter_Db2",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/14923",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Some additional information:\n\nWe're trying to make the Statement class match the behavior of PDOStatement, with respect to methods like bindParam(), bindValue, and bindColumn().\n\nSee:\nhttp:\/\/www.php.net\/manual\/en\/function.PDOStatement-bindParam.php\nhttp:\/\/www.php.net\/manual\/en\/function.PDOStatement-bindValue.php\nhttp:\/\/www.php.net\/manual\/en\/function.PDOStatement-bindColumn.php\n\nWe have unit tests for these in <zf-home>\/tests\/Zend\/Db\/Statement\/TestCommon.php.\n\nThe tests are currently overridden in <zf-home>\/tests\/Zend\/Db\/Statement\/Db2Test.php because the functionality does not work.  So to test, just comment out the functions in Db2Test.php so it uses the implementations of the tests from TestCommon.php.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-06-01T19:51:28.000+0000",
                    "updated": "2007-06-01T19:51:28.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/14957",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ledezma",
                        "name": "ledezma",
                        "displayName": "Salvador Ledezma",
                        "active": true
                    },
                    "body": "Patch for bindColumn() only.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ledezma",
                        "name": "ledezma",
                        "displayName": "Salvador Ledezma",
                        "active": true
                    },
                    "created": "2007-06-04T22:52:47.000+0000",
                    "updated": "2007-06-04T22:52:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/14958",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ledezma",
                        "name": "ledezma",
                        "displayName": "Salvador Ledezma",
                        "active": true
                    },
                    "body": "Removed bindColumn() no-op tests",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ledezma",
                        "name": "ledezma",
                        "displayName": "Salvador Ledezma",
                        "active": true
                    },
                    "created": "2007-06-04T22:53:44.000+0000",
                    "updated": "2007-06-04T22:53:44.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/14959",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ledezma",
                        "name": "ledezma",
                        "displayName": "Salvador Ledezma",
                        "active": true
                    },
                    "body": "Added new test for bindColumn() with a combination of bind column by name and position operations",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ledezma",
                        "name": "ledezma",
                        "displayName": "Salvador Ledezma",
                        "active": true
                    },
                    "created": "2007-06-04T22:54:30.000+0000",
                    "updated": "2007-06-04T22:54:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/15295",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Unit tests confirm that {{bindColumn()}} is working with the IBM_DB2 adapter at this time, but parameter binding is not.  There are apparently confirmed bugs at the driver level in the ibm_db2 extension, and we're waiting for fixes.\n\nAnother option would be to \"simulate\" the bound parameters and simply pass them to the statement execution during the {{execute()}} method of the Zend_Db_Statement_Db2 class.\n\nBut it seems that this fix is of very low priority, so I'm going to mark this issue POSTPONED at this time.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-06-18T21:16:14.000+0000",
                    "updated": "2007-06-18T21:16:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/19887",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Hy Salvador,\n\nif you are not able to commit this patch, you should un-assign this issue so anyone with commit-rights will do this.\n\nOtherwise please commit your changes and close this issue. ;-)\n\nWhen this issue is partitially fixed you should write this, and probably open a new issue for the not-fixed part so this one with the fixed half can be closed ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-03-12T14:47:02.000+0000",
                    "updated": "2008-03-12T14:47:02.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/19895",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ledezma",
                        "name": "ledezma",
                        "displayName": "Salvador Ledezma",
                        "active": true
                    },
                    "body": "I had submitted these patches for review by someone with commit authority.\n\nPlease use as you see fit, though I believe the fix is still incomplete.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ledezma",
                        "name": "ledezma",
                        "displayName": "Salvador Ledezma",
                        "active": true
                    },
                    "created": "2008-03-12T18:02:07.000+0000",
                    "updated": "2008-03-12T18:02:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41681",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ashawley",
                        "name": "ashawley",
                        "displayName": "Aaron S. Hawley",
                        "active": true
                    },
                    "body": "bkarwin mentions that bindParam() is broken because of a known bug at the driver level.  I can only see mention of it as a note in http:\/\/pecl.php.net\/bugs\/15062 on 2010-04-20.  Is it a reported issue?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ashawley",
                        "name": "ashawley",
                        "displayName": "Aaron S. Hawley",
                        "active": true
                    },
                    "created": "2010-07-22T14:05:30.000+0000",
                    "updated": "2010-07-22T14:05:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41773",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ashawley",
                        "name": "ashawley",
                        "displayName": "Aaron S. Hawley",
                        "active": true
                    },
                    "body": "I didn't find the issue to ever be sufficiently reported so I added a new bug:\r\n\r\nhttp:\/\/pecl.php.net\/bugs\/17868\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ashawley",
                        "name": "ashawley",
                        "displayName": "Aaron S. Hawley",
                        "active": true
                    },
                    "created": "2010-07-28T19:20:46.000+0000",
                    "updated": "2010-07-28T19:20:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41774",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "body": "Do I understand correctly that this is an issue that should be fixed upstream (read: in the php core)? If so, shouldn't this issue be closed?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "created": "2010-07-28T19:46:02.000+0000",
                    "updated": "2010-07-28T19:46:02.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41780",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ashawley",
                        "name": "ashawley",
                        "displayName": "Aaron S. Hawley",
                        "active": true
                    },
                    "body": "No, this issue is far from closed.  There will probably still need to be changes made to the Zend Framework -- assuming the issue *is* upstream, which hasn't been confirmed (nor fixed), yet.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ashawley",
                        "name": "ashawley",
                        "displayName": "Aaron S. Hawley",
                        "active": true
                    },
                    "created": "2010-07-29T05:30:30.000+0000",
                    "updated": "2010-07-29T05:30:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44005",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ashawley",
                        "name": "ashawley",
                        "displayName": "Aaron S. Hawley",
                        "active": true
                    },
                    "body": "So, the bug is fixed upstream, but indeed the way binding works for db2_bind_param is different than PDO.  Binding is done by the name of a variable, not by a reference to a variable.  This issue is intractable unless Zend_Db_Statement is rewritten to consider this case.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ashawley",
                        "name": "ashawley",
                        "displayName": "Aaron S. Hawley",
                        "active": true
                    },
                    "created": "2011-01-12T05:27:59.000+0000",
                    "updated": "2011-01-12T05:27:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51486",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jason.estrada",
                        "name": "jason.estrada",
                        "displayName": "Jason Estrada",
                        "active": true
                    },
                    "body": "I am proposing a possible solution for db2_bind_param() binding by variable name and not by variable reference issue. It appears this issue has been around for quite some time now, and waiting on a driver fix doesn't seem to be working.\r\n\r\nThe solution is simple:\r\n\r\n# Generate the variable +name+ used for binding within _bindParam(), and use this name for db2_bind_param(). This covers all cases.\r\n# Create the variables from the names generated\/bound from above and bind by reference to the _bindParam array elements within _execute(). \r\n\r\nThe variables have to be created and [re]bound on each execute since these will only be in scope for the duration of _execute(). It is also not necessary to perform this binding within _execute() when parameters are passed-in, since db2_execute() will use what's supplied on the call and not what was previously bound (if anything).\r\n\r\nI know this is not the most elegant of solutions since it relies upon eval'd code (flame on), but I do not see another alternative at this stage. If and when the ibm_db2 extension is later modified to bind by variable reference, this binding could be easily adapted back into the Statement class, and the eval can be removed. However, in the meantime, this should at least allow parameter binding to function as advertised by the Zend_Db_Statement_Interface.\r\n\r\n{noformat} \r\nIndex: library\/Zend\/Db\/Statement\/Db2.php\r\n===================================================================\r\n--- library\/Zend\/Db\/Statement\/Db2.php\t(revision 25028)\r\n+++ library\/Zend\/Db\/Statement\/Db2.php\t(working copy)\r\n@@ -37,6 +37,13 @@\r\n {\r\n \r\n     \/**\r\n+     * Bound query parameter-to-variable name mapping.\r\n+     *\r\n+     * @var array\r\n+     *\/\r\n+    protected $_bindParamNames = array();\r\n+\r\n+    \/**\r\n      * Column names.\r\n      *\/\r\n     protected $_keys;\r\n@@ -96,7 +103,12 @@\r\n             $datatype = DB2_CHAR;\r\n         }\r\n \r\n-        if (!db2_bind_param($this->_stmt, $parameter, \"variable\", $type, $datatype)) {\r\n+        \/\/ ZF-1475: support parameter and result binding.\r\n+        \/\/ db2_bind_param() binds by variable name and not by reference.\r\n+        \/\/ Generate the variable name here for the associated parameter, the\r\n+        \/\/ variable will be later created and bound in scope during _execute()\r\n+        $this->_bindParamNames[$parameter] = 'zf_bind_param_'.$parameter;\r\n+        if (!db2_bind_param($this->_stmt, $parameter, $this->_bindParamNames[$parameter], $type, $datatype)) {\r\n             \/**\r\n              * @see Zend_Db_Statement_Db2_Exception\r\n              *\/\r\n@@ -201,6 +213,12 @@\r\n         if ($params !== null) {\r\n             $retval = @db2_execute($this->_stmt, $params);\r\n         } else {\r\n+            \/\/ Expose any bound parameter variables set in _bindParam()\r\n+            if (empty($this->_bindParam) === false) {\r\n+                foreach ($this->_bindParamNames as $param => $bind_param) {\r\n+                    eval('$$bind_param =& $this->_bindParam[$param];');\r\n+                }\r\n+            }\r\n             $retval = @db2_execute($this->_stmt);\r\n         }\r\n \r\n\r\n{noformat}\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jason.estrada",
                        "name": "jason.estrada",
                        "displayName": "Jason Estrada",
                        "active": true
                    },
                    "created": "2012-07-30T19:46:06.000+0000",
                    "updated": "2012-07-30T19:46:06.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1475\/transitions"
}