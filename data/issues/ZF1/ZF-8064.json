{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8064",
    "key": "ZF-8064",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "File validation by \"IsImage\" broke upload process"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8064\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/5",
                "name": "Cannot Reproduce"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10360",
                    "id": 10360,
                    "description": "Minor Release",
                    "name": "1.10.0",
                    "userReleaseDate": "27\/Jan\/10",
                    "archived": false,
                    "releaseDate": "2010-01-27",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-10-18T13:08:17.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vasa",
                "name": "vasa",
                "displayName": "Vasa Grujic",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-10-13T06:20:27.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-10-18T13:08:17.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "File",
                "validators"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "File validation by \"IsImage\" broke upload process. No php warning or error, no validation errors even if file type is incorrect.\n\nExample 1:\n$this->addElement('file', 'file', array(\n        'size'        => '40',\n        'label'       => 'Seleccione un archivo de imagen que desea subir.',\n        'required'    => true,\n        'description' => 'Tipo de archivos permitidos: bmp, gif, jpg, png',\n        'validators'  => array(\n\t\t\t'Size'    => array('min' => 20000, 'max' => 1000000),\n        \t\t'IsImage' => array('image\/bmp', 'image\/gif', 'image\/jpeg', 'image\/pjpeg', 'image\/png')\n        )\n));\n\nExample 2:\n$this->addElement('file', 'file', array(\n        'size'        => '40',\n        'label'       => 'Seleccione un archivo de imagen que desea subir.',\n        'required'    => true,\n        'description' => 'Tipo de archivos permitidos: bmp, gif, jpg, png',\n        'validators'  => array(\n\t\t\t'Size'    => array('min' => 20000, 'max' => 1000000),\n        \t\t'IsImage'\n        )\n));\n\nWith ZF 1.9.2 everything is OK!"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8064\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10362",
                    "id": 10362,
                    "description": "Mini Release",
                    "name": "1.9.3",
                    "userReleaseDate": "22\/Sep\/09",
                    "archived": false,
                    "releaseDate": "2009-09-22",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10321",
                    "id": 10321,
                    "name": "Zend_Validate_File",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35247",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "When the process is broken then there must be a returned value, error message, validation message or exception. Something must be returned.\r\n\r\nOr you have changed anything... only updated parts of the framework instead of the complete framework?\r\n\r\nTry to call the validator standalone so you can give us something reproducable.\r\n\r\nYou could also try trunk and see if this issue exists also for the next major release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-10-15T14:25:40.000+0000",
                    "updated": "2009-10-15T14:25:40.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35260",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I just tried to reproduce, but I am not able... all works like expected.\r\nCan you give additional informations ?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-10-16T00:44:29.000+0000",
                    "updated": "2009-10-16T00:44:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35263",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vasa",
                        "name": "vasa",
                        "displayName": "Vasa Grujic",
                        "active": true
                    },
                    "body": "Scenario: When hint the submit button, after choosing the image file to upload, page is just refreshed. Without any feedback. In case without IsImage validation everything go smooth.\r\n\r\nForm:\r\n------------------------------------------------------------------------------------------------------------------------------------------\r\n<?php\r\n\r\nclass PortraitForm extends Zend_Form\r\n{\r\n    public function init()\r\n    {\r\n    \t$buttonDecorator     = array('ViewHelper', array('ViewScript', array('viewScript' => 'decorators\/form\/button.phtml', 'placement' => false)));\r\n    \t$hiddenDecorator     = array('ViewHelper', array('ViewScript', array('viewScript' => 'decorators\/form\/hidden.phtml', 'placement' => false)));\r\n    \t\r\n    \t$this->setMethod('post');\r\n    \t$this->setName('upload');\r\n        $this->setAttrib('enctype', 'multipart\/form-data');\r\n    \t\r\n\t\t\r\n        $this->addElement('file', 'file', array(\r\n        \t'size'        => '40',\r\n            'label'       => 'Seleccione un archivo de imagen que desea subir.',\r\n            'required'    => true,\r\n       \t\t'description' => 'Tipo de archivos permitidos: bmp, gif, jpg, png',\r\n            'validators'  => array(\r\n\t\t\t    'Size'    => array('min' => 10000, 'max' => 1000000),\r\n\t\t\t    'Count'   => array('min' => 1, 'max' => 1),\r\n        \t\t'IsImage' => array('image\/bmp', 'image\/gif', 'image\/jpeg', 'image\/pjpeg', 'image\/png'),\r\n\t        \t'NotEmpty'\r\n        \t)\r\n        ));\r\n        \r\n        $this->addElement('submit', 'submit', array(\r\n        \t'decorators'  => $buttonDecorator,\r\n            'ignore'      => true,\r\n            'label'       => 'Subir imagen',\r\n        ));\r\n\r\n        $this->addElement('hash', 'csrf', array(\r\n        \t'decorators'  => $hiddenDecorator,\r\n            'ignore'      => true,\r\n        ));\r\n        \r\n\t    $this->setDecorators(array(\r\n\t    \t'FormElements',\r\n\t    \tarray('HtmlTag', array('tag' => 'dl', 'class' => 'basic-form file')),\r\n\t    \tarray('Description', array('placement' => 'prepend')),\r\n\t    \t'Form'\r\n    \t));\r\n\t\r\n    }\r\n}\r\n------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nController:\r\n------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nif ($this->_request->isPost()) {\r\n\t\r\n\t$formData = $this->_request->getPost();\r\n\tif ($form->isValid($formData)) {\r\n\t\r\n\t\t$upload = new Zend_File_Transfer_Adapter_Http();\r\n\t\t$uploadDestination = APPLICATION_PATH . '\/..\/public\/tmp\/portraits\/';\r\n\t\t$upload->setDestination($uploadDestination);\r\n\t\r\n\t\tif($upload->receive()):\r\n\t\t  \/\/ Do something\r\n\t\tendif;\r\n\t}\r\n}\r\n------------------------------------------------------------------------------------------------------------------------------------------\r\n\r\nZF 1.9.3 FULL, Autoload.\r\nDevelopment environment: Mac OS X 10.6.1 with MAMP 1.7.2",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vasa",
                        "name": "vasa",
                        "displayName": "Vasa Grujic",
                        "active": true
                    },
                    "created": "2009-10-16T02:51:51.000+0000",
                    "updated": "2009-10-16T02:51:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35387",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I see no failure...\r\n\r\nThe default decorators are erased and, as described in FAQ and manual, in this case the file element is not rendered correctly. The seen behaviour can be a result.\r\n\r\nAdditionally you are using 2 different adapters... this can also lead to unexpected behaviour.\r\n\r\nAs third, when you see no failure, returned message or exception then you must have configured something wrong... Zend_File can not suppress failures or exceptions. And by erasing the decorators a notice is triggered which you don't see. Check your configuration \/ settings.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-10-18T13:07:39.000+0000",
                    "updated": "2009-10-18T13:07:39.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8064\/transitions"
}