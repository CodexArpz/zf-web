{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9364",
    "key": "ZF-9364",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Form isValid|isValidPartial overwrites Translator of SubForms and Elements"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/5",
                "name": "Sub-task",
                "subtask": true
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9364\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10440",
                    "id": 10440,
                    "description": "Mini Release",
                    "name": "1.10.3",
                    "userReleaseDate": "01\/Apr\/10",
                    "archived": false,
                    "releaseDate": "2010-04-01",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-03-25T14:49:26.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                "name": "alab",
                "displayName": "Christian Albrecht",
                "active": true
            }
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-03-08T05:32:24.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-10-21T01:56:36.000+0000"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend_Form isValid and isValidPartial calls $element->setTranslator()\r\nnot respecting if an individual Translator was set for $element."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9364\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                "name": "rob",
                "displayName": "Rob Allen",
                "active": true
            }
        },
        "parent": {
            "name": "parent",
            "type": "issuelinks",
            "value": {
                "issueKey": "ZF-9350",
                "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9350",
                "type": {
                    "name": "Parent",
                    "direction": "INBOUND"
                }
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-9330",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9330",
                    "type": {
                        "name": "Related",
                        "direction": "OUTBOUND",
                        "description": "is related to"
                    }
                },
                {
                    "issueKey": "ZF-9275",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9275",
                    "type": {
                        "name": "Related",
                        "direction": "OUTBOUND",
                        "description": "is related to"
                    }
                },
                {
                    "issueKey": "ZF-11831",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11831",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10430",
                    "id": 10430,
                    "description": "Mini Release",
                    "name": "1.10.2",
                    "userReleaseDate": "24\/Feb\/10",
                    "archived": false,
                    "releaseDate": "2010-02-24",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39482",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dlorre",
                        "name": "dlorre",
                        "displayName": "Dominique Lorre",
                        "active": true
                    },
                    "body": "That would be better fixed in the isValid() method of Zend_Form_Element which is overriding the translator for validators. Hence, it would allow us to use the resources\/translators arrays and our custom translator for the elements.\r\n\r\n#line 1330 in Zend_Form_Element:\r\n[code]\r\n        foreach ($this->getValidators() as $key => $validator) {\r\n            if (method_exists($validator, 'setTranslator')) {\r\n                $validator->setTranslator($this->getTranslator());\r\n            }\r\n[\/code]",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dlorre",
                        "name": "dlorre",
                        "displayName": "Dominique Lorre",
                        "active": true
                    },
                    "created": "2010-03-23T08:39:30.000+0000",
                    "updated": "2010-03-23T08:39:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39487",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "Dominique, you are right that the Validation translator is overwritten in Zend_Form_Element::isValid(),\r\nbut that really is a different issue.\r\n\r\nBut i realized now the example above is not at the state of the patch, i will update that.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-03-23T10:23:19.000+0000",
                    "updated": "2010-03-23T10:23:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39497",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "body": "The description isn't too helpful :)\r\n\r\nThe actual problem reported here is that if you attach a translator object to the form and to one of the elements, then the translator object attached to the element is overridden by the one attached to the form when isValid() or isValidPartial() is called. It is reasonable that the law of specificity applies here and that if someone has taken the trouble to apply a translator to the element, then it should be used in preference to the form level one.\r\n\r\nCorrect patch:\r\n{code}\r\nIndex: library\/Zend\/Form.php\r\n===================================================================\r\n--- library\/Zend\/Form.php\t(revision 21616)\r\n+++ library\/Zend\/Form.php\t(working copy)\r\n@@ -2031,7 +2031,7 @@\r\n         }\r\n \r\n         foreach ($this->getElements() as $key => $element) {\r\n-            if (null !== $translator) {\r\n+            if (null !== $translator && !$element->getTranslator()) {\r\n                 $element->setTranslator($translator);\r\n             }\r\n             if (!isset($data[$key])) {\r\n@@ -2079,7 +2079,7 @@\r\n \r\n         foreach ($data as $key => $value) {\r\n             if (null !== ($element = $this->getElement($key))) {\r\n-                if (null !== $translator) {\r\n+                if (null !== $translator && !$element->getTranslator()) {\r\n                     $element->setTranslator($translator);\r\n                 }\r\n                 $valid = $element->isValid($value, $data) && $valid;\r\n{code}\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "created": "2010-03-23T13:46:20.000+0000",
                    "updated": "2010-03-23T13:46:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39499",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "body": "Fixed in trunk r21617 and release-1.10 branch r21618.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "created": "2010-03-23T14:19:40.000+0000",
                    "updated": "2010-03-23T14:19:40.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39503",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "Thank you Rob,\r\nas i am new to ZFdev and new to collaborative OS Development in general,\r\ni am not used to the terms. You have correctly described the problem i \r\nthought to address here.\r\n\r\nI only recognize Zend_Form growed over time, getting more features and\r\nloosing concept.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-03-24T00:23:45.000+0000",
                    "updated": "2010-03-24T00:23:45.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39505",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dlorre",
                        "name": "dlorre",
                        "displayName": "Dominique Lorre",
                        "active": true
                    },
                    "body": "Christian, I was referring to ZF 9275 which is mentioned to be fixed by this patch.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dlorre",
                        "name": "dlorre",
                        "displayName": "Dominique Lorre",
                        "active": true
                    },
                    "created": "2010-03-24T04:06:14.000+0000",
                    "updated": "2010-03-24T04:06:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39511",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "Dominique, i reopend [ZF-9275]",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-03-24T07:31:08.000+0000",
                    "updated": "2010-03-24T07:31:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39535",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "The commited fix is incorrect as $element->getTranslator() will return\r\nthe default Translator from Zend_Form and if Zend_Form has no\r\ndefault Translator set the one from Zend_Registry if this is set.\r\nOnly when there is no translator set in the chain $element->getTranslator()\r\nreturns null.\r\n\r\nSo in a case when there is an indivdual Translator set for Zend_Form which\r\nshould overwrite the default Translator from Zend_Form or even Zend_Registry\r\nthis will not happen.\r\n\r\nCleaner solution, add Method hasTranslator() to Zend_Form and Zend_Form_Element\r\n\r\n{code}\r\nIndex: library\/Zend\/Form.php\r\n===================================================================\r\n--- library\/Zend\/Form.php       (Revision 21641)\r\n+++ library\/Zend\/Form.php       (Arbeitskopie)\r\n@@ -2031,7 +2031,7 @@\r\n         }\r\n \r\n         foreach ($this->getElements() as $key => $element) {\r\n-            if (null !== $translator && !$element->getTranslator()) {\r\n+            if (null !== $translator && !$element->hasTranslator()) {\r\n                 $element->setTranslator($translator);\r\n             }\r\n             if (!isset($data[$key])) {\r\n@@ -2041,7 +2041,9 @@\r\n             }\r\n         }\r\n         foreach ($this->getSubForms() as $key => $form) {\r\n-            $form->setTranslator($translator);\r\n+            if (null !== $translator && !$form->hasTranslator()) {\r\n+                $form->setTranslator($translator);\r\n+            }\r\n             if (isset($data[$key])) {\r\n                 $valid = $form->isValid($data[$key]) && $valid;\r\n             } else {\r\n@@ -2079,12 +2081,12 @@\r\n \r\n         foreach ($data as $key => $value) {\r\n             if (null !== ($element = $this->getElement($key))) {\r\n-                if (null !== $translator && !$element->getTranslator()) {\r\n+                if (null !== $translator && !$element->hasTranslator()) {\r\n                     $element->setTranslator($translator);\r\n                 }\r\n                 $valid = $element->isValid($value, $data) && $valid;\r\n             } elseif (null !== ($subForm = $this->getSubForm($key))) {\r\n-                if (null !== $translator) {\r\n+                if (null !== $translator && !$subForm->hasTranslator()) {\r\n                     $subForm->setTranslator($translator);\r\n                 }\r\n                 $valid = $subForm->isValidPartial($data[$key]) && $valid;\r\n@@ -2093,7 +2095,7 @@\r\n         }\r\n         foreach ($this->getSubForms() as $key => $subForm) {\r\n             if (!in_array($key, $validatedSubForms)) {\r\n-                if (null !== $translator) {\r\n+                if (null !== $translator && !$subForm->hasTranslator()) {\r\n                     $subForm->setTranslator($translator);\r\n                 }\r\n \r\n@@ -2743,6 +2745,20 @@\r\n     }\r\n \r\n     \/**\r\n+     * Was a (default) Translator set?\r\n+     *\r\n+     * @return Boolean\r\n+     *\/\r\n+    public function hasTranslator()\r\n+    {\r\n+        if (null === $this->_translator &&\r\n+            null === self::$_translatorDefault) {\r\n+            return false;\r\n+        }\r\n+        return true;\r\n+    }\r\n+\r\n+    \/**\r\n      * Get global default translator object\r\n      *\r\n      * @return null|Zend_Translate\r\nIndex: library\/Zend\/Form\/Element.php\r\n===================================================================\r\n--- library\/Zend\/Form\/Element.php       (Revision 21641)\r\n+++ library\/Zend\/Form\/Element.php       (Arbeitskopie)\r\n@@ -415,6 +415,19 @@\r\n     }\r\n \r\n     \/**\r\n+     * Was a Translator set?\r\n+     *\r\n+     * @return Boolean\r\n+     *\/\r\n+    public function hasTranslator()\r\n+    {\r\n+        if (null === $this->_translator) {\r\n+            return false;\r\n+        }\r\n+        return true;\r\n+    }\r\n+\r\n+    \/**\r\n      * Indicate whether or not translation should be disabled\r\n      *\r\n      * @param  bool $flag\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-03-25T08:16:02.000+0000",
                    "updated": "2010-03-25T14:01:17.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39536",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "Please review, there is an error in the commited fix.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-03-25T08:17:18.000+0000",
                    "updated": "2010-03-25T08:17:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39538",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "proove that it works\r\n{code}\r\ncd library\r\nphp -r 'require_once \"Zend\/Translate.php\"; \\\r\nrequire_once \"Zend\/Form.php\"; \\\r\n$translate = new Zend_Translate(\"Array\"); \\\r\n$form = new Zend_Form(); \\\r\nvar_dump($form->hasTranslator()); \\\r\nZend_Form::setDefaultTranslator($translate); \\\r\nvar_dump($form->hasTranslator());'\r\n\/\/ bool(false)\r\n\/\/ bool(true)\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-03-25T08:38:11.000+0000",
                    "updated": "2010-03-25T08:39:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39569",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "body": "The commit works as designed to fix the described issue :)\r\n\r\nThere is however a new issue introduced as a result as noted by Christian: If the element doesn't have a local translator and a translator is set into the registry using the key \"Zend_Translate\", then the form's translator is not used and the one in the registry is used instead.\r\n\r\nAs noted, this is because Zend_Form_Element::getTranslator() will return the 'Zend_Translate' translator if there isn't a local one set. \r\n\r\nThis patch with unit test fixes it:\r\n{code}\r\nIndex: tests\/Zend\/Form\/FormTest.php\r\n===================================================================\r\n--- tests\/Zend\/Form\/FormTest.php\t(revision 21644)\r\n+++ tests\/Zend\/Form\/FormTest.php\t(working copy)\r\n@@ -3847,6 +3847,42 @@\r\n         $this->assertEquals(2, count($messages));\r\n         $this->assertEquals('Element message', $messages['foo']['isEmpty']);\r\n         $this->assertEquals('Form message', $messages['bar']['isEmpty']);\r\n+    }\r\n+    \r\n+    \/**\r\n+     * @group ZF-9364\r\n+     *\/\r\n+    public function testElementTranslatorPreferredOverDefaultTranslator()\r\n+    {\r\n+        $defaultTranslations = array(\r\n+            'isEmpty' => 'Default message',\r\n+        );\r\n+        $formTranslations = array(\r\n+            'isEmpty' => 'Form message',\r\n+        );        \r\n+        $elementTranslations = array(\r\n+            'isEmpty' => 'Element message',\r\n+        );\r\n+        $defaultTranslate = new Zend_Translate('array', $defaultTranslations);\r\n+        $formTranslate = new Zend_Translate('array', $formTranslations);\r\n+        $elementTranslate = new Zend_Translate('array', $elementTranslations);\r\n+        \r\n+        Zend_Registry::set('Zend_Translate', $defaultTranslate);\r\n+        $this->form->setTranslator($formTranslate);        \r\n+        $this->form->addElement('text', 'foo', array('required'=>true, 'translator'=>$elementTranslate));\r\n+        $this->form->addElement('text', 'bar', array('required'=>true));\r\n+\r\n+        $this->assertFalse($this->form->isValid(array('foo'=>'', 'bar'=>'')));\r\n+        $messages = $this->form->getMessages();\r\n+        $this->assertEquals(2, count($messages));\r\n+        $this->assertEquals('Element message', $messages['foo']['isEmpty']);\r\n+        $this->assertEquals('Form message', $messages['bar']['isEmpty']);\r\n+        \r\n+        $this->assertFalse($this->form->isValidPartial(array('foo'=>'', 'bar'=>'')));\r\n+        $messages = $this->form->getMessages();\r\n+        $this->assertEquals(2, count($messages));\r\n+        $this->assertEquals('Element message', $messages['foo']['isEmpty']);\r\n+        $this->assertEquals('Form message', $messages['bar']['isEmpty']);\r\n     }    \r\n \r\n     \/**\r\nIndex: library\/Zend\/Form.php\r\n===================================================================\r\n--- library\/Zend\/Form.php\t(revision 21644)\r\n+++ library\/Zend\/Form.php\t(working copy)\r\n@@ -2031,7 +2031,7 @@\r\n         }\r\n \r\n         foreach ($this->getElements() as $key => $element) {\r\n-            if (null !== $translator && !$element->getTranslator()) {\r\n+            if (null !== $translator && !$element->hasTranslator()) {\r\n                 $element->setTranslator($translator);\r\n             }\r\n             if (!isset($data[$key])) {\r\n@@ -2079,7 +2079,7 @@\r\n \r\n         foreach ($data as $key => $value) {\r\n             if (null !== ($element = $this->getElement($key))) {\r\n-                if (null !== $translator && !$element->getTranslator()) {\r\n+                if (null !== $translator && !$element->hasTranslator()) {\r\n                     $element->setTranslator($translator);\r\n                 }\r\n                 $valid = $element->isValid($value, $data) && $valid;\r\nIndex: library\/Zend\/Form\/Element.php\r\n===================================================================\r\n--- library\/Zend\/Form\/Element.php\t(revision 21644)\r\n+++ library\/Zend\/Form\/Element.php\t(working copy)\r\n@@ -413,6 +413,16 @@\r\n         }\r\n         return $this->_translator;\r\n     }\r\n+    \r\n+    \/**\r\n+     * Does this element have its own specific translator?\r\n+     * \r\n+     * @return bool\r\n+     *\/\r\n+    public function hasTranslator()\r\n+    {\r\n+        return (bool)$this->_translator;\r\n+    }\r\n \r\n     \/**\r\n      * Indicate whether or not translation should be disabled\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "created": "2010-03-25T14:45:00.000+0000",
                    "updated": "2010-03-25T14:45:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39570",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "body": "Fixed again.  Trunk: r21648, release-1.0 branch: r21649",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "created": "2010-03-25T14:49:26.000+0000",
                    "updated": "2010-03-25T14:49:26.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9364\/transitions"
}