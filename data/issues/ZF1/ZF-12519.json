{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12519",
    "key": "ZF-12519",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "CLONE - Support for OpenId extension: Attribute Exchange"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/2",
                "name": "New Feature",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12519\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/3",
                "name": "Duplicate"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2013-02-05T08:29:05.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=maerf0x0",
                "name": "maerf0x0",
                "displayName": "Mike Graf",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2013-02-04T19:11:57.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2013-02-05T08:29:05.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Due to the increased popularity and the support of many popular providers, many sites are now looking to add OpenId support.  While currently it is possible to authenticate with google (with minor modifications) data can only be exchanged using Attribute Exchange.  This protocol is defined in [http:\/\/openid.net\/specs\/openid-attribute-exchange-1_0.html].  Google uses this protocol to exchange data such as gmail address, name, country and language.  I have created a *very* basic implementation that will allow consumers to pull data from google.  I have not implemented the provider side of the protocol and completely left out the capability to store data back on the providers servers.  This may be used as a starting point and will immediately allow consumers to query google.\r\n\r\n{code}\r\n<?php\r\n\/**\r\n * Extension class for Zend_OpenId.  Provides attribute exchange protocol.\r\n * \r\n * @author Chris Bisnett cbisnett@gmail.com\r\n * @date 19July2009\r\n *\/\r\nclass AttributeExchange extends Zend_OpenId_Extension\r\n{\r\n\t\/**\r\n\t * Namespace URI for attribute exchange version 1.0\r\n\t *\/\r\n\tconst NS_URL = 'http:\/\/openid.net\/srv\/ax\/1.0';\r\n\t\r\n\t\/**\r\n\t * Defined attributes listed at http:\/\/www.axschema.org\/types as of 19July2009.\r\n\t *\/\r\n\tprivate $_definedAttributes = array(\r\n\t\t\/\/ Name types\r\n\t\t'userName' => 'http:\/\/axschema.org\/namePerson\/friendly',\r\n\t\t'fullName' => 'http:\/\/axschema.org\/namePerson',\r\n\t\t'namePrefix' => 'http:\/\/axschema.org\/namePerson\/prefix',\r\n\t\t'firstName' => 'http:\/\/axschema.org\/namePerson\/first',\r\n\t\t'lastName' => 'http:\/\/axschema.org\/namePerson\/last',\r\n\t\t'middleName' => 'http:\/\/axschema.org\/namePerson\/middle',\r\n\t\t'nameSuffix' => 'http:\/\/axschema.org\/namePerson\/suffix',\r\n\t\t\r\n\t\t\/\/ Work types\r\n\t\t'company' => 'http:\/\/axschema.org\/company\/name',\r\n\t\t'jobTitle' => 'http:\/\/axschema.org\/company\/title',\r\n\t\t\r\n\t\t\/\/ Date of birth\r\n\t\t'birthDate' => 'http:\/\/axschema.org\/birthDate',\r\n\t\t'birthYear' => 'http:\/\/axschema.org\/birthDate\/birthYear',\r\n\t\t'birthMonth' => 'http:\/\/axschema.org\/birthDate\/birthMonth',\r\n\t\t'birthDay' => 'http:\/\/axschema.org\/birthDate\/birthday',\r\n\t\t\r\n\t\t\/\/ Telephone\r\n\t\t'phoneDefault' => 'http:\/\/axschema.org\/contact\/phone\/default',\r\n\t\t'phoneHome' => 'http:\/\/axschema.org\/contact\/phone\/home',\r\n\t\t'phoneBusiness' => 'http:\/\/axschema.org\/contact\/phone\/business',\r\n\t\t'phoneCell' => 'http:\/\/axschema.org\/contact\/phone\/cell',\r\n\t\t'phoneFax' => 'http:\/\/axschema.org\/contact\/phone\/fax',\r\n\t\t\r\n\t\t\/\/ Address\r\n\t\t'address' => 'http:\/\/axschema.org\/contact\/postalAddress\/home',\r\n\t\t'address2' => 'http:\/\/axschema.org\/contact\/postalAddressAdditional\/home',\r\n\t\t'city' => 'http:\/\/axschema.org\/contact\/city\/home',\r\n\t\t'state' => 'http:\/\/axschema.org\/contact\/state\/home',\r\n\t\t'country' => 'http:\/\/axschema.org\/contact\/country\/home',\r\n\t\t'postalCode' => 'http:\/\/axschema.org\/contact\/postalCode\/home',\r\n\t\t\r\n\t\t\/\/ Email\r\n\t\t'email' => 'http:\/\/axschema.org\/contact\/email',\r\n\t\t\r\n\t\t\/\/ Instant messaging\r\n\t\t'aim' => 'http:\/\/axschema.org\/contact\/IM\/AIM',\r\n\t\t'icq' => 'http:\/\/axschema.org\/contact\/IM\/ICQ',\r\n\t\t'msn' => 'http:\/\/axschema.org\/contact\/IM\/MSN',\r\n\t\t'yahoo' => 'http:\/\/axschema.org\/contact\/IM\/Yahoo',\r\n\t\t'jabber' => 'http:\/\/axschema.org\/contact\/IM\/Jabber',\r\n\t\t'skype' => 'http:\/\/axschema.org\/contact\/IM\/Skype',\r\n\t\t\r\n\t\t\/\/ Web sites\r\n\t\t'webPage' => 'http:\/\/axschema.org\/contact\/web\/default',\r\n\t\t'blog' => 'http:\/\/axschema.org\/contact\/web\/blog',\r\n\t\t'linkedIn' => 'http:\/\/axschema.org\/contact\/web\/Linkedin',\r\n\t\t'amazon' => 'http:\/\/axschema.org\/contact\/web\/Amazon',\r\n\t\t'flickr' => 'http:\/\/axschema.org\/contact\/web\/Flickr',\r\n\t\t'delicious' => 'http:\/\/axschema.org\/contact\/web\/Delicious',\r\n\t\t\r\n\t\t\/\/ Audio\/Video greetings\r\n\t\t'spokenName' => 'http:\/\/axschema.org\/media\/spokenname',\r\n\t\t'audioGreeting' => 'http:\/\/axschema.org\/media\/greeting\/audio',\r\n\t\t'videoGreeting' => 'http:\/\/axschema.org\/media\/greeting\/video',\r\n\t\t\r\n\t\t\/\/ Images\r\n\t\t'defaultImage' => 'http:\/\/axschema.org\/media\/image\/default',\r\n\t\t'squareImage' => 'http:\/\/axschema.org\/media\/image\/aspect11',\r\n\t\t'43Image' => 'http:\/\/axschema.org\/media\/image\/aspect43',\r\n\t\t'34Image' => 'http:\/\/axschema.org\/media\/image\/aspect34',\r\n\t\t'favIcon' => 'http:\/\/axschema.org\/media\/image\/favicon',\r\n\t\t\r\n\t\t\/\/ Misc details\r\n\t\t'gender' => 'http:\/\/axschema.org\/person\/gender',\r\n\t\t'language' => 'http:\/\/axschema.org\/pref\/language',\r\n\t\t'timezone' => 'http:\/\/axschema.org\/pref\/timezone',\r\n\t\t'biography' => 'http:\/\/axschema.org\/media\/biography'\r\n\t);\r\n\t\r\n\t\/**\r\n\t * Name\/Value pairs of requested attributes and a boolean specifying if the attribute is required.\r\n\t *\/\r\n\tprivate $_attributes = array();\r\n\t\r\n\t\/**\r\n\t * Holds the attribute and the returned value.\r\n\t *\/\r\n\tprivate $_properties = array();\r\n\t\r\n\tpublic function __construct(array $attribs)\r\n\t{\r\n\t\t$this->_attributes = $attribs;\r\n\t}\r\n\t\r\n\t\/**\r\n\t * Gets the property values returned by the provider.\r\n\t * \r\n\t * @return array\r\n\t *\/\r\n\tpublic function getProperties()\r\n\t{\r\n\t\treturn $this->_properties;\r\n\t}\r\n\t\r\n\tprivate function splitParams($params)\r\n\t{\r\n\t\t$final = array();\r\n\t\t\r\n\t\t\/\/ Loop the parameters\r\n\t\tforeach ($params as $identifier => $value)\r\n\t\t{\r\n\t\t\t\/\/ Split the identifier at the boundries\r\n\t\t\t$levels = explode('_', $identifier);\r\n\t\t\t\r\n\t\t\t\/\/ Get the last value as the key\r\n\t\t\t$key = array_pop($levels);\r\n\t\t\t\r\n\t\t\t\/\/ Loop the levels, creating any that don't exist\r\n\t\t\t$currentlevel = &$final;\r\n\t\t\tforeach ($levels as $level)\r\n\t\t\t{\r\n\t\t\t\t\/\/ Check if the level is defined\r\n\t\t\t\tif (!isset($currentlevel[$level]))\r\n\t\t\t\t\t\/\/ Create the level\r\n\t\t\t\t\t$currentlevel[$level] = array();\r\n\t\t\t\telse\r\n\t\t\t\t{\r\n\t\t\t\t\t\/\/ Change any found value to the first key of an array\r\n\t\t\t\t\tif (!is_array($currentlevel[$level]))\r\n\t\t\t\t\t\t$currentlevel[$level] = array($currentlevel[$level]);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t\/\/ Move down to the next level\r\n\t\t\t\t$currentlevel = &$currentlevel[$level];\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t\/\/ Set the value\r\n\t\t\t$currentlevel[$key] = $value;\r\n\t\t}\r\n\t\t\r\n\t\treturn $final;\r\n\t}\r\n\t\r\n\t\/**\r\n\t * Adds an attribute type and URI to the list of defined attributes.  This\r\n\t * can be used to add expiremental types for testing.\r\n\t * \r\n\t * @param array &$attribs New attribute\/URI pairs\r\n\t * @return bool\r\n\t *\/\r\n\tpublic function addType($attribs)\r\n\t{\r\n\t\t\/\/ Verify the attributes is an array\r\n\t\tif (!is_array($attribs))\r\n\t\t\treturn false;\r\n\t\t\r\n\t\t\/\/ Merge the new types into the defined attributes\r\n\t\t$this->_definedAttributes = array_merge($this->_definedAttributes, $attribs);\r\n\t\t\r\n\t\treturn true;\r\n\t}\r\n\t\r\n    \/**\r\n     * Generates a request to be sent to the provider requesting the\r\n     * specified attributes.\r\n     *\r\n     * @param array &$params request's var\/val pairs\r\n     * @return bool\r\n     *\/\r\n    public function prepareRequest(&$params)\r\n    {\r\n    \t\/\/ Don't add attributes if there are none\r\n    \tif (!is_array($this->_attributes) || count($this->_attributes) < 1)\r\n    \t\treturn;\r\n    \t\r\n    \t\/\/ Setup the lists\r\n    \t$requiredAttributes = '';\r\n    \t$availableAttributes = '';\r\n    \t    \t\r\n    \t\/\/ Set the name space\r\n    \t$params['openid.ns.ax'] = AttributeExchange::NS_URL;\r\n    \t\r\n    \t\/\/ Set the mode\r\n    \t$params['openid.ax.mode'] = 'fetch_request';\r\n    \t\r\n    \t\/\/ Loop the attributes only adding those that are valid\r\n    \tforeach ($this->_attributes as $attr => $isRequired)\r\n    \t{\r\n    \t\t\/\/ Check if the attribute is defined\r\n    \t\tif (!isset($this->_definedAttributes[$attr]))\r\n    \t\t\tcontinue;\r\n    \t\t\r\n    \t\t\/\/ Add the attribute to a list\r\n    \t\tif ($isRequired)\r\n    \t\t\t$requiredAttributes .= (empty($requiredAttributes)) ? $attr : ',' . $attr;\r\n    \t\telse\r\n    \t\t\t$availableAttributes .= (empty($availableAttributes)) ? $attr : ',' . $attr;\r\n    \t\t\r\n    \t\t\/\/ Add the type\r\n    \t\t$params['openid.ax.type.' . $attr] = $this->_definedAttributes[$attr];\r\n    \t}\r\n    \t\r\n    \t\/\/ Add the required\r\n    \tif (!empty($requiredAttributes))\r\n    \t\t$params['openid.ax.required'] = $requiredAttributes;\r\n    \t\r\n    \t\/\/ Add the requested\r\n    \tif (!empty($availableAttributes))\r\n    \t\t$params['openid.ax.if_available'] = $availableAttributes;\r\n    \t\r\n        return true;\r\n    }\r\n\r\n    \/**\r\n     * Parses the request from the consumer to determine what attribute values\r\n     * to return to the consumer.\r\n     *\r\n     * @param array $params request's var\/val pairs\r\n     * @return bool\r\n     *\/\r\n    public function parseRequest($params)\r\n    {\r\n        return true;\r\n    }\r\n\r\n    \/**\r\n     * Generates a response to the consumer's request that contains the\r\n     * requested attributes.\r\n     *\r\n     * @param array &$params response's var\/val pairs\r\n     * @return bool\r\n     *\/\r\n    public function prepareResponse(&$params)\r\n    {\r\n        return true;\r\n    }\r\n\r\n    \/**\r\n     * Gets property values from the response returned by the provider\r\n     *\r\n     * @param array $params response's var\/val pairs\r\n     * @return bool\r\n     *\/\r\n    public function parseResponse($params)\r\n    {\r\n    \t$params = $this->splitParams($params);\r\n    \t$ax = null;\r\n    \t\r\n    \t\/\/ Get the data name space\r\n    \tif (isset($params['openid']['ns']['ax']) && $params['openid']['ns']['ax'] == AttributeExchange::NS_URL)\r\n    \t\t$ax = $params['openid']['ax'];\r\n    \telse\r\n    \t{\r\n    \t\t\/\/ Loop the extensions looking for the namespace url\r\n    \t\tforeach ($params['openid']['ns'] as $namespace => $uri)\r\n    \t\t{\r\n    \t\t\t\/\/ Check if the uri is attribute exchange\r\n    \t\t\tif ($uri == AttributeExchange::NS_URL)\r\n    \t\t\t{\r\n    \t\t\t\t$ax = $params['openid'][$namespace];\r\n    \t\t\t\tbreak;\r\n    \t\t\t}\r\n    \t\t}\r\n    \t}\r\n    \t\r\n    \t\/\/ Check if the data was found\r\n    \tif ($ax == null)\r\n    \t\treturn false;\r\n    \t\r\n    \t\/\/ Verify the mode is fetch_response\r\n    \tif (isset($ax['mode']) && $ax['mode'] != 'fetch_response')\r\n    \t\treturn false;\r\n    \t\r\n    \t\/\/ Get the attributes\r\n    \tforeach ($ax['value'] as $attr => $value)\r\n    \t{\r\n    \t\t$this->_properties[$attr] = $value;\r\n    \t}\r\n    \t\r\n        return true;\r\n    }\r\n}\r\n{code}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12519\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User"
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-7328",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7328",
                    "type": {
                        "name": "Duplicate",
                        "direction": "OUTBOUND",
                        "description": "duplicates"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10340",
                    "id": 10340,
                    "description": "Mini Release",
                    "name": "1.8.4",
                    "userReleaseDate": "23\/Jun\/09",
                    "archived": false,
                    "releaseDate": "2009-06-23",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10210",
                    "id": 10210,
                    "name": "Zend_OpenId",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [

            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12519\/transitions"
}