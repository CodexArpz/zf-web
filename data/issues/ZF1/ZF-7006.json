{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7006",
    "key": "ZF-7006",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "setValue on Select fields does not correctly handle UUIDs which are ~16 digits long "
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7006\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=griesi007",
                "name": "griesi007",
                "displayName": "Christian Ebert",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-06-13T07:10:14.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-07-30T12:55:52.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Because we need to synchronise offline with online DB\u00b4s, we are using a sort of UUIDs for our primary keys. The UUIDs are generated with MySQL\u00b4s UUID_SHORT() function. This function returns UUIDs which consist only of digits and have a length around 16 digits. Because these UUIDs are longer than the maximum allowed Integer length in PHP (11 digits), these UUID\u00b4s must be handled as strings. When handled as Integers all digits after digit 11 are cut off. \r\n\r\nThe problem is when using these UUID\u00b4s with Select form fields. When setting the default value with setValue a lot of options are marked selected=selected and not only the one which should. Therefore if existing data is loaded in the form for editing, the last option with selected=selected is selected and not the one which should be. When saving the form even if the user has not modified the data, the wrong option is saved. This is very very bad. \r\n\r\nI guess this results because somewhere in the Zend Framework, values with digits are handled as Integer and not as string. Probably values with more than 11 digits should always be handled as string.\r\n\r\nThis is a very ugly bug because existing data is randomly modified when loaded for editing. The User does not even recognize this.\r\n "
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7006\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                "name": "ralph",
                "displayName": "Ralph Schindler",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10241",
                    "id": 10241,
                    "description": "Minor Release",
                    "name": "1.8.0",
                    "userReleaseDate": "30\/Apr\/09",
                    "archived": false,
                    "releaseDate": "2009-04-30",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10026",
                    "id": 10026,
                    "name": "Zend_View",
                    "description": "View portion of the ZF MVC",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38771",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arsa",
                        "name": "arsa",
                        "displayName": "Raul",
                        "active": true
                    },
                    "body": "For everyone affected by this bug:\r\n\r\nPHP's function in_array has a third parameter called 'strict' used to force the type checking of the needle and the haystack.\r\n\r\nJust taking a look at the FormSelect class file you will see that it uses this function to check which option should be selected.\r\nChange the original function:\r\nprotected function _build($value, $label, $selected, $disable)\r\n    {\r\n        if (is_bool($disable)) {\r\n            $disable = array();\r\n        }\r\n\r\n        $opt = '<option'\r\n             . ' value=\"' . $this->view->escape($value) . '\"'\r\n             . ' label=\"' . $this->view->escape($label) . '\"';\r\n\r\n        \/\/ selected?\r\n        if (in_array((string) $value, $selected)) {\r\n            $opt .= ' selected=\"selected\"';\r\n        }\r\n\r\n        \/\/ disabled?\r\n        if (in_array($value, $disable)) {\r\n            $opt .= ' disabled=\"disabled\"';\r\n        }\r\n\r\n        $opt .= '>' . $this->view->escape($label) . \"<\/option>\";\r\n\r\n        return $opt;\r\n    }\r\n\r\n\r\nfor this other:\r\n\r\nprotected function _build($value, $label, $selected, $disable)\r\n    {\r\n        if (is_bool($disable)) {\r\n            $disable = array();\r\n        }\r\n\r\n        $opt = '<option'\r\n             . ' value=\"' . $this->view->escape($value) . '\"'\r\n             . ' label=\"' . $this->view->escape($label) . '\"';\r\n\r\n        \/\/ selected?\r\n        if (in_array((string) $value, $selected, true)) {\r\n            $opt .= ' selected=\"selected\"';\r\n        }\r\n\r\n        \/\/ disabled?\r\n        if (in_array($value, $disable)) {\r\n            $opt .= ' disabled=\"disabled\"';\r\n        }\r\n\r\n        $opt .= '>' . $this->view->escape($label) . \"<\/option>\";\r\n\r\n        return $opt;\r\n    }\r\n\r\nAnd all will go fine :)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arsa",
                        "name": "arsa",
                        "displayName": "Raul",
                        "active": true
                    },
                    "created": "2010-02-26T04:03:09.000+0000",
                    "updated": "2010-02-26T04:03:09.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7006\/transitions"
}