{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6653",
    "key": "ZF-6653",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Calling from() and join() \"out of order\" causes incorrect SELECT generation"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField",
            "value": {
                "timeoriginalestimate": 0,
                "timeestimate": 0
            }
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6653\/votes",
                "votes": 3,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10370",
                    "id": 10370,
                    "description": "Mini Release",
                    "name": "1.9.4",
                    "userReleaseDate": "13\/Oct\/09",
                    "archived": false,
                    "releaseDate": "2009-10-13",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-10-12T07:36:57.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dkarlovi",
                "name": "dkarlovi",
                "displayName": "Dalibor Karlovic",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-05-14T08:12:02.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-10-12T07:36:56.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "auth",
                "from",
                "join",
                "order",
                "select"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I was trying to adjust the Zend_Auth DB adapter result to include the user role for a simple ACL I'm doing (I've tables \"users\" and \"roles\", with the former containing a FK to the latter).\n\n{code}\n\/\/ $select instanceof Zend_Db_Select:\n\n        $select\n            ->from(array('u' => 'users'), array('username'))\n            ->joinLeft(array('r' => 'roles'), 'u.role_id = r.role_id', array('role' => 'name'));\n\n\/\/ gives SELECT `u`.`username`, `r`.`name` AS `role` FROM `users` AS `u` LEFT JOIN `roles` AS `r` ON u.role_id = r.role_id\n\n\n        $select\n            ->joinLeft(array('r' => 'roles'), 'u.role_id = r.role_id', array('role' => 'name'))\n            ->from(array('u' => 'users'), array('username'));\n\n\/\/ gives SELECT `r`.`name` AS `role`, `u`.`username` FROM `roles` AS `r` INNER JOIN `users` AS `u`\n{code}\n\nThe DB auth adapter returns an empty $select so anything I do to it get's done first. This may be viewed as the adapter's fault but IMHO, you shouldn't force a specific order of calling the methods: I've said from('table') and expect to really be FROM table. :)"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/6",
                "name": "N\/A"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6653\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                "name": "ralph",
                "displayName": "Ralph Schindler",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12043",
                    "filename": "Select.php.diff",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shaddyz",
                        "name": "shaddyz",
                        "displayName": "Shaddy Zeineddine",
                        "active": true
                    },
                    "created": "2009-06-22T19:05:39.000+0000",
                    "size": 1202,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12043\/Select.php.diff"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-8344",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8344",
                    "type": {
                        "name": "Sub-Task",
                        "direction": "OUTBOUND"
                    }
                }
            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10310",
                    "id": 10310,
                    "description": "Mini Release",
                    "name": "1.8.1",
                    "userReleaseDate": "12\/May\/09",
                    "archived": false,
                    "releaseDate": "2009-05-12",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10132",
                    "id": 10132,
                    "name": "Zend_Db_Select",
                    "description": "OO interface to building a SELECT SQL query.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30978",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dkarlovi",
                        "name": "dkarlovi",
                        "displayName": "Dalibor Karlovic",
                        "active": true
                    },
                    "body": "Yeah, the code tag didn't take, hope this doesn't mean my issue get's disqualified. :)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dkarlovi",
                        "name": "dkarlovi",
                        "displayName": "Dalibor Karlovic",
                        "active": true
                    },
                    "created": "2009-05-14T08:12:50.000+0000",
                    "updated": "2009-05-14T08:12:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31989",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shaddyz",
                        "name": "shaddyz",
                        "displayName": "Shaddy Zeineddine",
                        "active": true
                    },
                    "body": "I can confirm this. I was trying to customize Zend_Auth because i store the password and identity in different tables\n\n{code}\n$adapter = new Zend_Auth_Adapter_DbTable($db, array('p'  => 'people'), 'p.person_tag', 'pd.person_password');\n$select = $adapter->getDbSelect();\n$select->join(array('pd' => 'people_detail'), 'p.person_id = pd.person_id', array('pd.person_password'));\n$adapter->setIdentity($person_tag)\n              ->setCredential($person_password);\n$result = $auth->authenticate($adapter);\n{code}\n\nwhat happens in the select is this:\n{code}\n            [from] => Array\n                (\n                    [pd] => Array\n                        (\n                            [joinType] => inner join\n                            [schema] => \n                            [tableName] => people_detail\n                            [joinCondition] => p.person_id = pd.person_id\n                        )\n\n                    [p] => Array\n                        (\n                            [joinType] => inner join\n                            [schema] => \n                            [tableName] => people\n                            [joinCondition] => \n                        )\n\n                )\n{code}\n\nand that creates a query like this:\n{code}\nSELECT `pd`.`person_password`, `p`.*, (CASE WHEN `pd`.`person_password` = 'password' THEN 1 ELSE 0 END) AS `zend_auth_credential_match` FROM `people_detail` AS `pd` INNER JOIN `people` AS `p` WHERE (`p`.`person_tag` = 'test')\n{code}\n\nbut it should be like this:\n{code}\nSELECT `pd`.`person_password`, `p`.*, (CASE WHEN `pd`.`person_password` = 'password' THEN 1 ELSE 0 END) AS `zend_auth_credential_match` FROM `people` AS `p` INNER JOIN `people_detail` AS `pd` ON p.person_id = pd.person_id WHERE (`p`.`person_tag` = 'test')\n{code}\n\nI'm guessing it should check the join condition to know if it should be shown as a join",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shaddyz",
                        "name": "shaddyz",
                        "displayName": "Shaddy Zeineddine",
                        "active": true
                    },
                    "created": "2009-06-19T10:39:50.000+0000",
                    "updated": "2009-06-19T10:39:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32085",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shaddyz",
                        "name": "shaddyz",
                        "displayName": "Shaddy Zeineddine",
                        "active": true
                    },
                    "body": "A solution to the problem which differentiates tables added with the from method",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shaddyz",
                        "name": "shaddyz",
                        "displayName": "Shaddy Zeineddine",
                        "active": true
                    },
                    "created": "2009-06-22T19:05:44.000+0000",
                    "updated": "2009-06-22T19:05:44.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32086",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shaddyz",
                        "name": "shaddyz",
                        "displayName": "Shaddy Zeineddine",
                        "active": true
                    },
                    "body": "my previous comment was in reference to the file i attached",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shaddyz",
                        "name": "shaddyz",
                        "displayName": "Shaddy Zeineddine",
                        "active": true
                    },
                    "created": "2009-06-22T19:06:21.000+0000",
                    "updated": "2009-06-22T19:06:21.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34205",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ccppprogrammer",
                        "name": "ccppprogrammer",
                        "displayName": "Nikolay Goldschmidt",
                        "active": true
                    },
                    "body": "I have same problem.\nWhen use join\/joinLeft\/joinRight Zend_Auth_Adapter_DbTable generate sql statement without second argument in join function (joinCondition).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ccppprogrammer",
                        "name": "ccppprogrammer",
                        "displayName": "Nikolay Goldschmidt",
                        "active": true
                    },
                    "created": "2009-09-03T02:44:03.000+0000",
                    "updated": "2009-09-03T02:44:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35062",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "Fix in trunk at r18475, might go into 1.9, needs to be decided.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2009-10-03T15:13:33.000+0000",
                    "updated": "2009-10-03T15:13:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35166",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "Fixed in r18511 in release 1.9 branch",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2009-10-12T07:36:48.000+0000",
                    "updated": "2009-10-12T07:36:48.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6653\/transitions"
}