{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11160",
    "key": "ZF-11160",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "RegisterErrorHandle not work in bootstrap"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11160\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/5",
                "name": "Cannot Reproduce"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-05-04T22:34:52.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fabioginzel",
                "name": "fabioginzel",
                "displayName": "Fabio Ginzel",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-03-10T19:17:54.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-05-04T22:34:52.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "If I call the Registererrorhandle from the bootstrap, it does not work on the errors that occur within the controller\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11160\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                "name": "adamlundrigan",
                "displayName": "Adam Lundrigan",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10540",
                    "id": 10540,
                    "description": "Mini Release",
                    "name": "1.11.4",
                    "userReleaseDate": "03\/Mar\/11",
                    "archived": false,
                    "releaseDate": "2011-03-03",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10017",
                    "id": 10017,
                    "name": "Zend_Log",
                    "description": "classic logging utility functions",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45506",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=intiilapa",
                        "name": "intiilapa",
                        "displayName": "Beno\u00eet Durand",
                        "active": true
                    },
                    "body": "@Fabio, Can you provide a code to reproduce your problem?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=intiilapa",
                        "name": "intiilapa",
                        "displayName": "Beno\u00eet Durand",
                        "active": true
                    },
                    "created": "2011-03-13T14:36:24.000+0000",
                    "updated": "2011-03-13T14:36:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45519",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fabioginzel",
                        "name": "fabioginzel",
                        "displayName": "Fabio Ginzel",
                        "active": true
                    },
                    "body": "{code:title=Bootstrap.php|borderStyle=solid}\r\n\tprotected function _initLogger() {\r\n\t  $this->bootstrap('log');\r\n\t  $log = $this->getResource('log');\r\n\t  $log->registerErrorHandler();\r\n\t}\r\n{code} \r\n\r\n{code:title=IndexController.php|borderStyle=solid}\r\n    public function indexAction()\r\n    {   \r\n    \tif ($aa)\r\n    \t\techo \"x\";\r\n    \r\n    }\r\n{code} \r\n\r\n\r\nThe log is still empty",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fabioginzel",
                        "name": "fabioginzel",
                        "displayName": "Fabio Ginzel",
                        "active": true
                    },
                    "created": "2011-03-15T19:49:22.000+0000",
                    "updated": "2011-03-15T19:49:22.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46250",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "@Fabio\r\nI attempted to reproduce your issue.  I created a stock Zend Framework project using Zend_Tool:\r\n{code}\r\nzf create project test\r\ncd test\r\nzf create controller Test\r\nmkdir -p data\/logs\r\ntouch data\/logs\/application.log\r\nchmod 777 data\/logs\/application.log\r\n{code}\r\nThen applied the following changes to add logging to the application (following instructions here: http:\/\/framework.zend.com\/manual\/en\/zend.application.available-resources.html#zend.application.available-resources.log):\r\n{code}\r\ndiff --git a\/application\/Bootstrap.php b\/application\/Bootstrap.php\r\nindex 26169dd..6ea96e7 100644\r\n--- a\/application\/Bootstrap.php\r\n+++ b\/application\/Bootstrap.php\r\n@@ -3,5 +3,11 @@\r\n class Bootstrap extends Zend_Application_Bootstrap_Bootstrap\r\n {\r\n\r\n+    protected function _initLogger()\r\n+    {\r\n+        $this->bootstrap('log');\r\n+        $this->getResource('log')->registerErrorHandler();\r\n+    }\r\n+\r\n }\r\n\r\ndiff --git a\/application\/configs\/application.ini b\/application\/configs\/application.ini\r\nindex d388364..081507d 100644\r\n--- a\/application\/configs\/application.ini\r\n+++ b\/application\/configs\/application.ini\r\n@@ -8,6 +8,10 @@ appnamespace = \"Application\"\r\n resources.frontController.controllerDirectory = APPLICATION_PATH \"\/controllers\"\r\n resources.frontController.params.displayExceptions = 0\r\n\r\n+resources.log.stream.writerName = \"Stream\"\r\n+resources.log.stream.writerParams.stream = APPLICATION_PATH \"\/..\/data\/logs\/application.log\"\r\n+resources.log.stream.writerParams.mode = \"a\"\r\n+\r\n [staging : production]\r\n\r\n [testing : production]\r\ndiff --git a\/application\/controllers\/TestController.php b\/application\/controllers\/TestController.php\r\nindex c4758fb..2d75c8d 100644\r\n--- a\/application\/controllers\/TestController.php\r\n+++ b\/application\/controllers\/TestController.php\r\n@@ -11,6 +11,8 @@ class TestController extends Zend_Controller_Action\r\n     public function indexAction()\r\n     {\r\n         \/\/ action body\r\n+        if ( $nonExistentVariable )\r\n+            echo \"Oh dear!\";\r\n     }\r\n{code}\r\nWhen I open up my web browser and go to \/test I see the expected view script and the following entry in data\/logs\/application.log:\r\n{code}\r\n2011-04-30T13:05:43-02:30 NOTICE (5): Undefined variable: nonExistentVariable\r\n{code}\r\n\r\nOne additional thing to note is that controller test suites still fail despite the error handler.  For example, if I run TestControllerTest it will fail with mismatch in the dispatched controller name, as the error handler resource still intercepts the dispatch process to display the error page from the default error controller:\r\n{code}\r\n$> phpunit application\/controllers\/TestControllerTest\r\n[...]\r\nThere was 1 failure:\r\n\r\n1) TestControllerTest::testIndexAction\r\nFailed asserting last controller used <\"error\"> was \"Test\"\r\n[...]\r\n{code}\r\n\r\nSo I don't think the problem you are experiencing is with the framework code. If you could provide more code from your application (ie: all log-related bootstrap functions and log-related entries in application.ini) we should be able to point you towards a fix.  \r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2011-04-30T15:37:55.000+0000",
                    "updated": "2011-04-30T15:43:32.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11160\/transitions"
}