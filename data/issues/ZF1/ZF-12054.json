{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12054",
    "key": "ZF-12054",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Possible XSS in Zend_View::escape()"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12054\/votes",
                "votes": 2,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tomas.fejfar@gmail.com",
                "name": "tomas.fejfar@gmail.com",
                "displayName": "Tom\u00e1\u0161 Fejfar",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2012-02-12T20:14:41.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-05-14T16:02:06.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "xss"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "{code:html}<?php\r\nrequire_once \"Zend\/Loader\/Autoloader.php\";\r\nZend_Loader_Autoloader::getInstance()->setFallbackAutoloader(true);\r\n$view = new Zend_View();\r\n$userInput = \"' onmouseover='alert(\/XSS\/)\";\r\n?>\r\n<span title='<?php echo $view->escape($userInput); ?>'>Test<\/span>\r\n{code}\r\n\r\nExpected output: \r\n{code:html}<span title='\\' onmouseover=\\'alert(\/XSS\/)'>Test<\/span>{code}\r\n\r\nActual output with ZF 1.11.8:\r\n{code:html}<span title='' onmouseover='alert(\/XSS\/)'>Test<\/span>{code}\r\n\r\nWhich results in Javascript being executed on mouse over. "
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/2",
                "name": "Critical"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12054\/watchers",
                "isWatching": false,
                "watchCount": 6
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/4",
                "name": "Reopened"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10780",
                    "id": 10780,
                    "description": "Mini Release",
                    "name": "1.11.8",
                    "userReleaseDate": "07\/Jul\/11",
                    "archived": false,
                    "releaseDate": "2011-07-07",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10026",
                    "id": 10026,
                    "name": "Zend_View",
                    "description": "View portion of the ZF MVC",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49627",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tomas.fejfar@gmail.com",
                        "name": "tomas.fejfar@gmail.com",
                        "displayName": "Tom\u00e1\u0161 Fejfar",
                        "active": true
                    },
                    "body": "via http:\/\/zdrojak.root.cz\/zpravicky\/vysel-nette-framework-2-0-final\/21292\/vlakno\/#o21292",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tomas.fejfar@gmail.com",
                        "name": "tomas.fejfar@gmail.com",
                        "displayName": "Tom\u00e1\u0161 Fejfar",
                        "active": true
                    },
                    "created": "2012-02-12T20:15:37.000+0000",
                    "updated": "2012-02-12T20:15:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49628",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bittarman",
                        "name": "bittarman",
                        "displayName": "Ryan Mauger",
                        "active": true
                    },
                    "body": "This is not an XSS vector which has resulted from Zend Framework code.\r\n\r\nThe escape function is intended to be used to convert html special characters into their entites, such as < into &amp;lt; thus preventing injection of further tags into content. If it were to also add slashes, (to ' or \", or both?)  then this would affect the output of many many applications, littering them with superflous slashes which are not actually needed.\r\n\r\nUnfortunately, you have decided to use it as a part of escaping a html attribute, not an entire block, it is therefore your responsibility to ensure that user input cannot prematurely end the quoting. (and this should be done through whitelisting your user input).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bittarman",
                        "name": "bittarman",
                        "displayName": "Ryan Mauger",
                        "active": true
                    },
                    "created": "2012-02-12T20:58:01.000+0000",
                    "updated": "2012-02-12T21:03:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49629",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bittarman",
                        "name": "bittarman",
                        "displayName": "Ryan Mauger",
                        "active": true
                    },
                    "body": "To make this clear, consider this example:\r\n\r\n$comments = array(\"I don't like XSS, it puts a crimp in my day\");\r\n\r\nforeach ($comments as $comment)  {\r\n    echo $view->escape($comment), \"\\n\";\r\n}\r\n\r\nYou'd expect:\r\nI don't like XSS, it puts a crimp in my day\r\n\r\nDue to your proposed fix to your problem:\r\nI don\\'t like XSS, it puts a crimp in my day\r\n\r\nThis is not desireable.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bittarman",
                        "name": "bittarman",
                        "displayName": "Ryan Mauger",
                        "active": true
                    },
                    "created": "2012-02-12T21:01:37.000+0000",
                    "updated": "2012-02-12T21:01:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49630",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bittarman",
                        "name": "bittarman",
                        "displayName": "Ryan Mauger",
                        "active": true
                    },
                    "body": "Closing as not an issue after getting some agreement from other contributors on IRC.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bittarman",
                        "name": "bittarman",
                        "displayName": "Ryan Mauger",
                        "active": true
                    },
                    "created": "2012-02-12T21:03:46.000+0000",
                    "updated": "2012-02-12T21:03:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49631",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tomas.fejfar@gmail.com",
                        "name": "tomas.fejfar@gmail.com",
                        "displayName": "Tom\u00e1\u0161 Fejfar",
                        "active": true
                    },
                    "body": "I understand how it works and why it does not work in this case. The problem is that (as average developer)  when I call $this->escape($var) I assume it's safe to  echo the code. There should at least be a warning in the manual for escape(), that you need to call addslashes whenever using escaped content inside tag's attribute. Typical use - user's name as image alt\/title - Jim O'Reily, Dwayne \"The Rock\" Johnson. You can't filter those. At least this problem is enough to debate whether to hide the real implementation in escape method or use the plain old htmlspecialchars without any wrapper. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tomas.fejfar@gmail.com",
                        "name": "tomas.fejfar@gmail.com",
                        "displayName": "Tom\u00e1\u0161 Fejfar",
                        "active": true
                    },
                    "created": "2012-02-12T21:16:51.000+0000",
                    "updated": "2012-02-12T21:16:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49632",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "Reopened pending security review.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2012-02-12T21:23:27.000+0000",
                    "updated": "2012-02-12T21:23:27.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49633",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "Call to htmlspecialchars() or htmlentities() from Zend_View_Abstract::escape uses ENT_COMPAT in preference to ENT_QUOTES which would have replaced single quotes with semantically equivalent numeric entities. Unless double quoted attributes are enforceable by the framework, it seems reasonable to switch the flag.\r\n\r\nPlease note that all security related issues should be reported to zf-security@zend.com in preference to the issue tracker. You can read our security policy at http:\/\/framework.zend.com\/security.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2012-02-12T22:02:10.000+0000",
                    "updated": "2012-02-12T22:02:10.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49634",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tomas.fejfar@gmail.com",
                        "name": "tomas.fejfar@gmail.com",
                        "displayName": "Tom\u00e1\u0161 Fejfar",
                        "active": true
                    },
                    "body": "I'm sorry. Didn't knew it. My appologies. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tomas.fejfar@gmail.com",
                        "name": "tomas.fejfar@gmail.com",
                        "displayName": "Tom\u00e1\u0161 Fejfar",
                        "active": true
                    },
                    "created": "2012-02-12T22:07:24.000+0000",
                    "updated": "2012-02-12T22:07:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49636",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "No worries . I've email the zf-security address with a quick note on this, and copied you in so you can track its progress.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2012-02-12T22:19:43.000+0000",
                    "updated": "2012-02-12T22:22:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49637",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mhujer",
                        "name": "mhujer",
                        "displayName": "Martin Hujer",
                        "active": true
                    },
                    "body": "http:\/\/php.vrana.cz\/defense-against-xss-in-zend-framework.php",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mhujer",
                        "name": "mhujer",
                        "displayName": "Martin Hujer",
                        "active": true
                    },
                    "created": "2012-02-13T08:06:52.000+0000",
                    "updated": "2012-02-13T08:06:52.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49640",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vrana",
                        "name": "vrana",
                        "displayName": "Jakub Vr\u00e1na",
                        "active": true
                    },
                    "body": "To clarify this, the expected output is:\r\n\r\n{code:html}\r\n<span title='&#039; onmouseover=&#039;alert(\/XSS\/)'>Test<\/span>\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vrana",
                        "name": "vrana",
                        "displayName": "Jakub Vr\u00e1na",
                        "active": true
                    },
                    "created": "2012-02-13T18:15:41.000+0000",
                    "updated": "2012-02-13T18:15:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49641",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "Jakub, noted ;). JIRA just decoded that into a forward slash I think for the comments above.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2012-02-13T19:12:24.000+0000",
                    "updated": "2012-02-13T19:12:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50650",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Where does this issue stand?  Are there any mitigation strategies we could realistically include in 1.12?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-14T16:02:06.000+0000",
                    "updated": "2012-05-14T16:02:06.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12054\/transitions"
}