{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2875",
    "key": "ZF-2875",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "swallowed exception in zend_date"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2875\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10174",
                    "id": 10174,
                    "description": "Mini Release",
                    "name": "1.5.1",
                    "userReleaseDate": "25\/Mar\/08",
                    "archived": true,
                    "releaseDate": "2008-03-25",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-03-13T12:58:54.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=antych",
                "name": "antych",
                "displayName": "Karol Grecki",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-03-13T11:46:35.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-03-29T10:03:08.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I noticed some stack traces in my log that were not normally displayed, I guess thanks to xdebug.\nThey originate from Zend_Date_DateObject->setTimezone() ZendFramework-1.5.0RC3\/library\/Zend\/Date.php:1338\nI looked at the code and saw this (lines 1344-1346):\n{code}\n        } catch (Exception $e) {\n            \/\/ fall through\n        }\n{code}\n\nClearly the exception doesn't fall through, it's swallowed and never handled.\n\nAfter commenting the try-catch block I get an error:\nZend_Date_Exception: timezone (2008) is not a known timezone in ZendFramework-1.5.0RC3\/library\/Zend\/Date\/DateObject.php on line 1018\nwhen calling code:\n{code}\nnew Zend_Date('09\/01\/2008');\n{code}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2875\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10171",
                    "id": 10171,
                    "description": "Minor Release Candidate",
                    "name": "1.5.0RC1",
                    "userReleaseDate": "26\/Feb\/08",
                    "archived": true,
                    "releaseDate": "2008-02-26",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10072",
                    "id": 10072,
                    "name": "Zend_Date",
                    "description": "Zend_Date is the basic library for the handling of all date, time and calendar-related issues.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/19903",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "This is no issue...\n\nTimezones can be given as string within a date... they are always the last portion of a string.\nTherefor Zend_Date tries to see if the last date part is a timezone.\n\nAnd as php itself throws an exception if you set a not existing timezone we must catch this exception... otherwise we would have no chance to have this feature.\n\nAs it is not displayed but pre-catched by your own exception handler this is not an error but a behaviour from your exception handler (xdebug).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-03-13T12:58:41.000+0000",
                    "updated": "2008-03-13T12:58:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/19913",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=antych",
                        "name": "antych",
                        "displayName": "Karol Grecki",
                        "active": true
                    },
                    "body": "Thanks for the explanation but I think this still needs to be addressed.\nThis code looks \"suspicious\" and comment is misleading.\nIt's doomed to be raised again unless the comments states that the exception is silenced on purpose and for a good reason.\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=antych",
                        "name": "antych",
                        "displayName": "Karol Grecki",
                        "active": true
                    },
                    "created": "2008-03-14T04:50:21.000+0000",
                    "updated": "2008-03-14T04:50:21.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/19916",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "When you tell me a way how to know if a given string is a timezone or not I will integrate it as replacement for the actual solution.\n\nBut actually there is no way... if a user gives \"myzone\" it will always try to set the zone... and you would also not know if a string like \"Monday\" is a timezone or a datevalue.\n\nAnd no, the framework does not raise the exception again... it's your own exception handler which you are using instead of the default one. This is the reason why this is not seen as bug.\n\nAs this method has always to return a integer and must not throw an exception this is wished behaviour.\nThere are some single places in the framework where this is done this way, because there are no other ways for handling.\n\nAlso to mention: The behaviour IS documented... but it's of course documented where the error is catched. You should have looked into DateObject where your exception handler told you the problem.\n{code}\n        \/\/ throw an error on false input, but only if the new date extension is available\n        if (function_exists('timezone_open')) {\n            if (!@timezone_open($zone)) {\n                require_once 'Zend\/Date\/Exception.php';\n                throw new Zend_Date_Exception(\"timezone ($zone) is not a known timezone\", $zone);\n            }\n        }\n        \/\/ this can generate an error if the date extension is not available and a false timezone is given\n        $result = @date_default_timezone_set($zone);\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-03-14T06:19:42.000+0000",
                    "updated": "2008-03-14T06:19:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/19917",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=antych",
                        "name": "antych",
                        "displayName": "Karol Grecki",
                        "active": true
                    },
                    "body": "I raised a very simple issue. Looking at the code, all I can see you explicitly throw Zend_Date_Exception that is silenced and never handled. If there is no better way of doing this, fine but the comment shouldn't say \"fall through\".\nIn my opinion empty catch block is bad and it looks like you are using exceptions for flaw control. For this reason I suggest that the comment should be improved to clearly state that this is a required behaviour and why the exception is silenced. The comment you mentioned is when the error is thrown not caught and it doesn't explain why it's not handled.\np.s. I'm not using a custom error handler and I never said the exception is re-thrown, It just appears in the logs because xdebug automatically attaches stack trace to it. Normally it will not show up and I agree that this is not a big issue, but still there's no harm in making the comment better, right? Can you see that it would already save us some time discussing this, and would prevent this issue from being raised ever again?\nI'm sure I'm not the only one alerted by empty catch blocks and I want to contribute by raising *potential* issues. Better comments will help us to judge whether this is an actual bug or not. Please understand.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=antych",
                        "name": "antych",
                        "displayName": "Karol Grecki",
                        "active": true
                    },
                    "created": "2008-03-14T07:07:21.000+0000",
                    "updated": "2008-03-14T07:07:21.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20147",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "I'm assuming this fix is merged to the 1.5 release branch for release with 1.5.1. Please update JIRA if this is not the case.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-03-21T17:34:13.000+0000",
                    "updated": "2008-03-21T17:34:13.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20716",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=akkie",
                        "name": "akkie",
                        "displayName": "Christian Kaps",
                        "active": true
                    },
                    "body": "Thomas, can you check if my proposal solves this issue.\n\nWhen i add in the method Zend_Date::getTimezoneFromString() the following part:\n\n{code}\nif (is_int($zone)) {\n   return $this->getTimezone();\n}\n{code}\n\nor better\n\n{code}\npublic function getTimezoneFromString($zone)\n{\n   if ($zone instanceof Zend_Date) {\n      return $zone->getTimezone();\n   }\n\n   if (!is_string($zone)) {\n      return $this->getTimezone();\n   }\n\n   preg_match('\/([+-]\\d{2}):{0,1}\\d{2}\/', $zone, $match);\n   .........\n{code}\n\nthis issue will besolved.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=akkie",
                        "name": "akkie",
                        "displayName": "Christian Kaps",
                        "active": true
                    },
                    "created": "2008-04-07T08:30:33.000+0000",
                    "updated": "2008-04-07T08:30:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20717",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=akkie",
                        "name": "akkie",
                        "displayName": "Christian Kaps",
                        "active": true
                    },
                    "body": "I have seen that this issue can not be resolved by my proposal because the value is 09\/01\/2008 and this is a string.\n\nIn my logs i get the message \nZend_Date_Exception: timezone (1207572901) is not a known timezone in \/srv\/apache\/htdocs\/user\/christian\/projects\/meet2cheat\/private\/library\/Zend\/Date\/DateObject.php on line 1018\n\nFor this case my proposal fix the issue.\n\nIs it not possible to check the format of the timezone. \ne.g. When the $zone var has no timezone format return the default timezone.\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=akkie",
                        "name": "akkie",
                        "displayName": "Christian Kaps",
                        "active": true
                    },
                    "created": "2008-04-07T08:47:11.000+0000",
                    "updated": "2008-04-07T08:47:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20719",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Maybe it would be resolved for you... but about 50% of all inputs would no longer be recognised.\nTimezones like \"+0100\" like done in atom format would be ignored.\n\nAlso to mention that the above described problem is not an issue from ZF.\nWhen using own error or exception handlers these handlers are getting ALL messages. Even if you supress them or have other settings in your php.ini.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-04-07T09:00:21.000+0000",
                    "updated": "2008-04-07T09:00:21.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45661",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=akkie",
                        "name": "akkie",
                        "displayName": "Christian Kaps",
                        "active": true
                    },
                    "body": "I know this is an old issue, but now I stumble over it again. My question is, why not validate the timezone in Zend_Date::getTimezoneFromString() and when it is valid set it with Zend_Date_DateObject::setTimezone(). This should be possible with the functions timezone_open() and date_default_timezone_set(). Then you needn't the empty catch block.\r\n\r\nI know this isn't directly a ZF problem. But disabling the xdebug extension for the whole application only why using the Zend_Date classes, shouldn't the preferred way.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=akkie",
                        "name": "akkie",
                        "displayName": "Christian Kaps",
                        "active": true
                    },
                    "created": "2011-03-29T10:03:08.000+0000",
                    "updated": "2011-03-29T10:03:08.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2875\/transitions"
}