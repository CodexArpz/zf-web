{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9216",
    "key": "ZF-9216",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "When entering a page through named route Zend_View_Helper_Url uses that route and not the default anymore"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9216\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-03-03T06:26:13.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=exceptione",
                "name": "exceptione",
                "displayName": "exceptione",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-02-20T04:47:21.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-03-03T06:26:15.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "The problem is detailed here also: http:\/\/n4.nabble.com\/Zend-View-Helper-Url-current-route-td667704.html\r\n\r\n\r\nWhen one enters a page via a named router, any call to Zend_View_Helper_Url will generate urls for that named route.\r\n\r\n{code:title=route defintions|borderStyle=solid}\r\n'shop_product_show' => new Zend_Controller_Router_Route(\r\n        'shop_products\/show\/:product_id',\r\n        array(\r\n            'module'        => 'default',\r\n            'controller'    => 'shop_products',\r\n            'action'        => 'show'\r\n        )\r\n    ) \r\n{code}\r\n\r\n{code:title=view script|borderStyle=solid}\r\n$this->url(array(\r\n    'module'        => 'foo',\r\n    'controller'    => 'bar',\r\n    'action'        => 'doh'\r\n))\r\n\r\n\/\/ result: \/shop_products\/show\/1 \r\n\r\n$this->url(array(\r\n    'module'        => 'foo',\r\n    'controller'    => 'bar',\r\n    'action'        => 'doh'\r\n), 'default');\r\n\r\n\/\/ result: \/foo\/bar\/doh\r\n\r\n{code}\r\n\r\nThis makes Zend_View_Helper_Url brittle, because a template might work fine, until the time you reach the page via a named route.\r\n\r\nThe linked page contains a possible solution:\r\n{quote}\r\nFor instance, when I change lines in Zend_View_Helper_Url::url() from:\r\n{code}\r\nif (empty($name)) {\r\n   try {\r\n      $name = $router->getCurrentRouteName();\r\n    } catch (Zend_Controller_Router_Exception $e) {\r\n      $name = 'default';\r\n    }\r\n}\r\n{code}\r\nto:\r\n{code}\r\nif (empty($name)) {\r\n   $name = 'default';\r\n}\r\n{code}\r\nI obtain expected behavior\r\n{quote}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9216\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10340",
                    "id": 10340,
                    "description": "Mini Release",
                    "name": "1.8.4",
                    "userReleaseDate": "23\/Jun\/09",
                    "archived": false,
                    "releaseDate": "2009-06-23",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10412",
                    "id": 10412,
                    "description": "Mini Release",
                    "name": "1.10.1",
                    "userReleaseDate": "10\/Feb\/10",
                    "archived": false,
                    "releaseDate": "2010-02-10",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10026",
                    "id": 10026,
                    "name": "Zend_View",
                    "description": "View portion of the ZF MVC",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38612",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mina",
                        "name": "mina",
                        "displayName": "Mina R Waheeb",
                        "active": true
                    },
                    "body": "I override the URL view helper because of this bug. I dunno why it still lives there. imagine static route to \/admin all links there go to \/admin! please fix or maybe explain what is the point?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mina",
                        "name": "mina",
                        "displayName": "Mina R Waheeb",
                        "active": true
                    },
                    "created": "2010-02-20T06:54:14.000+0000",
                    "updated": "2010-02-20T06:54:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38739",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=exceptione",
                        "name": "exceptione",
                        "displayName": "exceptione",
                        "active": true
                    },
                    "body": "I also don't know what benefit this has. Besides, I think that just catching any Zend_Controller_Router_Exception is not really elegant.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=exceptione",
                        "name": "exceptione",
                        "displayName": "exceptione",
                        "active": true
                    },
                    "created": "2010-02-25T06:22:24.000+0000",
                    "updated": "2010-02-25T06:22:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38741",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "By default, the url() view helper uses the current route name when generating routes; this is to make generation of URLs for the currently matched route as simple as possible. You can always pass a second argument to url(), which is the name of a specific named route to use; if provided, it will be used. This is well documented.\r\n\r\nMy recommendation is to use the second argument _always_, as this will ensure you're explicit about what route is being used, and makes it easier to debug if the wrong URL is generated.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2010-02-25T07:07:37.000+0000",
                    "updated": "2010-02-25T07:07:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38743",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=exceptione",
                        "name": "exceptione",
                        "displayName": "exceptione",
                        "active": true
                    },
                    "body": "{quote}this is to make generation of URLs for the currently matched route as simple as possible.{quote}\r\nOk. To me this seems a rather exotic requirement and I would 've made this a separate view helper, just to make this behaviour explicit.\r\n\r\nThe problem is that since the parameter is optional, you are inclined to think about an empty value, that is in this case: no route.\r\nThe current behaviour is so special and not really what is to be expected, so a big warning would be helpful.\r\n\r\nI could not find a warning at http:\/\/framework.zend.com\/manual\/1.10\/en\/zend.view.helpers.html\r\n\r\nTo me this seems to be at least a documentation isssue. I am sorry to steal your time, I've yet to sign and send an agreement thingie.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=exceptione",
                        "name": "exceptione",
                        "displayName": "exceptione",
                        "active": true
                    },
                    "created": "2010-02-25T07:35:18.000+0000",
                    "updated": "2010-02-25T07:35:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44625",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stryks",
                        "name": "stryks",
                        "displayName": "Peter Sharp",
                        "active": true
                    },
                    "body": "I must say that I also tripped over this one, and also find this behavior very unexpected.\r\n\r\nWithout any real indication as to why, zend_navigation menus suddenly find their output containing the current route instead of the default one when in a named route.  There seems to be no other option than to define the 'default' route for each element in the zend_navigation instance.\r\n\r\nThe way it seems to me is that there is a default route, and it works by default, unless you have custom routes, in which case it's not always default, and your only option is to specifically tag each url call as 'default'.\r\n\r\nI just question the use of the name 'default' if there are certain times when it is superseded by something else.  Surely the name 'default' implies that it will be used by default, and that the route *should* be set *only* when wanting to use something *other* than the default.\r\n\r\nAny clarification on how to get my head around this would be great.  And yes, there needs to be clear mention of this made somewhere where it can be found easily when reading about both routes and the url view helper.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stryks",
                        "name": "stryks",
                        "displayName": "Peter Sharp",
                        "active": true
                    },
                    "created": "2011-03-03T05:30:15.000+0000",
                    "updated": "2011-03-03T05:30:15.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44627",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Peter: I'd argue you should open a separate issue for Zend_Navigation indicating that if no route is specified, then \"default\" should be used (and that Zend_Navigation should always specify a route when assembling a URL).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2011-03-03T06:25:14.000+0000",
                    "updated": "2011-03-03T06:25:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44628",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Marking as \"Won't Fix\", as the behavior is already established and documented; any changes at this time would introduce backwards incompatiblities.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2011-03-03T06:26:15.000+0000",
                    "updated": "2011-03-03T06:26:15.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9216\/transitions"
}