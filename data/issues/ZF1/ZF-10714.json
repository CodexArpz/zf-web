{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10714",
    "key": "ZF-10714",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Form validation (Zend_Form_Element_Hash) in Google Chrome"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10714\/votes",
                "votes": 3,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=pixietrixibell",
                "name": "pixietrixibell",
                "displayName": "Martin \u008avec",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-11-19T07:11:44.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-05-02T04:26:40.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Hello,\r\ni have a problem with element Zend_Form_Element_Hash.\r\nIn Google Chrome (7) form validation report me a error : \"No token was provided to match against\",\r\nbut in FF or IE it works fine."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10714\/watchers",
                "isWatching": false,
                "watchCount": 7
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "zf-caretaker-adamlundrigan"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                "name": "alab",
                "displayName": "Christian Albrecht",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-5182",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5182",
                    "type": {
                        "name": "Related",
                        "direction": "OUTBOUND",
                        "description": "is related to"
                    }
                },
                {
                    "issueKey": "ZF-2915",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2915",
                    "type": {
                        "name": "Related",
                        "direction": "OUTBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10420",
                    "id": 10420,
                    "description": "Minor Release",
                    "name": "1.11.0",
                    "userReleaseDate": "02\/Nov\/10",
                    "archived": false,
                    "releaseDate": "2010-11-02",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43139",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bittarman",
                        "name": "bittarman",
                        "displayName": "Ryan Mauger",
                        "active": true
                    },
                    "body": "Could you provide some more information about how to reproduce this error? \r\n\r\nI use chrome daily for my development work, and have never had this issue.\r\n\r\nIf this is a support question, could you direct it to the fw-general mailing list, or to #zftalk on freenode IRC",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bittarman",
                        "name": "bittarman",
                        "displayName": "Ryan Mauger",
                        "active": true
                    },
                    "created": "2010-11-19T07:14:25.000+0000",
                    "updated": "2010-11-19T07:14:25.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43140",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=denniswinter",
                        "name": "denniswinter",
                        "displayName": "Dennis Winter",
                        "active": true
                    },
                    "body": "I don't think, this is an issue of ZF!\r\nI've had this and other problems in the past with Google Chrome.\r\nThis browser caches so freakin' hard, that it comes to such errors in development!\r\nPlease delete all your internet data in chrome and restart at least your browser (if not the whole OS).\r\nThat should normally do the job!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=denniswinter",
                        "name": "denniswinter",
                        "displayName": "Dennis Winter",
                        "active": true
                    },
                    "created": "2010-11-19T07:30:10.000+0000",
                    "updated": "2010-11-19T07:30:10.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43155",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "body": "Added issues I think are related to this issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "created": "2010-11-19T10:33:18.000+0000",
                    "updated": "2010-11-19T10:33:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43547",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "body": "The same issue haunted me in the beginning of the week. However, in my case I had two forms in the site: Feedback and Order. Both of these forms had hash element. In the latest version of Firefox, Feedback form worked but Order form didn't. In Chrome and IE both forms worked. I was unable to track the problem and it seems to be very hard to isolate. The only solution atm. was to remove the hash element from the Order form.\r\n\r\nI have had similar problems in ZF-5182, but at this time neither of these forms were placed at the landing page (the first page of the site).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "created": "2010-12-10T00:51:57.000+0000",
                    "updated": "2010-12-10T00:51:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44107",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mgordon",
                        "name": "mgordon",
                        "displayName": "Max Gordon",
                        "active": true
                    },
                    "body": "I've had the same problem with the Chrome browser. The issue is not really a bug in ZF but in redirects, in my case the Zend_Auth\/Acl code. When Chrome looks for pages to cache and is redirected to the current page the hash fails to validate. \r\n\r\nIn my code I've found that when I have a redirect to a form, usually the case with login forms I get the token error, I've now changed the redirect to an login error in the ErrorController and that seems to work better. \r\n\r\nBelow is some scaled down code that I've used when debugging this issue if you want to try it out yourselves:\r\n\r\n{code}\r\nclass IndexController extends Zend_Controller_Action {\r\n    public function indexAction() {\r\n        $form = new Form_Index_Test();\r\n        if ($this->getRequest()->isPost()\r\n                && $form->isValid($this->getRequest()->getPost())) {\r\n            die(\"Yes!\");\r\n        }\r\n\r\n        $this->view->form = $form;\r\n    }\r\n}\r\n\r\n\r\nclass LoginController extends Zend_Controller_Action {\r\n    public function userAction() {\r\n        $form = new Form_Login;\r\n\r\n        if ($this->_request->isPost()) {\r\n            if ($form->isValid($this->_request->getPost())) {\r\n                die(\"Logged in!\");\r\n            }\r\n        }\r\n\r\n        $this->view->form = $form;\r\n    }\r\n\r\n}\r\n\r\n\r\nclass ErrorController extends Zend_Controller_Action\r\n{\r\n\r\n    public function errorAction()\r\n    {\r\n    }\r\n\r\n\r\n    public function privilegesAction()\r\n    {\r\n        die(\"You lack the privileges!\");\r\n    }\r\n\r\n    public function loginAction()\r\n    {\r\n        die(\"Login please!\");\r\n    }\r\n\r\n}\r\n\r\n\r\nclass Form_Index_Test extends Zend_Form {\r\n\r\n    public function __construct($options = null) {\r\n        parent::__construct($options);\r\n        $this->setName('form_show_dates');\r\n\r\n        $this->addElement('Text', 'test', array('label' => 'Text'));\r\n\r\n        $this->addElement('hash', 'csrf');\r\n\r\n        $this->addElement('Submit', 'submit', array('label' => 'Save'));\r\n    }\r\n\r\n}\r\n\r\n\r\nclass Form_Login extends Form_Base {\r\n\r\n    public function init() {\r\n\r\n        $this->setName('form_login');\r\n\r\n        $length_message = 100;\r\n        $el_name = $this->createElement('ValidationTextBox', 'username')\r\n                        ->setRequired(true)\r\n                        ->setRegexp('[\\w\\d\\s\\@]+')\r\n                        ->addValidator('stringLength', true, array('min' => 2, 'max' => $length_message))\r\n                        ->addFilter(\"stringTrim\")\r\n                        ->setLabel('Uname');\r\n\r\n        $length_message = 255;\r\n        $el_password = $this->createElement('PasswordTextBox', 'password')\r\n                        ->setRequired(true)\r\n                        ->setRegexp('[\\w\\d\\s\\@]+')\r\n                        ->addValidator('stringLength', true, array('min' => 2, 'max' => $length_message))\r\n                        ->addFilter(\"stringTrim\")\r\n                        ->setLabel('Pwd');\r\n\r\n        $el_submit = $this->createElement('Submit', 'submit')\r\n                        ->setLabel(__('Save'))\r\n                        ->setOrder(998);\r\n\r\n        $this->addElements(array($el_name, $el_password, $el_submit));\r\n    }\r\n}\r\n\r\nabstract class Form_Base extends Zend_Dojo_Form {\r\n\r\n    public function __construct($options = null) {\r\n        parent::__construct($options);\r\n\r\n        $token_id = \"csrf_test_token_4_\" . get_called_class();\r\n        $this->addElement('hash', $token_id);\r\n    }\r\n}\r\n\r\n\r\nclass Plugin_Controller_Auth extends Zend_Controller_Plugin_Abstract {\r\n\r\n    \/**\r\n     * @var Zend_Auth\r\n     *\/\r\n    private $_auth;\r\n    \/**\r\n     * @var Zend_Acl\r\n     *\/\r\n    private $_acl;\r\n    private $_noauth = array('module' => 'default',\r\n        'controller' => 'error',\r\n        'action' => 'login');\r\n    private $_noacl = array('module' => 'default',\r\n        'controller' => 'error',\r\n        'action' => 'privileges');\r\n\r\n    public function __construct($auth, $acl) {\r\n        $this->_auth = $auth;\r\n        $this->_acl = $acl;\r\n    }\r\n\r\n    \/**\r\n     * Performs the login etc...\r\n     *\r\n     * @param Zend_Controller_Request_Abstract $request\r\n     * @return void\r\n     *\/\r\n    public function preDispatch($request) {\r\n        if ($this->_auth->hasIdentity()) {\r\n            $role = $this->_auth->getIdentity()->getRole();\r\n        } else {\r\n            $role = 'guest';\r\n        }\r\n\r\n        $resource = $controller = $request->controller;\r\n        $action = $request->action;\r\n        $module = $request->module;\r\n\r\n        $options = $request->getParams();\r\n\r\n\r\n        if (!$this->_acl->has($resource)) {\r\n            $resource = null;\r\n        }\r\n\r\n        if (!$this->_acl->isAllowed($role, $resource, $action)) {\r\n            if (!$this->_auth->hasIdentity()) {\r\n                $module = $this->_noauth['module'];\r\n                $controller = $this->_noauth['controller'];\r\n                $action = $this->_noauth['action'];\r\n            } else {\r\n                $module = $this->_noacl['module'];\r\n                $controller = $this->_noacl['controller'];\r\n                $action = $this->_noacl['action'];\r\n            }\r\n\r\n            $redirector = Zend_Controller_Action_HelperBroker::getStaticHelper('redirector');\r\n            $redirector->gotoSimpleAndExit($action, $controller, $module);\r\n        }\r\n    }\r\n\r\n}\r\n\r\nclass Security_Acl extends Zend_Acl {\r\n    public function __construct() {\r\n        $this->add(new Zend_Acl_Resource('index'));\r\n        $this->add(new Zend_Acl_Resource('login'));\r\n        $this->addRole(new Zend_Acl_Role('guest'));\r\n        $this->allow('guest', 'index');\r\n        $this->allow('guest', 'login', 'user');\r\n    }\r\n}\r\n{code}\r\n\r\nIf you want to see the error when logging in use:\r\n{code}\r\n    private $_noauth = array('module' => 'default',\r\n        'controller' => 'login',\r\n        'action' => 'user');\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mgordon",
                        "name": "mgordon",
                        "displayName": "Max Gordon",
                        "active": true
                    },
                    "created": "2011-01-21T14:40:19.000+0000",
                    "updated": "2011-01-21T14:40:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50026",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Does this problem still persist? If so, is it with the framework or the browser? A lot of these wishy-washy Zend_Session-related bugs appear to be falling into the \"concurrent requests returning 404 errors cause competing sessions to be initiated\" issue (primarily with Google Chrome)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-03-13T19:18:21.000+0000",
                    "updated": "2012-03-13T19:18:21.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50356",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=technoicon",
                        "name": "technoicon",
                        "displayName": "Patrick McMahon",
                        "active": true
                    },
                    "body": "I've having the same issue.\r\nIn chrome, if I wait over 5 mins.  i get \"No Token was provided to match against\"\r\nI can submit again and it works.\r\nIf i submit the form straight after loading the page it works fine.  \r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=technoicon",
                        "name": "technoicon",
                        "displayName": "Patrick McMahon",
                        "active": true
                    },
                    "created": "2012-04-24T07:50:20.000+0000",
                    "updated": "2012-04-24T07:50:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50357",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=technoicon",
                        "name": "technoicon",
                        "displayName": "Patrick McMahon",
                        "active": true
                    },
                    "body": "with IE.\r\nno need to wait, just get this error: \"The two given tokens do not match\"\r\nafter submitting twice it works.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=technoicon",
                        "name": "technoicon",
                        "displayName": "Patrick McMahon",
                        "active": true
                    },
                    "created": "2012-04-24T07:52:20.000+0000",
                    "updated": "2012-04-24T07:52:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50418",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=technoicon",
                        "name": "technoicon",
                        "displayName": "Patrick McMahon",
                        "active": true
                    },
                    "body": "I set the TTL.  via timeout.\r\nI did this and it worked for chrome and IE:\r\n\r\n$this->addElement('hash', 'csrf', array(\r\n            'ignore' => true,\r\n        \t'timeout' => 60000,\r\n        ));\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=technoicon",
                        "name": "technoicon",
                        "displayName": "Patrick McMahon",
                        "active": true
                    },
                    "created": "2012-05-02T04:26:40.000+0000",
                    "updated": "2012-05-02T04:26:40.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10714\/transitions"
}