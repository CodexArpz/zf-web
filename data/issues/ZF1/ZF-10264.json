{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10264",
    "key": "ZF-10264",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Service_Twitter Error"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10264\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-08-04T11:42:39.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rafa_corre",
                "name": "rafa_corre",
                "displayName": "Rafael Paulino",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-08-04T11:11:58.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-08-05T08:11:31.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Hi, I'm having problems with Zend_Service_Twitter (My library is version 1.10.6) I have downloaded several times the library...\r\n\r\nBelow is my code:\r\n\r\n$twitter = new Zend_Service_Twitter('myuser','mypassword');\r\n$response = $twitter->account->verifyCredentials();\r\n$response = $twitter->user->followers();\r\n\r\nBut it's dont work, I get the following error:\r\n\r\nCatchable fatal error: Argument 1 passed to Zend_Service_Twitter::__construct() must be an array, string given, called in C:\\xampp\\htdocs\\dev\\rafapaulino\\application\\default\\controllers\\PerfilController.php on line 25 and defined in C:\\xampp\\htdocs\\dev\\rafapaulino\\library\\Zend\\Service\\Twitter.php on line 131\r\n\r\nSo, I change by this code:\r\n\r\n$userInfo = array('username' => 'foo', 'password' => 'bar');\r\n$twitter = new Zend_Service_Twitter($userInfo);\r\n\r\nAnd then I get the following error:\r\n\r\nFatal error: Uncaught exception 'Zend_Service_Twitter_Exception' with message 'Twitter session is unauthorised. You need to initialize Zend_Service_Twitter with an OAuth Access Token or use its OAuth functionality to obtain an Access Token before attempting any API actions that require authorisation' in C:\\xampp\\htdocs\\dev\\rafapaulino\\library\\Zend\\Service\\Twitter.php:278 Stack trace: #0 C:\\xampp\\htdocs\\dev\\rafapaulino\\library\\Zend\\Service\\Twitter.php(749): Zend_Service_Twitter->_init() #1 [internal function]: Zend_Service_Twitter->accountVerifyCredentials() #2 C:\\xampp\\htdocs\\dev\\rafapaulino\\library\\Zend\\Service\\Twitter.php(266): call_user_func_array(Array, Array) #3 [internal function]: Zend_Service_Twitter->__call('verifyCredentia...', Array) #4 C:\\xampp\\htdocs\\dev\\rafapaulino\\application\\default\\controllers\\PerfilController.php(28): Zend_Service_Twitter->verifyCredentials() #5 C:\\xampp\\htdocs\\dev\\rafapaulino\\library\\Zend\\Controller\\Action.php(513): PerfilController->indexAction() #6 C:\\xampp\\htdocs\\dev\\rafapaulino\\libr in C:\\xampp\\htdocs\\dev\\rafapaulino\\library\\Zend\\Service\\Twitter.php on line 278\r\n\r\nWhen I change to an old library, then everything works normally.\r\n\r\n\r\nThen I was looking at the code and saw:\r\n\r\nThe first problem occurs because the class constructor looks for an array if you do not pass an array of options makes it an empty array.\r\n\r\n    New version:\r\n\r\n    public function __construct($options = null, Zend_Oauth_Consumer $consumer = null)\r\n    {\r\n        $this->setUri('http:\/\/api.twitter.com');\r\n        if (!is_array($options)) $options = array();\r\n        $options['siteUrl'] = self::OAUTH_BASE_URI;\r\n        if ($options instanceof Zend_Config) {\r\n            $options = $options->toArray();\r\n        }\r\n        $this->_options = $options;\r\n        if (isset($options['username'])) {\r\n            $this->setUsername($options['username']);\r\n        }\r\n        if (isset($options['accessToken'])\r\n        && $options['accessToken'] instanceof Zend_Oauth_Token_Access) {\r\n            $this->setLocalHttpClient($options['accessToken']->getHttpClient($options));\r\n        } else {\r\n            $this->setLocalHttpClient(clone self::getHttpClient());\r\n            if (is_null($consumer)) {\r\n                $this->_oauthConsumer = new Zend_Oauth_Consumer($options);\r\n            } else {\r\n                $this->_oauthConsumer = $consumer;\r\n            }\r\n        }\r\n    }\r\n\r\n    Old Version:\r\n\r\n    public function __construct($username = null, $password = null)\r\n    {\r\n        $this->setLocalHttpClient(clone self::getHttpClient());\r\n        if (is_array($username) && is_null($password)) {\r\n            if (isset($username['username']) && isset($username['password'])) {\r\n                $this->setUsername($username['username']);\r\n                $this->setPassword($username['password']);\r\n            } elseif (isset($username[0]) && isset($username[1])) {\r\n                $this->setUsername($username[0]);\r\n                $this->setPassword($username[1]);\r\n            }\r\n        } else if (!is_null($username)) {\r\n            $this->setUsername($username);\r\n            $this->setPassword($password);\r\n        }\r\n        $this->setUri('http:\/\/twitter.com');\r\n        $this->_localHttpClient->setHeaders('Accept-Charset', 'ISO-8859-1,utf-8');\r\n    }\r\n\r\n    The second error is because the access is not authorized to Twitter:\r\n\r\n    protected function _init()\r\n    {\r\n        if (!$this->isAuthorised() && $this->getUsername() !== null) {\r\n            require_once 'Zend\/Service\/Twitter\/Exception.php';\r\n            throw new Zend_Service_Twitter_Exception(\r\n                'Twitter session is unauthorised. You need to initialize '\r\n                . 'Zend_Service_Twitter with an OAuth Access Token or use '\r\n                . 'its OAuth functionality to obtain an Access Token before '\r\n                . 'attempting any API actions that require authorisation'\r\n            );\r\n        }\r\n        $client = $this->_localHttpClient;\r\n        $client->resetParameters();\r\n        if (null == $this->_cookieJar) {\r\n            $client->setCookieJar();\r\n            $this->_cookieJar = $client->getCookieJar();\r\n        } else {\r\n            $client->setCookieJar($this->_cookieJar);\r\n        }\r\n    }\r\n\r\n    But he will not be allowed because it needs accessToken:\r\n\r\n   \/**\r\n     * Set local HTTP client as distinct from the static HTTP client\r\n     * as inherited from Zend_Rest_Client.\r\n     *\r\n     * @param Zend_Http_Client $client\r\n     * @return self\r\n     *\/\r\n    public function setLocalHttpClient(Zend_Http_Client $client)\r\n    {\r\n        $this->_localHttpClient = $client;\r\n        $this->_localHttpClient->setHeaders('Accept-Charset', 'ISO-8859-1,utf-8');\r\n        return $this;\r\n    }\r\n   \r\n    \/**\r\n     * Get the local HTTP client as distinct from the static HTTP client\r\n     * inherited from Zend_Rest_Client\r\n     *\r\n     * @return Zend_Http_Client\r\n     *\/\r\n    public function getLocalHttpClient()\r\n    {\r\n        return $this->_localHttpClient;\r\n    }\r\n   \r\n    \/**\r\n     * Checks for an authorised state\r\n     *\r\n     * @return bool\r\n     *\/\r\n    public function isAuthorised()\r\n    {\r\n        if ($this->getLocalHttpClient() instanceof Zend_Oauth_Client) {\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    The token is created in the constructor as a parameter for options.\r\n\r\n    public function __construct($options = null, Zend_Oauth_Consumer $consumer = null)\r\n    {\r\n        $this->setUri('http:\/\/api.twitter.com');\r\n        if (!is_array($options)) $options = array();\r\n        $options['siteUrl'] = self::OAUTH_BASE_URI;\r\n        if ($options instanceof Zend_Config) {\r\n            $options = $options->toArray();\r\n        }\r\n        $this->_options = $options;\r\n        if (isset($options['username'])) {\r\n            $this->setUsername($options['username']);\r\n        }\r\n        if (isset($options['accessToken'])\r\n        && $options['accessToken'] instanceof Zend_Oauth_Token_Access) {\r\n            $this->setLocalHttpClient($options['accessToken']->getHttpClient($options));\r\n        } else {\r\n            $this->setLocalHttpClient(clone self::getHttpClient());\r\n            if (is_null($consumer)) {\r\n                $this->_oauthConsumer = new Zend_Oauth_Consumer($options);\r\n            } else {\r\n                $this->_oauthConsumer = $consumer;\r\n            }\r\n        }\r\n    }\r\n\r\n    Will changed the way of access because of oAuth? In the documentation is wrong?\r\n\r\n\r\n    I posted here too: http:\/\/forums.zend.com\/viewtopic.php?f=69&t=7101"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10264\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                "name": "padraic",
                "displayName": "P\u00e1draic Brady",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10470",
                    "id": 10470,
                    "description": "Mini Release",
                    "name": "1.10.6",
                    "userReleaseDate": "22\/Jun\/10",
                    "archived": false,
                    "releaseDate": "2010-06-22",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10480",
                    "id": 10480,
                    "description": "Mini Release",
                    "name": "1.10.7",
                    "userReleaseDate": "28\/Jul\/10",
                    "archived": false,
                    "releaseDate": "2010-07-28",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10370",
                    "id": 10370,
                    "name": "Zend_Service_Twitter",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41861",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "Unfortunately the documentation for Zend_Service_Twitter is outdated (not sure why since it's updated in SVN). Note that the component now requires using OAuth 1.0 authentication as is required by Twitter from later this month. You should refer to the Zend_Oauth documentation for details about OAuth. Zend_Service_Twitter also bundles an API to Zend_Oauth (i.e. Zend_Oauth's methods and options can be set\/accessed directly on an instance of Zend_Service_Twitter). So you can a) use OAuth directly and pass the access token to Zend_Service_Twitter (you should store the token on a per user basis for future use - don't re-auth on every request ;)) or b) do the same as (a) except through the Zend_Service_Twitter object.\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2010-08-04T11:42:41.000+0000",
                    "updated": "2010-08-04T11:42:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41862",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Paddy -- did you ever merge the doc changes to the release-1.10 branch? If not, that would be why the docs are not on the site.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2010-08-04T11:45:04.000+0000",
                    "updated": "2010-08-04T11:45:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41863",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "Yep, merged into the release branch. I just assume it went in after you tagged the release or something similar.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2010-08-04T13:11:41.000+0000",
                    "updated": "2010-08-04T13:11:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41866",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rafa_corre",
                        "name": "rafa_corre",
                        "displayName": "Rafael Paulino",
                        "active": true
                    },
                    "body": "Thanks, I downloaded the zend documentation and now I saw the correct documentation.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rafa_corre",
                        "name": "rafa_corre",
                        "displayName": "Rafael Paulino",
                        "active": true
                    },
                    "created": "2010-08-05T08:11:31.000+0000",
                    "updated": "2010-08-05T08:11:31.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10264\/transitions"
}