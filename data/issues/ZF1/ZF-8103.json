{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8103",
    "key": "ZF-8103",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Massive speedup in Zend_Mime::encodeQuotedPrintable()"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/21",
                "name": "Performance Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8103\/votes",
                "votes": 7,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/11380",
                    "id": 11380,
                    "description": "Mini Release",
                    "name": "Next Mini Release",
                    "archived": false,
                    "released": false
                }
            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jwueste",
                "name": "jwueste",
                "displayName": "Jonas W\u00fcste",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-10-20T01:04:35.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2013-03-13T20:55:22.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "There is a possibility to have a massive speedup in Zend_Mime::encodeQuotedPrintable().\r\nIf the imap extension in php is enabled, the function imap_8bit() should be used instead of doing it on your own. Here's a little script showing the speedup.\r\n{code:title=sandbox.php|borderStyle=solid}\r\n$client = new Zend_Http_Client(\"http:\/\/de.wikipedia.org\/w\/index.php?title=PHP&printable=yes\");\r\n\r\n$string = $client->request()->getBody();\r\n\r\necho \"Starting encoding with imap_8bit() (5000 times)\\n\";\r\n$startTime = time();\r\nfor ($i = 0; $i < 5000; $i++){\r\n   imap_8bit($string);\r\n}\r\n$durationImap_8bit = time()-$startTime;\r\necho \"Duration: \" . $durationImap_8bit . \" seconds\\n\";\r\necho \"Starting encoding with Zend_Mime::encodeQuotedPrintable() (5000 times)\\n\";\r\n$startTime = time();\r\nfor ($i = 0; $i < 5000; $i++){\r\n   Zend_Mime::encodeQuotedPrintable($string, Zend_Mime::LINELENGTH, Zend_Mime::LINEEND);\r\n}\r\n$durationZendMime = time()-$startTime;\r\necho \"Duration: \" . $durationZendMime . \" seconds\\n\\n\";\r\n\r\necho \"imap_8bit() is \" . ($durationZendMime-$durationImap_8bit) . \" seconds faster than Zend_Mime!\\n\";\r\necho \"It only needs \" . ceil((100\/$durationZendMime)*$durationImap_8bit) . \"% of time\";\r\n{code}\r\n\r\nOUTPUT:\r\n\r\nStarting encoding with imap_8bit() (5000 times)\r\nDuration: 7 seconds\r\nStarting encoding with Zend_Mime::encodeQuotedPrintable() (5000 times)\r\nDuration: 273 seconds\r\n\r\nimap_8bit() is 266 seconds faster than Zend_Mime!\r\nIt only needs 3% of time\r\n\r\nPossible changes for Zend_Mime::encode():\r\n{code:title=Zend_Mime.php|borderStyle=solid}\r\npublic static function encode($str, $encoding, $EOL = self::LINEEND)\r\n    {\r\n        switch ($encoding) {\r\n            case self::ENCODING_BASE64:\r\n                return self::encodeBase64($str, self::LINELENGTH, $EOL);\r\n\r\n            case self::ENCODING_QUOTEDPRINTABLE:\r\n                if (function_exists('imap_8bit')){\r\n    \t\t   return imap_8bit($str);\r\n    \t        }\r\n                return self::encodeQuotedPrintable($str, self::LINELENGTH, $EOL);\r\n\r\n            default:\r\n                \/**\r\n                 * @todo 7Bit and 8Bit is currently handled the same way.\r\n                 *\/\r\n                return $str;\r\n        }\r\n    }\r\n{code}\r\nGreetings,\r\nJonas"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8103\/watchers",
                "isWatching": false,
                "watchCount": 8
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "After1.12.0",
                "FixForZF1.12.1",
                "state:patch-ready-for-review",
                "zf-caretaker-adamlundrigan"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                "name": "mjh_ca",
                "displayName": "Marc Hodgins",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13513",
                    "filename": "benchmark.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2010-12-02T23:37:46.000+0000",
                    "size": 2173,
                    "mimeType": "application\/x-httpd-php",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13513\/benchmark.php"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13515",
                    "filename": "ZF-8103.new.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2010-12-03T03:53:38.000+0000",
                    "size": 7409,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13515\/ZF-8103.new.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13512",
                    "filename": "ZF8103.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=postalservice14",
                        "name": "postalservice14",
                        "displayName": "John Kelly",
                        "active": true
                    },
                    "created": "2010-12-02T15:27:26.000+0000",
                    "size": 2492,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13512\/ZF8103.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10370",
                    "id": 10370,
                    "description": "Mini Release",
                    "name": "1.9.4",
                    "userReleaseDate": "13\/Oct\/09",
                    "archived": false,
                    "releaseDate": "2009-10-13",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10019",
                    "id": 10019,
                    "name": "Zend_Mime",
                    "description": "support class for handling multi-part MIME messages",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35596",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "body": "Your proposition is very interesting, Jonas.\r\n\r\nBut I worry whether we would do against rule about extensions if we use IMAP extension.\r\nThe rule was written in PHP Coding Standard (draft).\r\n\r\ncf:\r\n{noformat}\r\nhttp:\/\/framework.zend.com\/wiki\/display\/ZFDEV\/PHP+Coding+Standard+(draft)\r\n{noformat}\r\n\r\nThe page says, ??Zend Framework components may use an extension only if that extension is enabled by default in the PHP.net binary distribution supported by the current release of Zend Framework.??\r\n\r\nTherefore, I think the exptension is not available at present unfortunately. :-(",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "created": "2009-10-28T08:06:57.000+0000",
                    "updated": "2009-10-28T08:06:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35599",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mkliewe",
                        "name": "mkliewe",
                        "displayName": "Michael Kliewe",
                        "active": true
                    },
                    "body": "If the extension is not available, it is not used. There is no problem I think.\r\n\r\nI have the same \"problem\" with the bad performance...\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mkliewe",
                        "name": "mkliewe",
                        "displayName": "Michael Kliewe",
                        "active": true
                    },
                    "created": "2009-10-28T10:47:27.000+0000",
                    "updated": "2009-10-28T10:47:27.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35600",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mkone",
                        "name": "mkone",
                        "displayName": "Martin K\u00f6rner",
                        "active": true
                    },
                    "body": "What about Zend_Db_Adapter_Sqlsrv? This class even uses a 3rd party extension (sqlsrv.dll from Microsoft Corp.) which is currently only available on Win32.\r\n\r\nThe Coding Standard should not be used in this case because:\r\n1. it's a draft\r\n2. there are other classes that don't follow it\r\n3. the Zend_Mime class will work without the extension enabled furthermore",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mkone",
                        "name": "mkone",
                        "displayName": "Martin K\u00f6rner",
                        "active": true
                    },
                    "created": "2009-10-28T11:09:09.000+0000",
                    "updated": "2009-10-28T11:09:09.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35789",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "body": "An extension, which is not in the default build may be used as a soft dependency AFAIK. BTW adapters are a bad example, because they invert the dependency (you use an adapter, because you have database X).\r\n\r\nAs long as imap\/c-client doesn't have problems, like different output than build-in methods or platform specific issues, it could be used if the benefit is big enough. The given example doesn't really test a real life issue if the page content is not fetched inside of the loop, so the benefit hasn't been measured yet.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "created": "2009-11-05T05:37:33.000+0000",
                    "updated": "2009-11-05T05:37:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/36084",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "body": "Hi, all ;)\r\n\r\nI will be happy if you give me more several weeks for my setting up Unit tests.\r\n\r\nThe tests should be able to check PHP script when both imap extension exists or not, I think.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "created": "2009-11-18T01:26:50.000+0000",
                    "updated": "2009-11-18T01:26:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39110",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jwueste",
                        "name": "jwueste",
                        "displayName": "Jonas W\u00fcste",
                        "active": true
                    },
                    "body": "Hi Satoru,\r\n\r\ncan you tell me something about the progress on this issue?\r\nI would be very happy if I don't have to change code everytime I update the framework ;)\r\n\r\nGreetings",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jwueste",
                        "name": "jwueste",
                        "displayName": "Jonas W\u00fcste",
                        "active": true
                    },
                    "created": "2010-03-08T23:48:05.000+0000",
                    "updated": "2010-03-08T23:48:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40120",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mben",
                        "name": "mben",
                        "displayName": "Marc Bennewitz (GIATA mbH)",
                        "active": true
                    },
                    "body": "There are new functions available since PHP 5.3: quoted_printable_encode & quoted_printable_decode\r\n\r\nphp.net:\r\n- encode\r\nReturns a quoted printable string created according to \u00bb RFC2045, section 6.7.\r\nThis function is similar to imap_8bit(), except this one does not require the IMAP module to work.\r\n\r\n- decode:\r\nThis function returns an 8-bit binary string corresponding to the decoded quoted printable string (according to \u00bb RFC2045, section 6.7, not \u00bb RFC2821, section 4.5.2, so additional periods are not stripped from the beginning of line).\r\nThis function is similar to imap_qprint(), except this one does not require the IMAP module to work. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mben",
                        "name": "mben",
                        "displayName": "Marc Bennewitz (GIATA mbH)",
                        "active": true
                    },
                    "created": "2010-04-19T06:59:26.000+0000",
                    "updated": "2010-04-19T06:59:26.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40967",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "body": "Sorry, I have been inactive since last April.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "created": "2010-06-12T06:30:11.000+0000",
                    "updated": "2010-06-12T06:30:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41927",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jwueste",
                        "name": "jwueste",
                        "displayName": "Jonas W\u00fcste",
                        "active": true
                    },
                    "body": "Any news on this?\r\nOr should I ask: Will it ever be fixed?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jwueste",
                        "name": "jwueste",
                        "displayName": "Jonas W\u00fcste",
                        "active": true
                    },
                    "created": "2010-08-09T23:07:47.000+0000",
                    "updated": "2010-08-09T23:07:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/42193",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jwueste",
                        "name": "jwueste",
                        "displayName": "Jonas W\u00fcste",
                        "active": true
                    },
                    "body": "Hello?!?\r\nCould anyone please be so kind and put the changes in the trunk?\r\nGreets",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jwueste",
                        "name": "jwueste",
                        "displayName": "Jonas W\u00fcste",
                        "active": true
                    },
                    "created": "2010-09-05T23:04:10.000+0000",
                    "updated": "2010-09-05T23:04:10.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43430",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "body": "The original patch could use a couple of improvements before going into trunk.  First, the optimization should be applied in Zend_Mime::_encodeQuotedPrintable() because this makes it available for calls to Zend_Mime::encodeQuotedPrintable() as well as ::encode(). \r\n\r\nAlso, Marc Bennewitz noted, PHP5.3 now includes quoted_printable_encode().  I have benchmarked this and it is even faster than using the IMAP extension.  So, IMO the ideal solution here is to test for quoted_printable_encode(), then test for imap_8bit(), then fall back to the existing behavior.  Speed tests from the benchmark (with 5000 iterations):\r\n\r\n{noformat}\r\nimap_8bit() is 145.0137 seconds faster than Zend_Mime!\r\nIt is 42.36 times faster\r\n\r\nquoted_printable_encode() is 145.3856 seconds faster than Zend_Mime!\r\nIt is 47.39 times faster\r\n{noformat}\r\n\r\nAttaching two files:\r\n\r\n# *Revised benchmark script* which includes testing of quoted_printable_encode(), and\r\n# *Revised patch* which: \r\n## Moves the fix to Zend_Mime::_encodeQuotedPrintable()\r\n## Modifies the behavior to try quoted_printable_encode(), then fall back to imap_8bit(), then fall back to existing internal encoding behavior.\r\n## Adds a note to the documentation about how enabling the IMAP extension on PHP < 5.3 will result in a speedup.\r\n## Adds a test to _tests\/Zend\/MimeTest.php_ to ensure that calls optimized to these faster PHP functions as well as the internal ability of Zend_Mime to handle quoted-printable encoding are tested no matter what platform or extensions are active when the tests are run.\r\n\r\nIf someone could test this patch by running _tests\/Zend\/MimeTest_ on PHP5.2 that would be great as I've only tested this on PHP5.3.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2010-12-02T23:37:49.000+0000",
                    "updated": "2010-12-02T23:37:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43431",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "body": "Targeting for next mini release since the patch is backwards-compatible and fixes a performance bottleneck.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2010-12-02T23:40:16.000+0000",
                    "updated": "2010-12-02T23:40:16.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43433",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jwueste",
                        "name": "jwueste",
                        "displayName": "Jonas W\u00fcste",
                        "active": true
                    },
                    "body": "I've noticed a needed modification in this patch.\r\nInstead of directly returning the result of imap_8bit() or quoted_printable_encode() you have to replace the lineendings \"\\r\\n\" by \"$EOL, which defaults to \"\\n\". \r\nWithout this modification the lineends in the mail are \"\\r\\r\\n\".\r\nWhen sending this mail with a SMTP-Server that tries to repair broken lineends (e.g. PowerMTA) the lineends are now \"\\r\\n\\r\\n\". This leads to misformatted (HTML-)mails.\r\nSo the function should look like this\r\n\r\nprivate static function _encodeQuotedPrintable($str)\r\n     {\r\n        \/\/ PHP or extension functions are much faster, use if available\r\n        if (function_exists('quoted_printable_encode')) {\r\n            return str_replace(\"\\r\\n\", $EOL, quoted_printable_encode($str));\r\n        } elseif (function_exists('imap_8bit')) {\r\n            return str_replace(\"\\r\\n\", $EOL, imap_8bit($str));\r\n        } else {\r\n            return self::_encodeQuotedPrintableInternal($str);\r\n        }\r\n    }\r\n\r\nGreets,\r\nJonas",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jwueste",
                        "name": "jwueste",
                        "displayName": "Jonas W\u00fcste",
                        "active": true
                    },
                    "created": "2010-12-03T00:05:09.000+0000",
                    "updated": "2010-12-03T00:05:09.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43435",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "body": "@Jonas: Good catch.  Hadn't noticed that the PHP methods do the line breaks for you.  This was at odds with how Zend_Mime allows specifying custom lineLength and lineBreak, so I refactored the patch a little more to support it.\r\n\r\nAlso added a few additional tests that should have been in there to confirm lineLength and lineBreak behavior.\r\n\r\nRevised patch is attached.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2010-12-03T03:53:38.000+0000",
                    "updated": "2010-12-03T03:53:38.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8103\/transitions"
}