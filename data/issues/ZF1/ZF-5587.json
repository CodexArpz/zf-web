{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5587",
    "key": "ZF-5587",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Validate_EmailAddress validate invalid MX records"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5587\/votes",
                "votes": 6,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10360",
                    "id": 10360,
                    "description": "Minor Release",
                    "name": "1.10.0",
                    "userReleaseDate": "27\/Jan\/10",
                    "archived": false,
                    "releaseDate": "2010-01-27",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-09-09T12:59:05.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=csecskedi",
                "name": "csecskedi",
                "displayName": "Csaba Csecskedi",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-01-20T05:05:49.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-09-09T12:59:03.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "Zend_Validate_EmailAddress"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "{{$validator = new Zend_Validate_EmailAddress(Zend_Validate_Hostname::ALLOW_DNS, true);}}\n{{var_export($validator->isValid(\"someone@yyahoo.de\"));}}\n\nZend_Validate_EmailAddress validate invalid MX record *yyahoo.de* because {{dns_get_mx()}} function returns {{array(0=>'')}} value."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5587\/watchers",
                "isWatching": false,
                "watchCount": 4
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11916",
                    "filename": "EmailAddress.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gixx",
                        "name": "gixx",
                        "displayName": "Gabor Ivan",
                        "active": true
                    },
                    "created": "2009-05-04T07:16:06.000+0000",
                    "size": 16053,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11916\/EmailAddress.php"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10250",
                    "id": 10250,
                    "description": "Mini Release",
                    "name": "1.7.3",
                    "userReleaseDate": "19\/Jan\/09",
                    "archived": false,
                    "releaseDate": "2009-01-19",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10140",
                    "id": 10140,
                    "name": "Zend_Validate",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29942",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "The MX check is only processed when dns_get_mx is available.\nWithin Windows for example no mx check is done.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-04-04T13:36:25.000+0000",
                    "updated": "2009-04-04T13:36:25.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29943",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dasprid",
                        "name": "dasprid",
                        "displayName": "Ben Scholzen",
                        "active": true
                    },
                    "body": "Well actually:\n\ndasprid@dasprid-desktop:~$ host -t MX yyahoo.com\nyyahoo.com mail is handled by 0 .\n\ndasprid@dasprid-desktop:~$ host -t MX some-non-existent-domain.com\nHost some-non-existent-domain.com not found: 3(NXDOMAIN)\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dasprid",
                        "name": "dasprid",
                        "displayName": "Ben Scholzen",
                        "active": true
                    },
                    "created": "2009-04-04T14:21:08.000+0000",
                    "updated": "2009-04-04T14:21:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29944",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I still don't get the point.\nArray(0=> '') is detected and no error is thrown as count is 1.\n\nMX is not a good way to detect the server, because according to RFC when no MX is available it has to be set to 0 and ignored.\n\nThe reason behind is that a server may accept mails from unknown domains according to RFC.\nIn my opinion this is not really an error as it works as defined by RFC.\n\nAdditionally dns_get_mx is not available on Windows systems.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-04-04T15:03:46.000+0000",
                    "updated": "2009-04-04T15:03:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30481",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lalaman",
                        "name": "lalaman",
                        "displayName": "Laszlo Berta",
                        "active": true
                    },
                    "body": "I have to agree with the reporter, it is a bug. It might be working as defined in the RFC page, but it is still a functional disorder.  \n\n@Thomas: 'The reason behind is that a server may accept mails from unknown domains according to RFC.'\nIf we're talking about _accepting_, _recieving_ mails, it's okay, but if you want to validate is for _sending_, it's no longer correct. E.g. you try to validate an email address given by a future user, who wants to register on your website, and mistypes his\/her email address, and the *foo@yyahoo.de* passes the validation, the user will never get the confirmation mail. Another example: take an e-card sending website, and try to imagine, how many 'delivery status notification' emails will the server recieve only because of the incorrectly validated yyahoo.de, uyahoo.com domains given as 'Send to' email domains.\n\nKeeping it short: the functionality implemented in the Zend_Validator_EmailAddress for checking the MX record is not correct if you have to validate a user input for email sending.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lalaman",
                        "name": "lalaman",
                        "displayName": "Laszlo Berta",
                        "active": true
                    },
                    "created": "2009-04-28T02:40:18.000+0000",
                    "updated": "2009-04-28T02:40:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30482",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I still don't get the point:\nyyahoo.com DOES exist... see http:\/\/whois.domaintools.com\/yyahoo.com\n\nThe own server is only not able to detect additional data... therefor a 0 is returned and no false.\n\nSo the thing seems more that MX itself is no proper way for a verification and not that it does not work in all usecases.\nAnd my point is that when 50% of the cases are correct it should stay implemented.\nErasing the MX test would mean that no case can be verified.\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-04-28T02:59:46.000+0000",
                    "updated": "2009-04-28T02:59:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30483",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gergely.sipics",
                        "name": "gergely.sipics",
                        "displayName": "Gergely Sipics",
                        "active": true
                    },
                    "body": "Yes the primary goal for MX checking should be checking if the target server has any usable MX record. If it has only unusable records, like 0 or 127.0.0.1 (what is RFC compilant), the developer should be able to get some info about this. So in my opinion, it would be great to add an optional parameter to the validator function for MX usability checking. It shold be for checking for unusable (0) and unrouted\/private IP addresses like 127.0.0.0\/8 10.0.0.0\/8 172.16.0.0\/12 192.168.0.0\/16 (for IPv4) too. (IPv6 checking would also be useful in futrure releases.)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gergely.sipics",
                        "name": "gergely.sipics",
                        "displayName": "Gergely Sipics",
                        "active": true
                    },
                    "created": "2009-04-28T03:19:19.000+0000",
                    "updated": "2009-04-28T03:19:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30485",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=letssurf",
                        "name": "letssurf",
                        "displayName": "James Dempster",
                        "active": true
                    },
                    "body": "This method already break the RFC's.\n\nA domain may have no MX records and can still be a valid email address and recieve emails.\n\n\"If no MX records were present, the server falls back to A, that is to say, it makes a request for the A record of the same domain.\"\ncite: http:\/\/en.wikipedia.org\/wiki\/MX_record\n\n\"If no MX records are found, but an A RR is found, the A RR is treated as if it was associated with an implicit MX RR, with a preference of 0, pointing to that host.\"\ncite: http:\/\/www.ietf.org\/rfc\/rfc2821.txt\n\n\"If one or more MX RRs are found for a given name, SMTP systems MUST NOT utilize any A RRs associated with that name unless they are located using the MX RRs; the \"implicit MX\" rule above applies only if there are no MX records present.  If MX records are present, but none of them are usable, this situation MUST be reported as an error.\"\ncite: http:\/\/www.ietf.org\/rfc\/rfc2821.txt\n\nTherefore yyahoo.com is an invalid domain for mail delivery because it's MX records are invalid.\n\nSecondly the isValid method should be changed to check for A records with mail servers on them if no MX records are present.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=letssurf",
                        "name": "letssurf",
                        "displayName": "James Dempster",
                        "active": true
                    },
                    "created": "2009-04-28T03:30:14.000+0000",
                    "updated": "2009-04-28T03:30:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30486",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gixx",
                        "name": "gixx",
                        "displayName": "Gabor Ivan",
                        "active": true
                    },
                    "body": "Hi!\n\n@Thomas: we don't want to erase the MX test, but extend it to make it smarter.\n\nIn our opinion the problems are e.g.:\n\n1. antoniabur@uyahoo.com\n    SMTP error from remote mail server after RCPT TO:<antoniabur@uyahoo.com>:\n    host ancksunamun2.hosting [172.16.100.252]: 550 Cannot route to <antoniabur@uyahoo.com>\n\nQuestion: Why?\nAnswer: uyahoo.com mail is handled by 10 10.0.0.2.\nConclusion: It is not in a routable network segment. This address should not be resolved form public network.\n\n2. ralupop2003@yohoo.com\n    SMTP error from remote mail server after RCPT TO:<ralupop2003@yohoo.com>:\n    host ancksunamun2.hosting [172.16.100.252]: 550 Cannot route to <ralupop2003@yohoo.com>\n\nQuestion: Why?\nAnswer: yohoo.com mail is handled by 0 .\nConclusion: it's a common mistake, They have registered it, but the MX record is empty or just a \".\"\n\nRecommendations:\n- extend the validator to check for not only the MX but also the following records:\n\tMX,\n\tA,\n\tAAAA,\n\tA6,\n\tand maybe CNAME\n\t\n- If the MX record returns with an empty (or invalid MX) value, e.g.: \".\", the address should be marked as invalid\n\n- It would be a good idea to extend the validator to OPTIONALLY detect and check for the following reserved network segments and mark as invalid:\n\n10.0.0.0\/8 # RFC 1918\n127.0.0.0\/8 # this host\n169.254.0.0\/16 # link-local\n172.16.0.0\/12 # RFC 1918\n192.0.2.0\/24 # example net\n192.168.0.0\/16 # RFC 1918\n198.18.0.0\/15 # benchmark net\n224.0.0.0\/3 # multicast & reserved\n\nVERY IMPORTANT: it should NOT be a default behaviour, but give the chance to the developers to prepare their application to use it.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gixx",
                        "name": "gixx",
                        "displayName": "Gabor Ivan",
                        "active": true
                    },
                    "created": "2009-04-28T03:37:24.000+0000",
                    "updated": "2009-04-28T03:37:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30487",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Ok:\n\nTo summarize:\nFrom the 3 levels of validation we will only support 2 levels.\nSyntax and MX... SMTP validation will not be implemented as it can lead to a 70 seconds delay until the mail server responded.\n\nRegarding IPV6:\nPlease note that IPV6 is not handled by Zend_Validate_EmailAdress but from another component.\nThis is not part of this issue and will be solved differently.\n\nRegarding A RR:\ndns_get_record has the same problem as getmxrecord... not available under Windows. I have to dig if there is a simple solution.\n\nRegarding \"good idea\":\nPlease note that \"good ideas\" are not part of this issue. I would ask, if you have a feature enhancement, to write a separate issue describing it.\n\nLast of my points:\nPlease note that the solution of this bug will still take additional time as discussion is not equal with bug-fix :-)\nBut you can be sure that I will fix this bug when no one applies a patch. It's just a matter of time ;-)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-04-28T04:13:07.000+0000",
                    "updated": "2009-04-28T04:13:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30637",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gixx",
                        "name": "gixx",
                        "displayName": "Gabor Ivan",
                        "active": true
                    },
                    "body": "This modified (patched) Zend_Validate_EmailAddress class allows users to perform a deeper email address analysis.\n\n- The class contains new constant value: self::INVALID_NETWORK_SEGMENT that tells if the host is not in a routable network segment.\n- There are several new private methods that calculate subnet informations from the IP address\n- The isValid method has been modified to optionally use these new features over the default behaviour in the following way:\n1. if the dns_get_mx(); function does not return with any MX record, the host may sill accept messages if there's a valid A, AAAA or A6 record\n2. if the dns_get_mx(); function returns with one or more MX record for the host, each of them must be checked for at lesat one valid address.\n\nThe modified file is based on Zend Framework 1.8 RC source.\n\nPlease check it, test it, modify it if needed.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gixx",
                        "name": "gixx",
                        "displayName": "Gabor Ivan",
                        "active": true
                    },
                    "created": "2009-05-04T07:16:11.000+0000",
                    "updated": "2009-05-04T07:16:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31724",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "@Gabor:\nThank you for the patch.\n\nBUT:\n* It does not work on other environments than *nix... this limitation is not acceptable for ZF\n* It integrates code from another project... this is not allowed within ZF",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-06-10T12:53:20.000+0000",
                    "updated": "2009-06-10T12:53:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34146",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I just added a complete rework of Zend_Validate_EmailAddress... this feature has also been added to incubator for tests.See SVN r17945 for details.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-09-01T14:45:37.000+0000",
                    "updated": "2009-09-01T14:45:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34350",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Implemented as new feature with r18050 for ZF 1.10",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-09-09T12:59:00.000+0000",
                    "updated": "2009-09-09T12:59:00.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5587\/transitions"
}