{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5928",
    "key": "ZF-5928",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "getList() returns only current value and not all available lanuages in case we use Zend_Translate+Zend_Cache"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5928\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10241",
                    "id": 10241,
                    "description": "Minor Release",
                    "name": "1.8.0",
                    "userReleaseDate": "30\/Apr\/09",
                    "archived": false,
                    "releaseDate": "2009-04-30",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-03-11T01:23:39.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=webdevbyjoss",
                "name": "webdevbyjoss",
                "displayName": "Joseph Chereshnovsky",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-03-03T02:59:25.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-03-11T01:23:39.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "getList_problem",
                "translation_cache"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "According API docs: \n{quote}\ngetList\n    Zend_Translate_Adapter::getList() in Adapter.php\n    Returns the available languages from this adapter\n{\/quote}\n\nBut it returns only language code for current (default) cached language, instead of returning the list of all available languages in translation data source.\n\nThis is a problem for me as I'm using the getList() method to extract values and build the languages selectbox to allow user to select interface language.\n\nWill attach the code to reproduce this error"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/6",
                "name": "N\/A"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5928\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11779",
                    "filename": "zend_translate_problem.zip",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=webdevbyjoss",
                        "name": "webdevbyjoss",
                        "displayName": "Joseph Chereshnovsky",
                        "active": true
                    },
                    "created": "2009-03-03T03:05:58.000+0000",
                    "size": 1497,
                    "mimeType": "application\/x-zip-compressed",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11779\/zend_translate_problem.zip"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10290",
                    "id": 10290,
                    "description": "Mini Release",
                    "name": "1.7.6",
                    "userReleaseDate": "02\/Mar\/09",
                    "archived": false,
                    "releaseDate": "2009-03-02",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10099",
                    "id": 10099,
                    "name": "Zend_Translate",
                    "description": "Provides translation functionality, based on standards such as TMX and Gettext.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29247",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=webdevbyjoss",
                        "name": "webdevbyjoss",
                        "displayName": "Joseph Chereshnovsky",
                        "active": true
                    },
                    "body": "according the attached code sample:\n\nRefresh the page couple times and you will see only one language in the list, even if we have three languages available in translation data source.\n\nClear the cache and you will see all three languages in the list, but only for this time. Refresh again and you will see one language in the list again.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=webdevbyjoss",
                        "name": "webdevbyjoss",
                        "displayName": "Joseph Chereshnovsky",
                        "active": true
                    },
                    "created": "2009-03-03T03:06:05.000+0000",
                    "updated": "2009-03-03T03:07:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29248",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "getList() returns all loaded languages.\nThis is independently of which language has been set.\n\nSo when the language is not loaded, it will not be returned.\n\nI expect that you are having problems eighter with your implementation or with your cache.\nI am not able to reproduce this behaviour on my system.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-03T04:46:55.000+0000",
                    "updated": "2009-03-03T04:46:55.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29249",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=webdevbyjoss",
                        "name": "webdevbyjoss",
                        "displayName": "Joseph Chereshnovsky",
                        "active": true
                    },
                    "body": "My implementation actually is a quite simple script with only 46 lines. You can find it in attached \"zend_translate_problem.zip\".\nCan you please try it? ( tmp\/ subdirectory must be writable)\n\nAll code works great if we disable Zend_Cache\n\nI've perfomed some debug using ZendDebuger and found the following:\n\n1. During the first run of the script, Zend_Translate_Adapter loads the metadata (available languages) from translation source (TMX file in my case), and tranlation data only for current language (locale).\n\nThen it writes all information into cache using Zend_Cache instance.  As only current locale data was loaded then we have translation information cached only for one (current) locale.\n\n2. After we refresh the page, - Zend_Translate loads data from cache now and not from original translation data source. So we receiving only one language available in ->getList() method because we have cached information for one locale.\n\n\nI've found this code in Zend\/Translate\/Adapter.php\n\n{{monospaced}}\n        if (isset(self::$_cache)) {\n            $id = 'Zend_Translate_' . preg_replace('\/[^a-zA-Z0-9_]\/', '_', $data) . '_' . $locale . '_' . $this->toString();\n            $result = self::$_cache->load($id);\n            if ($result) {\n                $this->_translate[$locale] = unserialize($result);\n                $read = false;\n            }\n        }\n\n        if ($read) {\n            $this->_loadTranslationData($data, $locale, $options);\n        }\n{{monospaced}}\n\nIf cache exists it loads the information from cache and \"$read = false;\" indicates that we don't need to read translation source file.\nHere is our issue: We have information only for ONE locale in the cache, and there is no any information about other locales available in the cache.\nThats why when we calling ->getList() method we receiving only one available language instead of the list of available languages.\n\nI can reproduce this on my clear install of ZendServer + WinXP + ZF 1.8dev (lates co from SVN)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=webdevbyjoss",
                        "name": "webdevbyjoss",
                        "displayName": "Joseph Chereshnovsky",
                        "active": true
                    },
                    "created": "2009-03-03T07:32:43.000+0000",
                    "updated": "2009-03-03T07:33:44.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29388",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=webdevbyjoss",
                        "name": "webdevbyjoss",
                        "displayName": "Joseph Chereshnovsky",
                        "active": true
                    },
                    "body": "I saw your last commit according this issue. \nI've tested new code and it looks OK right now, so I think the issue can be closed.\nThanks.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=webdevbyjoss",
                        "name": "webdevbyjoss",
                        "displayName": "Joseph Chereshnovsky",
                        "active": true
                    },
                    "created": "2009-03-11T00:59:39.000+0000",
                    "updated": "2009-03-11T00:59:39.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29389",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Reworked cache handling with r14274 which solves also this issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-11T01:23:38.000+0000",
                    "updated": "2009-03-11T01:23:38.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5928\/transitions"
}