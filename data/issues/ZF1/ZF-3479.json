{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3479",
    "key": "ZF-3479",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Mail_Protocol_Pop3: Wrong parsing of termination octet in multiline responses"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3479\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/4",
                "name": "Incomplete"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-02-24T02:46:22.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thorsten",
                "name": "thorsten",
                "displayName": "Thorsten Suckow-Homberg",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-06-18T18:25:08.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-05-21T15:00:48.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "*What steps will reproduce the problem?*\nFetch a message from a POP3 server where the email-body contains a single line with a dot (\".\"). For example (sent by the groups.google.com-Google Maps API):\n<quote>\nLooking for example - Can this be done? - 2 new\n-----------------------------------------------\nI have a google map on a web page. I would like for the user to enter in a=\n=20\nstate and hit submit. Using AJAX, I want to be able to access a database on=\n=20\nthe server, select all the addresses in that state and return them so they c=\nan\nbe displayed on the Google map. I was wondering if I have to do this using a=\n .\nNET user control since I - Mon, Jun 16 2008 1:14 pm=20\n2 messages , 2 authors\nhttp:\/\/groups.google.com\/group\/Google-Maps-API\/t\/928e1d733e1a5c85?hl=3Den\n<\/quote>\n\n*What is the expected output?*\nThe class will read the message from the server until the termination octet (wrapped in CRLF: \"\\r\\n.\\r\\n\") occurs.\n\n*What do you see instead?*\nThe class will read the message and return only the contents until the single line with the dot \".\" appears. Apparently, it is not parsing the termination octet as returned by the server correctly and assumes that any line in a message containing only a dot \".\" represents a termination octet.\n\n*Can you provide a fix for this problem?*\nIn line 188 in Zend\/mail\/Protocol\/Pop3.php, replace\n\n[code]\nwhile ($line && trim($line) != '.') {\n[\/code]\n\nwith \n\n[code]\nwhile ($line && $line != \".\\r\\n\") {\n[\/code]\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/1",
                "name": "Blocker"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3479\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                "name": "nico",
                "displayName": "Nico Edtinger",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10181",
                    "id": 10181,
                    "description": "Mini Release",
                    "name": " 1.5.2",
                    "userReleaseDate": "15\/May\/08",
                    "archived": true,
                    "releaseDate": "2008-05-15",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10018",
                    "id": 10018,
                    "name": "Zend_Mail",
                    "description": "high-level utility to build MIME-compliant messages and send using a mail transport adapter",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24546",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "body": "After rereading the RFC, the proposed patch is not correct or won't fix the problem. The trim should only remove \\r and \\n, but it's used to avoid problems with non-conforming servers (like ones that terminate lines with only \\n).\n\nNow the problem is, that a valid message with a single dot in a line would still have \".\\r\\n\" and that's the same as the line with the termination octet. The server should send \"..\\r\\n\" (and Zend_Mail_Protocol_Pop3 should remove the first dot), but it seems like your POP3 server isn't careful enough.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "created": "2008-09-15T03:17:23.000+0000",
                    "updated": "2008-09-15T03:17:23.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24599",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "body": "The termination octet is now handled correctly (\"..\\r\\n\" becomes \".\\r\\n\" in the message body).\n\nThe question remains, which wrong RFC violation we should support in addition. IMO wrong newlines are more common and therefor supporting \"\\n\" or and other combination of \"\\r\" and \"\\n\" more important, than a server, that does not escape a line with a single dot correctly. I leave this task open for comments. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "created": "2008-09-21T11:35:18.000+0000",
                    "updated": "2008-09-21T11:35:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24980",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thorsten",
                        "name": "thorsten",
                        "displayName": "Thorsten Suckow-Homberg",
                        "active": true
                    },
                    "body": "Nico, did you change the code in ZF 1.6.*? Because a diff to 1.5.2 does not give me any changes...",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thorsten",
                        "name": "thorsten",
                        "displayName": "Thorsten Suckow-Homberg",
                        "active": true
                    },
                    "created": "2008-10-10T04:19:52.000+0000",
                    "updated": "2008-10-10T04:19:52.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25644",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=davidgoodwin",
                        "name": "davidgoodwin",
                        "displayName": "David Goodwin",
                        "active": true
                    },
                    "body": "Hi,\n\nThis bug still exists in the 1.6 branch (revision 12162).\n\nIn my instance, the subject line wraps and has a single '.' on the end - which after the trim gets interpreted as part of the POP3 protocol.\n\ni.e. This is what I see when I telnet into the cyrus pop3 server and fetch the problem message :\n\nRETR 1\n+OK Message follows\nReturn-Path: <postmaster@xxxxxxxx.co.uk>\nReceived: from xxxxx.xxxxxxxx.com ([unix socket])\n\t by xxxxx.xxxxx.com (Cyrus v2.3.7-Invoca-RPM-2.3.7-2.el5) with LMTPA;\n\t Tue, 04 Nov 2008 05:27:46 +0000\nX-Sieve: CMU Sieve 2.3\nReceived: from xxxxx.xxxxx.com (xxxxxx.xxxxxxx.com [xx.xx.xx.xx])\n\tby xxxxx.xxxxxxxx.com (Postfix) with ESMTP id 7474029D92\n\tfor <return@xxxx.xxx>; Tue,  4 Nov 2008 05:27:46 +0000 (GMT)\nReceived: from surfcontrol.xxxxxx.local (xx.xxx.xxx.xx) by xxxx.xxxx.xxx (PowerMTA(TM) v3.5r9) id h1vel40mav0j for <return@xxxx.com>; Tue, 4 Nov 2008 05:27:46 +0000 (envelope-from <postmaster@xxxxxxxxxxx.xx>)\nDate: Tue, 04 Nov 2008 05:29:16 +0000\nFrom: <postmaster@xxxxxx.co.uk>\nTo: <return@xxxx.com>\nSubject: AutoNotify: Payday loans on call 24 hours a day. Between 80 and 750\n\t.\nContent-Type: multipart\/mixed;\n\tboundary=\"----=_NextPart_SEF_2008_11_04_05_29_16_28319\"\nX-SEF-Processed: 6_0_1_111__2008_11_04_05_29_16\nMessage-Id: <20081104052746.7474029D92@xxxxx.xxxxxxxxx.com>\n\n------=_NextPart_SEF_2008_11_04_05_29_16_28319\nContent-Type: text\/plain;charset=\"utf-8\"\nContent-Transfer-Encoding: quoted-printable\n\nMessage [oa129842ee9f84d02a5adecdb6bfb5ed6.pro] triggered rule [Anti-Spam A=\ngent (1)] at 05:29:16 04\/11\/2008=0D=0A=0D=0ASender: return@xxxx.com=0D=0ARe=\ncipient(s): barrie@xxxxxxx.co.uk=0D=0ASubject: Payday loans on call 24 hou=\nrs a day. Between 80 and 750.\n------=_NextPart_SEF_2008_11_04_05_29_16_28319--\n.\nDELE 1\n+OK message deleted\nquit\n\n\n\nNote, the single full stop\/period which is on the line AFTER the subject: - and it is indented correctly.\n\nWhen trying to parse the above, the class fails with an unhelpful message of 'cannot retrieve message' - and ends up thinking 'Content-Type: multipart\/mixed;' is the response to the previous command.....\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=davidgoodwin",
                        "name": "davidgoodwin",
                        "displayName": "David Goodwin",
                        "active": true
                    },
                    "created": "2008-11-04T01:59:59.000+0000",
                    "updated": "2008-11-04T01:59:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25645",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=davidgoodwin",
                        "name": "davidgoodwin",
                        "displayName": "David Goodwin",
                        "active": true
                    },
                    "body": "hmm, well the original message is indented correctly; clearly posting here gets mangled.\n\n{{\nTo: <return@xxxxx.com>\nSubject: AutoNotify: Payday loans on call 24 hours a day. Between 80 and 750\n\t.\nContent-Type: multipart\/mixed;\n}}\n\n(final attempt to get it rendering properly)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=davidgoodwin",
                        "name": "davidgoodwin",
                        "displayName": "David Goodwin",
                        "active": true
                    },
                    "created": "2008-11-04T02:01:51.000+0000",
                    "updated": "2008-11-04T02:01:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25886",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "body": "Thorsten: yes it was fixed in trunk\n\nDavid: That's a server problem. I've this message in my INBOX file: \n{quote}\nFrom next-message@example.com  Mon Jan 00 00:00:00 0000\nTo: to@example.com\nSubject: Dot Test\n.\nDate: Sun, 01 Jan 2000 01:00:00 +0000\nFrom: from@example.com\nX-UID: 7\nStatus: RO\n\nBefore the dot\n.\nis after the dot\n{quote}\n\nWith dovecot I get:\n{quote}\nRETR 7\n+OK 139 octets\nTo: to@example.com\nSubject: Dot Test\n..\nDate: Sun, 01 Jan 2000 01:00:00 +0000\nFrom: from@example.com\n\nBefore the dot\n..\nis after the dot\n.\n{quote}\n\nMaybe you could post your message source with all chars printed, including \\r and \\n - at least the snippet from your last comment.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "created": "2008-11-07T13:02:06.000+0000",
                    "updated": "2008-11-07T13:02:06.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29050",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "body": "no response",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "created": "2009-02-24T02:46:13.000+0000",
                    "updated": "2009-02-24T02:46:13.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31232",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=landon",
                        "name": "landon",
                        "displayName": "Landon Bradshaw",
                        "active": true
                    },
                    "body": "We were using qmail and ran into the same problem ... but I can verify with version 1.8.1 it is working properly",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=landon",
                        "name": "landon",
                        "displayName": "Landon Bradshaw",
                        "active": true
                    },
                    "created": "2009-05-21T15:00:47.000+0000",
                    "updated": "2009-05-21T15:00:47.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3479\/transitions"
}