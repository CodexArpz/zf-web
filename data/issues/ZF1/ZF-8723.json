{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8723",
    "key": "ZF-8723",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "addBcc() and addCc() also add email addresses to the \"To\" header"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/10",
                "name": "Docs: Task ",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8723\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10160",
                    "id": 10160,
                    "description": "Major Release",
                    "name": "Next Major Release",
                    "archived": false,
                    "released": false
                }
            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=janpolsen",
                "name": "janpolsen",
                "displayName": "Jan Olsen",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-01-06T05:23:01.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-08-03T08:10:42.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I have the following simple code:\r\n\r\n{code:javascript}\r\n$mail = new Zend_Mail();}}\r\n$mail->setBodyText('This is the text of the mail.');\r\n$mail->setFrom('somebody@example.com', 'Some Sender');\r\n$mail->addTo('jan.olsen@example.com');\r\n$mail->addBcc('janpolsen@example.com'); \/\/notice a different email address\r\n$mail->setSubject('TestSubject');\r\n$mail->send();\r\n{code}\r\n\r\nWhen I run this code, I will receive an email with BOTH {{jan.olsen@example.com}} and {{janpolsen@example.com}} in the TO field. That is very very very unfortunate, because it will expose email addresses when it shouldn't :(.\r\n\r\nThe same happens if I use {{addCc()}}.\r\n\r\nAs I see it, then the only possible way to send mails to people using BCC is by tricking {{addHeader()}} to accept \"Bcc\". \r\n\r\nBack in 2007 \"mike55\" wrote about this issue (http:\/\/www.mail-archive.com\/fw-general@lists.zend.com\/msg06988.html), but it seems that the problem is still there.\r\n\r\nPS: This is only tested on ZF v1.9.3PL1, but I can't see any fixes\/changes regarding this in the changelogs from v1.9.3 through v1.9.6."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/5",
                "name": "Trivial"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8723\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "customfield_10000": {
            "name": "Language",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                "name": "freak",
                "displayName": "Dolf Schimmel (Freeaqingme)",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10362",
                    "id": 10362,
                    "description": "Mini Release",
                    "name": "1.9.3",
                    "userReleaseDate": "22\/Sep\/09",
                    "archived": false,
                    "releaseDate": "2009-09-22",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10018",
                    "id": 10018,
                    "name": "Zend_Mail",
                    "description": "high-level utility to build MIME-compliant messages and send using a mail transport adapter",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37430",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "body": "Sendmail Transport and Windows?\r\n\r\nIf yes =>\r\n\"As the PHP manual states the mail() function has different behaviour on Windows and on *nix based systems. Using the Sendmail Transport on Windows will not work in combination with addBcc(). The mail() function will sent to the BCC recipient such that all the other recipients can see him as recipient! \r\n\r\nTherefore if you want to use BCC on a windows server, use the SMTP transport for sending!\"\r\n\r\nExtract of the new documentation for ZF 1.10",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "created": "2010-01-06T05:30:41.000+0000",
                    "updated": "2010-01-06T05:30:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37431",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=janpolsen",
                        "name": "janpolsen",
                        "displayName": "Jan Olsen",
                        "active": true
                    },
                    "body": "Thanks for the super fast response :)\r\n\r\nWindows... check\r\nSendmail Transport... check (it's the default which I can read is {{Zend_Mail_Transport_Sendmail}}\r\n\r\nSo it's a PHP \"bug\"?\r\n\r\nHow come I can add:\r\n{{$mail->addHeader(\"Bcc: janpolsen@example.com\\r\\n\", null);}}\r\n... which will work without exposing the email address?\r\n\r\nI will try to see if I can change the Transport method.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=janpolsen",
                        "name": "janpolsen",
                        "displayName": "Jan Olsen",
                        "active": true
                    },
                    "created": "2010-01-06T05:42:46.000+0000",
                    "updated": "2010-01-06T05:42:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37432",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=janpolsen",
                        "name": "janpolsen",
                        "displayName": "Jan Olsen",
                        "active": true
                    },
                    "body": "It does indeed seem to work if I use:\r\n\r\n{code:javascript}\r\n$tr1 = new Zend_Mail_Transport_Smtp('exchange.example.com');\r\n\r\n$mail = new Zend_Mail();\r\n...\r\n$mail->send($tr1);\r\n{code}\r\n\r\nI do however find it a bit weird, when I can use the {{addHeader()}}-trick.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=janpolsen",
                        "name": "janpolsen",
                        "displayName": "Jan Olsen",
                        "active": true
                    },
                    "created": "2010-01-06T06:05:52.000+0000",
                    "updated": "2010-01-06T06:05:52.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37433",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "body": "In that case someone else will have to resolve this issue, since I only have linux and can't test on windows.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "created": "2010-01-06T06:08:21.000+0000",
                    "updated": "2010-01-06T06:08:21.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40906",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "body": "Sorry, I have been inactive since last April.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "created": "2010-06-09T00:22:11.000+0000",
                    "updated": "2010-06-09T00:22:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41546",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "body": "If it doesn't work it is not supported. You're probably best off reporting this bug to the php bugtracker if there isn't a bugreport already. I'm postponing this issue so that if Zend\\Mail (zf2) doesn't support it either (which I'm not expecting), we can test it again and add a nice disclaimer in the documentation.\r\n\r\nThank you for taking the time to report this issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "created": "2010-07-16T14:53:49.000+0000",
                    "updated": "2010-07-16T14:53:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41568",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "body": "Leaving this issue open to make sure it gets documented with zf2",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "created": "2010-07-17T07:13:41.000+0000",
                    "updated": "2010-07-17T07:13:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44304",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                        "name": "thadafinser",
                        "displayName": "Martin Keckeis",
                        "active": true
                    },
                    "body": "I've got the same problem here.\r\n\r\nThe problem is here (Zend\/Mail\/Transport\/Sendmail.php):\r\n{code}\r\n$result = mail(\r\n    $this->recipients, \/\/contain all addresses from to, cc and bcc (should only contain \"to\")\r\n    $this->_mail->getSubject(),\r\n    $this->body,\r\n    $this->header \/\/contain all headers with cc, bcc (and not to -> like it should be)\r\n);\r\n{code}\r\n\r\nThe \"to\" can also be empty, if only using \"bcc\"\r\n\r\nMy patchfor now:\r\n{code}\r\n     public function _sendMail()\r\n     {\r\n         if ($this->parameters === null) {\r\n+        \t\r\n+        \t$recipients = $this->_mail->getHeaders();      \t\r\n+        \tif(isset($recipients['To']))\r\n+        \t\t$toMail = $this->recipients['To'];\r\n+        \telse\r\n+        \t\t$toMail = '';\r\n+        \t\r\n             set_error_handler(array($this, '_handleMailErrors'));\r\n             $result = mail(\r\n-                $this->recipients,\r\n+                $toMail,\r\n                 $this->_mail->getSubject(),\r\n                 $this->body,\r\n                 $this->header);\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                        "name": "thadafinser",
                        "displayName": "Martin Keckeis",
                        "active": true
                    },
                    "created": "2011-02-07T06:14:37.000+0000",
                    "updated": "2011-02-07T06:14:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51531",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tobias654",
                        "name": "tobias654",
                        "displayName": "Tobias Weber",
                        "active": true
                    },
                    "body": "The code above my post doesn't work for me. So this is my patch. Please correct the original ZF.\r\n\r\n{code}\r\n    public function _sendMail()\r\n    {\r\n        if ($this->parameters === null) {\r\n            $headers = $this->_mail->getHeaders();\r\n            if (isset($headers['To'])) {\r\n                unset($headers['To']['append']);\r\n                $this->recipients = implode(',', $headers['To']);\r\n            } else {\r\n                $this->recipients = '';\r\n            }\r\n            set_error_handler(array($this, '_handleMailErrors'));\r\n            $result = mail(\r\n                $this->recipients,\r\n                $this->_mail->getSubject(),\r\n                $this->body,\r\n                $this->header);\r\n            restore_error_handler();\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tobias654",
                        "name": "tobias654",
                        "displayName": "Tobias Weber",
                        "active": true
                    },
                    "created": "2012-08-03T08:10:42.000+0000",
                    "updated": "2012-08-03T08:10:42.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8723\/transitions"
}