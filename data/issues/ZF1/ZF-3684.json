{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3684",
    "key": "ZF-3684",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Exception error codes are NULL in Zend_Db"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3684\/votes",
                "votes": 2,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10501",
                    "id": 10501,
                    "description": "Mini Release",
                    "name": "1.11.1",
                    "userReleaseDate": "30\/Nov\/10",
                    "archived": false,
                    "releaseDate": "2010-11-30",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-08-28T10:14:23.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                "name": "till",
                "displayName": "Till Klampaeckel",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-07-18T15:58:17.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-08-28T10:14:23.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "{code}\nconst ERR_ALREADY_EXISTS = NULL;\nconst ERR_CANT_MAP = NULL;\nconst ERR_CONSTRAINT = NULL;\nconst ERR_DISCONNECTED = NULL;\nconst ERR_MISMATCH = NULL;\nconst ERR_NO_PERM = NULL;\nconst ERR_NONE = '00000';\nconst ERR_NOT_FOUND = NULL;\nconst ERR_NOT_IMPLEMENTED = NULL;\nconst ERR_SYNTAX = NULL;\nconst ERR_TRUNCATED = NULL;\n{code}\n\nWhy are all those constants null? Parsing the error message is what this leads to and that is a pretty expensive operation. E.g. I rely on constraints set in the DB (table) on some insert operations and would like to disregard some \"errors\" returned. Impossible if the error code is NULL.\n\nAt least you could pass through the real error codes which the designated backend provides and allow people to match based on that. I am using Zend_Db (with PDO mysql).\n\nI remember I had an issue open about a year or maybe 1.5 years ago describing exactly the same issues. I thought it had been fixed before.\n\nIt's only an improvement, but also a major showstopper for me."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/6",
                "name": "N\/A"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3684\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "zf-crteam-padraic",
                "zf-crteam-priority"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                "name": "padraic",
                "displayName": "P\u00e1draic Brady",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-3216",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3216",
                    "type": {
                        "name": "Related",
                        "direction": "OUTBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13421",
                    "filename": "ZF-3684.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2010-11-05T00:02:01.000+0000",
                    "size": 1135,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13421\/ZF-3684.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10181",
                    "id": 10181,
                    "description": "Mini Release",
                    "name": " 1.5.2",
                    "userReleaseDate": "15\/May\/08",
                    "archived": true,
                    "releaseDate": "2008-05-15",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10012",
                    "id": 10012,
                    "name": "Zend_Db",
                    "description": "interfaces, APIs, and adapters for various third-party data stores",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25800",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "body": "Just adding the relation.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "created": "2008-11-06T21:19:14.000+0000",
                    "updated": "2008-11-06T21:19:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/42094",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "body": "Hey Ralph,\r\n\r\ncan you comment what the hold up is?\r\n\r\nI'd love to help if I know how. Otherwise the fix seems trivial, e.g.:\r\n\r\n{code}\r\nconst ERR_ALREADY_EXISTS  = \"ZDx00\";\r\nconst ERR_CANT_MAP        = \"ZDx01\";\r\nconst ERR_CONSTRAINT      = \"ZDx02\";\r\nconst ERR_DISCONNECTED    = \"ZDx03\";\r\nconst ERR_MISMATCH        = \"ZDx04\";\r\nconst ERR_NO_PERM         = \"ZDx05\";\r\nconst ERR_NOT_FOUND       = \"ZDx06\";\r\nconst ERR_NOT_IMPLEMENTED = \"ZDx07\";\r\nconst ERR_SYNTAX          = \"ZDx08\";\r\nconst ERR_TRUNCATED       = \"ZDx09\";\r\n{code}\r\n\r\nThanks!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "created": "2010-08-24T15:54:36.000+0000",
                    "updated": "2010-08-24T15:54:36.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/42835",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "body": "The constants are null because it seems they were generated from the constants defined by the PHP PDO extension in source file php-src\/ext\/pdo\/pdo_dbh.c.  The constants were not defined as enums like the other PDO constants so their values were all set to null when defined at the PHP level.\r\n\r\nSince they're all NULL, and I don't see them being referenced anywhere in the C source except for where they are defined (as null), these can probably be safely removed from Zend_Db.  They appear to serve no purpose since it doesn't appear that PDO is using these constants, and if it were, you couldn't differentiate between them anyway since they are all NULL.  Comments?\r\n\r\nPatch is attached.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2010-11-05T00:02:03.000+0000",
                    "updated": "2010-11-05T00:02:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43159",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "body": "Patch applied to trunk in r23404, merged to 1.11 release branch in r23405",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2010-11-19T11:49:07.000+0000",
                    "updated": "2010-11-19T11:49:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43198",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "body": "Thanks, Marc! Appreciate it!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "created": "2010-11-20T08:59:18.000+0000",
                    "updated": "2010-11-20T08:59:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47988",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "body": "Hi,\r\n\r\nthe ERR constants are gone?\r\n\r\n{noformat}\r\nfgrep -r 'const ERR_' trunk\/library\/Zend\/*\r\ntrunk\/library\/Zend\/Captcha\/ReCaptcha.php:    const ERR_CAPTCHA   = 'errCaptcha';\r\ntrunk\/library\/Zend\/Captcha\/.svn\/text-base\/ReCaptcha.php.svn-base:    const ERR_CAPTCHA   = 'errCaptcha';\r\ntrunk\/library\/Zend\/Db.php:    const ERR_NONE = '00000';\r\ntill@till-laptop:~\/workspaces\/imagineeasy_v5$ \r\n{noformat}\r\n\r\nIsn't that a BC break?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "created": "2011-08-17T20:52:06.000+0000",
                    "updated": "2011-08-17T20:52:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47990",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "body": "Till, is there a real use case where you find this has caused an actual BC break?\r\n\r\nPer my earlier comments - they're all defined as NULL, just like in the underlying PDO driver.  Therefore these constants cannot be used to differentiate between error conditions... they appear to serve no purpose at all either at the PDO driver level or at the Zend_Db level.  I can't see how anyone is actually using these where their removal would cause a BC break.\r\n\r\nThis patch went in a number of versions ago and no one has raised any issues about this.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2011-08-17T21:48:34.000+0000",
                    "updated": "2011-08-17T21:48:34.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48037",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "body": "Hey Marc,\r\n\r\nfor some some reason, I don't see the constants at all though? They are not defined -- not even null.\r\n\r\nThat's my issue. I used them in my code, and now it fatals because the error constant is not there anymore.\r\n\r\nMy real use-case for 'values' of these constants was originally that parsing an error message is not very feasible. If I wanted to use PDO, I'd use it, but I use Zend_Db instead (and MySQLi). How do I tell errors apart? But using strstr, strpos or substr on the exception's message?\r\n\r\nDoes that make sense?\r\n\r\nTill",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "created": "2011-08-21T21:59:20.000+0000",
                    "updated": "2011-08-21T21:59:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48038",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "body": "I also mis-understood your original comment -- even if they are null, you cannot just remove them.\r\n\r\nThat's a clear BC break. Cause now they are not there and code like this will fatal:\r\n\r\n{code}\r\nif (Zend_Db::ERR_ALREADY_EXISTS) {\r\n\r\n}\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "created": "2011-08-21T22:00:57.000+0000",
                    "updated": "2011-08-21T22:00:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48046",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "body": "Hi Till, if you were using the removed ERR_ constants, your code was already (silently) failing or otherwise broken because these constants are all defined with the same value.\r\n\r\nYes, removing causes a BC break but it also fixes a 'bug' as these constants are NOT able to be used to differentiate error conditions and it is clearly misleading.\r\n\r\nThe ideal solution would be to assign values to these constants in Zend\/Db.php as per the original bug description, however this won't work because of the underlying PDO extension defining these as NULL.  Removing the constants alerts you to the fact that these constants should not be used as they won't behave as you expect.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mjh_ca",
                        "name": "mjh_ca",
                        "displayName": "Marc Hodgins",
                        "active": true
                    },
                    "created": "2011-08-23T00:33:04.000+0000",
                    "updated": "2011-08-23T00:33:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48047",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "body": "Doesn't matter, it's a BC break. ZF doesn't do them in minor release for this just this reason: you break working code.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=till",
                        "name": "till",
                        "displayName": "Till Klampaeckel",
                        "active": true
                    },
                    "created": "2011-08-24T10:24:28.000+0000",
                    "updated": "2011-08-24T10:24:28.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48252",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "Reverted removal of constants. BC breaks are not allowed in ZF1 unless for a critical or security issue where approval is agreed in advance with Zend.\n\nI am additionally marking the issue as Won't Fix as the constants, while NULL, are nonetheless accurate for PDO as weird as it seems. Use at your own risk ;).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2011-08-28T10:14:23.000+0000",
                    "updated": "2011-08-28T10:14:23.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3684\/transitions"
}