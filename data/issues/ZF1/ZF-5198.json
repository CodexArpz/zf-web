{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5198",
    "key": "ZF-5198",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Date::WEEKDAY_NARROW destroys multibyte-characters"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5198\/votes",
                "votes": 2,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-12-11T12:05:59.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=_david",
                "name": "_david",
                "displayName": "David Aurelio",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-12-10T06:31:21.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-12-11T12:05:58.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend_Date::get() uses substr() to return dates formatted as Zend_Date::WEEKDAY_NARROW, which obviously doesn't work with multibyte charsets (as long it has not been overloaded with mb_substr).\n\nThis shortening method may also distort the meaning of the output for ideographic writing systems (not sure about that, but according to google translate \"\u661f\u671f\u4e09\" means \"wednesday\" while \"\u661f\" means \"star\").\n\nEDIT:\n====\nSorry for editing, but I could not find a possibility to add a comment.\n\nMaybe I should have opened two bugs ...\nWhile it is debatable whether the user of a framework or the framework itself should provide the functionality to distinguish between ideographic and alphabetic languages, it seems pretty clear to me that\n\n{{<?php}}\n{{$date = new Zend_Date('2008-12-10');}}\n{{echo $date->get(Zend_Date::WEEKDAY_NARROW, 'pl');}}\n\nis not supposed to output \"\ufffd\".\nThis issue is due to the usage of substr() on an UTF-8-string, as I had already pointed out. It has also been the main reason for opening this bug. I really can't understand the reason for setting the resolution of this bug to \"Won't Fix\".\n\nEDIT 2:\n======\nOnce again, sorry for editing. Is there a way to comment?\n\nThe title of this Issue is \"Zend_Date::WEEKDAY_NARROW destroys multibyte-characters\". This has nothing to do with the second problem mentioned in my description, which is arguable and a \"Won't Fix\" for that is acceptable.\n\nPlease read the first paragraph of my issue report once again. No mentioning of chinese. But mentioning multibyte characters. This is clearly a bug. No need for excuses.\n\nEDIT 3:\n======\nI'm sorry I have to say this, but I get the impression that you're either too haughty to admit there is a problem with the (your?) implementation or you really have no clue about multibyte encodings. You've been pointed to the exact location by Martin. If the use of mb_* functions breaks your code, just use iconv_substr instead. But I'm sure you \u2012 as a professional programmer \u2012 already knew about that. I will open a new bug without mentioning the minor issue concerning ideographic writing systems. Maybe the point will be clearer to you, then."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5198\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10270",
                    "id": 10270,
                    "description": "Mini Release",
                    "name": "1.7.1",
                    "userReleaseDate": "01\/Dec\/08",
                    "archived": false,
                    "releaseDate": "2008-12-01",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10072",
                    "id": 10072,
                    "name": "Zend_Date",
                    "description": "Zend_Date is the basic library for the handling of all date, time and calendar-related issues.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27191",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "According to manual:\n\n\"Weekday (Name of the day, localized, abbreviated, only the first digit)\"\n\"F for Friday\"\n\nSo this can not work for multicharacter languages when the meaning of one character is different than using the whole weekdayname.\n\nThe solution is not to use this constant with multichar languages like chinese, korean or japanese when they can not be used this way.\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-12-10T08:25:09.000+0000",
                    "updated": "2008-12-10T08:25:09.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27192",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Your issue was about chinese producing a false output for weekdays.\n\nAs I said, when a abbreviation of a day has a different meaning in a language you can not use abbreviated days when you are working with such a language.\n\nThere is no way to differ for the framework what you want. All data which is provided by Zend_Date are originally from a Unicode database. There is no way for us to check all translations and all strings of this database if they are consistent or not.\n\nTherefor I said: When you are using multicharacter languages, where the abbreviated string has a different meaning than the complete word, you can not use the abbreviation constants.\n\nThis is something the user has to be aware and not ZF.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-12-10T09:35:38.000+0000",
                    "updated": "2008-12-10T09:35:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27194",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mhujer",
                        "name": "mhujer",
                        "displayName": "Martin Hujer",
                        "active": true
                    },
                    "body": "It does not work also for Czech.\n\n{code}$date = new Zend_Date('2008-12-11');\nvar_dump($date->get(Zend_Date::WEEKDAY_NARROW, 'cs'));{code}\n\nI think, most of the Czech ZF users will be waiting for: '\u010d' and if they get '\ufffd' they won't be very happy.\n\nFix can be done somehow like: in Zend\/Date.php:839 change  return substr($day, 0, 1); to return mb_substr($day, 0, 1, 'utf-8');\nBut it should be more sophisticated and allow setting of the encoding.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mhujer",
                        "name": "mhujer",
                        "displayName": "Martin Hujer",
                        "active": true
                    },
                    "created": "2008-12-10T09:53:14.000+0000",
                    "updated": "2008-12-10T09:53:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27196",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "*) I may be blind but these \"\u661f\u671f\u4e09\"  are definitly chinese hant or pigdin characters.\n\n*) Please do not throw together multiple issues in one... this is really bad behaviour and complicates search, reply and fixing. Thank you.\n\n*) Actually it is not possible to add mb_* functions to Zend_Date as it is based in iconv_* and not mb_*. This dependency would break things elsewhere in Zend_Date. Czech characters are no multibyte so the issue is not the same.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-12-10T10:45:46.000+0000",
                    "updated": "2008-12-10T10:45:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27201",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "body": "David,\n\nFirst of all, let me please start by saying that constantly editing your first post is very irritating, especially if you keep doing so after you were asked to stop it. If you really can't find it, look harder, or click this link: http:\/\/framework.zend.com\/issues\/secure\/AddComment!default.jspa?id=16822\n\nSecondly, the problem with the thing you're trying to address is that your solution would break BC, and that a lot of people currently do not have the mb_ functions installed and\/or enabled. Instead of Thomas not knowing about multibyte encodings, and maybe seems to ignore you, it sounds like you are not realizing on how a framework is developed, and what kind of aspects are to be taken into account. Of course you can disagree with decisions made by a component lead. If you do, I'd like to invite you to IRC ( irc:\/\/irc.freenode.org\/zftalk.dev ) or the ZF-contributors mailinglist.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "created": "2008-12-10T14:04:08.000+0000",
                    "updated": "2008-12-10T14:04:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27235",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Multichar languages are not supported by unicode",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-12-11T12:05:57.000+0000",
                    "updated": "2008-12-11T12:05:57.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5198\/transitions"
}