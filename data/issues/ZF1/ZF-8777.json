{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8777",
    "key": "ZF-8777",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "zend translate : avaibility test for locale instance"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8777\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10360",
                    "id": 10360,
                    "description": "Minor Release",
                    "name": "1.10.0",
                    "userReleaseDate": "27\/Jan\/10",
                    "archived": false,
                    "releaseDate": "2010-01-27",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-01-11T23:30:00.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=samuel",
                "name": "samuel",
                "displayName": "samuel",
                "active": false
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-01-11T07:53:52.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-01-11T23:30:00.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "when we test the avaibility of a Zend_Locale instance, the test is done on zend_locale ::to_string instead of zend_locale::getlanguage"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8777\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10330",
                    "id": 10330,
                    "description": "Mini Release",
                    "name": "1.8.2",
                    "userReleaseDate": "27\/May\/09",
                    "archived": false,
                    "releaseDate": "2009-05-27",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10099",
                    "id": 10099,
                    "name": "Zend_Translate",
                    "description": "Provides translation functionality, based on standards such as TMX and Gettext.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37566",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "And what's the problem with this way?\r\ngetLanguage() does only return the language and not the locale.\r\n\r\nZend_Translate on the other side allows also to do regionbased translations.... wordings from one region are not always equal to another region using the same language. Using getLanguage() would not work in such a case.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-01-11T10:19:25.000+0000",
                    "updated": "2010-01-11T10:19:25.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37568",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Please give us a reproducable usecase which shows what exactly your problem is",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-01-11T11:24:30.000+0000",
                    "updated": "2010-01-11T11:24:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37572",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=samuel",
                        "name": "samuel",
                        "displayName": "samuel",
                        "active": false
                    },
                    "body": "In the application I initialize Zend_translate with the 'en' string as locale then I test if the Zend_Locale('auto') is available.\r\n\r\nif(Zend_Translate::isAvailable(Zend_Locale('auto')){\r\nZend_Translate::setLocale(Zend_Locale('auto));\r\n}\r\n\r\nIf in the http header the value of Accept Language is something like fr_FR, Zend_Translate::isAvailable returns false while for fr it returns true. In fact Zend_Tranlate works fine in the two cases, if the locale isn't translatable it search translation for the regional part of the locale, so it seems logical that isAvailable returns true for all case where Zend_Translate is working fine.\r\n\r\np.s. : I know that I have a very uggly english so if you want some clarifications please let me know.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=samuel",
                        "name": "samuel",
                        "displayName": "samuel",
                        "active": false
                    },
                    "created": "2010-01-11T13:11:18.000+0000",
                    "updated": "2010-01-11T13:11:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37574",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Sorry, but I don't get the point...\r\n\r\n\"auto\" is ALWAYS available... when your user does not provide one, your systems locale will be used as \"auto\"-value.\r\n\r\nSomething like isAvailable('auto') is useless and will not work in such a situation (in my eyes) as \"auto\" is no locale at all. You can use it at initiation, but not when you request a locale.\r\n\r\nisAvailable() returns true when you have translations for fr, your user sets fr_FR and you allow degradation.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-01-11T13:25:16.000+0000",
                    "updated": "2010-01-11T13:25:16.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37575",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Another note:\r\nRelease 1.8 is no longer supported except for security problems.\r\n\r\nIt could be that your problem is already fixed within the actual release or the new upcoming release 1.10.\r\n\r\nYou should test one of these to see it that is the case.\r\nAnd you should beware to use the actual online manual for the release you are using. Actual release is 1.9.7. It adds some features which are not available within your release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-01-11T13:48:51.000+0000",
                    "updated": "2010-01-11T13:48:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37582",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=samuel",
                        "name": "samuel",
                        "displayName": "samuel",
                        "active": false
                    },
                    "body": "I explain from the beginning.\r\nMy browser send http request like with \"Accept-Language\tfr-fr,fr;q=0.8,en-us;q=0.5,en;q=0.3\"\r\nIf I in my application I have :\r\nZend_Translate(Zend_Locale('auto'));\r\nThe Zend_Translate uses my french translation file ( fr.mo ), it search fr_FR.po then fr.po\r\n\r\nSo I think Zend_Translate(Zend_locale('fr_FR')) would return true to have the approach in isAvailable and in setLocale methods.\r\nisAvailable would be more like that : \r\n    public function isAvailable($locale)\r\n    {\r\n        $return = isset($this->_translate[(string) $locale]);\r\n        if(!$return){\r\n            $temp = explode('_',$locale);\r\n            $return = isset($this->_translate[(string) $temp[0]);\r\n        }\r\n        return $return;\r\n    }\r\n\r\np.s. : I just download the 1.9.7 release the issue exists ever\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=samuel",
                        "name": "samuel",
                        "displayName": "samuel",
                        "active": false
                    },
                    "created": "2010-01-11T15:36:30.000+0000",
                    "updated": "2010-01-11T15:36:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37595",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "As described before isAvailable() returns only SET translations.\r\n\r\nAnd as also described before Zend_Translate itself must allow to return regional translations.\r\n\r\nThis means in detail that you could have:\r\nde => \"Auto\"\r\nde_AT => \"Karre\"\r\nde_DE => \"Automobil\"\r\nde_CH => \"Vehikel\"\r\n\r\nSo far so good. What ever language your user requests he get's his dialect.\r\n\r\nRelated to isAvailable returning ONLY language and not region is\r\n* errorous and\r\n* problematic\r\n\r\nThink of a translation which provides only\r\nde_AT => \"Karre\"\r\nde_DE => \"Automobil\"\r\n\r\nThe user requests \"de\"... and your change would force isAvailable to return true... but there is no translation at all. So this approach would not work.\r\n\r\nThis is the reason why, as described before, you must give the proper locale... when you are not able to do so (because you are working with uncommon locale abbreviations) simply use Zend_Locale to get the correct locale.\r\n\r\nThis means:\r\n$locale = new Zend_Locale($mystring);\r\n\r\nisAvailable() itself supports also to use a locale instance.\r\n\r\nFor your case this means:\r\n* There is no official locale \"auto\", therefor null is returned when requested\r\n* The Zend_Locale-internal locale \"auto\" is converted by Zend_Locale to the wished locale\r\n\r\nRelated to your issue using \"getLanguage\" instead of \"toString\" this does mean: \"No... this is not a bug, but wished and expected behaviour\"\r\n\r\nRelated to your other request that isAvailable() should return true on \"fr_FR\" by using \"fr\" is available also a NO.\r\n\r\nWhen there is no fallback it would return NO as described before even if I would expect YES.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-01-11T23:29:02.000+0000",
                    "updated": "2010-01-11T23:29:02.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37596",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Closing as won't fix.\r\n\r\nDisallowing regional translation will not be done.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-01-11T23:30:00.000+0000",
                    "updated": "2010-01-11T23:30:00.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8777\/transitions"
}