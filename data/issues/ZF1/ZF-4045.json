{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4045",
    "key": "ZF-4045",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Form_Element_Captcha validation always return \"Empty captcha value\""
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4045\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/5",
                "name": "Cannot Reproduce"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10240",
                    "id": 10240,
                    "description": "Minor Release",
                    "name": "1.6.0",
                    "userReleaseDate": "02\/Sep\/08",
                    "archived": false,
                    "releaseDate": "2008-09-02",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-08-24T15:41:27.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=hedonism",
                "name": "hedonism",
                "displayName": "Hristo Angelov",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-08-23T11:40:36.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-07-02T04:00:14.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "The code:\n\n{code}\n$captchaImage = new Zend_Captcha_Image();\n$captchaImage->setFont(Standart_Main::getDirs('fonts', 'arial.ttf'));\n$captchaImage->setFontSize(30);\n$captchaImage->setWordlen(6);\n$captchaImage->setImgDir(Standart_Main::getDirs('wwwStatic', array('images', 'captcha')));\n$captchaImage->setImgUrl(Zend_Registry::get('config')->host->static.'\/images\/captcha\/');\n$captchaImage->setWidth(175);\n$captchaImage->setHeight(75);\n$captchaImage->setName('captcha');\n        \n$elementCaptcha = new Zend_Form_Element_Captcha(\n'captcha', array('captcha' => $captchaImage)\n);\n{code}\n\nIn isValid method i add some dumps:\n\n{code}\nZend_Debug::dump($name, 'Name');\nZend_Debug::dump($value, 'Value');\nZend_Debug::dump($context, 'Context');\nZend_Debug::dump($_SESSION, 'Session');\nZend_Debug::dump($this->getWord(), 'Word');\n{code}\n\nThe result:\n\n{quote}\nName string(7) \"captcha\"\n\nValue NULL\n\nContext array(8) {\n  [\"user_id\"] => string(0) \"\"\n  [\"language_id\"] => string(1) \"1\"\n  [\"active\"] => string(0) \"\"\n  [\"ads_category_id\"] => string(2) \"37\"\n  [\"ads_type_id\"] => string(1) \"2\"\n  [\"valid_before\"] => string(10) \"2008-08-31\"\n  [\"title\"] => string(5) \"title\"\n  [\"description\"] => string(11) \"description\"\n}\n\nSession array(2) {\n  [\"language\"] => array(2) {\n    [\"key\"] => string(2) \"bg\"\n    [\"id\"] => int(1)\n  }\n  [\"__ZF\"] => array(19) {\n    [\"Zend_Form_Captcha_a2c7e64cdc91d56cfc11127278c964fd\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_48aa2bbc0a9887a161f1632fb726f1a5\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_bd3dc9f1996ea2f03b5b9acd6905b7f0\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_346eb8794280bde2382a7016e209dc6b\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_1ad1e43e983fea4d63ff4c1283c9044c\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_8898a57797db19fea838ca0506a5c80a\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_4c006ea48459e3e31dde851ba507944b\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_16defd32612dbcd742a0f650a95f3259\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_b5e2101afabf3ed67183fbb83e7b4d2e\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_c6b51064309bf4a2bf15801b2e294d60\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_017f39f365669e15c405618616bb390c\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_115c8b7b5e2c0a78e826a6fa2e5071f2\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_cba0ca5d99e57918f83ab76825b5a809\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_ec556f4afd9a1b685c0c9fb4d65169c9\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_ce8483069451988fc44725bf2e8766d0\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_d76c33ffd12bb489d57bee23694177bd\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_00b4977ad4ad7da6dfbc883139679d17\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_58f32c355c8af8df63e5da866f17af49\"] => array(0) {\n    }\n    [\"Zend_Form_Captcha_4881c034e1e97431f0fe2ef0c7aa1f81\"] => array(0) {\n    }\n  }\n}\n\nWord NULL\n{quote}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/customFieldOption\/10037",
                "value": "   Must Have"
            }
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4045\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-3975",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3975",
                    "type": {
                        "name": "Duplicate",
                        "direction": "OUTBOUND",
                        "description": "duplicates"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10050",
                    "id": 10050,
                    "description": "Minor Release Candidate",
                    "name": "1.6.0RC2",
                    "userReleaseDate": "11\/Aug\/08",
                    "archived": true,
                    "releaseDate": "2008-08-11",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10340",
                    "id": 10340,
                    "name": "Zend_Captcha",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23630",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Scheduling for RC3",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-08-23T15:23:38.000+0000",
                    "updated": "2008-08-23T15:23:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23678",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Duplicate of ZF-3975, but provides more context.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-08-24T15:20:46.000+0000",
                    "updated": "2008-08-24T15:20:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23679",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "I cannot reproduce this issue; the value of getWord() always exists when I use it. I have altered your example to the following:\n\n{code}\nclass TestController extends Zend_Controller_Action\n{\n    public function captchaAction()\n    {\n        $captchaImage = new Zend_Captcha_Image();\n        $captchaImage->setFont('\/usr\/share\/fonts\/truetype\/freefont\/FreeSans.ttf');\n        $captchaImage->setFontSize(30);\n        $captchaImage->setWordlen(6);\n        $captchaImage->setImgDir(dirname(__FILE__) . '\/..\/..\/..\/public\/img\/captcha');\n        $captchaImage->setImgUrl('\/img\/captcha\/');\n        $captchaImage->setWidth(175);\n        $captchaImage->setHeight(75);\n        $captchaImage->setName('captcha');\n                \n        $elementCaptcha = new Zend_Form_Element_Captcha(\n            'captcha', array('captcha' => $captchaImage)\n        );\n        $form = new Zend_Form(array(\n            'action' => '\/test\/captcha',\n            'method' => 'post',\n        ));\n        $form->addElement($elementCaptcha, 'captcha')\n            ->addElement('submit', 'process', array(\n                'required' => false,\n                'ignore'   => true,\n                'label'    => 'Process',\n            ));\n\n        $this->view->captcha = $captchaImage;\n\n        $request = $this->getRequest();\n        if (!$request->isPost()) {\n            $this->view->form = $form;\n            return;\n        }\n        if (!$form->isValid($request->getPost())) {\n            $this->view->form = $form;\n            return;\n        }\n    }\n}\n{code}\nThe above works in conjunction with the following view script:\n{code}\n<? if (isset($this->form)): ?>\n<h2>Testing Captcha<\/h2>\n<?= $this->form ?>\n<? else: ?>\n<h2>Captcha Form validated!<\/h2>\n<? endif ?>\n<? if (isset($this->captcha)): ?>\n<h4>Captcha word dump<\/h4>\n<pre><?= var_dump($this->captcha->getWord()) ?><\/pre>\n<? endif ?>\n{code}\nIn all cases, the captcha word is presented, and using that particular captcha word always validates appropriately.\n\nMy inclination is that this is an issue with your local session storage.\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-08-24T15:41:27.000+0000",
                    "updated": "2008-08-24T15:41:27.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23981",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "Updating for the 1.6.0 release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-09-02T10:39:03.000+0000",
                    "updated": "2008-09-02T10:39:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32340",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arondeparon",
                        "name": "arondeparon",
                        "displayName": "Aron Rotteveel",
                        "active": true
                    },
                    "body": "I am having the exact same problem. On each request, two images are generated using the following code:\n\n{code}\n\t\t\t$captchaImage = new Zend_Captcha_Image();\n\t\t\t$captchaImage->setFont(APPLICATION_PATH . '\/..\/data\/fonts\/tahoma.ttf')\n\t\t\t\t->setWordLen(6)\n\t\t\t\t->setHeight(80)\n\t\t\t\t->setTimeout(300)\n\t\t\t\t->setImgDir(APPLICATION_PATH . '\/..\/public\/data\/captcha')\n\t\t\t\t->setImgUrl('\/data\/captcha\/');\n\n\t\t\t$captchaElement = new Zend_Form_Element_Captcha('humanCheck', array('captcha' => $captchaImage));\n\t\t\t$captchaElement->setLabel('Vul a.u.b. de letters in')\n\t\t\t\t->setOrder(2)\n\t\t\t\t->setRequired(true);\n\t\t\t\t\n\t\t\t$this->addElement($captchaElement, 'captcha');\t\t\n\t\t\t$this->_hasCaptcha = true;\n\t\t\t\n\t\t\treturn $captchaImage;\n{\/code}\n\nWhen I call getWord(), the value returned is the first image, not the image shown. This makes validation through normal means impossible.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arondeparon",
                        "name": "arondeparon",
                        "displayName": "Aron Rotteveel",
                        "active": true
                    },
                    "created": "2009-07-02T03:49:47.000+0000",
                    "updated": "2009-07-02T03:49:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32341",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arondeparon",
                        "name": "arondeparon",
                        "displayName": "Aron Rotteveel",
                        "active": true
                    },
                    "body": "Apologies, the error was being caused due to the fact that the captcha generating code was being called both on post as view rendering.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arondeparon",
                        "name": "arondeparon",
                        "displayName": "Aron Rotteveel",
                        "active": true
                    },
                    "created": "2009-07-02T04:00:13.000+0000",
                    "updated": "2009-07-02T04:00:13.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4045\/transitions"
}