{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6905",
    "key": "ZF-6905",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_OpenID need support for OpenId Specification 2.0 final"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6905\/votes",
                "votes": 43,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/7",
                "name": "Needs Proposal"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-02-24T22:41:58.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=buzz",
                "name": "buzz",
                "displayName": "buzz lightgear",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-06-04T13:19:29.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-02-24T22:41:58.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "2_0",
                "final",
                "google",
                "openid",
                "support",
                "yahoo"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "We need the final spec implemented to use openid with yahoo and google accounts!!!\nHere we found a hack for zend, perhaps this is a solution:\nhttp:\/\/stackoverflow.com\/questions\/741345\/how-do-i-implement-direct-identity-based-openid-authentication-with-zend-openid\n\nFrom the link:\nLittle late to the game but I was able to get this working with some hacks I found around the interwebs.\n\nFirst. Yahoo. To get Yahoo working all I had to do was change the JavaScript to use me.yahoo.com instead of just yahoo.com and it worked perfectly with the version of the Zend Framework I'm using. Unfortunately Google still wasn't, so some hacking was in order.\n\nAll of these changes go in Zend\/OpenId\/Consumer.php\n\nFirst, in the _discovery method add the following on the series of preg_match checks that starts at around line 740.\n\n{code}\n} else if (preg_match('\/<URI>([^<]+)<\\\/URI>\/i', $response, $r)) {\n  $version = 2.0;\n  $server = $r[1];\n{code}\n\nI added this right before the return false; statement that's in the else {} block.\n\nSecond, in the _checkId method you'll need to add 3 new blocks (I haven't dug around enough to know what causes each of these three cases to be called, so I covered all to be on the safe side.\n\nInside the $version <= 2.0 block, you'll find an if\/else if\/else block. In the first if statement ($this->_session !== null) add this to the end:\n\n{code}\nif ($server == 'https:\/\/www.google.com\/accounts\/o8\/ud') {\n  $this->_session->identity = 'http:\/\/specs.openid.net\/auth\/2.0\/identifier_select';\n  $this->_session->claimed_id = 'http:\/\/specs.openid.net\/auth\/2.0\/identifier_select';\n}\n{code}\n\nIn the else if (defined('SID') block add this to the end:\n\n{code}\nif ($server == 'https:\/\/www.google.com\/accounts\/o8\/ud') {\n  $_SESSION['zend_openid']['identity'] = 'http:\/\/specs.openid.net\/auth\/2.0\/identifier_select';\n  $_SESSION['zend_openid']['claimed_id'] = 'http:\/\/specs.openid.net\/auth\/2.0\/identifier_select';\n}\n{code}\n\nAnd then after the else block (so outside the if\/else if\/else block all together, but still inside the $version <= 2.0 block) add this:\n\n{code}\nif ($server == 'https:\/\/www.google.com\/accounts\/o8\/ud') {\n  $params['openid.identity'] = 'http:\/\/specs.openid.net\/auth\/2.0\/identifier_select';\n  $params['openid.claimed_id'] = 'http:\/\/specs.openid.net\/auth\/2.0\/identifier_select';\n}\n{code}\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6905\/watchers",
                "isWatching": false,
                "watchCount": 33
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                "name": "adamlundrigan",
                "displayName": "Adam Lundrigan",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-5242",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5242",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                },
                {
                    "issueKey": "ZF-8294",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-8294",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                },
                {
                    "issueKey": "ZF-3187",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3187",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13240",
                    "filename": "Consumer.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eekhoorn13",
                        "name": "eekhoorn13",
                        "displayName": "Niek Bosch",
                        "active": true
                    },
                    "created": "2010-08-11T09:26:44.000+0000",
                    "size": 42253,
                    "mimeType": "application\/x-suggestions+json",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13240\/Consumer.php"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10330",
                    "id": 10330,
                    "description": "Mini Release",
                    "name": "1.8.2",
                    "userReleaseDate": "27\/May\/09",
                    "archived": false,
                    "releaseDate": "2009-05-27",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10210",
                    "id": 10210,
                    "name": "Zend_OpenId",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32240",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=aartiles",
                        "name": "aartiles",
                        "displayName": "Alfredo Artiles",
                        "active": true
                    },
                    "body": "I have tried this patch and didn't work for me. I am using 1.8.4. I hope to see a solution to authenticate with google and yahoo soon",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=aartiles",
                        "name": "aartiles",
                        "displayName": "Alfredo Artiles",
                        "active": true
                    },
                    "created": "2009-06-28T05:18:23.000+0000",
                    "updated": "2009-06-28T05:18:23.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32764",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chris.bisnett",
                        "name": "chris.bisnett",
                        "displayName": "Chris",
                        "active": true
                    },
                    "body": "I have found this patch to work for version 1.8.4p1.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chris.bisnett",
                        "name": "chris.bisnett",
                        "displayName": "Chris",
                        "active": true
                    },
                    "created": "2009-07-20T15:51:47.000+0000",
                    "updated": "2009-07-20T15:51:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/33173",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "body": "add code tag",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "created": "2009-08-03T19:18:38.000+0000",
                    "updated": "2009-08-03T19:18:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34863",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=urn",
                        "name": "urn",
                        "displayName": "Igor",
                        "active": true
                    },
                    "body": "Thanks for the hack.\nWe definately need official support of 2.0 version of OpenId.\nWhen will it be..?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=urn",
                        "name": "urn",
                        "displayName": "Igor",
                        "active": true
                    },
                    "created": "2009-09-24T04:00:17.000+0000",
                    "updated": "2009-09-24T04:00:17.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41949",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eekhoorn13",
                        "name": "eekhoorn13",
                        "displayName": "Niek Bosch",
                        "active": true
                    },
                    "body": "I've done this for my own website. It's probably not conform all Zend Framework standards and it lacks unit testing and all that. Nevertheless, it will probably help you a great deal. When I'm more at home in this contributing thing, I'll do more work myself. For now it supports:\r\n\r\n* XRI (not tested in this version)\r\n* Yadis discovery\r\n* XRDS document parsing (as is needed for XRI and Yadis)\r\n* HTML discovery (not changed)\r\n\r\nIt works with google and with myopenid.com",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=eekhoorn13",
                        "name": "eekhoorn13",
                        "displayName": "Niek Bosch",
                        "active": true
                    },
                    "created": "2010-08-11T09:26:48.000+0000",
                    "updated": "2010-11-16T02:35:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41950",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=torio",
                        "name": "torio",
                        "displayName": "Torio Farazdagi",
                        "active": true
                    },
                    "body": "Thanks Niek! Will look into the supplied code and accommodate for ZF standards + UTs.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=torio",
                        "name": "torio",
                        "displayName": "Torio Farazdagi",
                        "active": true
                    },
                    "created": "2010-08-11T10:17:31.000+0000",
                    "updated": "2010-08-11T10:17:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41984",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cloakedninjas",
                        "name": "cloakedninjas",
                        "displayName": "DJ",
                        "active": true
                    },
                    "body": "While the attached script does allow for authentication with Google, Yahoo - or any other v2.0 provider still won't.\r\n\r\n\r\nI've had to ditch ZF in favour of a complete working solution. I'm now using an implementatation from Janrain : http:\/\/www.janrain.com\/openid-enabled",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=cloakedninjas",
                        "name": "cloakedninjas",
                        "displayName": "DJ",
                        "active": true
                    },
                    "created": "2010-08-16T04:22:20.000+0000",
                    "updated": "2010-08-16T04:22:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47584",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=carlos.vini",
                        "name": "carlos.vini",
                        "displayName": "Carlos Rodrigues",
                        "active": true
                    },
                    "body": "The changes suggested worked for me. But there is a problem when you use a Google Apps domain as the identifier, like this: \r\n*https:\/\/www.google.com\/accounts\/o8\/site-xrds?hd=example.com\r\n\r\nThe login() method works fine, but in this case the verify() method is unable to discover the data because Google sends back the identity in a format similar to this:\r\n* http:\/\/example.com\/openid\/123456789 \r\n\r\nI don't know if its a Google problem, or a Zend problem. But i had to comment the lines below to ignore the discovery on verify().\r\n\r\n \/*\r\n\t\t\t\t\t} else if (!$this->_discovery($id, $discovered_server, $discovered_version)) {\r\n                        $this->_setError(\"Discovery failed: \" . $this->getError());\r\n                        return false;\r\n                    \r\n                    } else if ((!empty($params['openid_identity']) &&\r\n                                $params[\"openid_identity\"] != $id) ||\r\n                               (!empty($params['openid_op_endpoint']) &&\r\n                                $params['openid_op_endpoint'] != $discovered_server) ||\r\n                               $discovered_version != $version) {\r\n                        $this->_setError(\"Discovery information verification failed\");\r\n                        return false;\r\n\t\t\t\t\t*\/ \r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=carlos.vini",
                        "name": "carlos.vini",
                        "displayName": "Carlos Rodrigues",
                        "active": true
                    },
                    "created": "2011-07-21T20:12:11.000+0000",
                    "updated": "2011-07-21T20:12:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49764",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Closing as \"Needs Proposal\". If someone wants to step up and implement this for v1.12 please draft an RFC.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-02-24T22:41:58.000+0000",
                    "updated": "2012-02-24T22:41:58.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6905\/transitions"
}