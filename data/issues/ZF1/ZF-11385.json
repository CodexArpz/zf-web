{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11385",
    "key": "ZF-11385",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Json doesn't seem to count recursion correctly"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11385\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10680",
                    "id": 10680,
                    "description": "Mini Release",
                    "name": "1.11.7",
                    "userReleaseDate": "02\/Jun\/11",
                    "archived": false,
                    "releaseDate": "2011-06-02",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-08-26T21:26:03.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ehaber",
                "name": "ehaber",
                "displayName": "Edward Haber",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-05-17T22:32:51.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-08-26T23:37:47.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "Zend_Json",
                "json",
                "recursion"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "The following XML fragment has a nested depth of 6. It however throws a maxRecursion error ($maxRecursionDepthAllowed is set to 25). If I remove any one of the nodes below, it translates perfectly. So it is counting across nodes as well.\r\n\r\n{code}\r\n$body = <<<EOF\r\n<response>\r\n\t<status>success<\/status>\r\n\t<description>200 OK<\/description>\r\n\t<message_type>\r\n\t\t<system_name>A<\/system_name>\r\n\t\t<shortname>B<\/shortname>\r\n\t\t<long_name>C<\/long_name>\r\n\t\t<as_verb>D<\/as_verb>\r\n\t\t<as_noun>E<\/as_noun>\r\n\t\t<challenge_phrase>F<\/challenge_phrase>\r\n\t\t<recipient_details>G<\/recipient_details>\r\n\t\t<sender_details>H<\/sender_details>\r\n\t\t<example_text>A<\/example_text>\r\n\t\t<short_description>B<\/short_description>\r\n\t\t<long_description>C<\/long_description>\r\n\t\t<version>D<\/version>\r\n\t\t<developer>E<\/developer>\r\n\t\t<config_instructions>A<\/config_instructions>\r\n\t\t<config_fragment>B<\/config_fragment>\r\n\t\t<icon_small>C<\/icon_small>\r\n\t\t<icon_medium>D<\/icon_medium>\r\n\t\t<icon_large>E<\/icon_large>\r\n\t\t<defaults>\r\n\t\t\t<close_rules>\r\n\t\t\t\t<after_responses>A<\/after_responses>\r\n\t\t\t<\/close_rules>\r\n\t\t\t<recipient_visibility>B<\/recipient_visibility>\r\n\t\t\t<recipient_invite>C<\/recipient_invite>\r\n\t\t\t<results_visibility>A<\/results_visibility>\r\n\t\t\t<response_visibility>B<\/response_visibility>\r\n\t\t\t<recipient_resubmit>C<\/recipient_resubmit>\r\n\t\t\t<feed_status>D<\/feed_status>\r\n\t\t<\/defaults>\r\n\t<\/message_type>\r\n\t<execution_time>0.0790269374847<\/execution_time>\t\r\n<\/response>\r\nEOF;\r\n\r\nheader('Content-type', 'text\/json');\r\necho Zend_Json::fromXml($body, true);\r\n{code}\r\n\r\nIf I add these lines in _processXml to see what's going on:\r\n{code}\r\nZend_Debug::dump($recursionDepth);\r\nZend_Debug::dump($simpleXmlElementObject);\r\n{code}\r\n... I find that it is counting every node laterally rather than by depth.\r\n\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11385\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "zf-crteam-padraic",
                "zf-crteam-priority"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                "name": "adamlundrigan",
                "displayName": "Adam Lundrigan",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-3257",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3257",
                    "type": {
                        "name": "Duplicate",
                        "direction": "OUTBOUND",
                        "description": "duplicates"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10580",
                    "id": 10580,
                    "description": "Mini Release",
                    "name": "1.11.6",
                    "userReleaseDate": "05\/May\/11",
                    "archived": false,
                    "releaseDate": "2011-05-05",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10016",
                    "id": 10016,
                    "name": "Zend_Json",
                    "description": "serializes native PHP to JSON and decodes JSON to native PHP",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48222",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "I was able to reproduce your issue against SVN tag release-1.11.6 using the XML you provided, but not against trunk.  It appears that this issue was eliminated in 1.11.7 with the fix for ZF-3257 (fromXml functionality was rewritten).\r\n\r\nHere are my tests, both of which pass:\r\n{code}\r\nIndex: tests\/Zend\/Json\/JsonXMLTest.php\r\n===================================================================\r\n--- tests\/Zend\/Json\/JsonXMLTest.php     (revision 24405)\r\n+++ tests\/Zend\/Json\/JsonXMLTest.php     (working copy)\r\n@@ -586,6 +586,74 @@\r\n\r\n     }\r\n\r\n+    \/**\r\n+     * @group ZF-11385\r\n+     * @expectedException Zend_Json_Exception\r\n+     * @dataProvider providerNestingDepthIsHandledProperly\r\n+     *\/\r\n+    public function testNestingDepthIsHandledProperlyWhenNestingDepthExceedsMaximum($xmlStringContents)\r\n+    {\r\n+        Zend_Json::$maxRecursionDepthAllowed = 1;\r\n+        Zend_Json::fromXml($xmlStringContents, true);\r\n+    }\r\n+\r\n+    \/**\r\n+     * @group ZF-11385\r\n+     * @dataProvider providerNestingDepthIsHandledProperly\r\n+     *\/\r\n+    public function testNestingDepthIsHandledProperlyWhenNestingDepthDoesNotExceedMaximum($xmlStringContents)\r\n+    {\r\n+        Zend_Json::$maxRecursionDepthAllowed = 25;\r\n+        Zend_Json::fromXml($xmlStringContents, true);\r\n+    }\r\n+\r\n+    \/**\r\n+     * XML document provider for ZF-11385 tests\r\n+     * @return array\r\n+     *\/\r\n+    public static function providerNestingDepthIsHandledProperly()\r\n+    {\r\n+        $xmlStringContents = <<<EOT\r\n+<response>\r\n+       <status>success<\/status>\r\n+       <description>200 OK<\/description>\r\n+       <message_type>\r\n+               <system_name>A<\/system_name>\r\n+               <shortname>B<\/shortname>\r\n+               <long_name>C<\/long_name>\r\n+               <as_verb>D<\/as_verb>\r\n+               <as_noun>E<\/as_noun>\r\n+               <challenge_phrase>F<\/challenge_phrase>\r\n+               <recipient_details>G<\/recipient_details>\r\n+               <sender_details>H<\/sender_details>\r\n+               <example_text>A<\/example_text>\r\n+               <short_description>B<\/short_description>\r\n+               <long_description>C<\/long_description>\r\n+               <version>D<\/version>\r\n+               <developer>E<\/developer>\r\n+               <config_instructions>A<\/config_instructions>\r\n+               <config_fragment>B<\/config_fragment>\r\n+               <icon_small>C<\/icon_small>\r\n+               <icon_medium>D<\/icon_medium>\r\n+               <icon_large>E<\/icon_large>\r\n+               <defaults>\r\n+                       <close_rules>\r\n+                               <after_responses>A<\/after_responses>\r\n+                       <\/close_rules>\r\n+                       <recipient_visibility>B<\/recipient_visibility>\r\n+                       <recipient_invite>C<\/recipient_invite>\r\n+                       <results_visibility>A<\/results_visibility>\r\n+                       <response_visibility>B<\/response_visibility>\r\n+                       <recipient_resubmit>C<\/recipient_resubmit>\r\n+                       <feed_status>D<\/feed_status>\r\n+               <\/defaults>\r\n+       <\/message_type>\r\n+       <execution_time>0.0790269374847<\/execution_time>\r\n+<\/response>\r\n+EOT;\r\n+        return array(array($xmlStringContents));\r\n+    }\r\n+\r\n } \/\/ End of class Zend_Json_JsonXMLTest\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2011-08-26T21:25:43.000+0000",
                    "updated": "2011-08-26T23:18:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48223",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Committed tests in r24406\r\nMerged to release-1.11 in r24407",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2011-08-26T21:55:32.000+0000",
                    "updated": "2011-08-26T21:55:32.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48225",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Just realized that when I slimmed-down the XML, it kinda defeated the purpose of the tests.  I've made it right. \r\nMerged updated tests to trunk in r24409 and release-1.11 in r24410",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2011-08-26T23:17:55.000+0000",
                    "updated": "2011-08-26T23:17:55.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48226",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Issued ZF2 pull request [PR-356|https:\/\/github.com\/zendframework\/zf2\/pull\/356] to have changes pulled forward",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2011-08-26T23:37:47.000+0000",
                    "updated": "2011-08-26T23:37:47.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11385\/transitions"
}