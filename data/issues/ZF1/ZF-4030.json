{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4030",
    "key": "ZF-4030",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Warning on form validation"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/2",
                "name": "New Feature",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4030\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10260",
                    "id": 10260,
                    "description": "Minor Release",
                    "name": "1.7.0",
                    "userReleaseDate": "17\/Nov\/08",
                    "archived": false,
                    "releaseDate": "2008-11-17",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-11-07T08:14:09.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=norm2782",
                "name": "norm2782",
                "displayName": "Jurrien Stutterheim",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-08-22T01:51:41.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-01-28T15:34:32.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "For each invalid field Zend_Form generates a warning:\n\nWarning: htmlspecialchars() expects parameter 1 to be string, array given in \/Library\/WebServer\/Library\/Zend\/View\/Abstract.php on line 804\n\nI've encountered this with both Select fields and normal Text fields, but other elements might be affected as well. A valid field does not generate this warning. The error messages do appear next to the elements.\n\nSelect code:\n{code}\n$fieldElement1 = new Zend_Form_Element_Select('field1');\n$fieldElement1->setRequired(true)\n              ->setAllowEmpty(false)\n              ->setMultiOptions(array('foo' => 'FOO', 'bar' => 'BAR'));\n{code}\n\nTextfield code:\n{code}\n$queryElement1 = new Zend_Form_Element_Text('query1');\n$queryElement1->setRequired(true)\n              ->setAllowEmpty(false);\n{code}\n\nEdit:\n\nThe call to Zend_View_Abstract's escape() method originates from Zend_View_Helper_FormErrors line 75. A var_dump() on line 74 gives these results:\n\narray\n  'isEmpty' => string 'Value is empty, but a non-empty value is required' (length=49)\n\narray\n  'isEmpty' => string 'Value is empty, but a non-empty value is required' (length=49)\n\narray\n  'field1' => \n    array\n      'isEmpty' => string 'Value is empty, but a non-empty value is required' (length=49)\n  'query1' => \n    array\n      'isEmpty' => string 'Value is empty, but a non-empty value is required' (length=49)\n\nEdit2:\nIt appears it's caused by adding the Errors decorator manually with $this->addDecorator('Errors');"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4030\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-9002",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9002",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10190",
                    "id": 10190,
                    "description": "Minor Release Candidate",
                    "name": "1.6.0RC1",
                    "userReleaseDate": "21\/Jul\/08",
                    "archived": true,
                    "releaseDate": "2008-07-21",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10050",
                    "id": 10050,
                    "description": "Minor Release Candidate",
                    "name": "1.6.0RC2",
                    "userReleaseDate": "11\/Aug\/08",
                    "archived": true,
                    "releaseDate": "2008-08-11",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23632",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "I'm actually unsure exactly what the issue is. I've tried creating the elements  you specify, passing invalid values to isValid(), and rendering, but with no errors. I've even tried specifying adding the Errors decorator manually -- I simply cannot reproduce any sort of warning.\n\nI'm going to mark the issue as \"cannot reproduce\". Feel free to re-open if you can provide the following, succinctly:\n* Reproduce case\n* Expected result (this can even be \"no warnings\")\n* Actual result (this could be \"warnings generated\" -- please make sure you paste in the warnings)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-08-23T20:57:03.000+0000",
                    "updated": "2008-08-23T20:57:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23640",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=norm2782",
                        "name": "norm2782",
                        "displayName": "Jurrien Stutterheim",
                        "active": true
                    },
                    "body": "Both of these code snippets reproduce the bug:\n{code}\nrequire_once 'Zend\/Form.php';\nrequire_once 'Zend\/Form\/Element\/Select.php';\nrequire_once 'Zend\/Form\/Element\/Text.php';\nrequire_once 'Zend\/View.php';\n\nclass FooForm extends Zend_Form\n{\n    public function init()\n    {\n        $fieldElement1 = new Zend_Form_Element_Select('field1');\n        $fieldElement1->setRequired(true)\n                      ->setAllowEmpty(false)\n                      ->setMultiOptions(array('foo' => 'FOO', 'bar' => 'BAR'));\n        \n        $queryElement1 = new Zend_Form_Element_Text('query1');\n        $queryElement1->setRequired(true)\n                      ->setAllowEmpty(false);\n                      \n        $this->addElements(array($fieldElement1, $queryElement1));\n    }\n    \n    public function loadDefaultDecorators()\n    {\n        parent::loadDefaultDecorators();\n        $this->addDecorator('Errors');\n    }\n}\n\n$form = new FooForm();\n$form->isValid(array('field1' => 'baz', 'query1' => ''));\n\necho $form->render(new Zend_View());\n{code}\n{code}\nrequire_once 'Zend\/Form.php';\nrequire_once 'Zend\/Form\/Element\/Select.php';\nrequire_once 'Zend\/Form\/Element\/Text.php';\nrequire_once 'Zend\/View.php';\n\nclass FooForm extends Zend_Form\n{\n    public function init()\n    {\n        $fieldElement1 = new Zend_Form_Element_Select('field1');\n        $fieldElement1->setRequired(true)\n                      ->setAllowEmpty(false)\n                      ->setMultiOptions(array('foo' => 'FOO', 'bar' => 'BAR'));\n        \n        $queryElement1 = new Zend_Form_Element_Text('query1');\n        $queryElement1->setRequired(true)\n                      ->setAllowEmpty(false);\n                      \n        $this->addElements(array($fieldElement1, $queryElement1));\n        \n        $this->addDecorator('FormElements')\n             ->addDecorator('HtmlTag', array('tag' => 'dl', 'class' => 'zend_form'))\n             ->addDecorator('Form')\n             ->addDecorator('Errors');\n    }\n}\n\n$form = new FooForm();\n$form->isValid(array('field1' => 'baz', 'query1' => ''));\n\necho $form->render(new Zend_View());\n{code}\n\nOutput:\n{code}\n<br \/>\n<b>Warning<\/b>:  htmlspecialchars() expects parameter 1 to be string, array given in <b>\/Library\/WebServer\/Library\/Zend\/View\/Abstract.php<\/b> on line <b>804<\/b><br \/>\n<br \/>\n<b>Warning<\/b>:  htmlspecialchars() expects parameter 1 to be string, array given in <b>\/Library\/WebServer\/Library\/Zend\/View\/Abstract.php<\/b> on line <b>804<\/b><br \/>\n<form enctype=\"application\/x-www-form-urlencoded\" action=\"\" method=\"post\"><dl class=\"zend_form\">\n<dt>&nbsp;<\/dt>\n<dd>\n<select name=\"field1\" id=\"field1\">\n    <option value=\"foo\" label=\"FOO\">FOO<\/option>\n    <option value=\"bar\" label=\"BAR\">BAR<\/option>\n<\/select>\n<ul class=\"errors\"><li>'baz' was not found in the haystack<\/li><\/ul><\/dd>\n<dt>&nbsp;<\/dt>\n<dd>\n<input type=\"text\" name=\"query1\" id=\"query1\" value=\"\">\n<ul class=\"errors\"><li>Value is empty, but a non-empty value is required<\/li><\/ul><\/dd><\/dl><\/form>\n<ul class=\"errors\"><li><\/li><li><\/li><\/ul>\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=norm2782",
                        "name": "norm2782",
                        "displayName": "Jurrien Stutterheim",
                        "active": true
                    },
                    "created": "2008-08-24T03:53:48.000+0000",
                    "updated": "2008-08-24T03:53:48.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23657",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "The 'Errors' decorator is currently not intended for use at the form level, only with individual elements. I'm going to change this to a feature request, as we probably need a 'FormErrors' decorator.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-08-24T14:31:46.000+0000",
                    "updated": "2008-08-24T14:31:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25839",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "FormErrors decorator added in r12369 to trunk; will release with 1.7.0",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-11-07T08:14:08.000+0000",
                    "updated": "2008-11-07T08:14:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26198",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "Changing issues in preparation for the 1.7.0 release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-11-13T14:10:09.000+0000",
                    "updated": "2008-11-13T14:10:09.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37842",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vpgodara",
                        "name": "vpgodara",
                        "displayName": "ved prakash bishnoi",
                        "active": true
                    },
                    "body": "Use this for remove haystack error\r\n\r\n<code>\r\n$fieldElement1 = new Zend_Form_Element_Select('field1');\r\n$fieldElement1->setRequired(true)\r\n->setRegisterInArrayValidator(false);\r\n<\/code",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vpgodara",
                        "name": "vpgodara",
                        "displayName": "ved prakash bishnoi",
                        "active": true
                    },
                    "created": "2010-01-20T03:31:52.000+0000",
                    "updated": "2010-01-20T03:31:52.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4030\/transitions"
}