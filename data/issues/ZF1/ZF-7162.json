{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7162",
    "key": "ZF-7162",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Db_Table_Row should only update modified fields"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7162\/votes",
                "votes": 9,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=snefit",
                "name": "snefit",
                "displayName": "Sven Franke",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-06-30T05:00:40.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-11-20T21:37:32.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "Zend_Db_Table_Row",
                "modifiedFields",
                "update"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "When changing a value in a Zend_Db_Table_Row it is always set as a modified field so it is always issued in an update.\n\nI think that it can be improved by checking the value with the _cleanData to see if it is modified (to another value than the original).\n\nOriginal:\n{code}\n    public function __set($columnName, $value)\n    {\n        $columnName = $this->_transformColumn($columnName);\n        if (!array_key_exists($columnName, $this->_data)) {\n            require_once 'Zend\/Db\/Table\/Row\/Exception.php';\n            throw new Zend_Db_Table_Row_Exception(\"Specified column \\\"$columnName\\\" is not in the row\");\n        }\n        $this->_data[$columnName] = $value;\n        $this->_modifiedFields[$columnName] = true;\n    }\n{code}\n\nSuggested:\n{code}\n    public function __set($columnName, $value)\n    {\n        $columnName = $this->_transformColumn($columnName);\n        if (!array_key_exists($columnName, $this->_data)) {\n            require_once 'Zend\/Db\/Table\/Row\/Exception.php';\n            throw new Zend_Db_Table_Row_Exception(\"Specified column \\\"$columnName\\\" is not in the row\");\n        }\n        $this->_data[$columnName] = $value;\n        \n        if ($value === $this->_cleanData[$columnName]) {\n            if (isset($this->_modifiedFields[$columnName])) {\n                unset($this->_modifiedFields[$columnName]);   \n            }\n        } else {\n            $this->_modifiedFields[$columnName] = true;\n        }\n    }\n{code}\n\nIn this case the field is only 'modified' when it is not the same as the original value (in _cleanData). \n\nWhy? I know you only need to set the real modified fields to the row but sometimes it is more convieniant to update the complete row with setFromArray even when not all fields are changed.\n\nThe created query is smaller because only the real modified fields are used in the query."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/6",
                "name": "N\/A"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7162\/watchers",
                "isWatching": false,
                "watchCount": 7
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User"
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10340",
                    "id": 10340,
                    "description": "Mini Release",
                    "name": "1.8.4",
                    "userReleaseDate": "23\/Jun\/09",
                    "archived": false,
                    "releaseDate": "2009-06-23",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10133",
                    "id": 10133,
                    "name": "Zend_Db_Table",
                    "description": "Lightweight OO interface to database tables and rowsets.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/33462",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lucidix",
                        "name": "lucidix",
                        "displayName": "Marcus Welz",
                        "active": true
                    },
                    "body": "This ticket has my vote. I've been trying to come up with instances where you don't want that. I guess one is when you use timestamps in mysql -- unless you specify the value explicitly (such as the timestamp it already contained which, using this patch, you can't) it'll update the column to the current time.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lucidix",
                        "name": "lucidix",
                        "displayName": "Marcus Welz",
                        "active": true
                    },
                    "created": "2009-08-14T13:24:48.000+0000",
                    "updated": "2009-08-14T13:24:48.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/33464",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=snefit",
                        "name": "snefit",
                        "displayName": "Sven Franke",
                        "active": true
                    },
                    "body": "Thanks for voting....\n\nIMHO I think that the timestamp field isn't an issue, it is how MySQL uses the timestamp field. If you don't specify an value, it will update to the current time.\n\nI've used similar solutions like the suggested one in several projects when not using ZF. I think it is not efficient to update all fields when you only want to update a single or some fields ;)\n\nI hope this will get into the next release....",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=snefit",
                        "name": "snefit",
                        "displayName": "Sven Franke",
                        "active": true
                    },
                    "created": "2009-08-14T13:46:05.000+0000",
                    "updated": "2009-08-14T13:46:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39506",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=zukunft",
                        "name": "zukunft",
                        "displayName": "Timon Zielonka",
                        "active": true
                    },
                    "body": "Thanks for this suggestion. \r\n\r\nI think, in ZF 1.10.2 the modification must be done in Zend_Db_Table_Row_Abstract.php.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=zukunft",
                        "name": "zukunft",
                        "displayName": "Timon Zielonka",
                        "active": true
                    },
                    "created": "2010-03-24T05:16:43.000+0000",
                    "updated": "2010-03-24T05:16:43.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7162\/transitions"
}