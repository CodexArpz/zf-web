{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11651",
    "key": "ZF-11651",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Cookie jar doesn't work with Google"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11651\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dkong5",
                "name": "dkong5",
                "displayName": "D. Kong",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-08-08T17:22:45.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-08-26T17:26:43.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "cookie",
                "cookies",
                "zf-crteam-padraic",
                "zf-crteam-priority"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Cookie jar is supposed to store cookies, but it doesn't seem to work with Google. When you send two requests in one script execution, the second request should have a cookie set from the first. It doesn't, or rather Google doesn't recognize it for some reason and sets a new cookie.\r\n\r\n---\r\n\r\nHere's a sample log with request and response headers, see below for PHP code.\r\n{code}\r\nArray\r\n(\r\n    [0] => Host: www.google.pl\r\n    [1] => Accept-encoding: gzip, deflate\r\n    [2] => User-Agent: Opera\/9.80 (Windows NT 5.1; U; en) Presto\/2.7.62 Version\/11.01\r\n)\r\nArray\r\n(\r\n    [Date] => Mon, 08 Aug 2011 17:16:25 GMT\r\n    [Expires] => -1\r\n    [Cache-control] => private, max-age=0\r\n    [Content-type] => text\/html; charset=UTF-8\r\n    [Set-cookie] => Array\r\n        (\r\n            [0] => PREF=ID=55a7efd6a5984be0:FF=0:TM=1312823785:LM=1312823785:S=SIeCIg7tlSPtiMWW; expires=Wed, 07-Aug-2013 17:16:25 GMT; path=\/; domain=.google.pl\r\n            [1] => NID=49=AuVilAWC3-AJFCtpbXVSekIcet2H9BiVi0HDCO-al12GLRx78xQ16ExezszGCTyyudKfQupxa368C2UL2KiolcDTgqfPSMJQEJ7r7nVYQD18v3rJCaXQGUMY4Ntoj2Kc; expires=Tue, 07-Feb-2012 17:16:25 GMT; path=\/; domain=.google.pl; HttpOnly\r\n        )\r\n\r\n    [Content-encoding] => gzip\r\n    [Server] => gws\r\n    [Content-length] => 11979\r\n    [X-xss-protection] => 1; mode=block\r\n)\r\n{code}\r\ncookies: \r\n{code}\r\nPREF=ID%3D55a7efd6a5984be0%3AFF%3D0%3ATM%3D1312823785%3ALM%3D1312823785%3AS%3DSIeCIg7tlSPtiMWW;NID=49%3DAuVilAWC3-AJFCtpbXVSekIcet2H9BiVi0HDCO-al12GLRx78xQ16ExezszGCTyyudKfQupxa368C2UL2KiolcDTgqfPSMJQEJ7r7nVYQD18v3rJCaXQGUMY4Ntoj2Kc;\r\n{code}\r\n\r\nSecond request:\r\n{code}\r\nArray\r\n(\r\n    [0] => Host: www.google.pl\r\n    [1] => Accept-encoding: gzip, deflate\r\n    [2] => User-Agent: Opera\/9.80 (Windows NT 5.1; U; en) Presto\/2.7.62 Version\/11.01\r\n    [3] => Cookie: PREF=ID%3D55a7efd6a5984be0%3AFF%3D0%3ATM%3D1312823785%3ALM%3D1312823785%3AS%3DSIeCIg7tlSPtiMWW;NID=49%3DAuVilAWC3-AJFCtpbXVSekIcet2H9BiVi0HDCO-al12GLRx78xQ16ExezszGCTyyudKfQupxa368C2UL2KiolcDTgqfPSMJQEJ7r7nVYQD18v3rJCaXQGUMY4Ntoj2Kc;\r\n)\r\nArray\r\n(\r\n    [Date] => Mon, 08 Aug 2011 17:16:25 GMT\r\n    [Expires] => -1\r\n    [Cache-control] => private, max-age=0\r\n    [Content-type] => text\/html; charset=UTF-8\r\n    [Set-cookie] => PREF=ID=ffe4c60540013bd2:U=f63e1da7ed13dc9b:FF=0:TM=1312823785:LM=1312823785:S=QA99Nuw3HK4D3xhf; expires=Wed, 07-Aug-2013 17:16:25 GMT; path=\/; domain=.google.pl\r\n    [Content-encoding] => gzip\r\n    [Server] => gws\r\n    [Content-length] => 12021\r\n    [X-xss-protection] => 1; mode=block\r\n)\r\n{code}\r\ncookies: \r\n{code}\r\nPREF=ID%3Dffe4c60540013bd2%3AU%3Df63e1da7ed13dc9b%3AFF%3D0%3ATM%3D1312823785%3ALM%3D1312823785%3AS%3DQA99Nuw3HK4D3xhf;NID=49%3DAuVilAWC3-AJFCtpbXVSekIcet2H9BiVi0HDCO-al12GLRx78xQ16ExezszGCTyyudKfQupxa368C2UL2KiolcDTgqfPSMJQEJ7r7nVYQD18v3rJCaXQGUMY4Ntoj2Kc;\r\n{code}\r\n\r\n---\r\n\r\nPHP Code:\r\n\r\n{code}\r\n$client->setCookieJar();\r\n$client->setUri( 'http:\/\/www.google.pl\/' );\r\n\r\n$response = $client->request();\r\n$headers = $response->getHeaders();\r\n\r\nprint_r( $headers );\r\n\r\n$body = $response->getBody();\r\n\r\n$cookie_jar = $client->getCookieJar();\r\n$cookies = $cookie_jar->getAllCookies( Zend_Http_CookieJar::COOKIE_STRING_CONCAT );\r\n\r\necho \"cookies: \\n\";\r\nprint_r( $cookies ); \r\n{code}\r\n\/\/ --- a second request\r\n{code}\r\n$response = $client->request();\r\n$headers = $response->getHeaders();\r\n\r\nprint_r( $headers );\r\n\r\n$body = $response->getBody();\r\n\r\n$cookie_jar = $client->getCookieJar();\r\n$cookies = $cookie_jar->getAllCookies( Zend_Http_CookieJar::COOKIE_STRING_CONCAT );\r\n\r\necho \"cookies: \\n\";\r\nprint_r( $cookies ); \r\n\r\nexit;\r\n{code}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11651\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "zf-crteam-padraic",
                "zf-crteam-priority"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=shahar",
                "name": "shahar",
                "displayName": "Shahar Evron",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10980",
                    "id": 10980,
                    "description": "Mini Release",
                    "name": "1.11.10",
                    "userReleaseDate": "04\/Aug\/11",
                    "archived": false,
                    "releaseDate": "2011-08-04",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10015",
                    "id": 10015,
                    "name": "Zend_Http_Client",
                    "description": "performs HTTP requests",
                    "isAssigneeTypeValid": false
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10111",
                    "id": 10111,
                    "name": "Zend_Http_Cookie",
                    "isAssigneeTypeValid": false
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10112",
                    "id": 10112,
                    "name": "Zend_Http_CookieJar",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48177",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=joust",
                        "name": "joust",
                        "displayName": "Artur Bodera",
                        "active": true
                    },
                    "body": "When viewing google on browser, it requests another url via async call. \r\n\r\nThe url is something like:\r\n{{http:\/\/www.google.pl\/client_204?&biw=1981&bih=611&ei=SHNXTrO-NAAAswbIn9wECg}}\r\n\r\nThis sets up similar, but different cookies, which are then sent in subsequent requests. It might be the cause of cookie reset. I recommend you try tracing XHR calls in browser when going to google.pl and then try to implement it in your code.\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=joust",
                        "name": "joust",
                        "displayName": "Artur Bodera",
                        "active": true
                    },
                    "created": "2011-08-26T10:28:34.000+0000",
                    "updated": "2011-08-26T10:28:34.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48199",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dkong5",
                        "name": "dkong5",
                        "displayName": "D. Kong",
                        "active": true
                    },
                    "body": "Thank you for the reply. I'm inclined to think that the problem lays in Zend HTTP Client, however, because another client, namely PEAR HTTP_Request2, works fine with Google. And it's not a browser, so it doesn't make XHR calls.\r\n\r\nStill, I would like this case fixed, because I use Zend HTTP Client in my code and I am fine with it, except for that glitch with Google.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dkong5",
                        "name": "dkong5",
                        "displayName": "D. Kong",
                        "active": true
                    },
                    "created": "2011-08-26T17:26:43.000+0000",
                    "updated": "2011-08-26T17:26:43.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11651\/transitions"
}