{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12181",
    "key": "ZF-12181",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Format of a negative number with precision 0 is ignored using locale of en_PY"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12181\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lesliehh",
                "name": "lesliehh",
                "displayName": "Leslie Harrison",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2012-04-28T21:32:55.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-10-03T08:34:13.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "format",
                "negative",
                "number",
                "precision"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Using locale of es_PY and Zend_Currency, was trying to get a negative currency value using precision of 0.\r\nThe positive values comes out good, the problem is when the value is a negative number.\r\nThe negative currency ignores precision settings.\r\n\r\n{code:title=bootstrap} \r\n$locale = new Zend_Locale('es_PY');\r\n$currency = new Zend_Currency(array('precision' => '0'), $locale);\r\n{code} \r\n\r\n{code:title=view} \r\n\/\/ With value of -50000, it should show \u20b2 -50.000\r\n$this->currency(-50000) \/\/ \u20b2 -50.000.00 \r\n\/\/ With value of 50000, it has no problem\r\n$this->currency(50000) \/\/ \u20b2 50.000\r\n{code} \r\n\r\nI was able to do a quick fix and get the result I wanted by commenting out a line in Zend_Locale_Format. It is not a fix, as I do not know whether the change I made breaks anything else. I am not a \"pro\" in programming, just 3-4 years of experience with it. Thought I'd report this as it was bugging me for a while.\r\n\r\nThis is the original code from Zend_Locale_Format starting on line 417: \r\n{code:title=Zend_Local_Format from line 417} \r\n        if ($options['precision'] == '0') {\r\n            if (iconv_strrpos($format, '-') != 0) {\r\n                $format = iconv_substr($format, 0, $point);\r\n                        . iconv_substr($format, iconv_strrpos($format, '#') + 2);\r\n            } else {\r\n                $format = iconv_substr($format, 0, $point);\r\n            }\r\n        } else {\r\n            $format = iconv_substr($format, 0, $point) . $symbols['decimal']\r\n                               . iconv_substr($prec, 2);\r\n        }\r\n{code} \r\n\r\nThe change I made was to comment out the concatenation on line 420.\r\n{code:title=Zend_Local_Format from line 417} \r\n        if ($options['precision'] == '0') {\r\n            if (iconv_strrpos($format, '-') != 0) {\r\n                $format = iconv_substr($format, 0, $point);\r\n                        \/\/ TODO: Make the quickfix a proper fix.\r\n                        \/\/ The below portion was concatonated with the statement above\r\n                        \/\/. iconv_substr($format, iconv_strrpos($format, '#') + 2);\r\n            } else {\r\n                $format = iconv_substr($format, 0, $point);\r\n            }\r\n        } else {\r\n            $format = iconv_substr($format, 0, $point) . $symbols['decimal']\r\n                               . iconv_substr($prec, 2);\r\n        }\r\n{code} "
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12181\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "Zend_Locale_Format"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10980",
                    "id": 10980,
                    "description": "Mini Release",
                    "name": "1.11.10",
                    "userReleaseDate": "04\/Aug\/11",
                    "archived": false,
                    "releaseDate": "2011-08-04",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10073",
                    "id": 10073,
                    "name": "Zend_Locale",
                    "description": "Zend_Locale is a basic wrapper for all I18N and L10N issues for the Zend Framework. It provides the userbasically with access to translation functionality. It can handle different source file types for translation.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51947",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=benno",
                        "name": "benno",
                        "displayName": "Benno",
                        "active": true
                    },
                    "body": "Same problem here, using \u00abes_CL\u00bb as locale.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=benno",
                        "name": "benno",
                        "displayName": "Benno",
                        "active": true
                    },
                    "created": "2012-10-03T08:34:13.000+0000",
                    "updated": "2012-10-03T08:34:13.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12181\/transitions"
}