{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1041",
    "key": "ZF-1041",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Mail splits up words in email body"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1041\/votes",
                "votes": 8,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-09-18T06:17:40.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vero",
                "name": "vero",
                "displayName": "V\u00e9ronique M.",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2007-03-12T14:25:03.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-09-18T06:17:40.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Using PHP Version 5.1.6-pl6-gentoo, I tried to use Zend_Mail to send a confirmation email upon a user registration. I use HTML emails, and Zend's default transporter.\nBut sometimes spaces are inserted in the words, which would not be that bad if it didn't also sometimes break the link that the user must click in order to activate his account.\n\n_Edit 2007\/03\/13:_ I'll add that this behaviour has occurred when viewing the sent email in Gmail, and Mozilla Thunderbird. So far, my tests using Hotmail and Yahoo Mail have produced intact emails. Something to do with how the mail clients interprete the maximum line lengths, perhaps....\n\nHere is some test code I made for an example:\n{code}\n<?\nrequire_once('Zend.php');\n\nfunction __autoload($class_name) {\n   Zend::loadClass($class_name);\n}\n\ndefine('SITE_NAME', 'MySite');\n$email = 'v.marchand@gmail.com';\n$username = 'vero';\n$fullName = 'Vero. M.';\n$url = 'http:\/\/www.' . SITE_NAME . '.com\/Inscription\/Confirmer\/key\/7b2836967a0829a13c4c910683c82038e582afac';\n\n$body = \"\n<html>\n    <head>\n        <style>\n            body { font-family: Arial, Helvetica; font-size: 13px; }\n        <\/style>\n    <\/head>\n<body>\n\n<p> Bonjour <b>\" . $fullName . \"<\/b>,<\/p>\n\n<p>Merci de vous \u00eatre enregistr\u00e9 avec <b>\" . SITE_NAME . \"<\/b>.<\/p>\n\n<p>\nVotre compte \" . $username . \" est pr\u00e9sentement inactif. Pour \u00eatre activ\u00e9, il doit d'abord \u00eatre valid\u00e9 en deux \u00e9tapes.<br \/>\nPour la premi\u00e8re \u00e9tape de validation votre compte, veuillez tout simplement cliquer sur le URL ci-dessous (vous pouvez \u00e9galement le copier dans votre navigateur):\n<\/p>\n<a href='\" . $url . \"'>\" . $url . \"<\/a>\n<p>Une fois votre adresse email valid\u00e9e, votre compte sera revu par l'\u00e9quipe \" . SITE_NAME . \" et activ\u00e9. <\/p>\n\n<p>Merci!<\/p>\n\n<p>L'\u00c9quipe \" . SITE_NAME . \"<\/p>\n\n<\/body>\n<\/html>\n\";\n\n$mail = new Zend_Mail();\n$mail->setFrom('v.marchand@gmail.com', SITE_NAME);\n$mail->addTo($email, $fullName);\n$mail->setSubject('Votre inscription \u00e0 ' . SITE_NAME);\n$mail->setBodyHtml($body);\n$mail->send();\n?>\n{code}\n\nHere is the email I received on Gmail. Note the broken link, both in display (the space) and in the actual href (after the http:\/\/ )\n{quote}\n< body>\n\nBonjour Vero. M.,\n\nMerci de vous \u00eatre e nregistr\u00e9 avec MySite.\n\nVotre compte vero est pr\u00e9 sentement inactif. Pour \u00eatre activ\u00e9, il doit d'abord \u00eatre valid\u00e9 e n deux \u00e9tapes.\nPour la premi\u00e8re \u00e9tape de validation votre co mpte, veuillez tout simplement cliquer sur le URL ci-dessous (vous pouvez \u00e9galement le copier dans votre navigateur):\n[http:\/\/www.MySite.com\/Inscription\/Confirmer\/key\/7b2836967a0829a13 c4c910683c82038e582afac|http:\/\/%0awww.mysite.com\/Inscription\/Confirmer\/key\/7b2836967a0829a13c4c910683c82038e%0A582afac]\n\nUne fois votre adresse email valid\u00e9e, v otre compte sera revu par l'\u00e9quipe MySite et activ\u00e9.\n\nMerc i!\n\nL'\u00c9quipe MySite\n\n{quote}\n\nHere is the email content with the full headers, in case it helps:\n\n{quote}\nDelivered-To: v.marchand@gmail.com\nReceived: by 10.114.25.12 with SMTP id 12cs11848way;\n        Mon, 12 Mar 2007 08:19:35 -0700 (PDT)\nReceived: by 10.90.104.14 with SMTP id b14mr4553398agc.1173712775222;\n        Mon, 12 Mar 2007 08:19:35 -0700 (PDT)\nReturn-Path: <apache@zeus.opale>\nReceived: from zeus.opale (modemcable042.27-70-69.static.videotron.ca [69.70.27.42])\n        by mx.google.com with ESMTP id i5si8402101nzi.2007.03.12.08.19.34;\n        Mon, 12 Mar 2007 08:19:35 -0700 (PDT)\nReceived-SPF: neutral (google.com: 69.70.27.42 is neither permitted nor denied by best guess record for domain of apache@zeus.opale)\nReceived: by zeus.opale (Postfix, from userid 81)\n\tid 8097A105A7; Mon, 12 Mar 2007 11:19:34 -0400 (EDT)\nTo: \"Vero. M.\" <v.marchand@gmail.com>\nSubject: =?iso-8859-1?Q?Votre inscription =E0 MySite?=\nFrom: \"MySite\" <v.marchand@gmail.com>\nTo: \"Vero. M.\" <v.marchand@gmail.com>\nContent-Type: text\/html; charset=\"iso-8859-1\"\nContent-Transfer-Encoding: quoted-printable\nContent-Disposition: inline\nMessage-Id: <20070312151934.8097A105A7@zeus.opale>\nDate: Mon, 12 Mar 2007 11:19:34 -0400 (EDT)\n\n\n=0A<html>=0A    <head>=0A        <style>=0A            body { font-family:=\n\n Arial, Helvetica; font-size: 13px; }=0A        <\/style>=0A    <\/head>=0A<=\n\nbody>=0A=0A<p> Bonjour <b>Vero. M.<\/b>,<\/p>=0A=0A<p>Merci de vous =EAtre e=\n\nnregistr=E9 avec <b>MySite<\/b>.<\/p>=0A=0A<p>=0AVotre compte vero est pr=E9=\n\nsentement inactif. Pour =EAtre activ=E9, il doit d'abord =EAtre valid=E9 e=\n\nn deux =E9tapes.<br \/>=0APour la premi=E8re =E9tape de validation votre co=\n\nmpte, veuillez tout simplement cliquer sur le URL ci-dessous (vous pouvez=\n\n =E9galement le copier dans votre navigateur):=0A<\/p>=0A<a href=3D'http:\/\/=\n\nwww.MySite.com\/Inscription\/Confirmer\/key\/7b2836967a0829a13c4c910683c82038e=\n\n582afac'>http:\/\/www.MySite.com\/Inscription\/Confirmer\/key\/7b2836967a0829a13=\n\nc4c910683c82038e582afac<\/a>=0A<p>Une fois votre adresse email valid=E9e, v=\n\notre compte sera revu par l'=E9quipe MySite et activ=E9. <\/p>=0A=0A<p>Merc=\n\ni!<\/p>=0A=0A<p>L'=C9quipe MySite<\/p>=0A=0A<\/body>=0A<\/html>=0A\n{quote}\n\n\nAny suggestions? Perhaps there is a method I should use or setting I should change, but I'm not sure what exactly.\nThanks for your help.\n\nPS: also you might notice that the \"to\" recipient is there twice. I think this is a known bug, but I'm bringing it up here too, because it's been slightly bothering me. :)"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1041\/watchers",
                "isWatching": false,
                "watchCount": 7
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                "name": "beberlei",
                "displayName": "Benjamin Eberlei",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10021",
                    "id": 10021,
                    "description": "Preview release; DB, Filter, Log",
                    "name": "0.8.0",
                    "userReleaseDate": "21\/Feb\/07",
                    "archived": true,
                    "releaseDate": "2007-02-21",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10018",
                    "id": 10018,
                    "name": "Zend_Mail",
                    "description": "high-level utility to build MIME-compliant messages and send using a mail transport adapter",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/13282",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vero",
                        "name": "vero",
                        "displayName": "V\u00e9ronique M.",
                        "active": true
                    },
                    "body": "clarification",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vero",
                        "name": "vero",
                        "displayName": "V\u00e9ronique M.",
                        "active": true
                    },
                    "created": "2007-03-13T12:20:42.000+0000",
                    "updated": "2007-03-13T12:20:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/13340",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=peptolab",
                        "name": "peptolab",
                        "displayName": "Simon Mundy",
                        "active": true
                    },
                    "body": "Your example above looks like there are empty lines between each encoded line - is this how it is on your email source or is that just the way JIRA is displaying it? If there's extra linespaces it may be throwing the mail clients you mentioned.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=peptolab",
                        "name": "peptolab",
                        "displayName": "Simon Mundy",
                        "active": true
                    },
                    "created": "2007-03-14T17:38:53.000+0000",
                    "updated": "2007-03-14T17:38:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/13354",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vero",
                        "name": "vero",
                        "displayName": "V\u00e9ronique M.",
                        "active": true
                    },
                    "body": "Hello,\nThanks for responding. In the above example, the first block is the email as it appears on Gmail. The last block with the full headers is the actual email source.\nNote that the broken words match the end of lines (=) in the source. Such as the words \"e nregistr\u00e9\", \"pr\u00e9 sentement\", \"votre co mpte\", \"Merc i\", and of course the link.\n\nIt clearly has something to do with the maximum line length, but I'm not sure what I can do about it. Surely there is a way to use Zend_Mail without words being split like that (especially if it breaks important links), but I haven't been able to figure out how, so I reported it here.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vero",
                        "name": "vero",
                        "displayName": "V\u00e9ronique M.",
                        "active": true
                    },
                    "created": "2007-03-15T08:16:54.000+0000",
                    "updated": "2007-03-15T08:16:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/13381",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Assigning to Nico.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-03-15T13:54:03.000+0000",
                    "updated": "2007-03-15T13:54:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/13562",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thing2b",
                        "name": "thing2b",
                        "displayName": "thing2b",
                        "active": true
                    },
                    "body": "I will just confirm that this happens for me as well.\nOne thing that I will note is that this did not appear for me in any versions 0.7 and before.\nIt started occurring when I moved to version 0.8 and continues to do it in version 0.9",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thing2b",
                        "name": "thing2b",
                        "displayName": "thing2b",
                        "active": true
                    },
                    "created": "2007-03-19T19:18:56.000+0000",
                    "updated": "2007-03-19T19:18:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/13563",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=peptolab",
                        "name": "peptolab",
                        "displayName": "Simon Mundy",
                        "active": true
                    },
                    "body": "thing2b and Veronique, can you also please confirm which MTA is installed on your machines? Is it Postfix, QMail or Sendmail?\n\nCould you also please send a test email to webmaster at peptolab dot com so I can see the source intact?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=peptolab",
                        "name": "peptolab",
                        "displayName": "Simon Mundy",
                        "active": true
                    },
                    "created": "2007-03-19T19:29:58.000+0000",
                    "updated": "2007-03-19T19:29:58.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/13564",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thing2b",
                        "name": "thing2b",
                        "displayName": "thing2b",
                        "active": true
                    },
                    "body": "I have send a message to Simon Mundy and with the same code sent myself one.\nUsing version 0.9.0 of Zend Framework.\nSendmail is in my phpinfo().\nPostfix, QMail and not in my phpinfo().\n\n{noformat}\n$mail = new Zend_Mail();\n$mail->setBodyText('Simon Mundy [19\/Mar\/07 07:29 PM]\nthing2b and Veronique, can you also please confirm which MTA is installed on your machines? Is it Postfix, QMail or Sendmail?\nCould you also please send a test email to webmaster at peptolab dot com so I can see the source intact?\n');\n$mail->setFrom( 'test@example.com'  );\n$mail->setReturnPath( 'test@example.com'  );\n$mail->addTo('cencored@gmail.com', 'Cencored');\n$mail->setSubject( '[#ZF-1041] Zend_Mail splits up words in email body - Zend Framework Issue Tracker' );\n$mail->send();\n{noformat}\n\nAnd the mail I received at gmail was:\n\n{noformat}\nDelivered-To: cencored@gmail.com\nReceived: by 10.100.111.13 with SMTP id j13cs581656anc;\n        Mon, 19 Mar 2007 17:40:55 -0700 (PDT)\nReceived: by 10.35.41.12 with SMTP id t12mr11603001pyj.1174351255333;\n        Mon, 19 Mar 2007 17:40:55 -0700 (PDT)\nReturn-Path: <test@example.com>\nReceived: from luke.cencored.com.au (luke.cencored.com.au [64.49.254.38])\n        by mx.google.com with ESMTP id w67si69927pyg.2007.03.19.17.40.54;\n        Mon, 19 Mar 2007 17:40:55 -0700 (PDT)\nReceived-SPF: neutral (google.com: 64.49.254.38 is neither permitted nor denied by best guess record for domain of test@example.com)\nReceived: (qmail 30589 invoked by uid 80); 20 Mar 2007 11:40:53 +1100\nDate: 20 Mar 2007 11:40:53 +1100\nMessage-ID: <20070320004053.30588.qmail@luke.cencored.com.au>\nTo: \"cencored\" <cencored@gmail.com>\nSubject: [#ZF-1041] Zend_Mail splits up words in email body - Zend Framework Issue Tracker\nFrom: \"\" <test@example.com>\nContent-Type: text\/plain; charset=\"iso-8859-1\"\nContent-Transfer-Encoding: quoted-printable\nContent-Disposition: inline\n\n\nSimon Mundy [19\/Mar\/07 07:29 PM]=0D=0Athing2b and Veronique, can you also=\n\n please confirm which MTA is installed on your machines? Is it Postfix, QM=\n\nail or Sendmail?=0D=0ACould you also please send a test email to webmaster=\n\n at peptolab dot com so I can see the source intact?=0D=0A\n{noformat}\n\nShown on screen through gmail is: \n\n{noformat}\nSimon Mundy [19\/Mar\/07 07:29 PM]\nthing2b and Veronique, can you also\n please confirm which MTA is installed on your machines? Is it Postfix, QM\nail or Sendmail?\nCould you also please send a test email to webmaster\n at peptolab dot com so I can see the source intact?\n{noformat}\n\nNote the break in the word \"QMail\"",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thing2b",
                        "name": "thing2b",
                        "displayName": "thing2b",
                        "active": true
                    },
                    "created": "2007-03-19T19:54:59.000+0000",
                    "updated": "2007-03-19T19:54:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/13571",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vero",
                        "name": "vero",
                        "displayName": "V\u00e9ronique M.",
                        "active": true
                    },
                    "body": "I have sent the same email, with the same code posted earlier (in my first post) but with a CC to Simon and \"[#ZF-1041]\" prefixing the mail subject.\n\nThe email shown in Gmail is the same as I posted before. I tried also with Thunderbird, same thing. On the other hand, the email displayed fine in Yahoo. But I haven't been able to find a way to print the original source in Yahoo mail, though. :(\n\nAccording to our sysadmin, we use postfix 2.2.10.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vero",
                        "name": "vero",
                        "displayName": "V\u00e9ronique M.",
                        "active": true
                    },
                    "created": "2007-03-20T08:16:47.000+0000",
                    "updated": "2007-03-20T08:16:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/13651",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thing2b",
                        "name": "thing2b",
                        "displayName": "thing2b",
                        "active": true
                    },
                    "body": "I have found a few resources that may help in the solving of this bug. The website:\nhttp:\/\/www.nabble.com\/Zend_Mail-problem-with-special-chars-and-automatic-line-break-t3128214s16154.html\nhas an interesting note about something that sounds the same. \n\nThe problem was:\n{noformat} \n> Second, a long line with a link gets an automatic line break in the\n> middle of the link which makes the link invalid. Also I would like to\n> add a couple of empty lines but Zend_Mail always gets rid of them. I\n> would rather prefer to handle the line breaks myself to prevent\n> Zend_Mail from splitting up words and links in the middle. \n{noformat} \n\nAnd the bug was stated as:\n{noformat} \n- Finally, the bug: When using the Zend_Mail default transport --  \nPHP's own mail() function (sendmail) -- all of the CRLF end-of-line  \nsequences that Zend_Mime::encodeQuotedPrintable() correctly generates  \nare silently duplicated in the resulting message body. This results  \nin the correct 'soft line break' to continue a line, followed by an  \nadditional CRLF by itself which mail clients interpret as a genuine  \nline break. \n{noformat} \n\nAnd the temporary fix that I am thinking about using in the mean time is:\n{noformat} \n2. If you're only ever going to use the default sendmail transport  \nwith Zend_Mail, you can change Zend_Mime::encodeQuotedPrintable() so  \nthat it only generates a single LF end-of-line sequence which will  \nnot be duplicated by PHP's mail() function (this is the solution  \nproposed by Kevin in ZF-264). Change line 74 of Zend_Mime from this:\n\n   const LINEEND = \"\\r\\n\";\n\nto this:\n\n   const LINEEND = \"\\n\";\n\nThis change will cause problems if you attempt to use the SMTP  \ntransport because now the end-of-line sequence is wrong. Your  \nmessages will likely be rejected at some point in the delivery chain. \n{noformat} ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thing2b",
                        "name": "thing2b",
                        "displayName": "thing2b",
                        "active": true
                    },
                    "created": "2007-03-22T19:25:07.000+0000",
                    "updated": "2007-03-22T19:25:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/13684",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=peptolab",
                        "name": "peptolab",
                        "displayName": "Simon Mundy",
                        "active": true
                    },
                    "body": "Why thankyou thing! (Couldn't resist)\n\nThanks for following up the bugs. Problem is, Zend_Db_Transport_Sendmail _does_ use the default PHP lineending instead of \"\\r\\n\". So UNIX defaults to \"\\n\".\n\nIt's not an easy one to track insofar as we're seeing different results using the same MTA so I'd like to find some more common threads before we start committing changes.\n\nThis bug is still a priority but a fix will only be on the way once we're 100% sure!\n\nCheers",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=peptolab",
                        "name": "peptolab",
                        "displayName": "Simon Mundy",
                        "active": true
                    },
                    "created": "2007-03-24T04:55:56.000+0000",
                    "updated": "2007-03-24T04:55:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/13790",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tbrady",
                        "name": "tbrady",
                        "displayName": "Tony Brady",
                        "active": true
                    },
                    "body": "I have the same problem using the Postfix MTA 2.2.10 on RHEL 4. My work-around for now is *not* to use the quoted-printable encoding. This is easily done by extending the Zend_Mail class and has the advantage that you don't need to edit the ZF files (e.g. Zend_Mime LINEEND work-around above). All you need to do is change the\n\n{{$mp->encoding = Zend_Mime::ENCODING_QUOTEDPRINTABLE;}}\n\nline in setBodyText() and setBodyHtml() methods. E.g. (based on ZF-0.7):\n\n{code}\n\/**\n * Fix to Zend_Mail so that mail is not sent out with quoted printable encoding\n*\/\nclass MyApp_Mail extends Zend_Mail\n{\n\n    \/**\n     * Sets the text body for the message.\n     *\n     * @param string $txt\n     * @param string $charset\n     * @return Zend_Mime_Part\n    *\/\n    public function setBodyText($txt, $charset=null)\n    {\n        if ($charset === null) {\n            $charset = $this->_charset;\n        }\n\n        $mp = new Zend_Mime_Part($txt);\n        $mp->encoding = Zend_Mime::ENCODING_8BIT;\n        $mp->type = Zend_Mime::TYPE_TEXT;\n        $mp->disposition = Zend_Mime::DISPOSITION_INLINE;\n        $mp->charset = $charset;\n\n        $this->_bodyText = $mp;\n        return $mp;\n    }\n\n    \/**\n     * Sets the HTML body for the message\n     *\n     * @param string $html\n     * @param string $charset\n     * @return Zend_Mime_Part\n     *\/\n    public function setBodyHtml($html, $charset=null)\n    {\n        if ($charset === null) {\n            $charset = $this->_charset;\n        }\n\n        $mp = new Zend_Mime_Part($html);\n        $mp->encoding = Zend_Mime::ENCODING_8BIT;\n        $mp->type = Zend_Mime::TYPE_HTML;\n        $mp->disposition = Zend_Mime::DISPOSITION_INLINE;\n        $mp->charset = $charset;\n\n        $this->_bodyHtml = $mp;\n        return $mp;\n    }\n\n}\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tbrady",
                        "name": "tbrady",
                        "displayName": "Tony Brady",
                        "active": true
                    },
                    "created": "2007-03-29T06:53:35.000+0000",
                    "updated": "2007-03-29T06:53:35.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/14075",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vero",
                        "name": "vero",
                        "displayName": "V\u00e9ronique M.",
                        "active": true
                    },
                    "body": "For the record, I am using the workaround posted above and so far I have not had any problems.\n\nIs there any update from the devteam about this? I wonder if there's any reason to use the quoted-printable encoding instead of the 8bit one...",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vero",
                        "name": "vero",
                        "displayName": "V\u00e9ronique M.",
                        "active": true
                    },
                    "created": "2007-04-09T12:35:32.000+0000",
                    "updated": "2007-04-09T12:35:32.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/14910",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "body": "As Simon has written this bug is not easy to track down. Newlines are handled differently depending on the platform and MTA. As Tony has written one workaround is a different encoding. With the fix to ZF-980 the encoding can be changed with the third parameter in setBodyText() and setBodyHtml().",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "created": "2007-06-01T14:48:46.000+0000",
                    "updated": "2007-06-01T14:48:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28033",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "body": "Since the bug does not depend on Zend_Mail, but on lower layers of Mail transport shouldn't the workaround possiblity through the API just be documented and the bug be closed?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "created": "2009-01-11T01:18:42.000+0000",
                    "updated": "2009-01-11T01:18:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28981",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vero",
                        "name": "vero",
                        "displayName": "V\u00e9ronique M.",
                        "active": true
                    },
                    "body": "Sorry for the delay in responding. I have no problem with documenting the use of the third parameter and closing the bug, myself.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=vero",
                        "name": "vero",
                        "displayName": "V\u00e9ronique M.",
                        "active": true
                    },
                    "created": "2009-02-20T11:23:56.000+0000",
                    "updated": "2009-02-20T11:23:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34615",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "body": "Close as bug\/problem in the lower MTA layers, which can be circumvented with using base64 instead of quoted printable encoding.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=beberlei",
                        "name": "beberlei",
                        "displayName": "Benjamin Eberlei",
                        "active": true
                    },
                    "created": "2009-09-18T06:17:39.000+0000",
                    "updated": "2009-09-18T06:17:39.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1041\/transitions"
}