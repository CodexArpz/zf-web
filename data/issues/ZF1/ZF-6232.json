{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6232",
    "key": "ZF-6232",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "findManyToManyRowset() returns columns from the intersection table"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6232\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/3",
                "name": "Duplicate"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10430",
                    "id": 10430,
                    "description": "Mini Release",
                    "name": "1.10.2",
                    "userReleaseDate": "24\/Feb\/10",
                    "archived": false,
                    "releaseDate": "2010-02-24",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-02-19T13:15:08.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ludek.stepan",
                "name": "ludek.stepan",
                "displayName": "Ludek Stepan",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-04-07T08:58:50.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-11-16T08:30:19.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Hello,\n\nI've found that the method findManyToManyRowset() from the Zend_Db_Table_Row_Abstract returns all columns both from the matching and intersection tables in the resulting rowset. Is that safe? I mean what happens if the matching and intersection table have a same column name with different values? Would the results be valid? However the $select sets integrityCheck off and consequently the result rowset's readOnly flag off too.\n\nI believe that the result rowset should not contain any values from the intersection table or optionaly some column collision checking should be done. At least, if the resulting rowset contains any values from the intersection table, it should be marked readOnly for sake.\n\nBest regards,\nLudek Stepan"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/6",
                "name": "N\/A"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6232\/watchers",
                "isWatching": false,
                "watchCount": 4
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                "name": "ralph",
                "displayName": "Ralph Schindler",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-3709",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3709",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                },
                {
                    "issueKey": "ZF-10626",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10626",
                    "type": {
                        "name": "Dependency",
                        "direction": "INBOUND",
                        "description": "is dependecy of"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12763",
                    "filename": "zf6232.r21084.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tech13",
                        "name": "tech13",
                        "displayName": "Michael Rehbein",
                        "active": false
                    },
                    "created": "2010-02-18T11:53:19.000+0000",
                    "size": 1715,
                    "mimeType": "text\/x-diff",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12763\/zf6232.r21084.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10133",
                    "id": 10133,
                    "name": "Zend_Db_Table",
                    "description": "Lightweight OO interface to database tables and rowsets.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/33156",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=steve.yang",
                        "name": "steve.yang",
                        "displayName": "Steve Yang",
                        "active": true
                    },
                    "body": "Hi,\n\nI believe this is linked to http:\/\/framework.zend.com\/issues\/browse\/ZF-3709\n\nInside Zend_Db_Table_Row_Abstract line 1053 onwards we have \n{noformat}\n $select->from(array('i' => $interName), Zend_Db_Select::SQL_WILDCARD, $interSchema)\n               ->joinInner(array('m' => $matchName), $joinCond, Zend_Db_Select::SQL_WILDCARD, $matchSchema)\n               ->setIntegrityCheck(false);\n{noformat} \n\nI believe the from column declaration is causing the issue and should be \n{noformat}\n $select->from(array('i' => $interName), array(), $interSchema)\n               ->joinInner(array('m' => $matchName), $joinCond, Zend_Db_Select::SQL_WILDCARD, $matchSchema)\n               ->setIntegrityCheck(false);\n{noformat} \n\nto hide all the columns of the intersection table.  This would then matchup with the documentation in http:\/\/framework.zend.com\/manual\/en\/zend.db.table.relationships.html#zend.db.table.relationships.fetching.many-to-many\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=steve.yang",
                        "name": "steve.yang",
                        "displayName": "Steve Yang",
                        "active": true
                    },
                    "created": "2009-08-03T08:56:51.000+0000",
                    "updated": "2009-08-03T08:56:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37699",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tech13",
                        "name": "tech13",
                        "displayName": "Michael Rehbein",
                        "active": false
                    },
                    "body": "Comment converted to patch file.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tech13",
                        "name": "tech13",
                        "displayName": "Michael Rehbein",
                        "active": false
                    },
                    "created": "2010-01-14T10:37:16.000+0000",
                    "updated": "2010-01-14T10:37:16.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38549",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tech13",
                        "name": "tech13",
                        "displayName": "Michael Rehbein",
                        "active": false
                    },
                    "body": "Attached patch with fix and adjustment to a unit test to verify",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tech13",
                        "name": "tech13",
                        "displayName": "Michael Rehbein",
                        "active": false
                    },
                    "created": "2010-02-18T11:53:19.000+0000",
                    "updated": "2010-02-18T11:53:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38596",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "Fixed in trunk 21100 and in release branch 1.10 in 21102",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2010-02-19T13:15:08.000+0000",
                    "updated": "2010-02-19T13:15:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39139",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=croensch",
                        "name": "croensch",
                        "displayName": "Christoph Roensch",
                        "active": true
                    },
                    "body": "First, i believe this is a behaviour not suited to be changed in a minor version.\r\n\r\nI have to agree that overlapping column names could invalidate the result set.\r\n\r\nHowever i disagree with *issue 3709* that any subsequent {{save()}} will fail with an exception as it would only fail if you explicitly {{_set_()}} a column of the intersection table, wich does not make any sense.\r\n\r\nWe would like to adapt these changes as they make our domain model code somewhat less complicated, but we are running into issues.\r\n\r\nPreviously we used to display a ManyToMany-Rowset using all columns [i.id_r, i.id_m, m.id, m.value]. Then manipulate it and then synchronize it to a Dependent-Rowset using only the columns that represent the intersection [i.id_r, i.id_m]. This is still possible by _translating_\/_fixing_ the column names from [m.id] to [i.id_r (given), i.id_m].\r\n\r\nHowever we are facing an issue when we *actually need a value from the intersection table*, in other words when the relation contains some data. I have tried to give a Zend_Db_Table_Select statement to findManyToManyRowset().\r\nbq. {{$this->select()->columns(array('i' => 'value'));}}\r\nThis fails because the intersection Table has not been defined.\r\nbq. Zend_Db_Select(255): No table has been specified for the FROM clause\r\n\r\n+Do we really have to findDependents and then findParents on this rowset to get the information we could retrieve just fine before?+\r\n\r\nAnother quick but possibly dirty solution would be to revert the behaviour of this fix by overloading findManyToManyRowset with\r\n{code}\r\nif( $select === null )\r\n{\r\n  if( is_string($intersectionTable) )\r\n  {\r\n    $intersectionTable = $this->_getTableFromString($intersectionTable);\r\n  }\r\n  $select = $intersectionTable->select(true);\r\n}\r\n{code}\r\nbefore calling the parent method.\r\n\r\nAnyway i'd like this bug to be reopened because of the issue:\r\n+It is not easily possible to include intersection values that are actually needed.+",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=croensch",
                        "name": "croensch",
                        "displayName": "Christoph Roensch",
                        "active": true
                    },
                    "created": "2010-03-10T00:56:37.000+0000",
                    "updated": "2010-03-10T00:56:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40294",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=martinph",
                        "name": "martinph",
                        "displayName": "martin hughes",
                        "active": true
                    },
                    "body": "I'm going to agree with Christoph here. This one came as a bit of a surprise in a minor release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=martinph",
                        "name": "martinph",
                        "displayName": "martin hughes",
                        "active": true
                    },
                    "created": "2010-04-29T06:48:29.000+0000",
                    "updated": "2010-04-29T06:48:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/42129",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=deebuck",
                        "name": "deebuck",
                        "displayName": "William McDonald Buck",
                        "active": true
                    },
                    "body": "For what it is worth I just spent 4 hours trying to track down a problem which turns out to be due to this change. Working code dependent on the documented behaviour that the result set contains data from the intersection table. Docs say \"This method returns a Zend_Db_Table_Rowset_Abstract containing rows from the table $table, satisfying the many-to-many relationship. The current Row object $row from the origin table is used to find rows in the intersection table, and that is joined to the destination table. \"\r\nNot nice to break working code in a minor release. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=deebuck",
                        "name": "deebuck",
                        "displayName": "William McDonald Buck",
                        "active": true
                    },
                    "created": "2010-08-27T11:05:27.000+0000",
                    "updated": "2010-08-27T11:05:27.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/42133",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=croensch",
                        "name": "croensch",
                        "displayName": "Christoph Roensch",
                        "active": true
                    },
                    "body": "I've extraced my solution to a Workaround: http:\/\/gist.github.com\/554965",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=croensch",
                        "name": "croensch",
                        "displayName": "Christoph Roensch",
                        "active": true
                    },
                    "created": "2010-08-28T03:06:38.000+0000",
                    "updated": "2010-08-28T03:06:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43010",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "Commentary and workaround on this issue has been blogged about here: http:\/\/ralphschindler.com\/2010\/11\/15\/composite-rowsets-for-many-to-many-relationships-via-zend_db_table\r\n\r\n-ralph",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2010-11-16T08:30:17.000+0000",
                    "updated": "2010-11-16T08:30:17.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6232\/transitions"
}