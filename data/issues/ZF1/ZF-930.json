{
    "expand": "html",
    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-930",
    "key": "ZF-930",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Http_Client::request mishandles relative paths on Windows"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-930\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10022",
                    "id": 10022,
                    "description": "Beta Release; all components feature complete for 1.0",
                    "name": "0.9.0",
                    "userReleaseDate": "17\/Mar\/07",
                    "archived": true,
                    "releaseDate": "2007-03-17",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2007-02-25T09:42:30.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=elazar",
                "name": "elazar",
                "displayName": "Matthew Turland",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2007-02-16T20:31:51.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2007-07-05T14:43:50.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "When calling Zend_Http_Client::request, some valid URLs end up causing a Zend_Uri_Exception when they result in redirects in which relative paths are used in the HTTP response headers. A code example that exposes this is shown below.\n\n{code}\nrequire 'Zend\/Http\/Client.php';\n\n$http = new Zend_Http_Client(null, array('timeout' => 10));\n$http->setUri('http:\/\/portasoft.org');\n\n$response = $http->request('HEAD');\n\n\/*\nOutput:\nFatal error: Uncaught exception 'Zend_Uri_Exception' with message 'Path \"\\\/news.\nphp\" is not a valid HTTP path' in Zend\\Uri\\Http.php:457\nStack trace:\n#0 Zend\\Http\\Client.php(775): Zend_Uri_Http->setPath('\\\/news.php')\n#1 test.php(7): Zend_Http_Client->request('HEAD')\n#2 {main} thrown in Zend\\Uri\\Http.php on line 457\n*\/\n{code}\n\nFirefox 2 and curl 7.15.4 process this URL as expected. Below is the result of manually accessing each URL in the redirection from http:\/\/portasoft.org to the end of the redirection at http:\/\/www.portasoft.org\/e107\/news.php.\n\n{code}\nMatthew@turland ~\n$ curl -I http:\/\/portasoft.org\nHTTP\/1.1 302 Found\nDate: Sat, 17 Feb 2007 00:58:14 GMT\nServer: Apache\/2.0.59 (Unix) mod_perl\/1.99_17-dev Perl\/v5.8.4 mod_ssl\/2.0.59 Ope\nnSSL\/0.9.7e FrontPage\/5.0.2.2634 PHP\/5.2.0\nX-Powered-By: PHP\/5.2.0\nLocation: http:\/\/www.portasoft.org\/e107\/\nContent-Type: text\/html\n\n\nMatthew@turland ~\n$ curl -I http:\/\/www.portasoft.org\/e107\/\nHTTP\/1.1 302 Found\nDate: Sat, 17 Feb 2007 00:58:26 GMT\nServer: Apache\/2.0.59 (Unix) mod_perl\/1.99_17-dev Perl\/v5.8.4 mod_ssl\/2.0.59 Ope\nnSSL\/0.9.7e FrontPage\/5.0.2.2634 PHP\/5.2.0\nX-Powered-By: PHP\/5.2.0\nLocation: news.php\nContent-Type: text\/html\n\n\nMatthew@turland ~\n$ curl -I http:\/\/www.portasoft.org\/e107\/news.php\nHTTP\/1.1 200 OK\nDate: Sat, 17 Feb 2007 00:58:32 GMT\nServer: Apache\/2.0.59 (Unix) mod_perl\/1.99_17-dev Perl\/v5.8.4 mod_ssl\/2.0.59 Ope\nnSSL\/0.9.7e FrontPage\/5.0.2.2634 PHP\/5.2.0\nX-Powered-By: PHP\/5.2.0\nCache-Control: must-revalidate\nETag: 33da36178024e4e022803f5669cf5566\nContent-Length: 32557\nContent-Type: text\/html; charset=utf-8\n{code}\n\nThe issue is in Zend_Http_Client's handling of relative paths. Around line 774 in the class file for Zend_Http_Client is a line that looks like the one shown below. On Windows under PHP 5.2.0, dirname('\/e107\/') results in '\\' on Windows under PHP 5.2.0, which is of course not the expected response with respect to this application of the function. (In Linux, the same call results in '\/' which IS the expected response.) Removing the call to dirname() appears to fix this problem. If complete removal of this call is undesirable, perhaps realpath() might work better.\n\n{code}\n$path = rtrim(dirname($this->uri->getPath()), \"\/\");\n{code}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-930\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=shahar",
                "name": "shahar",
                "displayName": "Shahar Evron",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/attachment\/10271",
                    "filename": "Client.php.patch",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=inash",
                        "name": "inash",
                        "displayName": "Inash Zubair",
                        "active": true
                    },
                    "created": "2007-02-18T10:28:30.000+0000",
                    "size": 648,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/framework.zend.com\/issues\/secure\/attachment\/10271\/Client.php.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10020",
                    "id": 10020,
                    "description": "Preview Release; I18N, Acl, Auth, Session",
                    "name": "0.7.0",
                    "userReleaseDate": "18\/Jan\/07",
                    "archived": true,
                    "releaseDate": "2007-01-18",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/component\/10015",
                    "id": 10015,
                    "name": "Zend_Http_Client",
                    "description": "performs HTTP requests",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12832",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=inash",
                        "name": "inash",
                        "displayName": "Inash Zubair",
                        "active": true
                    },
                    "body": "Attached is a patch for current Http_Client which is currently at revision 3039.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=inash",
                        "name": "inash",
                        "displayName": "Inash Zubair",
                        "active": true
                    },
                    "created": "2007-02-18T10:28:30.000+0000",
                    "updated": "2007-02-18T10:28:30.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12943",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=shahar",
                        "name": "shahar",
                        "displayName": "Shahar Evron",
                        "active": true
                    },
                    "body": "I think I fixed the issue in revision 3618 - please update and test again.\nIt's hard for me to make sure because I have limited access to a Windows machine now. \n\nUpdate this bug if the issue is not resolved.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=shahar",
                        "name": "shahar",
                        "displayName": "Shahar Evron",
                        "active": true
                    },
                    "created": "2007-02-25T09:42:30.000+0000",
                    "updated": "2007-02-25T09:42:30.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-930\/transitions"
}