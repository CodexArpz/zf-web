{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10713",
    "key": "ZF-10713",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Search_Lucene_Document_Html should be able to ignore some code"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/2",
                "name": "New Feature",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10713\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sylvestre",
                "name": "sylvestre",
                "displayName": "Sylvestre Ledru",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-11-19T06:39:36.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-08-09T15:29:20.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Hello,\r\n\r\nI need to index more than 3000 pages of documentation with Zend Lucene. \r\nEach page has a menu on the left. This menu contains references to other functions.\r\n\r\nDuring the search, it causes many unrelated pages to pop up.\r\n\r\nIt would be nice if Zend Lucene could ignore some portions of the HTML code.\r\nFor example:\r\n\r\n<!-- LUCENE_IGNORE -->\r\nMenu item 1\r\nMenu item 2\r\nMenu item 3\r\n<!-- \/\/LUCENE_IGNORE -->\r\n\r\nMenu item * would not be indexed at the end.\r\n\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10713\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                "name": "alexander",
                "displayName": "Alexander Veremyev",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10021",
                    "id": 10021,
                    "name": "Zend_Search_Lucene",
                    "description": "pure PHP robust, general purpose text search engine",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43209",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sylvestre",
                        "name": "sylvestre",
                        "displayName": "Sylvestre Ledru",
                        "active": true
                    },
                    "body": "Hello,\r\n\r\nThe following patch (developed against the SVN) implements this feature.\r\nIf you agree on adding this feature, I can update the documentation and unitary tests (I haven't done it yet in case you refuse this feature).\r\n\r\nIndex: library\/Zend\/Search\/Lucene\/Document\/Html.php\r\n===================================================================\r\n--- library\/Zend\/Search\/Lucene\/Document\/Html.php\t(r\u00c3\u00a9vision 23417)\r\n+++ library\/Zend\/Search\/Lucene\/Document\/Html.php\t(copie de travail)\r\n@@ -67,6 +67,30 @@\r\n      *\/\r\n     private static $_excludeNoFollowLinks = false;\r\n \r\n+\t\/**\r\n+\t * Defines if the current analysis should be indexed or not\r\n+\t *\r\n+\t * @var boolean if true, skip the current indexation\r\n+\t *\/ \r\n+\tprivate $skipIndex = false;\r\n+\r\n+\t\/** \r\n+\t * Defines the beginning tag which starts the blocking of the indexation\r\n+\t * of some section of the code\r\n+\t * \r\n+\t * @var string\r\n+\t *\/\r\n+\tprivate $skipTagBegin = \"LUCENE IGNORE\";\r\n+\r\n+\t\/** \r\n+\t * Defines the ending tag which ends the blocking of the indexation\r\n+\t * of some section of the code\r\n+\t * \r\n+\t * @var string\r\n+\t *\/\r\n+\tprivate $skipTagEnd = \"\/\/LUCENE IGNORE\";\r\n+\r\n+\r\n     \/**\r\n      *\r\n      * List of inline tags\r\n@@ -186,6 +210,29 @@\r\n     }\r\n \r\n     \/**\r\n+     * Set the beginning skip Tag \r\n+     * Default: LUCENE IGNORE\r\n+\t * \r\n+     * @param boolean $newValue\r\n+     *\/\r\n+    public static function setSkipTagBegin($newValue)\r\n+    {\r\n+\t\t$this->setSkipTagBegin=$newValue;\r\n+    }\r\n+\r\n+    \/**\r\n+     * Set the ending skip Tag \r\n+     * Default: \/\/LUCENE IGNORE\r\n+\t * \r\n+     * @param boolean $newValue\r\n+     *\/\r\n+    public static function setSkipTagEnd($newValue)\r\n+    {\r\n+\t\t$this->setSkipTagEnd=$newValue;\r\n+    }\r\n+\r\n+\r\n+    \/**\r\n      * Set exclude nofollow links flag\r\n      *\r\n      * @param boolean $newValue\r\n@@ -215,12 +262,23 @@\r\n      *\/\r\n     private function _retrieveNodeText(DOMNode $node, &$text)\r\n     {\r\n-        if ($node->nodeType == XML_TEXT_NODE) {\r\n+\t\tif ($node->nodeName==\"#comment\" && (strpos($node->nodeValue,$this->skipTagBegin) || strpos($node->nodeValue,$this->skipTagEnd))) {\r\n+\r\n+\t\t\tif (strpos($node->nodeValue,$this->skipTagBegin)) {\r\n+\t\t\t\t\/* Start to ignore *\/\r\n+\t\t\t\t$this->skipIndex = true;\r\n+\t\t\t} else {\r\n+\t\t\t\t\/* Stop the ignore *\/\r\n+\t\t\t\t$this->skipIndex = false;\r\n+\t\t\t}\r\n+\t\t}\r\n+\r\n+        if ($node->nodeType == XML_TEXT_NODE && $this->skipIndex != true) {\r\n             $text .= $node->nodeValue;\r\n             if(!in_array($node->parentNode->tagName, $this->_inlineTags)) {\r\n                 $text .= ' ';\r\n             }\r\n-        } else if ($node->nodeType == XML_ELEMENT_NODE  &&  $node->nodeName != 'script') {\r\n+        } else if ($node->nodeType == XML_ELEMENT_NODE  &&  $node->nodeName != 'script' && $this->skipIndex != true) {\r\n             foreach ($node->childNodes as $childNode) {\r\n                 $this->_retrieveNodeText($childNode, $text);\r\n             }\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sylvestre",
                        "name": "sylvestre",
                        "displayName": "Sylvestre Ledru",
                        "active": true
                    },
                    "created": "2010-11-20T15:18:18.000+0000",
                    "updated": "2010-11-20T15:18:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43540",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sylvestre",
                        "name": "sylvestre",
                        "displayName": "Sylvestre Ledru",
                        "active": true
                    },
                    "body": "Is there any chance this patch \/ features could be accepted ?\r\n\r\nThanks!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sylvestre",
                        "name": "sylvestre",
                        "displayName": "Sylvestre Ledru",
                        "active": true
                    },
                    "created": "2010-12-09T08:41:44.000+0000",
                    "updated": "2010-12-09T08:41:44.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47909",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sylvestre",
                        "name": "sylvestre",
                        "displayName": "Sylvestre Ledru",
                        "active": true
                    },
                    "body": "ping ?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sylvestre",
                        "name": "sylvestre",
                        "displayName": "Sylvestre Ledru",
                        "active": true
                    },
                    "created": "2011-08-09T15:29:20.000+0000",
                    "updated": "2011-08-09T15:29:20.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10713\/transitions"
}