{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9002",
    "key": "ZF-9002",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Warning on form validation"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9002\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-05-24T09:10:01.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stewartlord",
                "name": "stewartlord",
                "displayName": "Stewart Lord",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-01-28T15:34:02.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-05-29T09:26:09.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "This is essentially a re-open of ZF-4030. I could not find a way to change the status of that issue.\r\n\r\nZend_Form_Decorator_Errors produces PHP warnings and erroneous output if $element->getMessages() produces a multi-dimensional array of errors instead of a single-dimensional array of messages. This will happen if the Errors decorator is attached to a form and the form has no form-level errors (e.g. messages added via addError()), but does contain elements with errors.\r\n\r\nSuggested fix is to remove errors that are not strings:\r\n\r\nZend_Form_Decorator_Errors (line 53):\r\n\r\n        \/\/ remove errors that are not strings.\r\n        $errors = $element->getMessages();\r\n        foreach ($errors as $key => $error) {\r\n            if (!is_string($error)) {\r\n                unset($errors[$key]);\r\n            }\r\n        } \r\n\r\nThe crux of the problem is actually the behaviour of Zend_Form::getMessages(), but that would be difficult to resolve and may break BC.\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9002\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                "name": "alab",
                "displayName": "Christian Albrecht",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-4030",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4030",
                    "type": {
                        "name": "Duplicate",
                        "direction": "OUTBOUND",
                        "description": "duplicates"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10400",
                    "id": 10400,
                    "description": "Mini Release",
                    "name": "1.9.7",
                    "userReleaseDate": "11\/Jan\/10",
                    "archived": false,
                    "releaseDate": "2010-01-11",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38112",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Why are you using the Errors decorator on a form object instead of the FormErrors decorator (which was designed specifically for handling the multi-dimensional arrays returned by Zend_Form::getMessages())?\r\n\r\nRight now, it feels like you're using the wrong tool for the job. However, if you have a good reason for this and can detail the use case sufficiently, I'll investigate further. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2010-01-29T04:40:43.000+0000",
                    "updated": "2010-01-29T04:40:43.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38135",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stewartlord",
                        "name": "stewartlord",
                        "displayName": "Stewart Lord",
                        "active": true
                    },
                    "body": "Fair question. The FormErrors decorator has different behavior. It displays all of the implicit errors on a form (e.g. errors on the elements of the form). It does not display errors that are directly attached to the form (e.g. errors set explicitly via $form->addError()).\r\n\r\nIn this case, I want to display element errors on the elements, but form-level errors at the top of the form. The proposed fix allows the errors decorator to be used on both elements and forms. In my case it produces the desired behavior. It's also defensive which is probably good.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stewartlord",
                        "name": "stewartlord",
                        "displayName": "Stewart Lord",
                        "active": true
                    },
                    "created": "2010-01-29T09:29:30.000+0000",
                    "updated": "2010-01-29T09:29:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38136",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stewartlord",
                        "name": "stewartlord",
                        "displayName": "Stewart Lord",
                        "active": true
                    },
                    "body": "...It is probably worth noting that the getMessages() method of the Zend_Form object contributes to the problem because it has a bit of a split personality. In the case where errors have been explicitly set on the form it will return a single-dimensional array and will not include any of the implicit\/element errors. If, however, the form does not have explicit errors, but does have elements with errors, it will return a multi-dimensional array.\r\n\r\nIn the first case, the standard Errors decorator works fine on forms. In the second case it produces warnings and erroneous output.\r\n\r\nHope that helps!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stewartlord",
                        "name": "stewartlord",
                        "displayName": "Stewart Lord",
                        "active": true
                    },
                    "created": "2010-01-29T09:33:44.000+0000",
                    "updated": "2010-01-29T09:33:44.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38137",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Stewart -- thanks for clarifying. I'll look into the behavior this coming month.\r\n\r\nIn the meantime, can you provide an example form that displays the issue? That will make writing up a test case easier. Thanks!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2010-01-29T11:07:00.000+0000",
                    "updated": "2010-01-29T11:07:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38138",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stewartlord",
                        "name": "stewartlord",
                        "displayName": "Stewart Lord",
                        "active": true
                    },
                    "body": "Sure, np...\r\n\r\nThis works fine:\r\n\r\n        $form = new Zend_Form;\r\n        $form->setView(new Zend_View);\r\n        $form->addDecorator('Errors');\r\n        $form->addElement('text','text');\r\n        $form->addError('form-badness');\r\n        echo $form;\r\n\r\nThis breaks:\r\n\r\n        $form = new Zend_Form;\r\n        $form->setView(new Zend_View);\r\n        $form->addDecorator('Errors');\r\n        $form->addElement('text','text');\r\n        $form->getElement('text')->addError('element-badness');\r\n        echo $form;\r\n\r\nFormErrors doesn't solve the problem because it won't show 'form-badness', only 'element-badness':\r\n\r\n        $form = new Zend_Form;\r\n        $form->setView(new Zend_View);\r\n        $form->addDecorator('FormErrors');\r\n        $form->addElement('text','text');\r\n        $form->addError('form-badness');\r\n        $form->getElement('text')->addError('element-badness');\r\n        echo $form;\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stewartlord",
                        "name": "stewartlord",
                        "displayName": "Stewart Lord",
                        "active": true
                    },
                    "created": "2010-01-29T11:53:23.000+0000",
                    "updated": "2010-01-29T11:53:23.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40665",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "This is fixed in trunk r22272 and merged into 1.10 release branch,\r\nin a way that FormErrors now render custom form errors.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-05-24T09:10:01.000+0000",
                    "updated": "2010-05-24T09:10:01.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40757",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stewartlord",
                        "name": "stewartlord",
                        "displayName": "Stewart Lord",
                        "active": true
                    },
                    "body": "Hi Christian, does the Errors decorator still produce warnings? Having FormErrors display both element-level errors and form level errors is not necessarily desirable. Consider the use case where you want form-level errors displayed at the top of the form, and element-level errors display next to the element.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stewartlord",
                        "name": "stewartlord",
                        "displayName": "Stewart Lord",
                        "active": true
                    },
                    "created": "2010-05-28T18:06:35.000+0000",
                    "updated": "2010-05-28T18:06:35.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40759",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "Hi Stewart, uhh yes the Errors Decorator still produces a warning about \r\nhtmlspecialchar getting wrong parameter type - look into it right after\r\nwriting. For the FormErrors i introduced two more options\r\nshowCustomFormErrors = (bool) & onlyCustomFormErrors (bool) as you can\r\nsee in [r22272|http:\/\/framework.zend.com\/code\/changelog\/Standard_Library?cs=22272], is it that what you meant?\r\n\r\nThanks for taking me back to that one :) don't know what i was doing, now there \r\nis a fix for the previous commit [r22316|http:\/\/framework.zend.com\/code\/changelog\/Standard_Library?cs=22316] that does what i expected it to do.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-05-29T03:09:48.000+0000",
                    "updated": "2010-05-29T03:09:48.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40761",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "So finally i think you can go with\r\n{code}\r\n$form->addDecorator('FormErrors', array('onlyCustomFormErrors' => true))\r\n     ->addError('form-badness')\r\n     ->addElement('text','text')\r\n     ->text->addError('element-badness');\r\n{code}\r\n\r\nNo more need to set Errors Decorator on the form :D",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-05-29T04:17:46.000+0000",
                    "updated": "2010-05-29T04:17:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40762",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "Now we may discuss if the default setting for onlyCustomFormErrors should be true instead of false.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-05-29T04:23:33.000+0000",
                    "updated": "2010-05-29T04:23:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40772",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stewartlord",
                        "name": "stewartlord",
                        "displayName": "Stewart Lord",
                        "active": true
                    },
                    "body": "Hi Christian, thanks for the follow-up. Those options are helpful. Yes, given that elements have the 'Errors' decorator by default, I think that onlyCustomFormErrors should be set to true initially.\r\n\r\nAlthough the Errors decorator is no longer needed at the form-level, it might still be a good idea to apply the patch from the original description above. It's defensive and if someone attaches the Errors decorator to a form it will work. It's not obvious that you need one decorator for elements and another for the form.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stewartlord",
                        "name": "stewartlord",
                        "displayName": "Stewart Lord",
                        "active": true
                    },
                    "created": "2010-05-29T09:26:08.000+0000",
                    "updated": "2010-05-29T09:26:08.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9002\/transitions"
}