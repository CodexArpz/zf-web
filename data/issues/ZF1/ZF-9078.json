{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9078",
    "key": "ZF-9078",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Measure_Abstract: Precision detection on type change possible bug"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9078\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10440",
                    "id": 10440,
                    "description": "Mini Release",
                    "name": "1.10.3",
                    "userReleaseDate": "01\/Apr\/10",
                    "archived": false,
                    "releaseDate": "2010-04-01",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-03-04T14:08:07.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                "name": "thymus",
                "displayName": "Raphael Dehousse",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-02-04T00:18:10.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-03-05T01:59:40.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Dears,\r\n\r\nIn this code (line 287)\r\n\r\n$slength = strlen($value);\r\n$length  = 0;\r\nfor($i = 1; $i <= 25; ++$i) {\r\n    if ($value[$slength - $i] != '0') {\r\n        $length = 26 - $i;\r\n        break;\r\n    }\r\n}\r\n\r\n$this->_value = Zend_Locale_Math::round($value, $length);\r\n$this->_type  = $type;\r\n\r\nA possible error can occur if $slength is < 25...\r\nWe will have $value[$indexNegative].\r\nA simple fix would be\r\n\r\nfor($i = 1; $i <= $slength && $i <= 25; ++$i) {\r\n\r\nRegards,\r\n\r\nRapha\u00ebl Dehousse"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9078\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10360",
                    "id": 10360,
                    "description": "Minor Release",
                    "name": "1.10.0",
                    "userReleaseDate": "27\/Jan\/10",
                    "archived": false,
                    "releaseDate": "2010-01-27",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10075",
                    "id": 10075,
                    "name": "Zend_Measure",
                    "description": "Zend_Measure is a locale aware Class which can convert measurement units.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38237",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "body": "This has been introduced in revision 18493:\r\n\r\n[ZF-8009] Zend_Measure:\r\n\r\n- added precision detection on type change",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "created": "2010-02-04T00:19:01.000+0000",
                    "updated": "2010-02-04T00:19:01.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38284",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Closing as non-issue.\r\nThe code works as intended and throws no warning or error.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-02-05T13:07:54.000+0000",
                    "updated": "2010-02-05T13:07:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38318",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "body": "Thomas,\r\n\r\nWith all the respect I owe you, I do not understand why a notice is not considered as a possible bug.\r\nWith this code, I get notices than causes unit tests to fail.\r\nA simple fix I provided you resolve the problem.\r\nWhy not integrate it?\r\n\r\nRegards,\r\n\r\nRapha\u00ebl Dehousse",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "created": "2010-02-07T05:34:48.000+0000",
                    "updated": "2010-02-07T05:34:48.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38320",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "body": "If the strlen($value) == 0, then, the index will be -1 => notice\r\n\r\nI will try to give you a test case to reproduce this",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "created": "2010-02-07T06:53:49.000+0000",
                    "updated": "2010-02-07T06:53:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38321",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "body": "$time = new Zend_Measure_Time(0, Zend_Measure_Time::SECOND);\r\n\r\n$time->setType(Zend_Measure_Time::SECOND);\r\n\r\nUninitialized string offset: -1\r\n\r\nZend\/Measure\/Abstract.php:293\r\n\r\nRegards,\r\n\r\nRapha\u00ebl Dehousse",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "created": "2010-02-07T07:00:17.000+0000",
                    "updated": "2010-02-07T07:00:17.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38322",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "body": "This is because with 0,\r\nstrlen($value) = 1,\r\n\r\nfor($i = 1; $i <= 25; ++$i) {\r\n    if ($value[$slength - $i] != '0') {\r\n        $length = 26 - $i;\r\n        break;\r\n    }\r\n}\r\n\r\n$value[1 - 1] == 0 => won't break\r\n$value[1 - 2] => negative offset...\r\n\r\nWon't occur with $i <= $slength\r\n\r\nThank for your help :)\r\n\r\nRegards\r\n\r\nRapha\u00ebl Dehousse",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "created": "2010-02-07T07:07:55.000+0000",
                    "updated": "2010-02-07T07:07:55.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38465",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "body": "Dear Thomas,\r\n\r\nI really like the Zend Framework and I think that I have shown good will by providing patches to the issues I reported.\r\n\r\nWould it be possible to see any action from you? A response?\r\n\r\nThank you very much for your cooperation.\r\n\r\nRapha\u00ebl Dehousse",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "created": "2010-02-15T07:52:05.000+0000",
                    "updated": "2010-02-15T07:52:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38560",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "The input value is fixed to a length of 25 by using Zend_Locale_Math.\r\nUsing your example code, a vardump of $value on line 290 returns:\r\nstring '0.0000000000000000000000000' (length=27)\r\n\r\nTherefor still not reproducable. (speaking of revision 20096 or higher)\r\n\r\nPS: Please note that I am always replying, even if I am one week away due to my real live job or because I am working on other issues... no reason to get impatient.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-02-18T14:56:56.000+0000",
                    "updated": "2010-02-18T14:58:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38893",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "body": "Dear Thomas,\r\n\r\nFirst, please accept my excuses about my many comments.\r\n\r\nLet's back to the issue :)\r\n\r\nI tested on Linux and on Windows and indeed, the result is different.\r\nOn Windows, if I dump $value line around 289-290, I receive string(27) \"0.0000000000000000000000000\".\r\nOn Linux, I receive : string(1) \"0\".\r\n\r\nSo, the \"problem\" could be here.\r\nThen the issue is maybe in Zend_Locale_Math?\r\n\r\nPS: I tested against ZF 1.10.1 and 1.10.2\r\n\r\nBest regards,\r\n\r\nRapha\u00ebl Dehousse",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "created": "2010-03-01T02:36:29.000+0000",
                    "updated": "2010-03-01T02:36:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38913",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Note:\r\nWhen you say that unittests fail it is always recommended, and in my eyes useful, when you provide the returned informations from unittests to see which test fails on which line with which returned value.\r\n\r\nAnd we need also some other informations for reproducation in all issues:\r\n* PHP release?\r\n* BCMath available?\r\n* Used locale",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-03-01T12:44:42.000+0000",
                    "updated": "2010-03-01T12:44:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38924",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "body": "Test:\r\n\r\n$ cat DummyTest.php \r\n<?php\r\n\r\nrequire_once('Zend\/Measure\/Time.php');\r\n\r\nclass DummyTest extends PHPUnit_Framework_TestCase\r\n{\r\n\r\n        public function testTime()\r\n        {\r\n                $locale = new Zend_Locale();\r\n                var_dump((string) $locale);\r\n\r\n                var_dump(Zend_Locale_Math::isBcmathDisabled());\r\n\r\n                $time = new Zend_Measure_Time(0, Zend_Measure_Time::SECOND);\r\n                $time->setLocale($locale);\r\n\r\n                $time->setType(Zend_Measure_Time::SECOND);\r\n        }\r\n\r\n}\r\n\r\nTest output:\r\n\r\n$ phpunit DummyTest.php \r\nPHPUnit 3.4.6 by Sebastian Bergmann.\r\n\r\nstring(5) \"en_US\"\r\nbool(true)\r\nE\r\n\r\nTime: 0 seconds, Memory: 5.75Mb\r\n\r\nThere was 1 error:\r\n\r\n1) DummyTest::testTime\r\nUninitialized string offset: -1\r\n\r\n\/usr\/share\/php5\/Zend\/Measure\/Abstract.php:292\r\n\/home\/rdehouss\/DummyTest.php:12\r\n\r\nFAILURES!\r\nTests: 1, Assertions: 0, Errors: 1.\r\n\r\nPHP release: 5.2.12\r\nBC math disabled\r\nLocale: en_US",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "created": "2010-03-02T00:58:09.000+0000",
                    "updated": "2010-03-02T00:58:09.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38925",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "body": "With bcmath compiled with php, the problem does not occur:\r\n\r\n$ phpunit DummyTest.php\r\nPHPUnit 3.4.6 by Sebastian Bergmann.\r\n\r\nstring(5) \"en_US\"\r\nbool(false)\r\n.\r\n\r\nTime: 1 second, Memory: 5.75Mb\r\n\r\nOK (1 test, 0 assertions)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "created": "2010-03-02T01:27:26.000+0000",
                    "updated": "2010-03-02T01:27:26.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38927",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "body": "Do you want I create another bug for Zend_Locale_Math_PhpMath and let this one closed?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "created": "2010-03-02T02:39:14.000+0000",
                    "updated": "2010-03-02T02:39:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38958",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "You said that unitests fail..\r\n\r\nSo I don't need a new test from you, but the information which unittests from ZF fail, with the exact failure, the exceptionstack and so on.\r\n\r\nGive me not only the unitests from Zend_Measure but also the testresults from Zend_Locale_AllTests. These tests are deeper.\r\n\r\nThnx\r\n\r\nPS: Please use styling and don't write code plaintext.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-03-03T12:18:42.000+0000",
                    "updated": "2010-03-03T12:18:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38983",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "At last I was able to reproduce with a different code than yours.\r\n\r\nFixed with r21330",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-03-04T14:08:07.000+0000",
                    "updated": "2010-03-04T14:08:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38992",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "body": "Thanks!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thymus",
                        "name": "thymus",
                        "displayName": "Raphael Dehousse",
                        "active": true
                    },
                    "created": "2010-03-05T01:59:37.000+0000",
                    "updated": "2010-03-05T01:59:37.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9078\/transitions"
}