{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1269",
    "key": "ZF-1269",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Error extending Zend_Db_Table for PostGreSQL database views "
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField",
            "value": {
                "timeoriginalestimate": 4320,
                "timeestimate": 2880,
                "timespent": 4320
            }
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1269\/votes",
                "votes": 2,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/5",
                "name": "Cannot Reproduce"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10172",
                    "id": 10172,
                    "description": "Minor Release",
                    "name": "1.5.0",
                    "userReleaseDate": "17\/Mar\/08",
                    "archived": true,
                    "releaseDate": "2008-03-17",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-01-29T10:25:50.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=joshualross",
                "name": "joshualross",
                "displayName": "Joshua L Ross",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2007-04-12T16:24:35.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-08-07T07:13:46.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I attempted to model a PostGreSQL database view by extending Zend_Db_Table and it is failing.  I am able to instantiate the object but a call to Zend_Db_Table_Abstract::fetchAll() fails with the following error and stack trace:\n\nFatal error: Uncaught exception 'Zend_Db_Adapter_Exception' with message 'SQLSTATE[42601]: Syntax error: 7 ERROR: syntax error at or near \"FROM\" at character 10' in \/data\/www\/vhosts\/mysite\/v2\/library\/Zend\/Db\/Adapter\/Pdo\/Abstract.php:156 \nStack trace: \n#0 \/data\/www\/vhosts\/mysite\/v2\/library\/Zend\/Db\/Table\/Abstract.php(761): Zend_Db_Adapter_Pdo_Abstract->query(Object(Zend_Db_Select)) \n#1 \/data\/www\/vhosts\/mysite\/v2\/library\/Zend\/Db\/Table\/Abstract.php(658): Zend_Db_Table_Abstract->_fetch(NULL, NULL, NULL, NULL) \n#2 \/data\/www\/vhosts\/mysite\/v2\/application\/fileprocessing\/controllers\/MyController.php(117): Zend_Db_Table_Abstract->fetchAll() \n#3 \/data\/www\/vhosts\/mysite\/v2\/library\/Zend\/Controller\/Action.php(488): Fileprocessing_MyController->processAction() \n#4 \/data\/www\/vhosts\/mysite\/v2\/library\/Zend\/Controller\/Dispatcher\/Standard.php(214): Zend_Controller_Action->dispatch('processAction') \n#5 \/da in \/data\/www\/vhosts\/mysite\/v2\/library\/Zend\/Db\/Adapter\/Pdo\/Abstract.php on line 156\n\n\nIn the newsgroup Bill mentioned:\n{quote}\nI haven't tested the PostgreSQL adapter for Zend_Db with database views\nyet, so it's likely that some adjustment is needed in the query against\nthe system catalog tables to support views in the describeTable()\nmethod.\n{quote}\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/customFieldOption\/10039",
                "value": "  Should Have"
            }
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1269\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/worklog\/17984",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1269",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "comment": "http:\/\/framework.zend.com\/fisheye\/changelog\/Zend_Framework\/?cs=7178",
                    "created": "2007-12-17T16:45:19.000+0000",
                    "updated": "2007-12-17T16:45:19.000+0000",
                    "started": "2007-12-17T16:45:19.000+0000",
                    "minutesSpent": 4320
                }
            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                "name": "darby",
                "displayName": "Darby Felton",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10060",
                    "id": 10060,
                    "description": "Beta Release; bug fixes",
                    "name": "0.9.1",
                    "userReleaseDate": "23\/Mar\/07",
                    "archived": true,
                    "releaseDate": "2007-03-23",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10012",
                    "id": 10012,
                    "name": "Zend_Db",
                    "description": "interfaces, APIs, and adapters for various third-party data stores",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/17983",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "body": "I committed a unit test In [SVN r7178|http:\/\/framework.zend.com\/fisheye\/changelog\/Zend_Framework\/?cs=7178] to test the use of {{Zend_Db_Table_Abstract::fetchAll()}} on a view. The table\/view class {{Zend_Db_Table_TableViewBugsFixed}} (in {{trunk\/tests\/Zend\/Db\/Table\/TableViewBugsFixed.php}}) represents a view created by the test setup. I noticed that I could only get this to work using a view name having all lowercase characters and no underscores. Also, defining the primary key in the class extending {{Zend_Db_Table_Abstract}} avoids problems with automatic primary key resolution via the results of {{describeTable()}}.\n\nI heartily recommend that more unit tests using views are developed for these database components.\n\nCan you please provide more information about the conditions under which you experience this issue? I could not quickly reproduce the exact error message you received. Thanks. :)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "created": "2007-12-17T16:43:26.000+0000",
                    "updated": "2007-12-17T16:43:26.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/18023",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "body": "Reducing priority to Should Have, pending additional issue reproduction information from reporter.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "created": "2007-12-20T10:58:48.000+0000",
                    "updated": "2007-12-20T10:58:48.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/18030",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=joshualross",
                        "name": "joshualross",
                        "displayName": "Joshua L Ross",
                        "active": true
                    },
                    "body": "Unfortunately I no longer have access to this... I have moved on from that company.  So my memory of the issue is going to be a bit muddle but in essence we had created a view in the database and were trying to use zend_db_table to create a model for it.  So in the model _setup method we set the name property to the name of the view.  It seemed to instantiate just fine but we could not perform any fetch operation.  Hope that helps.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=joshualross",
                        "name": "joshualross",
                        "displayName": "Joshua L Ross",
                        "active": true
                    },
                    "created": "2007-12-20T13:01:15.000+0000",
                    "updated": "2007-12-20T13:01:15.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/18652",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "body": "Resolving as \"cannot reproduce\" pending further information receipt.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "created": "2008-01-29T10:25:50.000+0000",
                    "updated": "2008-01-29T10:25:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/33284",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=brunofriedmann",
                        "name": "brunofriedmann",
                        "displayName": "Bruno Friedmann",
                        "active": true
                    },
                    "body": "I've just been hit by this bug with version from svn today 08-07-2009.\n\nThe test case would be this ( I express it first in human language ) \n\nCreate a view called view_test_zf with two simple columns issue form a \nselect t.id as view_id, t.label as view_label from test\n\nNow if you create a class extending Zend_Db_Table_Abstract like this \n\nclass Default_Model_DbView_Test extends Zend_Db_Table_Abstract\n{\n    \/**\n     * The default table name \n     *\/\n    protected $_name = 'view_test_zf';\n    protected $_id = 'view_id';\n    \n}\nThis work well with real tables. and should be suffisant \n(db adapter used is pdo_pgsql with a traditionnal initialisation by Zend_Application )\n\nIt produce the following error\n\nException information:\n\nMessage: A table must have a primary key, but none was found\nStack trace:\n\n#0 \/home\/ioda_data\/web-include\/ZF.svn\/library\/Zend\/Db\/Table\/Abstract.php(964): Zend_Db_Table_Abstract->_setupPrimaryKey()\n#1 \/home\/ioda_data\/web-include\/ZF.svn\/library\/Zend\/Db\/Table\/Select.php(100): Zend_Db_Table_Abstract->info()\n#2 \/home\/ioda_data\/web-include\/ZF.svn\/library\/Zend\/Db\/Table\/Select.php(78): Zend_Db_Table_Select->setTable(Object(Default_Model_DbView_Communes))\n#3 \/home\/ioda_data\/web-include\/ZF.svn\/library\/Zend\/Db\/Table\/Abstract.php(1000): Zend_Db_Table_Select->__construct(Object(Default_Model_DbView_Communes))\n#4 \/home\/ioda_data\/web-include\/ZF.svn\/library\/Zend\/Db\/Table\/Abstract.php(1286): Zend_Db_Table_Abstract->select()\n#5 \/home\/bruno\/workspace\/pdc-ioda\/library\/Sigeom\/Pdc\/Commune\/Adapter\/Default.php(10): Zend_Db_Table_Abstract->fetchAll()\n#6 \/home\/bruno\/workspace\/pdc-ioda\/library\/Sigeom\/Pdc\/Commune\/Service.php(63): Sigeom_Pdc_Commune_Adapter_Default->listCommunes()\n#7 \/home\/bruno\/workspace\/pdc-ioda\/application\/controllers\/IndexController.php(66): Sigeom_Pdc_Commune_Service->listCommunes()\n#8 \/home\/ioda_data\/web-include\/ZF.svn\/library\/Zend\/Controller\/Action.php(513): IndexController->indexAction()\n#9 \/home\/ioda_data\/web-include\/ZF.svn\/library\/Zend\/Controller\/Dispatcher\/Standard.php(289): Zend_Controller_Action->dispatch('indexAction')\n#10 \/home\/ioda_data\/web-include\/ZF.svn\/library\/Zend\/Controller\/Front.php(946): Zend_Controller_Dispatcher_Standard->dispatch(Object(Zend_Controller_Request_Http), Object(Zend_Controller_Response_Http))\n#11 \/home\/ioda_data\/web-include\/ZF.svn\/library\/Zend\/Application\/Bootstrap\/Bootstrap.php(77): Zend_Controller_Front->dispatch()\n#12 \/home\/bruno\/workspace\/pdc-ioda\/application\/Bootstrap.php(69): Zend_Application_Bootstrap_Bootstrap->run()\n#13 \/home\/bruno\/workspace\/pdc-ioda\/application\/Bootstrap.php(63): Bootstrap->runHttp()\n#14 \/home\/ioda_data\/web-include\/ZF.svn\/library\/Zend\/Application.php(335): Bootstrap->run()\n#15 \/home\/bruno\/workspace\/pdc-ioda\/contexts\/commons.php(54): Zend_Application->run()\n#16 \/home\/bruno\/workspace\/pdc-ioda\/contexts\/http.php(8): require_once('\/home\/bruno\/wor...')\n#17 \/home\/bruno\/workspace\/pdc-ioda\/public\/index.php(3): require_once('\/home\/bruno\/wor...')\n#18 {main}\n\nIf you add this in the class \n\n\/**\n *\t@FIXME : Zend trouble with postgresql view\n *\/    \n    protected function _setup()\n    {\n        $this->_name = 'view_test_zf';\n        $this->_primary = 'view_id';\n        parent::_setup();\n    }\t\n\n    public function __construct(){\n        \/\/ \tcontinue with automated setup\n        $this->_setup();\n    }\n    \n    \nIt simply work !\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=brunofriedmann",
                        "name": "brunofriedmann",
                        "displayName": "Bruno Friedmann",
                        "active": true
                    },
                    "created": "2009-08-07T07:13:44.000+0000",
                    "updated": "2009-08-07T07:13:44.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-1269\/transitions"
}