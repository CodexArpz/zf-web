{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5139",
    "key": "ZF-5139",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "CLONE -Zend_Auth_Adapter_Db_Table authentication bug"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5139\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-01-11T21:57:13.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alias.mac",
                "name": "alias.mac",
                "displayName": "Filipe Guerra",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-12-02T11:22:03.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-01-12T07:28:38.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "First of all In the components list of this issue there is no Zend_Auth_Adapter_Db_Table.\n\nIn the _authenticateValidateResultSet method of this class, there can be only one result from the array. This is a problem if we have (like in sugar for example) a deleted = 1 row that defines if some records are deleted and there is more than 1 row with the same username, of course credential treatment fails (the columns in data base are correct) but it fails to complete validation in PHP (because of the count() in the method reported above.\n\nThank you for this great Framework ;)"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/1",
                "name": "Blocker"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5139\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                "name": "ralph",
                "displayName": "Ralph Schindler",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10251",
                    "id": 10251,
                    "description": "Mini Release",
                    "name": "1.6.2",
                    "userReleaseDate": "13\/Oct\/08",
                    "archived": false,
                    "releaseDate": "2008-10-13",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10260",
                    "id": 10260,
                    "description": "Minor Release",
                    "name": "1.7.0",
                    "userReleaseDate": "17\/Nov\/08",
                    "archived": false,
                    "releaseDate": "2008-11-17",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10084",
                    "id": 10084,
                    "name": "Zend_Auth",
                    "description": "A abstraction for various concrete web application authentication implementations.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26901",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alias.mac",
                        "name": "alias.mac",
                        "displayName": "Filipe Guerra",
                        "active": true
                    },
                    "body": "The problem is exactly that. If I have the same user (username) and one of them has deleted = 0 and then I create a new user (with the same username, which is possible because the other is deleted) I'll have 2 records 1 of them is deleted=0. In the database I have 2 rows and the column to be validated is correct 0 on the first, 1 on the next. But the validation fails because of the method I quoted before. It will try to get 1 record only. Everything else returns an error...\nThis is not an error it's a perfectly valid query and the method should go for each value search if at least one is returning 1 on the zend_auth column.\nThanks for your time",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alias.mac",
                        "name": "alias.mac",
                        "displayName": "Filipe Guerra",
                        "active": true
                    },
                    "created": "2008-12-02T11:24:57.000+0000",
                    "updated": "2008-12-02T11:24:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26902",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alias.mac",
                        "name": "alias.mac",
                        "displayName": "Filipe Guerra",
                        "active": true
                    },
                    "body": "I don't know how to reopen some issue that was defined as resolved... so I cloned it...\n\nSorry... but this is important and it really blocks implementation...",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alias.mac",
                        "name": "alias.mac",
                        "displayName": "Filipe Guerra",
                        "active": true
                    },
                    "created": "2008-12-02T11:26:08.000+0000",
                    "updated": "2008-12-02T11:26:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28082",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "I think your use case can be covered by the use cases described in the manual in section 4.2.3\n\nhttp:\/\/framework.zend.com\/manual\/en\/zend.auth.adapter.dbtable.html\n\nin your case\n\n{code}\n'MD5(?) AND deleted = 0' \/\/ for the treatment\n{code}\n\nIf not, please reopen.\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2009-01-11T21:57:13.000+0000",
                    "updated": "2009-01-11T21:57:13.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28113",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alias.mac",
                        "name": "alias.mac",
                        "displayName": "Filipe Guerra",
                        "active": true
                    },
                    "body": "I can't re-open this... at least I don't see anything to do that.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alias.mac",
                        "name": "alias.mac",
                        "displayName": "Filipe Guerra",
                        "active": true
                    },
                    "created": "2009-01-12T07:02:37.000+0000",
                    "updated": "2009-01-12T07:02:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28115",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "Can you explain how your use case is not solved by the above example? I can reopen if you add a comment (suprised you dont have access to reopen, ill look into that).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2009-01-12T07:10:20.000+0000",
                    "updated": "2009-01-12T07:10:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28116",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alias.mac",
                        "name": "alias.mac",
                        "displayName": "Filipe Guerra",
                        "active": true
                    },
                    "body": "At least when I reply (comment) directly in the website (link of the issue) I can't change status or anything, neither it is changed automatically.\n\nThanks for your time.\n\nAnyway the problem is when you have 2 rows with the same username (imagine that the first is deleted or something like that, deleted = 0 like you said above). So if you have 1 row with username = 'someone' and deleted=0 the sql query will return all the rows with username = 'someone' and then it has in the end a zend_auth column that is correctly filled. But! in PHP the code has something like if (count() > 0) then throw error... which is not correct. You can have several usernames that are equal and 1 or more of them are deleted (others can be inactive or something like that) and what it matters is that at least 1 of them is correct (i.e. it has username and all the other treatments with passwords, etc, are correct).\n\nSorry for the bad english :)\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alias.mac",
                        "name": "alias.mac",
                        "displayName": "Filipe Guerra",
                        "active": true
                    },
                    "created": "2009-01-12T07:28:37.000+0000",
                    "updated": "2009-01-12T07:28:37.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5139\/transitions"
}