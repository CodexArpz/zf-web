{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3076",
    "key": "ZF-3076",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Cache_Frontend_Page empty cache on non 200 HTTP status"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3076\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10240",
                    "id": 10240,
                    "description": "Minor Release",
                    "name": "1.6.0",
                    "userReleaseDate": "02\/Sep\/08",
                    "archived": false,
                    "releaseDate": "2008-09-02",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-05-09T01:52:10.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                "name": "at465",
                "displayName": "Andy Thompson",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-04-08T14:27:08.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-10-10T08:02:39.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I have come across a serious problem with using Frontent_Page when implementing additional HTTP status.\n\nThis includes the problem in issue #ZF-2841, but has more serious implications.\n\nThe frontend cache's a page no matter what HTTP status was sent in the response, and then serves it as though it was a HTTP\/1.x 200 OK.\n\nI have implemented correct Last-Modified\/If-Modified-Since behaviour in my website, and so it sends a HTTP\/1.1 304 Not Modified when the browser has an up to date cache.\n\nThe problem is, when I change the http status (php function header()), I exit the request, as is meant to be done. The ob_start callback then caches the blank response. Once this is in the cache, it will be served as a blank page on subsiquent requests.\n\nI would assume this would happen on any other HTTP status which involves any other way of sending alternative content\/behaviour (e.g. 206, 301, 307 even 404s?). The correct behaviour would be to only cache if the HTTP status was 200 (or have some alternative storage for redirects).\n\nI have tried looking for a php solution that would return the sent status, but not found any. Sadly headers_list does not include this. So I think the only way to fix this is to modify the php binary itself to include something that does this. Alternatively any cache\/redirect\/etc behaviour would need to be registered before hand by a Zend php class, but this wouldn't be ideal.\n\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3076\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                "name": "fab",
                "displayName": "Fabien MARTY",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10174",
                    "id": 10174,
                    "description": "Mini Release",
                    "name": "1.5.1",
                    "userReleaseDate": "25\/Mar\/08",
                    "archived": true,
                    "releaseDate": "2008-03-25",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10028",
                    "id": 10028,
                    "name": "Zend_Cache",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21124",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "Please evaluate and categorize\/assign as necessary.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-04-18T15:53:09.000+0000",
                    "updated": "2008-04-18T15:53:09.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21189",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "body": "I understand your problem. But there is no easy solution for this.\n\nI keep this issue open as a reminder\n\nWe will work soon on the \"headers\" part of Frontend_Page.  ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "created": "2008-04-19T03:24:23.000+0000",
                    "updated": "2008-04-19T03:24:23.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21201",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "body": "I think the simplest tidy solution at the moment would be to add a \"cancel\" method to the class, so in the very least, anyone who alters headers and exits can stop the page from being cached. e.g.\n\nheader('Location: \/newpage.html');\n$cache->cancel();\nexit;",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "created": "2008-04-19T07:17:06.000+0000",
                    "updated": "2008-04-19T07:17:06.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21215",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "body": "hum... good idea !\n\nI just commited in SVN trunk your cancel() method\n\ncan you give it a try ?\n\nthanks",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "created": "2008-04-19T16:18:56.000+0000",
                    "updated": "2008-04-19T16:18:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24112",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "Updating for the 1.6.0 release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-09-02T10:39:27.000+0000",
                    "updated": "2008-09-02T10:39:27.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39707",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=neutre",
                        "name": "neutre",
                        "displayName": "Yacine Filali",
                        "active": true
                    },
                    "body": "If anyone stumbles on this: The current option to solve the problem described here is memorize_headers.\r\n\r\nmemorize_headers  Array  array():  an array of strings corresponding to some HTTP headers name. Listed headers will be stored with cache datas and \"replayed\" when the cache is hit \r\n\r\nSee http:\/\/framework.zend.com\/manual\/en\/zend.cache.frontends.html",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=neutre",
                        "name": "neutre",
                        "displayName": "Yacine Filali",
                        "active": true
                    },
                    "created": "2010-04-01T10:48:37.000+0000",
                    "updated": "2010-04-01T10:48:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39713",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "body": "I'm not sure how you mean memorize_headers should be used for it. That is used to tell the cache what response headers to cache.\r\n\r\nThe response headers themselves are retrievable after being sent. Its just the HTTP status isn't, and a redirect or error can't be recognised to stop the cache.\r\n\r\nThe cancel method Fabien implemented, that's documented further down that page, is the only realistic workaround without a PHP binary fix.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=at465",
                        "name": "at465",
                        "displayName": "Andy Thompson",
                        "active": true
                    },
                    "created": "2010-04-01T12:42:52.000+0000",
                    "updated": "2010-04-01T12:44:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40131",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=neutre",
                        "name": "neutre",
                        "displayName": "Yacine Filali",
                        "active": true
                    },
                    "body": "Sorry, should have made myself clearer. I was responding to your comment about canceling when changing the Location header:\r\n\r\nheader('Location: \/newpage.html');\r\n$cache->cancel();\r\nexit;\r\n\r\nIn this case, the redirect will work if you simply add Location to memorize_headers.\r\n\r\nUnfortunately this does not help with Status no being replayed and the page cache will still return 200 OK when loading the page from cache instead of any 301 or 302 you may be setting with header or $response->setRawHeader...\r\n\r\nThe jist of it for me at least is: HTTP Error codes -> cancel cache using the cancel() method. HTTP Redirect codes: you can still cache the pages by adding 'Location' to memorize_headers, while the code will not be replayed, the Location header will be.\r\n\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=neutre",
                        "name": "neutre",
                        "displayName": "Yacine Filali",
                        "active": true
                    },
                    "created": "2010-04-19T12:54:05.000+0000",
                    "updated": "2010-04-19T12:54:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/52126",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arthurkang",
                        "name": "arthurkang",
                        "displayName": "Arthur Kang",
                        "active": true
                    },
                    "body": "Why not just memorize the response codes too?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=arthurkang",
                        "name": "arthurkang",
                        "displayName": "Arthur Kang",
                        "active": true
                    },
                    "created": "2012-10-10T08:02:39.000+0000",
                    "updated": "2012-10-10T08:02:39.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3076\/transitions"
}