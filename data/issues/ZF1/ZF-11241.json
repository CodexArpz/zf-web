{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11241",
    "key": "ZF-11241",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "View plugin loader - Registered paths at plugin controller predispatch point"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11241\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nuxwin",
                "name": "nuxwin",
                "displayName": "Laurent declercq",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-03-29T13:34:27.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-05-07T13:57:10.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Hello ;\r\n\r\n I want use my module view filters\/helpers in a plug-in controller at the *predispatch* point. Unfortunately, the plug-in loader linked to the view object has not my view helpers\/filters paths registered at this point. I've tried to do the same in my action controller and then, the paths are available.\r\n\r\nQuestion, why the modules paths (eg. view helpers and view filter) are not available at the *predispatch* point ? It's a bug or not ? Of course, I can register the paths by hand but I think that these paths should be discovered automatically, and not just at the action point.\r\n\r\n\r\n\r\n*To resume:*\r\n\r\nIn my plug-in controller, at \"predispatch\" point:\r\n{code:title=php|borderStyle=solid}\r\n$view = Zend_Controller_Front::getInstance()->getParam('bootstrap')->getResource('view');\r\necho '<pre>';\r\n\tprint_r($view->getPluginLoader('filter'));\r\necho '<\/pre>';\r\n{code}\r\n\r\n*Result:*\r\n{code:title=php|borderStyle=solid}\r\nZend_Loader_PluginLoader Object\r\n(\r\n    [_loadedPluginPaths:protected] => Array\r\n        (\r\n        )\r\n\r\n    [_loadedPlugins:protected] => Array\r\n        (\r\n        )\r\n\r\n    [_prefixToPaths:protected] => Array\r\n        (\r\n            [Zend_View_Filter_] => Array\r\n                (\r\n                    [0] => Zend\/View\/Filter\/\r\n                    [1] => \/var\/www\/imscp\/site\/themes\/default\/templates\/views\/filters\/\r\n                )\r\n\r\n            [iPMS_View_Filter_] => Array\r\n                (\r\n                    [0] => iPMS\/View\/Filter\/\r\n                )\r\n\r\n        )\r\n\r\n    [_useStaticRegistry:protected] => \r\n)\r\n{code}\r\n\r\n\r\n*In my controller action:*\r\n{code:title=php|borderStyle=solid}\r\necho '<pre>';\r\n\tprint_r($this->view->getPluginLoader('filter'));\r\necho '<\/pre>';\r\nexit;\r\n{code}\r\n\r\n*Result:*\r\n{code:title=php|borderStyle=solid}\r\nZend_Loader_PluginLoader Object\r\n(\r\n    [_loadedPluginPaths:protected] => Array\r\n        (\r\n        )\r\n\r\n    [_loadedPlugins:protected] => Array\r\n        (\r\n        )\r\n\r\n    [_prefixToPaths:protected] => Array\r\n        (\r\n            [Zend_View_Filter_] => Array\r\n                (\r\n                    [0] => Zend\/View\/Filter\/\r\n                    [1] => \/var\/www\/imscp\/site\/themes\/default\/templates\/views\/filters\/\r\n                )\r\n\r\n            [iPMS_View_Filter_] => Array\r\n                (\r\n                    [0] => iPMS\/View\/Filter\/\r\n                )\r\n\r\n            [Dashboard_View_Filter_] => Array\r\n                (\r\n                    [0] => \/var\/www\/imscp\/site\/application\/modules\/Dashboard\/views\/filters\/\r\n                )\r\n\r\n        )\r\n\r\n    [_useStaticRegistry:protected] => \r\n)\r\n{code}\r\n\r\nLike you can see here, the view filters path from my dashboard module is only available in my controller action. It's same for the view helpers path.\r\n\r\nThe expected result is like the last but at the plug-in controller *predispatch* point.\r\n\r\nSorry for my english, I'm french."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11241\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10540",
                    "id": 10540,
                    "description": "Mini Release",
                    "name": "1.11.4",
                    "userReleaseDate": "03\/Mar\/11",
                    "archived": false,
                    "releaseDate": "2011-03-03",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10550",
                    "id": 10550,
                    "description": "Mini Release",
                    "name": "1.11.5",
                    "userReleaseDate": "07\/Apr\/11",
                    "archived": false,
                    "releaseDate": "2011-04-07",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10580",
                    "id": 10580,
                    "description": "Mini Release",
                    "name": "1.11.6",
                    "userReleaseDate": "05\/May\/11",
                    "archived": false,
                    "releaseDate": "2011-05-05",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10011",
                    "id": 10011,
                    "name": "Zend_Controller",
                    "description": "front controller, including router and dispatcher",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45665",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nuxwin",
                        "name": "nuxwin",
                        "displayName": "Laurent declercq",
                        "active": true
                    },
                    "body": "Re ;\r\n\r\nAfter a little research, it's seem that the paths to module filters\/helpers are added by the *ViewRenderer* action helper that is initialized when the action controller is instantiated and not before...\r\n\r\n{quote}\r\nZend_Controller_Action::__construct()\r\n\t-- $this->_helper = new Zend_Controller_Action_HelperBroker($this);\r\n\t\t--  Zend_Controller_Action_Helper_ViewRenderer::setActionController($actionController);\r\n\t\t--  Zend_Controller_Action_Helper_ViewRenderer::init(); \r\n\t\t-------Zend_Controller_Action_Helper_ViewRenderer::initView() \r\n...\r\n{quote}\r\n\r\nSo, the Zend_Controller_Action_Helper_ViewRenderer uses the module name as class prefix for helpers and views such that if the module name is 'Dashboard', it will set the helper lass prefix to 'Dashboard_View_Helper' and 'the filter class prefix to 'Dashboard_View_Filter...\r\n\r\nThis behavior explain why the specific view paths (filters\/helpers) for modules are not registered in the plugin Loader linked to the view at the *preDispatch* point since the action controller is instantiated later. Unfortunately, that mean too that we cannot use any of them at this point (eg. in plugin).\r\n\r\nOf course, like already said, we can register them by hand but is a bit annoying in my opinion. We can not more use them at the *postDispatch* point since the rendering process is already done. In fact, we can but in some case, that can pose some problems such as when we use the jQuery view Helper.\r\n\r\nSo, it seem that in your current vision, it's the expected behavior. Now, my question is simple: What's the better solution to have the modules view filters\/helpers paths registered in the view plugin Loader at the *preDispatch* point.\r\n\r\nThanks in advance for any answer.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nuxwin",
                        "name": "nuxwin",
                        "displayName": "Laurent declercq",
                        "active": true
                    },
                    "created": "2011-03-29T17:43:34.000+0000",
                    "updated": "2011-03-29T17:43:34.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/45794",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nuxwin",
                        "name": "nuxwin",
                        "displayName": "Laurent declercq",
                        "active": true
                    },
                    "body": "No new because it's tagged as 'improvement' or ?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nuxwin",
                        "name": "nuxwin",
                        "displayName": "Laurent declercq",
                        "active": true
                    },
                    "created": "2011-04-04T10:14:24.000+0000",
                    "updated": "2011-04-04T10:14:24.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11241\/transitions"
}