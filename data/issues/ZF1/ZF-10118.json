{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10118",
    "key": "ZF-10118",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Speed improvement for Zend_Form_Element"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/11",
                "name": "Patch",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10118\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bugslayer",
                "name": "bugslayer",
                "displayName": "John Crenshaw",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-07-07T16:58:40.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-06-09T16:49:33.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Form elements each get their own set of plugin loaders. At 3 per element, this overhead adds up fast with large forms, or pages that heavily use multiple forms. In the most common cases, there is no reason for this. The default plugin loaders are fine, and can be reused.\r\n\r\nI've included a patch that uses a set of shared static loaders by default. Special loaders can be set on a per element basis as needed (just like before). This seems to improve speed by 10%-20% on the large forms I was testing. There is a mechanism for ignoring the static loaders, but it's probably not needed, so feel free to remove it.\r\n\r\n{noformat}\r\n\r\nIndex: Element.php\r\n===================================================================\r\n--- Element.php\t(revision 936)\r\n+++ Element.php\t(working copy)\r\n@@ -141,8 +141,20 @@\r\n      * Element label\r\n      * @var string\r\n      *\/\r\n-    protected $_label;\r\n-\r\n+    protected $_label;\r\n+    \r\n+    \/**\r\n+     * Static plugin loaders (improves performance)\r\n+     * @var array\r\n+     *\/\r\n+    static protected $_staticLoaders = array();\r\n+\r\n+    \/**\r\n+     * Option to disable static loaders if needed\r\n+     * @var boolean\r\n+     *\/\r\n+    static protected $_useStaticLoaders = true;\r\n+    \r\n     \/**\r\n      * Plugin loaders for filter and validator chains\r\n      * @var array\r\n@@ -1000,15 +1012,28 @@\r\n                     $prefixSegment = 'Form_Decorator';\r\n                     $pathSegment   = 'Form\/Decorator';\r\n                 }\r\n-                if (!isset($this->_loaders[$type])) {\r\n-                    require_once 'Zend\/Loader\/PluginLoader.php';\r\n-                    $this->_loaders[$type] = new Zend_Loader_PluginLoader(\r\n-                        array('Zend_' . $prefixSegment . '_' => 'Zend\/' . $pathSegment . '\/')\r\n-                    );\r\n+                if (!isset($this->_loaders[$type])) {\r\n+                    if (self::$_useStaticLoaders && isset(self::$_staticLoaders[$type]))\r\n+                    {\r\n+                      $this->_loaders[$type] = self::$_staticLoaders[$type];\r\n+                    }\r\n+                    else\r\n+                    {\r\n+                      require_once 'Zend\/Loader\/PluginLoader.php';\r\n+                      $this->_loaders[$type] = new Zend_Loader_PluginLoader(\r\n+                          array('Zend_' . $prefixSegment . '_' => 'Zend\/' . $pathSegment . '\/')\r\n+                      );\r\n+                      \r\n+                      if (self::$_useStaticLoaders)\r\n+                      {\r\n+                        \/\/ this is our new static loader\r\n+                        self::$_staticLoaders[$type] = $this->_loaders[$type];\r\n+                      }\r\n+                    }\r\n                 }\r\n                 return $this->_loaders[$type];\r\n             default:\r\n                 require_once 'Zend\/Form\/Exception.php';\r\n                 throw new Zend_Form_Exception(sprintf('Invalid type \"%s\" provided to getPluginLoader()', $type));\r\n         }\r\n     }\r\n\r\n{noformat}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10118\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                "name": "alab",
                "displayName": "Christian Albrecht",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13193",
                    "filename": "Element.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bugslayer",
                        "name": "bugslayer",
                        "displayName": "John Crenshaw",
                        "active": true
                    },
                    "created": "2010-07-07T20:05:54.000+0000",
                    "size": 2302,
                    "mimeType": "text\/x-diff",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13193\/Element.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10430",
                    "id": 10430,
                    "description": "Mini Release",
                    "name": "1.10.2",
                    "userReleaseDate": "24\/Feb\/10",
                    "archived": false,
                    "releaseDate": "2010-02-24",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41383",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "body": "Did you run the unittests with this patch? If so, did all tests pass?\r\n\r\nAlso, as a sidenote for a next time; often it helps if you attach a patch as a file rather than inline, so people can easily wget it ;)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "created": "2010-07-07T18:19:19.000+0000",
                    "updated": "2010-07-07T18:19:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41385",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bugslayer",
                        "name": "bugslayer",
                        "displayName": "John Crenshaw",
                        "active": true
                    },
                    "body": "No, I didn't run the tests (I actually deleted them locally some time ago assuming I didn't need them.)\r\n\r\nI actually intended to attach a patch file, but there wasn't an upload field when I created the ticket.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bugslayer",
                        "name": "bugslayer",
                        "displayName": "John Crenshaw",
                        "active": true
                    },
                    "created": "2010-07-07T20:03:46.000+0000",
                    "updated": "2010-07-07T20:03:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47055",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "body": "This patch introduces one error and two failures. John - could you provide a new patch and make sure you have signed CLA.\r\n\r\n{code}\r\n$ cd tests\r\n$ phpunit Zend\/Form\/AllTests.php\r\n\r\n...\r\n\r\nThere was 1 error:\r\n\r\n1) Zend_Form_Element_RadioTest::testCustomLabelDecorator\r\n\r\n\/home\/kim\/workspace\/zf\/tests\/Zend\/Form\/Element\/RadioTest.php:184\r\n\r\n--\r\n\r\n\r\nThere were 2 failures:\r\n\r\n1) Zend_Form_ElementTest::testAddingFilterPluginLoaderPrefixPathDoesNotAffectOtherLoaders\r\nFailed asserting that \r\nArray\r\n(\r\n    [0] => Zend\/Form\/\r\n)\r\n is false.\r\n\r\n\/home\/kim\/workspace\/zf\/tests\/Zend\/Form\/ElementTest.php:609\r\n\r\n2) Zend_Form_FormTest::testCustomGlobalElementPrefixPathUsedInNewlyCreatedElements\r\nZend_Form_Decorator_Label\r\nFailed asserting that <boolean:false> is true.\r\n\r\n\/home\/kim\/workspace\/zf\/tests\/Zend\/Form\/FormTest.php:3764\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "created": "2011-06-08T16:30:49.000+0000",
                    "updated": "2011-06-08T16:30:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47066",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bugslayer",
                        "name": "bugslayer",
                        "displayName": "John Crenshaw",
                        "active": true
                    },
                    "body": "If I get a minute, I'll try to work out what is happening there.\r\n\r\nIs there any documentation on setting things up to run the unit tests? I tried to run them a year ago after your prior comment, but it seemed like I got more skip and error than anything else, seemingly due to lack of configuration on various stuff.\r\n\r\nWhere do I check whether I signed the CLA? I think I did a while back, but I don't remember for certain.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bugslayer",
                        "name": "bugslayer",
                        "displayName": "John Crenshaw",
                        "active": true
                    },
                    "created": "2011-06-08T23:53:12.000+0000",
                    "updated": "2011-06-08T23:53:12.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47094",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "body": "John - you can start by running test only for form element and when everything is right then run all form related tests. To run these tests you don't have to set any configurations.\r\n\r\n{code}\r\n$ cd tests\r\n$ phpunit Zend\/Form\/ElementTest.php # Zend Form Element tests\r\n$ phpunit Zend\/Form\/AllTests.php # All Zend Form related tests\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "created": "2011-06-09T16:49:33.000+0000",
                    "updated": "2011-06-09T16:49:33.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10118\/transitions"
}