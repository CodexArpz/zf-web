{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5269",
    "key": "ZF-5269",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "String conversion issues related to issues for ZF-5030\/ZF-5077"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5269\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/3",
                "name": "Duplicate"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-12-16T11:36:41.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=zijin",
                "name": "zijin",
                "displayName": "Zijin Huang",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-12-15T13:30:54.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-03-31T02:29:29.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Reproducable on Zend Framework version 1.7.1 on PHP v5.1.6\n\n\n{code}\nerror_reporting(E_ALL);\nini_set('display_errors', 1);\ndate_default_timezone_set('Europe\/London');\n\nset_include_path('.'\n\t. PATH_SEPARATOR . '.\/library2\/'\n\t. PATH_SEPARATOR . get_include_path());\n\nrequire_once('Zend\/Loader.php');\nZend_Loader::registerAutoload();\n\n$locale = new Zend_Locale('en_GB');\n$date = new Zend_Date('11\/12\/2008', 'd\/m\/Y', $locale);\necho $date;\n{code}\n \nAbove code will produce the following:\n\n{code}\nFatal error: Uncaught exception 'Zend_Date_Exception' with message ''Object id #1' is not a known locale.' in \/home\/vhost\/www\/library2\/Zend\/Date.php:2576 \nStack trace: \n#0 \/home\/vhost\/www\/library2\/Zend\/Date.php(1181): Zend_Date->_calculate('set', '11\/12\/2008', 'd\/m\/Y', 'Object id #1') \n#1 \/home\/vhost\/www\/library2\/Zend\/Date.php(212): Zend_Date->set('11\/12\/2008', 'd\/m\/Y', 'Object id #1') \n#2 \/home\/vhost\/www\/test.php(20): Zend_Date->__construct('11\/12\/2008', 'd\/m\/Y', Object(Zend_Locale)) \n#3 {main} thrown in \/home\/vhost\/www\/library2\/Zend\/Date.php on line 2576\n{code}\n\nAppears to realted to issue ZF-5030 \/ ZF-5077, the toString() method for PHP version < 5.2\nhttp:\/\/www.php.net\/manual\/en\/language.oop5.magic.php\n\nCurrently with 1.7.1, we have in Zend\/Date.php:\n{code}\n    \/**\n     * Sets a new standard locale for the date object.\n     * This locale will be used for all functions\n     * Returned is the really set locale.\n     * Example: 'de_XX' will be set to 'de' because 'de_XX' does not exist\n     * 'xx_YY' will be set to 'root' because 'xx' does not exist\n     *\n     * @param  string|Zend_Locale $locale (Optional) Locale for parsing input\n     * @throws Zend_Date_Exception When the given locale does not exist\n     * @return Zend_Date Provides fluent interface\n     *\/\n    public function setLocale($locale = null)\n    {\n        if (!Zend_Locale::isLocale($locale, true, false)) {\n            if (!Zend_Locale::isLocale($locale, false, false)) {\n                require_once 'Zend\/Date\/Exception.php';\n                throw new Zend_Date_Exception(\"Given locale ({$locale}) does not exist\", (string) $locale);\n            }\n\n            $locale = new Zend_Locale($locale);\n        }\n\n        $this->_locale = (string) $locale;\n        return $this;\n    }\n{code}\n\nIf I change to the following, using ($locale->toString()), everything appear to work then:\n{code}\n    \/**\n     * Sets a new standard locale for the date object.\n     * This locale will be used for all functions\n     * Returned is the really set locale.\n     * Example: 'de_XX' will be set to 'de' because 'de_XX' does not exist\n     * 'xx_YY' will be set to 'root' because 'xx' does not exist\n     *\n     * @param  string|Zend_Locale $locale (Optional) Locale for parsing input\n     * @throws Zend_Date_Exception When the given locale does not exist\n     * @return Zend_Date Provides fluent interface\n     *\/\n    public function setLocale($locale = null)\n    {\n        if (!Zend_Locale::isLocale($locale, true, false)) {\n            if (!Zend_Locale::isLocale($locale, false, false)) {\n                require_once 'Zend\/Date\/Exception.php';\n                throw new Zend_Date_Exception(\"Given locale ({$locale}) does not exist\", (string) $locale);\n            }\n\n            $locale = new Zend_Locale($locale);\n        }\n\n        $this->_locale = $locale->toString();\n        return $this;\n    }\n{code}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5269\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10270",
                    "id": 10270,
                    "description": "Mini Release",
                    "name": "1.7.1",
                    "userReleaseDate": "01\/Dec\/08",
                    "archived": false,
                    "releaseDate": "2008-12-01",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10072",
                    "id": 10072,
                    "name": "Zend_Date",
                    "description": "Zend_Date is the basic library for the handling of all date, time and calendar-related issues.",
                    "isAssigneeTypeValid": false
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10073",
                    "id": 10073,
                    "name": "Zend_Locale",
                    "description": "Zend_Locale is a basic wrapper for all I18N and L10N issues for the Zend Framework. It provides the userbasically with access to translation functionality. It can handle different source file types for translation.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/27352",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Your change forces object as you can not call toString on a string value.\nAlso for ZF 1.7.1 the minimum supported PHP release is 5.2.4",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-12-16T11:36:40.000+0000",
                    "updated": "2008-12-16T11:36:40.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29831",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=amumia",
                        "name": "amumia",
                        "displayName": "Miguel Manso",
                        "active": true
                    },
                    "body": "I made this chage to line 4537:\n\nif (gettype($locale) == 'object') {\n    $this->_locale = $locale->toString();\n} else {\n    $this->_locale = (string) $locale;\n}\n\nIt worked on both cases.\nI have:\nphp 5.2.8 (mac osx ports) - ZF 1.7.4\nand:\nphp 5.1.6 (CentOS release 5  2.6.18-53.1.13.el5) - ZF 1.7.4\n\nOn mac osx the 1.7.4 version worked like a charm, but when i moved to the linux machine it all went wrong.\nI tried to apply the fix suggested in this post and i inverted the results...\n\nSo i did the fix above and it started working on both systems.\n\nHope this helps.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=amumia",
                        "name": "amumia",
                        "displayName": "Miguel Manso",
                        "active": true
                    },
                    "created": "2009-03-31T02:29:26.000+0000",
                    "updated": "2009-03-31T02:29:26.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5269\/transitions"
}