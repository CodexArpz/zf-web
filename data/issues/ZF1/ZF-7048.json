{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7048",
    "key": "ZF-7048",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_View_Helper_FormRadio creates invalid labels and id's"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7048\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=htbaa",
                "name": "htbaa",
                "displayName": "Christiaan Kras",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-06-19T03:25:12.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-07-08T07:16:17.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "Zend_View_Helper_FormRadio",
                "duplicate_ids",
                "duplicate_labels"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "There's a problem when passing an array to Zend_View_Helper_FormRadio that contains positive and negative values,\n\nThis array for example\n{code}\n\t$opties = array('1' \t=> 'Some option',\n\t\t\t\t    '-1'\t=> 'Another option');\n{code}\n\nWill generate 2 radio buttons with the id \"myname-1\". Duplicate id's are not allowed and it also disables you from choosing the desired option. When you choose 'Another option' by clicking the label the radio button for 'Some option'  will be selected."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7048\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10331",
                    "id": 10331,
                    "description": "Mini Release",
                    "name": "1.8.3",
                    "userReleaseDate": "09\/Jun\/09",
                    "archived": false,
                    "releaseDate": "2009-06-09",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10026",
                    "id": 10026,
                    "name": "Zend_View",
                    "description": "View portion of the ZF MVC",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32502",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Component assigned",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-07-09T23:42:42.000+0000",
                    "updated": "2009-07-09T23:42:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/33174",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=snover",
                        "name": "snover",
                        "displayName": "C Snover",
                        "active": true
                    },
                    "body": "Although we can't quite match on the full list of valid characters since PHP's regular expressions can't match Unicode character ranges, creating and using this filter instead of the Alnum filter should work for all cases when only 7-bit characters are used in IDs (which should be pretty much always):\n\n{code}\n<?php\n\n\/**\n * @see Zend_Filter_Interface\n *\/\nrequire_once 'Zend\/Filter\/Interface.php';\n\nclass Zend_Filter_XmlName implements Zend_Filter_Interface\n{\n    \/**\n     * Defined by Zend_Filter_Interface\n     *\n     * Returns the string $value, removing all characters not valid in an XML\n     * name as defined by http:\/\/www.w3.org\/TR\/REC-xml\/#id.\n     *\n     * Note that this currently only allows 7-bit-safe characters since\n     * preg_replace does not support pattern matching on unicode character\n     * ranges.\n     *\n     * @param  string $value\n     * @return string\n     *\/\n    public function filter($value)\n    {\n        $value = preg_replace('\/[^A-Za-z0-9:_.-]\/', '', (string) $value);\n        return substr($value, strspn($value, '0123456789.-'));\n    }\n}\n{code}\n\nPatch against 1.8.4PL1:\n{code}\nIndex: Zend\/View\/Helper\/FormRadio.php\n===================================================================\n--- Zend\/View\/Helper\/FormRadio.php      (revision 16719)\n+++ Zend\/View\/Helper\/FormRadio.php      (working copy)\n@@ -129,8 +129,8 @@\n         }\n\n         \/\/ add radio buttons to the list.\n-        require_once 'Zend\/Filter\/Alnum.php';\n-        $filter = new Zend_Filter_Alnum();\n+        require_once 'Zend\/Filter\/XmlName.php';\n+        $filter = new Zend_Filter_XmlName();\n         foreach ($options as $opt_value => $opt_label) {\n\n             \/\/ Should the label be escaped?\n@@ -153,7 +153,7 @@\n             }\n\n             \/\/ generate ID\n-            $optId = $id . '-' . $filter->filter($opt_value);\n+            $optId = $filter->filter($id . '-' . $opt_value);\n\n             \/\/ Wrap the radios in labels\n             $radio = '<label'\n{code}\n\nThere are probably other cases where this new filter should be used as well but I am not going to go looking for them right now. :)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=snover",
                        "name": "snover",
                        "displayName": "C Snover",
                        "active": true
                    },
                    "created": "2009-08-03T20:25:28.000+0000",
                    "updated": "2009-08-03T20:25:28.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47389",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sukebe",
                        "name": "sukebe",
                        "displayName": "Dmitry Plenkin",
                        "active": true
                    },
                    "body": "Fixed in 1.11.8\r\nHell yeah!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=sukebe",
                        "name": "sukebe",
                        "displayName": "Dmitry Plenkin",
                        "active": true
                    },
                    "created": "2011-07-08T07:16:17.000+0000",
                    "updated": "2011-07-08T07:16:17.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7048\/transitions"
}