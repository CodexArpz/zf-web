{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2599",
    "key": "ZF-2599",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Object-variables and add\/getAttribs() in Zend_Form_Element"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2599\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-02-08T06:59:14.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=brati",
                "name": "brati",
                "displayName": "Stefan Koch",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-02-07T16:43:39.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-02-08T07:01:55.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Hello,\n\nI found a bug in the Zend_Form_Element class today. You assign the added attributes (function addAttrib()) directly to a object-variable of the class.\nThe code's here\n{code}    \/**\n     * Set element attribute\n     * \n     * @param  string $name \n     * @param  string $value \n     * @return Zend_Form_Element\n     * @throws Zend_Form_Exception for invalid $name values\n     *\/\n    public function setAttrib($name, $value)\n    {\n        $name = (string) $name;\n        if ('_' == $name[0]) {\n            require_once 'Zend\/Form\/Exception.php';\n            throw new Zend_Form_Exception(sprintf('Invalid attribute \"%s\"; must not contain a leading underscore', $name));\n        }\n\n        if (null === $value) {\n            unset($this->$name);\n        } else {\n            $this->$name = (string) $value;\n        }\n\n        return $this;\n    }{code}\n\nSo far no problem. But when it comes to receiving the attributes with the method getAttribs() (mark the plural form) the application crashes. You use the ReflectionObject and ReflectionProperty classes. With ReflectionProperty, you try to check if the given variable (property) is public.\n{code}    \/**\n     * Return all attributes\n     * \n     * @return array\n     *\/\n    public function getAttribs()\n    {        \n        $r = new ReflectionObject($this);\n        $properties = $r->getProperties();\n        $attribs = array();\n        foreach ($properties as $property) {\n            if ($property->isPublic())\n                $attribs[$property->getName()] = $property->getValue($this);\n        }\n\n        return $attribs;\n    }{code}\n\nThis crashes because of the assignment without declaring the variable at the beginning of the method as public, portected or private: There seems to be no such scope given. The application just ends without any PHP-error (display_errors is on and error_reporting is put to E_ALL|E_STRICT) or Zend Exception.\n{code}$this->$name = (string) $value; # (mark: bad assignment, since the variable wasn't declared before){code}\n\nI can say this so sure, because I did a lot of debugging to find out that the problem is in the line\nif ($property->isPublic())\nand then tried to declare the variable $id at the beginning of the class as public (public $id;). I was able to assign an attribute with the name \"id\" now, and it didn't crash.\n\nI wonder: Why didn't you use an array to save the attributes instead of creating variables in the class which were not declared before, which seems very bad to me?\nIs this a general problem or only with my version of PHP (php-5.2.0-8+etch10 (Debian GNU\/Linux))?\n\nI hope that you can understand what I mean though my English isn't perfect. :)\nI marked the issue as \"Minor\" since this only seems to affect the usage of addAttrib(s) in the Zend_Form_Element class (and of course the subclasses of this one).\n\n\n\nEdit: I was just told that the issue has already been solved in a Incubation version of Zend. So you can mark this issue as solved, though adding new variables to a class without declaring them seems like bad bahaviour to me."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2599\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10160",
                    "id": 10160,
                    "description": "Major Release",
                    "name": "Next Major Release",
                    "archived": false,
                    "released": false
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/18949",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Please, before posting issues, check the issue tracker as well as the current trunk (accessible via http:\/\/framework.zend.com\/fisheye\/ if you are not tracking current SVN).\n\nThis issue was reported in ZF-2526 and ZF-2518, and is fixed in trunk; it only affected PHP <= 5.2.0, and now works correctly.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-02-08T06:59:14.000+0000",
                    "updated": "2008-02-08T06:59:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/18951",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "{quote}\nthough adding new variables to a class without declaring them seems like bad bahaviour to me\n{quote}\n\nWhile I agree that this is not a desirable situation, unfortunately there are language level issues that require this approach (I won't document them here as they have been documented elsewhere in the tracker, on the lists, and on my own blog). Those issues have been solved in recent PHP versions, but due to the minimum required version supported by ZF, we need to use this approach to ensure that the code works for all users.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-02-08T07:01:55.000+0000",
                    "updated": "2008-02-08T07:01:55.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2599\/transitions"
}