{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4657",
    "key": "ZF-4657",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Validate_Date('yyyy\/MM\/dd') returns FALSE but should return TRUE"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4657\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10241",
                    "id": 10241,
                    "description": "Minor Release",
                    "name": "1.8.0",
                    "userReleaseDate": "30\/Apr\/09",
                    "archived": false,
                    "releaseDate": "2009-04-30",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-11-27T14:37:04.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=aselvais",
                "name": "aselvais",
                "displayName": "Arnaud Selvais",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-10-20T18:52:32.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-11-27T14:37:04.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I understand what you are saying and that is why I insist on this... and posted a new example.\nI understand changer the timezone after the a Zend_Date object has been instanciated will result in problem as Zend_Date should be based on the default timezone.\n\nIn my environement, the default timezone is not set in the php.ini, so I set it ONCE :) in the bootstrap; then I have some problems with the date validator. So in my last example, I tried to reproduce the problem in a simple script (without MVC, forms and so on...). I set the default time zone in the begining of the script (and I won't change it) and I get different result if it is set to the US or China... Same thing if I change the default timezone explicitly in the php.ini and I do not set it in the script...\n\nI get an unexpected result when I define the format 'yyyy\/MM\/dd' + timezone China but not with the default format.\n\n\n\n------------------------------------------------------\n\nSorry it seems I don't have the right to add a comment... That's why I am editing the issue.\n\nAbout the issue; If this behavior is normal, the documentation at http:\/\/framework.zend.com\/manual\/en\/zend.date.html#zend.date.setdefaulttimezone is ambiguous or wrong then.\n\nAbout the code I sent, even if I set the default timezone once then instantiate Zend_date\n\n{code} \ndate_default_timezone_set(\"Asia\/Taipei\");\n\nrequire_once 'Zend\/Validate\/Date.php';\n$date = \"1980\/06\/30\";\n$vali = new Zend_Validate_Date('yyyy\/MM\/dd');\n\nprint \"\\n\".date_default_timezone_get().\"\\n\";\n$result = $vali->isValid($date);\nvar_dump($result);\n{code} \n\noutputs:\n{code} \nAsia\/Taipei\nbool(false)\n{code} \n\nIn the documentation it is specified:\n\"When creating Zend_Date instances, their timezone will automatically become the current default timezone!\"\nSo is there something I do not get? :)\n\n\n------------------------------------------------------\n\nThis is another spooky example:\n\n*CODE:*\n{code} \nrequire_once 'Zend\/Validate\/Date.php';\n$date = \"1980\/06\/30\";\n$vali = new Zend_Validate_Date('yyyy\/MM\/dd');\n\nprint \"\\n\".date_default_timezone_get().\"\\n\";\n$result = $vali->isValid($date);\nvar_dump($result);\n\ndate_default_timezone_set(\"Asia\/Taipei\");\nprint \"\\n\".date_default_timezone_get().\"\\n\";\n$result = $vali->isValid($date);\nvar_dump($result);\n{code} \n\n*OUTPUT:*\n{code} \nAmerica\/New_York\nbool(true)\n\nAsia\/Taipei\nbool(false)\n{code} \n\n\n--------------------------------------------\n\nFor some specific dates, Zend_Validate_Date when defining a specific format does not return an expected result:\n\n*Expected behavior*\n$date = \"1980-06-30\";\n$vali = new Zend_Validate_Date();\n\/\/ $vali->isValid($date) returns TRUE\n\n*UNexpected behavior !!!*\n$date = \"1980\/06\/30\";\n$vali = new Zend_Validate_Date('yyyy\/MM\/dd');\n\/\/ $vali->isValid($date) returns FALSE but should be TRUE\n\n*Expected behavior*\n$date = \"1980\/06\/29\";\n$vali = new Zend_Validate_Date('yyyy\/MM\/dd');\n\/\/ $vali->isValid($date) returns TRUE\n\n\nThis is a big problem for me as I use a date validator on a form for an order entry tool using this format of date (for China). So in this case the customer born the June 30th 1980 can not by the product we sell... I had to implement a custom validator to treat this issue. \n\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4657\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10240",
                    "id": 10240,
                    "description": "Minor Release",
                    "name": "1.6.0",
                    "userReleaseDate": "02\/Sep\/08",
                    "archived": false,
                    "releaseDate": "2008-09-02",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10201",
                    "id": 10201,
                    "description": "Mini Release",
                    "name": "1.6.1",
                    "userReleaseDate": "15\/Sep\/08",
                    "archived": false,
                    "releaseDate": "2008-09-15",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10251",
                    "id": 10251,
                    "description": "Mini Release",
                    "name": "1.6.2",
                    "userReleaseDate": "13\/Oct\/08",
                    "archived": false,
                    "releaseDate": "2008-10-13",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10252",
                    "id": 10252,
                    "description": "Minor Preview Release",
                    "name": "1.7 Preview Release",
                    "userReleaseDate": "13\/Oct\/08",
                    "archived": true,
                    "releaseDate": "2008-10-13",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10140",
                    "id": 10140,
                    "name": "Zend_Validate",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25254",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I reworked you example:\n{code}\nrequire_once 'Zend\/Validate\/Date.php';\n\n$date = \"1980\/06\/30\";\n$vali = new Zend_Validate_Date('yyyy\/MM\/dd');\n$result = $vali->isValid($date);  \/\/ returns FALSE but should be TRUE\nvar_dump($result);\n{code}\n\nBut I get a boolean TRUE returned.\nI can't reproduce your problem.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-10-21T01:42:48.000+0000",
                    "updated": "2008-10-21T01:42:48.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25258",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Please add comments instead of changing the original issue",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-10-21T07:40:53.000+0000",
                    "updated": "2008-10-21T07:40:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25259",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Your second code is a handling problem...\n\nWhen you change the base timezone within your code, of course also the returned date object will differ.\nChanging the timezone can only work when you do this within the object and not within the configuration.\n\nSorry, but this is not a problem... see setTimezone() for proper changing of timezones for date objects.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-10-21T07:45:08.000+0000",
                    "updated": "2008-10-21T07:45:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25264",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "When you set Zend_Date to the default timezone and then change this timezone (in php) afterwards, then the default timezone is different from before.\n\nIt is logically impossible that the date is not changed in this case. The thing is that you must not change the default timezone multiple times in your script. This is a no-no in every language !!\n\nThis note is only to remember users that they must set a default timezone in their bootstrap because in some php environments it is not set, and then unexpected results will occur.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-10-21T10:45:27.000+0000",
                    "updated": "2008-10-21T10:45:27.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26798",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "This is a reproducable php bug which can not be solved by ZF.\n\nTry the following code for reproduction:\n{code}\ndate_default_timezone_set(\"Asia\/Taipei\");\n\nprint \"\\n1:\".date('m.d.Y H:i:s', 331056000);\nprint \"\\n2:\".date('m.d.Y H:i:s', 331142400);\n{code}\n\nAs you see 1. returns 06.29.2008 00:00:00\nBut 2. returns 06.30.2008 01:00:00\n\nAs one day has 86400 seconds the initial values given to the two dates are correct.\n\nThere is one hour more than it should be.\nThis date is no dst change so it seems to be a php bug.\nThere is no way for ZF to fix such a deep bug.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-11-27T14:37:03.000+0000",
                    "updated": "2008-11-27T14:37:03.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4657\/transitions"
}