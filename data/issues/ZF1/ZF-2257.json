{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2257",
    "key": "ZF-2257",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Acl - access control list processing error"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2257\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10240",
                    "id": 10240,
                    "description": "Minor Release",
                    "name": "1.6.0",
                    "userReleaseDate": "02\/Sep\/08",
                    "archived": false,
                    "releaseDate": "2008-09-02",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-04-02T07:45:59.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=motzel",
                "name": "motzel",
                "displayName": "Bogdan Modzelewski",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2007-12-03T13:23:00.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-09-02T10:39:15.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Bug example follows:\n\n{code}\nrequire_once 'Zend\/Acl.php';\nrequire_once 'Zend\/Acl\/Resource.php';\nrequire_once 'Zend\/Acl\/Role.php';\n\n$acl = new Zend_Acl();\n\n$acl->addRole(new Zend_Acl_Role('foo'));\n$acl->add(new Zend_Acl_Resource('bar'));\n\n$acl->allow('foo','bar');\n$acl->deny('foo');\n\necho 'access to bar by foo is '.($acl->isAllowed('foo','bar') ? 'allowed' : 'denied');\n{code}\n\nI've encountered an error during processing simple ACL.\nFirst, we allow acces to resource 'bar' by 'foo' role, and then we deny access to all resources by this role.\nExpecting result is 'denied', but unfortunately 'allowed' appears on screen...\n\nACL works as expected when we explictly pass a resource to deny method, - try change last acl line to:\n\n{code}\n$acl->deny('foo','bar');\n{code}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2257\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                "name": "darby",
                "displayName": "Darby Felton",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10140",
                    "id": 10140,
                    "description": "Mini Release",
                    "name": "1.0.3",
                    "userReleaseDate": "30\/Nov\/07",
                    "archived": true,
                    "releaseDate": "2007-11-30",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10070",
                    "id": 10070,
                    "name": "Zend_Acl",
                    "description": "Access control list authorization component",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/19207",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jordanryanmoore",
                        "name": "jordanryanmoore",
                        "displayName": "Jordan Ryan Moore",
                        "active": true
                    },
                    "body": "This is not a bug, it works as intended. $acl->deny('foo') means deny 'foo' access to all resources where other rules have not been defined. It basically sets a default.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jordanryanmoore",
                        "name": "jordanryanmoore",
                        "displayName": "Jordan Ryan Moore",
                        "active": true
                    },
                    "created": "2008-02-17T23:49:49.000+0000",
                    "updated": "2008-02-17T23:49:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20581",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "Please evaluate and categorize as necessary.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-03-31T16:14:04.000+0000",
                    "updated": "2008-03-31T16:14:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20590",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=motzel",
                        "name": "motzel",
                        "displayName": "Bogdan Modzelewski",
                        "active": true
                    },
                    "body": "I still think that it's a bug.\n\nIf $acl->allow('foo') gives access to ALL resources to foo role, then why $acl->deny('foo') doesn't do opposite ? \nIf, as you say, $acl->deny('foo') means deny 'foo' access to all resources where other rules have not been defined then why\n$acl->deny('foo', 'bar') doesn't mean the same (deny 'foo' access to 'bar' WHERE OTHER RULES HAVE NOT BEEN DEFINED) ???\n\nBesides, I'd understand your explanation if it really should be used to set a default values, BUT it is the way acl works by default WITHOUT explictly calling $acl->deny(). So what is a deny() method() possible NULL values for? If it shouldn't be called with NULL values then why are they declared as default in following php implementation?\n \npublic function deny($roles = null, $resources = null, $privileges = null, Zend_Acl_Assert_Interface $assert = null) \n\nYou should throw an exception in such a situation and not declare it as default.\n\nAfter I review ZF ACL php code It looks for me like that it is a consequence of chosen implementation and it's not easily fixable. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=motzel",
                        "name": "motzel",
                        "displayName": "Bogdan Modzelewski",
                        "active": true
                    },
                    "created": "2008-04-01T02:42:38.000+0000",
                    "updated": "2008-04-01T02:42:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20595",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=octavian",
                        "name": "octavian",
                        "displayName": "Marc Jakubowski",
                        "active": true
                    },
                    "body": "I agree with you, Bogdan, that it is very confusing. \nThe documentation should make clear, that a \"null\" value doesn\u00b4t actually mean \"all\" roles\/resources but \"all, if not defined otherwise\".\n\nBut I think a change to this issue would have some performance impact as in your example, the whole rule tree would have to be traversed to deny every single rule that was allowed for the various resources (child resources of what you want to deny).\nThe other way around \"$acl->allow('admin');\" would have to set \"allow\" for every previously set rule.\n\nSo I would suggest a convention, that either, you don\u00b4t use resources at all ($resource = null) or always define resources, but never mixing those two approaches.\nWhen using both, \"null\" should only be used as a fallback setting.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=octavian",
                        "name": "octavian",
                        "displayName": "Marc Jakubowski",
                        "active": true
                    },
                    "created": "2008-04-01T05:42:54.000+0000",
                    "updated": "2008-04-01T05:42:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20601",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "body": "Perhaps this issue would be more completely resolved with additions and\/or modifications to the documentation. Indeed, the behavior described is the behavior intended - that the use of {{null}} implies a fallback or default rule in the case where a more specific rule does not apply. In general, Zend_Acl obeys a given rule if and only if a more specific rule does not apply.\n\nShall we reopen the issue until documentation is updated thusly?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "created": "2008-04-01T08:29:56.000+0000",
                    "updated": "2008-04-01T08:29:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20629",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=motzel",
                        "name": "motzel",
                        "displayName": "Bogdan Modzelewski",
                        "active": true
                    },
                    "body": "> In general, Zend_Acl obeys a given rule if and only if a more specific rule does not apply.\n\nAnd that's a sentence missing in documentation! It explains every \"problem\" mentioned in this issue.\nI think issue should be reopened until documentation is updated. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=motzel",
                        "name": "motzel",
                        "displayName": "Bogdan Modzelewski",
                        "active": true
                    },
                    "created": "2008-04-02T00:11:11.000+0000",
                    "updated": "2008-04-02T00:11:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20631",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "body": "Reopening pending addition to documentation.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "created": "2008-04-02T07:41:40.000+0000",
                    "updated": "2008-04-02T07:41:40.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20632",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "body": "Resolved with [SVN r9112|http:\/\/framework.zend.com\/fisheye\/changelog\/Zend_Framework\/?cs=9112].",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=darby",
                        "name": "darby",
                        "displayName": "Darby Felton",
                        "active": true
                    },
                    "created": "2008-04-02T07:45:59.000+0000",
                    "updated": "2008-04-02T07:45:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24055",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "Updating for the 1.6.0 release.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-09-02T10:39:15.000+0000",
                    "updated": "2008-09-02T10:39:15.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-2257\/transitions"
}