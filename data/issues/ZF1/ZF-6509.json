{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6509",
    "key": "ZF-6509",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Cache with Zend_Translate omits language label in cache filenames resulting in translations not working"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6509\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10320",
                    "id": 10320,
                    "description": "Minor Release",
                    "name": "1.9.0",
                    "userReleaseDate": "31\/Jul\/09",
                    "archived": false,
                    "releaseDate": "2009-07-31",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-07-20T12:14:17.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=teosurf",
                "name": "teosurf",
                "displayName": "TeOSuRf",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-05-03T11:57:05.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-08-28T09:27:08.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "1)No bug with Zend Framework v1.7.2.\n2)Bug with Zend Framework v1.8.0dev.\n\nI use a very simple translate config with array adapter:\n\n        $frontendOptions = array(\n                'lifetime' => 30,\n                'automatic_serialization' => true);\n        \/\/ cache_dir: directory where to put the cache files\n        $backendOptions = array(\n                'cache_dir' => $this->_root . '\/var\/tmp\/');\n        \/\/ getting a Zend_Cache_Core object\n        $this->_cache = Zend_Cache::factory(\n                'Core',\n                'File',\n                $frontendOptions,\n                $backendOptions);\n        Zend_Registry::set('cache', $this->_cache);\n\n\n        $english = array('title' => 'title');\n        $italian= array('title' => 'titolo');\n        $german= array('title' => 'Titel');\n\n        Zend_Translate::setCache(Zend_Registry::get('cache'));\n        $translate = new Zend_Translate('array', $english, 'en');\n        $translate->addTranslation($italian, 'it');\n        $translate->addTranslation($german, 'de');\n\n\nCache files (content of ....\/var\/tmp\/):\nCase 1) :\nzend_cache---internal-metadatas---Zend_Translate_Array_de_Array\nzend_cache---internal-metadatas---Zend_Translate_Array_en_Array\nzend_cache---internal-metadatas---Zend_Translate_Array_it_Array\nzend_cache---internal-metadatas---Zend_Translate_Array_Options\nzend_cache---Zend_Translate_Array_de_Array\nzend_cache---Zend_Translate_Array_en_Array\nzend_cache---Zend_Translate_Array_it_Array\nzend_cache---Zend_Translate_Array_Options\n\nCase 2) :\nzend_cache---internal-metadatas---Zend_Translate_Array_Array\nzend_cache---internal-metadatas---Zend_Translate_Array_Options\nzend_cache---Zend_Translate_Array_Array\nzend_cache---Zend_Translate_Array_Options\n\nIn case 2) only the first loaded translation works."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6509\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10241",
                    "id": 10241,
                    "description": "Minor Release",
                    "name": "1.8.0",
                    "userReleaseDate": "30\/Apr\/09",
                    "archived": false,
                    "releaseDate": "2009-04-30",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10099",
                    "id": 10099,
                    "name": "Zend_Translate",
                    "description": "Provides translation functionality, based on standards such as TMX and Gettext.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30617",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "The reason for this behaviour is that you don't give a file but only the content of the file to the adapter.\nThe cachename holds the filename (translation files are cached based on their path and filename).\nThe old behaviour did not work for 2\/3 of usecases and specially for multilingual files.\n\nSo to have it working correct there are 2 ways for you:\n\n* Load the array from within a file (that's ho the manual describes the array adapter)\n* Load only the one single array you want to use actually... no user needs to have a site simultanly in 2 or more languages.\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-05-03T12:41:53.000+0000",
                    "updated": "2009-05-03T12:41:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30620",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=teosurf",
                        "name": "teosurf",
                        "displayName": "TeOSuRf",
                        "active": true
                    },
                    "body": "Thank you very much, loading the array from within a file works perfectly.\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=teosurf",
                        "name": "teosurf",
                        "displayName": "TeOSuRf",
                        "active": true
                    },
                    "created": "2009-05-03T18:41:14.000+0000",
                    "updated": "2009-05-03T18:41:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30660",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "body": "remove Zend_Cache as affected component (not a Zend_Cache issue)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "created": "2009-05-04T13:27:58.000+0000",
                    "updated": "2009-05-04T13:27:58.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32225",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "In Incubator since r16247, waiting for code review of ZF-2400",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-06-27T10:01:11.000+0000",
                    "updated": "2009-06-27T10:01:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32344",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=becoded",
                        "name": "becoded",
                        "displayName": "Bert Van Hauwaert",
                        "active": true
                    },
                    "body": "It doesn't seem right that this doesn't work anymore when you give the content to the adapter.\nThere is an example in the manuel, to just give the data. So it should work that way also.\nI'm using an custom adapter that loads the data from MySQL, so I don't have a file. But now I can't cache anymore because of this change.\n{code:title=First example under 56.3.2. Creating Array source files}\n$english = array(\n    'message1' => 'message1',\n    'message2' => 'message2',\n    'message3' => 'message3');\n\n$german = array(\n    'message1' => 'Nachricht1',\n    'message2' => 'Nachricht2',\n    'message3' => 'Nachricht3');\n\n$translate = new Zend_Translate('array', $english, 'en');\n$translate->addTranslation($deutsch, 'de');\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=becoded",
                        "name": "becoded",
                        "displayName": "Bert Van Hauwaert",
                        "active": true
                    },
                    "created": "2009-07-02T04:38:07.000+0000",
                    "updated": "2009-07-02T04:38:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32345",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "You may have noted that this issue is marked as \"in progress\" which means that it's not resolved in core.\nYou may have also noted that this issue is fixed within incubator and actually blocked by another issue.\n\nPlease read previous comment before adding a own comment.\nGiving someone help to make his application work should always be allowed even if it's not the fix itself.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-07-02T04:53:37.000+0000",
                    "updated": "2009-07-02T04:53:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32748",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Accepted and integrated into core with r16883.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-07-20T12:14:17.000+0000",
                    "updated": "2009-07-20T12:14:17.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34043",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jmarien",
                        "name": "jmarien",
                        "displayName": "Jonas Marien",
                        "active": true
                    },
                    "body": "Caching still didn't work - even when applying the above mentioned version.\n\nWe had to add the locale to the cache key to make caching work as it should:\n\n{code}\n$id = 'Zend_Translate_' . (string) $locale. '_'. md5(serialize($data)) . '_' . $this->toString();\n{\/code}\n\ninstead of:\n{code}\n$id = 'Zend_Translate_' . md5(serialize($data)) . '_' . $this->toString();\n{\/code}\n\nin Zend_Translate_Adapter.\n\nIt helped for us, so someone else might be interested too in this fix.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jmarien",
                        "name": "jmarien",
                        "displayName": "Jonas Marien",
                        "active": true
                    },
                    "created": "2009-08-28T07:29:50.000+0000",
                    "updated": "2009-08-28T07:29:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34044",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jmarien",
                        "name": "jmarien",
                        "displayName": "Jonas Marien",
                        "active": true
                    },
                    "body": "Again, now with markup as it should (I hope):\n\n{code:php}\n$id = 'Zend_Translate_' . (string) $locale. '_'. md5(serialize($data)) . '_' . $this->toString();\n{code}\n\ninstead of:\n{code:php}\n$id = 'Zend_Translate_' . md5(serialize($data)) . '_' . $this->toString();\n{code}\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jmarien",
                        "name": "jmarien",
                        "displayName": "Jonas Marien",
                        "active": true
                    },
                    "created": "2009-08-28T07:31:46.000+0000",
                    "updated": "2009-08-28T07:31:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34052",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Your proposed change re-introduces the problem that caching does not work with multilimgual translation files.\n\nLocale and Caching must not be fixed to each other. As $data referrs to the filename\/path this is the better way than using the locale. Additionally your change introduces problems when someone uses multiple files for the same locale.\n\nOur unittests show that things work as expected with release 1.9. The problem described in this issue does no longer exist with the mentioned release.\n\nAs you said \"Applying\" I think that you did not use the release but only this single release. You should note that before and after that also changes occured. And changes could have been done in other components as well (Zend_Cache).\n\nFeel free to give reproducable information that this problem is not fixed with 1.9 and we will reopen it.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-08-28T09:27:07.000+0000",
                    "updated": "2009-08-28T09:27:07.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6509\/transitions"
}