{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9293",
    "key": "ZF-9293",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Wrong behavior in Zend_Validate_Int and Zend_Validate_Float when locale is present."
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9293\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/5",
                "name": "Cannot Reproduce"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10451",
                    "id": 10451,
                    "description": "Mini Release",
                    "name": "1.10.4",
                    "userReleaseDate": "28\/Apr\/10",
                    "archived": false,
                    "releaseDate": "2010-04-28",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-04-26T11:44:43.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=leandrorc",
                "name": "leandrorc",
                "displayName": "Leandro Rodrigues Chaves",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-02-28T14:40:01.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-04-26T11:44:44.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "When locale is present, isValid() shouldn't test using 'en' locale also. A example of this inconsistency is:\r\n\r\n{code}\r\n\/\/consider Zend_Locale is already in Zend_Registry and it's 'pt_BR'\r\n$number = $_POST['VALUE_IN_BRL'] \/\/ Value must be in Brazil's currency format, but let's suppose user typed 2,500.99 ('en' format)\r\n$validate = new Zend_Validate_Float();\r\nif(is_valid($number)){\r\n   \/\/get number from localized string and save it to database\r\n   $number = Zend_Locale_Format::getNumber($number);\r\n}\r\nelse{\r\n   $msg = 'Enter the correct value!'\r\n}\r\n{code}\r\n\r\nIn addition to wrong behavior (2,500.99 is not valid in my application), i get this error:\r\n\r\nUncaught exception 'Zend_Locale_Exception' with message 'No localized value in 2,500.99 found, or the given number does not match the localized format' in path_to_zf\\library\\Zend\\Locale\\Format.php:247"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9293\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10430",
                    "id": 10430,
                    "description": "Mini Release",
                    "name": "1.10.2",
                    "userReleaseDate": "24\/Feb\/10",
                    "archived": false,
                    "releaseDate": "2010-02-24",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10140",
                    "id": 10140,
                    "name": "Zend_Validate",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38993",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chameleon",
                        "name": "chameleon",
                        "displayName": "Benjamin-Timm Broich",
                        "active": true
                    },
                    "body": "{code:php}\r\n$number = '1.5';\r\n\/\/$number   = '1,5'; \/\/ <- correct value for de_DE\r\n\r\n$locale = new Zend_Locale('de_DE');\r\n$validate = new Zend_Validate_Float($locale);\r\n\r\nif($validate->isValid($number)){\r\n   echo Zend_Locale_Format::getNumber($number, array('locale' => $locale));\r\n   \/\/ Throws Exception: No localized value in 1.5 found, or the given number does not match the localized format\r\n}\r\nelse{\r\n   echo 'Wrong number or format';\r\n}\r\n{code}\r\n\r\nOne of my co-workers noticed me about the above mentioned code thats not working. Its still checking against the \"en\" locale, instaed of checking against the given de_DE locale.\r\n\r\nI think that it's not necessary to check against the english locale if another locale (in this case de_DE) is given?!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chameleon",
                        "name": "chameleon",
                        "displayName": "Benjamin-Timm Broich",
                        "active": true
                    },
                    "created": "2010-03-05T02:03:01.000+0000",
                    "updated": "2010-03-05T02:03:01.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38994",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chameleon",
                        "name": "chameleon",
                        "displayName": "Benjamin-Timm Broich",
                        "active": true
                    },
                    "body": "Additionally to my comment above:\r\n\r\nAs we can see, the Float Validator always checks for the english locale.\r\n\r\n{code}\r\n<?php\r\nclass Zend_Validate_Float extends Zend_Validate_Abstract\r\n{\r\n\/\/..\r\n    public function isValid($value)\r\n    {\r\n\/\/..\r\n                if (!Zend_Locale_Format::isFloat($value, array('locale' => 'en')) && \/\/ <- not needed if $this->_locale defined???\r\n                    !Zend_Locale_Format::isFloat($value, array('locale' => $this->_locale))) {\r\n                    $this->_error(self::NOT_FLOAT);\r\n                    return false;\r\n                }\r\n\/\/..\r\n    }\r\n}\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chameleon",
                        "name": "chameleon",
                        "displayName": "Benjamin-Timm Broich",
                        "active": true
                    },
                    "created": "2010-03-05T02:08:19.000+0000",
                    "updated": "2010-03-05T02:08:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38996",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=leandrorc",
                        "name": "leandrorc",
                        "displayName": "Leandro Rodrigues Chaves",
                        "active": true
                    },
                    "body": "Exactly Benjamin! Same with Zend_Validate_Int. Another example why isValid() shouldn't test against 'en' could be in a financial test, when students must type the number format of many countries and the application must validate this.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=leandrorc",
                        "name": "leandrorc",
                        "displayName": "Leandro Rodrigues Chaves",
                        "active": true
                    },
                    "created": "2010-03-05T03:29:51.000+0000",
                    "updated": "2010-03-05T03:29:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39010",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Reducing from critical to major.\r\nThe inclusion of EN was forced by the core team despite my negative response to this request. Has to be discussed with team members before changing this in my eyes errorous behaviour.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-03-05T14:53:11.000+0000",
                    "updated": "2010-03-05T14:53:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39606",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Not reproducable for Zend_Validate_Int.\r\nThere is no relation to \"en\" within the Int validator.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-03-27T14:31:45.000+0000",
                    "updated": "2010-03-27T14:31:45.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40236",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Closing as not reproduceable\r\n\r\nWether Int nor Float have a fixed \"en\" locale as mentioned.\r\nBoth validators do not validate localized \"en\" numbers when another locale is given within or after the mentioned release \r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-04-26T11:44:44.000+0000",
                    "updated": "2010-04-26T11:44:44.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-9293\/transitions"
}