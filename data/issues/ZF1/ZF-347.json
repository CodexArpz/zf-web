{
    "expand": "html",
    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-347",
    "key": "ZF-347",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "PDO:  expressions with colon character interpreted as PDO named parameter"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-347\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10090",
                    "id": 10090,
                    "description": "Release Candidate 2",
                    "name": "1.0.0 RC2",
                    "userReleaseDate": "08\/Jun\/07",
                    "archived": true,
                    "releaseDate": "2007-06-08",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2007-06-11T19:11:52.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=patrik",
                "name": "patrik",
                "displayName": "Patrik Henningsson",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2006-08-31T13:50:19.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2007-07-05T14:43:19.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "{code}\n$db = Zend_Db::factory('pdo_mysql', array (\n\t\t'host'     => $config->database->host,\n\t\t'username' => $config->database->username,\n\t\t'password' => $config->database->password,\n\t\t'dbname'   => $config->database->name)\n);\n{code}\n\nRunning this query works:\n{code}\n$db->query(\"SELECT * FROM kund WHERE foretag REGEXP '.*a+[[:space:]]*b.*' \");\n{code}\n\nBut this doesn't:\n{code}\n$db->query(\"SELECT * FROM kund WHERE foretag REGEXP '.*a+[[:space:]]*\u00f6.*' \");\n{code}\n\nAn exeption is being thrown ..\nMessage: SQLSTATE[HY093]: Invalid parameter number: no parameters were bound\nFile: \/home\/test\/lib\/ZendFramework\/library\/Zend\/Db\/Adapter\/Abstract.php:156\n\nI'm running version 1020 from SVN."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-347\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                "name": "bkarwin",
                "displayName": "Bill Karwin",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10001",
                    "id": 10001,
                    "description": "Preview Release",
                    "name": "0.1.5",
                    "userReleaseDate": "11\/Jul\/06",
                    "archived": true,
                    "releaseDate": "2006-07-11",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/component\/10012",
                    "id": 10012,
                    "name": "Zend_Db",
                    "description": "interfaces, APIs, and adapters for various third-party data stores",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/10758",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=gavin",
                        "name": "gavin",
                        "displayName": "Gavin",
                        "active": true
                    },
                    "body": "Would you have time to poke around a little in the code and trouble shoot this Patrik?\nI would also be curious if the same problem occurs when using PDO directly (no ZF).",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=gavin",
                        "name": "gavin",
                        "displayName": "Gavin",
                        "active": true
                    },
                    "created": "2006-08-31T15:02:56.000+0000",
                    "updated": "2006-08-31T15:02:56.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/10764",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=patrik",
                        "name": "patrik",
                        "displayName": "Patrik Henningsson",
                        "active": true
                    },
                    "body": "Sure, what do you want me to do?\n\nSeems to work when using PDO directly, I've tried the code below and it works.\n\ntry {\n   $dbh = new PDO('mysql:host=localhost;dbname=test', 'user', 'pass');\n   foreach ($dbh->query(\"SELECT * FROM kund WHERE foretag REGEXP '.a+[[:space:]]*\u00f6.' \") as $row) {\n     print_r($row);\n   }\n   $dbh = null;\n} catch (PDOException $e) {\n   print \"Error!: \" . $e->getMessage() . \"<br\/>\";\n   die();\n}",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=patrik",
                        "name": "patrik",
                        "displayName": "Patrik Henningsson",
                        "active": true
                    },
                    "created": "2006-09-01T03:42:57.000+0000",
                    "updated": "2006-09-01T03:42:57.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/10996",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=patrik",
                        "name": "patrik",
                        "displayName": "Patrik Henningsson",
                        "active": true
                    },
                    "body": "Little more information ..\n\nThe following queries works:\nUPDATE foo SET title='\u00d6vrigt arbete' WHERE id=1\nUPDATE foo SET title='Xvrigt arbete', dt='2006-09-28 10:00:00' WHERE id=1\n\nThe following query doesn't works:\nUPDATE foo SET title='\u00d6vrigt arbete', dt='2006-09-28 10:00:00' WHERE id=1\n\nSo it seems like the ':' in the date is handled as a placeholder, but\nonly if the query contains \"\u00d6\"?\nCould it be any regex with \"a-z\" somewhere in the code that mess things up?\nMaybe Zend_Db_Statement::_prepSql ?",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=patrik",
                        "name": "patrik",
                        "displayName": "Patrik Henningsson",
                        "active": true
                    },
                    "created": "2006-10-18T01:46:36.000+0000",
                    "updated": "2006-10-18T01:46:36.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/11002",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=gavin",
                        "name": "gavin",
                        "displayName": "Gavin",
                        "active": true
                    },
                    "body": "Zend_Db_Adapter_Abstract::query() forces all input to pass through PDO's prepare() .\nHowever, the example you give have no bound parameters, yet uses colons.\nIf you try using PDO natively, but first pass your SQL string to PDO's prepare(),\nI expect you will receive the same error.\n\nThus, either query() needs a mechanism to disable use of prepare(),\nor the ZF needs a different function to pass SQL code directly to the adapter,\nor you can use getConnection() to retrieve the PDO object and then directly\nuse the PDO object to execute() your SQL.  Frankly, I am not sure what\nvalue Zend_Db* is providing to you beyond what is already available using\nPHP's PDO functions directly.\n\nI suppose some will want to dynamically choose a database (e.g. MySQL, SQLite, etc.),\nand then directly issue portable SQL code against that Zend DB adapter,\nso we will probably need to provide an alternative to the existing query() in\nZend_Db_Adapter_Abstract.  Patch suggestions are welcomed.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=gavin",
                        "name": "gavin",
                        "displayName": "Gavin",
                        "active": true
                    },
                    "created": "2006-10-18T11:43:32.000+0000",
                    "updated": "2006-10-18T11:43:32.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/11360",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Changing fix version to 0.8.0.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2006-11-13T15:14:33.000+0000",
                    "updated": "2006-11-13T15:14:33.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12549",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Reformatted description, restated summary.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-02-06T18:11:22.000+0000",
                    "updated": "2007-02-06T18:11:22.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12550",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "One workaround could be to use a parameter for the string that contains colon characters:\n\n{code}\n$db->query('SELECT * FROM kund WHERE foretag REGEXP ?', array('.*a+[[:space:]]*b.*' ));\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-02-06T18:13:01.000+0000",
                    "updated": "2007-02-06T18:13:01.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/15112",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "In revision 5065, I added logic to the parsing of SQL statements.  Parameter placeholders inside quoted strings or delimited identifiers should no longer be noted as parameters.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-06-11T19:11:52.000+0000",
                    "updated": "2007-06-11T19:11:52.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-347\/transitions"
}