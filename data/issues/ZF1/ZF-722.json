{
    "expand": "html",
    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-722",
    "key": "ZF-722",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Cache_Frontend_Function::call() Supporting object methods via callback parameter"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issueType\/2",
                "name": "New Feature",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-722\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2007-02-08T15:32:20.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=jeremygiberson",
                "name": "jeremygiberson",
                "displayName": "Jeremy Giberson",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2007-01-05T17:45:03.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2007-07-05T14:43:38.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Currently the Zend_Cache_Frontend_Function::call() function does not support object methods. \nFor two reasons I believe it should support object functions:\n1) Use case for caching object method:\n{code}\n\/\/ part class\nclass part { \n     private $partnum;\n\n     public function __construct($partnum) {\n        $this->partnum = $partnum;\n     }\n\n     public function display() {\n         \/\/ renders part and part information in elaborate html\n         \/\/ relies on super expensive _getPartInfo() for data\n         $info = $this->cache->call( array($this, '_getPartInfo') );\n         echo \"Part: {$this->partnum}\";\n         print_r($info);\n     }\n\n     private function _getPartInfo() {\n         \/\/ query some databases\n         \/\/ crunch some numbers\n         \/\/ pretify data\n         \/\/ ..\n         return $info;\n     }\n\n     public function initCache() {\n         \/\/ set up new Zend_Cache_Frontend_Function()\n         \/\/ ..\n     }\n}\n\n\/\/ main script\n\/\/ parts list contains a list of part numbers\nforeach ($partslist as $partnum) {\n     $p = new Part($partnum);\n     $p->display();\n}\n{code}\n2) The Zend_Cache_Frontend_Function::call() documentation specifically states:\n{quote}Using the call() function is the same as using call_user_func_array() in PHP: {quote}\n\n\nIn order to accommodate this functionality the Zend_Cache_Frontend_Function::call() function's first parameter $name needs to allow for callbacks (http:\/\/us2.php.net\/manual\/en\/language.pseudo-types.php#language.types.callback).  My first implementation resulted in:\n{code}\n\/\/Zend\/Cache\/Frontend\/Function.php\n    private function _makeId($name, $parameters)\n    {\n\t\t\/** callback handling fix **\/\n        if ( is_array($name) && is_object($name[0]) && is_string($name[1]) ) {\n        \t$name = get_class($name[0]).\"::\".$name[1];\n        } else if ( is_array($name) ) {\n        \tZend_Cache::throwException('Incorrect callback format');\n        }\n\n        if (!is_string($name)) {\n            Zend_Cache::throwException('Incorrect function name');\n        }\n        if (!is_array($parameters)) {\n            Zend_Cache::throwException('parameters argument must be an array');\n        }\n        return md5($name . serialize($parameters));\n    }\n{code}\n\nWhile this technically produced working functionality it had the draw back that the cached result was the same for every instance. I believe the cached result should not only be based on parameters passed to the function but also the variables in the scope of the function (which change generally per instance of an object). To achieve the feature I came up with another modification:\n{code}\n\/\/Zend\/Cache\/Frontend\/Function.php\n    private function _makeId($name, $parameters)\n    {\n\t\t\/** callback handling fix **\/\n\t\t$obj = null;\n        if ( is_array($name) && is_object($name[0]) && is_string($name[1]) ) {\n        \t$obj = $name[0];\n        \t$name = get_class($name[0]).\"::\".$name[1];\n        } else if ( is_array($name) ) {\n        \tZend_Cache::throwException('Incorrect callback format');\n        }\n\n        if (!is_string($name)) {\n            Zend_Cache::throwException('Incorrect function name');\n        }\n        if (!is_array($parameters)) {\n            Zend_Cache::throwException('parameters argument must be an array');\n        }\n        if ($obj)\n        \treturn md5($name . serialize($obj) . serialize($parameters));\n       \telse\n        \treturn md5($name . serialize($parameters));\n    }\n{code}\n\nThus concludes the new feature. Please forgive me if this does not belong here as it seemed to me the most practical place.\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-722\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                "name": "fab",
                "displayName": "Fabien MARTY",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10040",
                    "id": 10040,
                    "description": "Preview Release; MVC maturation, HTTP client, Gdata",
                    "name": "0.6.0",
                    "userReleaseDate": "16\/Dec\/06",
                    "archived": true,
                    "releaseDate": "2006-12-16",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/component\/10028",
                    "id": 10028,
                    "name": "Zend_Cache",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12162",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=jeremygiberson",
                        "name": "jeremygiberson",
                        "displayName": "Jeremy Giberson",
                        "active": true
                    },
                    "body": "Fixed code tags",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=jeremygiberson",
                        "name": "jeremygiberson",
                        "displayName": "Jeremy Giberson",
                        "active": true
                    },
                    "created": "2007-01-05T17:47:43.000+0000",
                    "updated": "2007-01-05T17:47:43.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12406",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "body": "for the point 1, the Class frontend is not ok for you ?",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "created": "2007-01-27T05:22:07.000+0000",
                    "updated": "2007-01-27T05:22:07.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12605",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "body": "no feedback",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "created": "2007-02-08T15:32:20.000+0000",
                    "updated": "2007-02-08T15:32:20.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-722\/transitions"
}