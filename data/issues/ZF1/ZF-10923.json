{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10923",
    "key": "ZF-10923",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Url action helper adds a slash in front of url"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10923\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-05-30T12:12:20.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=can3p",
                "name": "can3p",
                "displayName": "Dmitry Petrov",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-01-07T02:03:59.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-05-30T12:14:06.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend_Controller_Action_Helper_Url always adds a slash in front of generated url. So, if baseUrl is defined. it leads to the incorrect urls:\r\n\r\n$this->_helper->url('action', 'controller', 'module') \r\n\r\n=> '\/http:\/\/yourbase.com\/module\/controller\/action'"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10923\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "FixForZF1.12",
                "zf-caretaker-adamlundrigan"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                "name": "adamlundrigan",
                "displayName": "Adam Lundrigan",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-10091",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10091",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/15114",
                    "filename": "50a1a8.png",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-29T16:53:41.000+0000",
                    "size": 35683,
                    "mimeType": "image\/png",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/15114\/50a1a8.png",
                    "thumbnail": "http:\/\/fw02.zend.com\/issues\/secure\/thumbnail\/15114\/_thumb_15114.png"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/15115",
                    "filename": "ZF-10923.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-29T17:12:50.000+0000",
                    "size": 1628,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/15115\/ZF-10923.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10520",
                    "id": 10520,
                    "description": "Mini Release",
                    "name": "1.11.2",
                    "userReleaseDate": "30\/Dec\/10",
                    "archived": false,
                    "releaseDate": "2010-12-30",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10011",
                    "id": 10011,
                    "name": "Zend_Controller",
                    "description": "front controller, including router and dispatcher",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43960",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Removing the leading slash would break existing applications, as the URLs generated would now be relevant to the current page, not the document root.\r\n\r\nHow are you defining the baseUrl? Is it being auto-determined for you, or have you set it explicitly? I'm guessing, based on the URL you display above, that you are setting it explicitly. The baseUrl should only contain path information, not the protocol and host -- if you need the protocol and host, you should use the serverUrl() view helper, or grab the information from the request object.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2011-01-07T04:47:00.000+0000",
                    "updated": "2011-01-07T04:47:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43967",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=can3p",
                        "name": "can3p",
                        "displayName": "Dmitry Petrov",
                        "active": true
                    },
                    "body": "I'm setting baseUrl in application.ini config.\r\n\r\nYou can look through the class source code. It gets basDir from front controller if availible and adds it to the url. After that it adds the leading slash without any conditions.\r\n\r\nThe right behavior is if leading slash would be added only if baseUrl was not defined in front controller.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=can3p",
                        "name": "can3p",
                        "displayName": "Dmitry Petrov",
                        "active": true
                    },
                    "created": "2011-01-07T08:50:03.000+0000",
                    "updated": "2011-01-07T08:50:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46048",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rockaut",
                        "name": "rockaut",
                        "displayName": "Markus",
                        "active": true
                    },
                    "body": "And hasn't changed since then. Infact i remember two more issue dubles.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rockaut",
                        "name": "rockaut",
                        "displayName": "Markus",
                        "active": true
                    },
                    "created": "2011-04-26T10:13:30.000+0000",
                    "updated": "2011-04-26T10:13:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50825",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Confirmed.  If a fully-qualified baseUrl is supplied to the front controller, then the bug outlined in this ticket manifests itself.  Troublesome code:\r\n!50a1a8.png!\r\n\r\nUnit test:\r\n{code}\r\nIndex: tests\/Zend\/Controller\/Action\/Helper\/UrlTest.php\r\n===================================================================\r\n--- tests\/Zend\/Controller\/Action\/Helper\/UrlTest.php\t(revision 24820)\r\n+++ tests\/Zend\/Controller\/Action\/Helper\/UrlTest.php\t(working copy)\r\n@@ -178,6 +178,21 @@\r\n         $url = $this->helper->simple('action', null, null, array('foo' => 'bar'));\r\n         $this->assertEquals('\/baseurl\/module\/controller\/action\/foo\/bar', $url);\r\n     }\r\n+\r\n+    \/**\r\n+     * @group ZF-10923\r\n+     *\/\r\n+    public function testFullyQualifiedBaseUrlDoesNotGetSlashPrepended()\r\n+    {\r\n+        $this->front->setBaseUrl('http:\/\/example.com');\r\n+\r\n+        $request = $this->front->getRequest();\r\n+        $request->setModuleName('module')\r\n+                ->setControllerName('controller');\r\n+\r\n+        $url = $this->helper->simple('action', null, null, array('foo' => 'bar'));\r\n+        $this->assertEquals('http:\/\/example.com\/module\/controller\/action\/foo\/bar', $url);\r\n+    }\r\n }\r\n \r\n \/\/ Call Zend_Controller_Action_Helper_UrlTest::main() if this source file is executed directly.\r\n{code}\r\n\r\nAnd result of running it:\r\n{code}\r\nThere was 1 failure:\r\n\r\n1) Zend_Controller_Action_Helper_UrlTest::testFullyQualifiedBaseUrlDoesNotGetSlashPrepended\r\nFailed asserting that two strings are equal.\r\n--- Expected\r\n+++ Actual\r\n@@ @@\r\n-http:\/\/example.com\/module\/controller\/action\/foo\/bar\r\n+\/http:\/\/example.com\/module\/controller\/action\/foo\/bar\r\n\r\nFAILURES!\r\nTests: 1, Assertions: 1, Failures: 1.\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-29T16:54:04.000+0000",
                    "updated": "2012-05-29T17:06:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50866",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "After discussing the issue with [~dasprid], this is the intended behavior of {{setBaseUrl}}.  That method's primary purpose is to allow Zend Framework applications to run in sub-folders by specifying the path prefix that should be stripped from the request URI before being processed by the router.  This request URI is an absolute path, not a fully-qualified URI, and so setting the base URL to a fully-qualified URL will break this feature (and the view helper too). \r\n\r\nIf you need to use the FQDN URL in your view scripts, you can wrap the call to the URL view helper in a call to the {{serverUrl}} helper:\r\n\r\n{code}\r\n<?php echo $this->serverUrl($this->url(...)); ?>\r\n{code}\r\n\r\nOr set the base tag in the header of your HTML page:\r\n{code}\r\n<base href=\"<?php echo $this->serverUrl($this->baseUrl()); ?>\" \/>\r\n{code}\r\n\r\nI've updated the relevant manual pages (SVN r24827) with a note about fully-qualified base URLs not being supported.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-30T12:12:20.000+0000",
                    "updated": "2012-05-30T12:14:06.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10923\/transitions"
}