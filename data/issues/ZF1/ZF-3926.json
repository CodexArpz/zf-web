{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3926",
    "key": "ZF-3926",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Form_Element settings 'zfBreakChainOnFailure' property"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3926\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-08-22T15:18:10.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jaka",
                "name": "jaka",
                "displayName": "Jaka Jancar",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-08-11T11:11:52.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-08-22T15:18:10.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend_Form_Element is setting the propery 'zfBreakChainOnFailure' on the validators passed to it:\n\n        if ($validator instanceof Zend_Validate_Interface) {\n            $name = get_class($validator);\n\n            if (!isset($validator->zfBreakChainOnFailure)) {\n                $validator->zfBreakChainOnFailure = $breakChainOnFailure;\n            }\n\nNot only that setting arbitrary properties on objects isn't nice, it might not work. For example when Zend_Form is added as a validator to a form element (I use it for subforms, and it should work since it implements the interface), you get:\n\nFatal error: Uncaught exception 'Zend_Form_Exception' with message 'Only form elements and groups may be overloaded; variable of type \"boolean\" provided' in library\/Zend\/Form.php\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3926\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10050",
                    "id": 10050,
                    "description": "Minor Release Candidate",
                    "name": "1.6.0RC2",
                    "userReleaseDate": "11\/Aug\/08",
                    "archived": true,
                    "releaseDate": "2008-08-11",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [

            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23430",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "You're commenting on two separate issues.\n\nYour second issue has to do with the fact that you're incorrectly adding the validator to the form; that exception occurs when you add anything other than an element, display group, or sub form to the form using overloading, such as this:\n{code}\n$form->validator = $validator;\n{code}\nAs you do not provide a reproduce case but only the exception message, I can only assume the above is what you were doing.\n\nRegarding the zfBreakChainOnFailure property, PHP allows for the creation of arbitrary public members, and this was a trick we could use _now_ without needing to alter the current validator interface (which would have created a BC break). We will alter the interface in later releases, likely with 2.0, but this methodology will persist until then.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-08-11T11:18:20.000+0000",
                    "updated": "2008-08-11T11:18:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23431",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jaka",
                        "name": "jaka",
                        "displayName": "Jaka Jancar",
                        "active": true
                    },
                    "body": "Please re-read the description more carefully.\n\nI'm not trying to assign a validator to the form, but to a Zend_Form_Element. And the validator is a (nested) Zend_Form (I don't use subforms because of other reasons).\n\n\nBut this is not relevent. This can also break other validators. And it might interfere if a single validator is used in multiple places!\n\nIt can be fixed easily by storing the zfBreakChainOnFailure flag inside the object that needs it (Zend_Form_Element in this case) and not just sticking it to the validators, e.g. with an array:\n\n$this->_breakOnFailure[$validator]\n\ninstead of\n\n$validator->zfBreakChainOnFailure\n\nPlease consider this seriously, as it may cause problems and is trivial to fix.\n\nJaka",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jaka",
                        "name": "jaka",
                        "displayName": "Jaka Jancar",
                        "active": true
                    },
                    "created": "2008-08-11T11:28:41.000+0000",
                    "updated": "2008-08-11T11:28:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23433",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Can you please post a reproduce case? It sounds like you're attaching a form as a validator for an element? If that's the case, I honestly see this as a fringe case, though I'll consider a change.\n\nAdditionally, attaching the same validator to multiple elements is discouraged, as validators often require and store state information. \n\nFinally, you're oversimplifying the \"triviality\" of the fix. By setting the flag on the validator itself, we are able to process the validator chain as a simple array, which also allows us to export the validation chain for later serialization. If we store the flag in the element with the validator, we make a much more complex, less performant API. If we instead require that the validator have a published flag for this, we would need to break the Interface -- which leads to a BC break for anybody who has created their own validators.\n\nRegardless, at this point I will not entertain a change to the functionality unless you can provide a reasonable use case that demonstrates the issue. Right now, I only have a _description_ of a failing use case.\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-08-11T12:29:53.000+0000",
                    "updated": "2008-08-11T12:29:53.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23464",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jaka",
                        "name": "jaka",
                        "displayName": "Jaka Jancar",
                        "active": true
                    },
                    "body": "I don't understand why storing the flag in the element would be less performant.\n\nCouldn't Zend_Form_Element::$_validators contain, instead of:\narray($name => $instance)\nthis:\narray($name => array(\"breakChain\"=>$break, \"instance\"=>$instance));\n\nI'm almost certain this doesn't affect performance, but don't know if it interferes with serialization that you mentioned.\n\n\nAs for the use case... it's probably pretty uncommon, I admit, but it may affect others with other use cases whose validators don't support setting the property. But if you're really interested, here's mine:\n\n- I have extended the functionality of the ViewHelper decorator to support isArray for any view helper (users can click \"add value\" to add arbitrarily many, say, TextInputs or dates, or \"remove value\". Using javascript, of course.) and some other cool stuff. Screenshot:\nhttp:\/\/mt14.quickshareit.com\/share\/picture41330c.png\n\n- I want subforms, but the way they're implemented doesn't work for me, since Zend_Form's isArray works quite differently than Zend_Form_Element's isArray. Additionaly, I just don't want to treat \"simple\" elements differently from complex\/compound (form) elements.\n\n- So I made Zend_Form_Element_Form (yes! :P). It accepts a form, and displays it as an element of another form.\n\n- If the Zend_Form_Element_Form is valid naturally depends on whether the contained Zend_Form is valid. So I wanted to use the form itself as a validator. Which broke, because of the zfBreakChainOnFailure.\n\nI easily avoided this by creating My_Validate_Form, which merely wraps the form and allows setting of the flag, but the point is that I should be able to just use Zend_Form directly, given that it implements Zend_Form_Interface.\n\nEnd result, working perfectly in ~100 lines of custom code:\nhttp:\/\/mt14.quickshareit.com\/share\/picture2714ac.png\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jaka",
                        "name": "jaka",
                        "displayName": "Jaka Jancar",
                        "active": true
                    },
                    "created": "2008-08-12T15:02:31.000+0000",
                    "updated": "2008-08-12T15:02:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23615",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Again, there are some design and BC issues that led to the current implementation. We're not going to change it at this time.\n\nIf you can find a way to refactor the component that is 100% BC with the current implementation _and_ can demonstrate a compelling reason to make the changes, please create a proposal for us to review (not an issue).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-08-22T15:18:10.000+0000",
                    "updated": "2008-08-22T15:18:10.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3926\/transitions"
}