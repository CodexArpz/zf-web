{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4007",
    "key": "ZF-4007",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "stream_get_contents() issue in Zend_Mail_Storage_Mbox.php, when mail body is empty"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4007\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-05-26T20:41:47.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=michaelm",
                "name": "michaelm",
                "displayName": "Michael Mayer",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-08-20T02:15:49.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-05-26T20:41:47.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Problem:\n\nWhen a mail body is empty, stream_get_contents() gets passed a negative value (-2) as second argument (the length in bytes). According to the documentation, only positive values and -1 are defined as second argument. The mbox file was created by Mozilla Thunderbird on Ubuntu Linux 8.04 LTS.\n\nResult:\n\nFatal error: Out of memory (allocated 11534336) (tried to allocate 18446744073709551615 bytes) in \/usr\/share\/php\/libzend-framework-php\/Zend\/Mail\/Storage\/Mbox.php on line 198\n\nPlatform:\n\nPHP 5.2.4-2ubuntu5.3 with Suhosin-Patch 0.9.6.2 (cli) (built: Jul 23 2008 06:46:18)\n\nWorkaround:\n\nDon't pass arguments < 0 to stream_get_contents()."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/1",
                "name": "Blocker"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4007\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                "name": "satoruyoshida",
                "displayName": "Satoru Yoshida",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-3564",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3564",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10174",
                    "id": 10174,
                    "description": "Mini Release",
                    "name": "1.5.1",
                    "userReleaseDate": "25\/Mar\/08",
                    "archived": true,
                    "releaseDate": "2008-03-25",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10074",
                    "id": 10074,
                    "name": "Zend_Mail_Storage",
                    "description": "Facilitates reading mail from any of several common mail storage formats.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23544",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=michaelm",
                        "name": "michaelm",
                        "displayName": "Michael Mayer",
                        "active": true
                    },
                    "body": "Please note: The issue still seems to exist in the svn head revision. I just checked the source and it didn't change since 1.5.1 (which comes with Ubuntu 8.04).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=michaelm",
                        "name": "michaelm",
                        "displayName": "Michael Mayer",
                        "active": true
                    },
                    "created": "2008-08-20T02:33:31.000+0000",
                    "updated": "2008-08-20T02:33:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25904",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "body": "There must be something else wrong (too). The test file tests\/Zend\/Mail\/_files\/test.mbox\/INBOX has a message with an empty body, yet it doesn't have that problem. Could you check with that file on your platform and send me your file if the test file works?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nico",
                        "name": "nico",
                        "displayName": "Nico Edtinger",
                        "active": true
                    },
                    "created": "2008-11-07T16:12:58.000+0000",
                    "updated": "2008-11-07T16:12:58.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28498",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chris.priebe",
                        "name": "chris.priebe",
                        "displayName": "Chris Priebe",
                        "active": true
                    },
                    "body": "I found a related issue but the body of my email had content in it.  Albeit it had a mircosoft quote in it that may have been causing the problem\n\nSMALL SECTION OF EMAIL (privacy constraints refrain me from submitting all)\n=======================\n...however, we =\ndon=92t\n==============================\n\nRunning Apache 2 on  localhost  for testing it causes an apache crash for the file Maildir.php\n$content = stream_get_contents($fh,-1,1000);\n\nAfter changing the code to the following it now works\n\n    \t$content = '';\n        while (!feof($fh)) {\n            $content .= fgets($fh);\n        }",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chris.priebe",
                        "name": "chris.priebe",
                        "displayName": "Chris Priebe",
                        "active": true
                    },
                    "created": "2009-01-27T16:58:19.000+0000",
                    "updated": "2009-01-27T16:58:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28499",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chris.priebe",
                        "name": "chris.priebe",
                        "displayName": "Chris Priebe",
                        "active": true
                    },
                    "body": "Correction to the above.  The following was a test for me, the correct follows\n# test\n$content = stream_get_contents($fh,-1,1000);\n\n#live\n#@version    $Id: Maildir.php 9099 2008-03-30 19:35:47Z thomas $\n$content = stream_get_contents($fh);",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=chris.priebe",
                        "name": "chris.priebe",
                        "displayName": "Chris Priebe",
                        "active": true
                    },
                    "created": "2009-01-27T17:02:22.000+0000",
                    "updated": "2009-01-27T17:02:22.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39537",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "body": "_openMboxFile() of Zend_Mail_Storage_Mbox.php requires the Mbox file has CRLF on its end of lines as following.\r\n\r\nPossibly the end of lines has only CR or LF?\r\n\r\n{code}\r\nif (strpos($line, 'From ') === 0) {\r\n    $messagePos['end'] = ftell($this->_fh) - strlen($line) - 2; \/\/ + newline\r\n    if (!$messagePos['separator']) {\r\n        $messagePos['separator'] = $messagePos['end'];\r\n    }\r\n    $this->_positions[] = $messagePos;\r\n    $messagePos = array('start' => ftell($this->_fh), 'separator' => 0, 'end' => 0);\r\n}\r\n{code}\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "created": "2010-03-25T08:36:39.000+0000",
                    "updated": "2010-03-25T08:36:39.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40710",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "body": "Sadly, I feel unhappy because no responce.\r\nI will close it.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=satoruyoshida",
                        "name": "satoruyoshida",
                        "displayName": "Satoru Yoshida",
                        "active": true
                    },
                    "created": "2010-05-26T20:41:47.000+0000",
                    "updated": "2010-05-26T20:41:47.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4007\/transitions"
}