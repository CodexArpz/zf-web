{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3021",
    "key": "ZF-3021",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "PHP 5.1.6 and string conversion issue"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3021\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10161",
                    "id": 10161,
                    "description": "Mini Release",
                    "name": "1.5.3",
                    "userReleaseDate": "28\/Jul\/08",
                    "archived": true,
                    "releaseDate": "2008-07-28",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-04-02T12:53:47.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rcastley",
                "name": "rcastley",
                "displayName": "Robert Castley",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-04-02T08:48:34.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-01-19T13:07:03.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I am testing my application on both PHP 5.1.6 and PHP 5.2.5, the docs state a min requirement of PHP 5.1.4.\n\nExample Zend_Locale code:\n{code}\n        $locale = new Zend_Locale();\n        .....\n        setcookie('lang', $locale, null, '\/');\n        Zend_Registry::set('locale', substr($locale, 0, 2));\n        .....\n{code}\n\nUnder PHP 5.1.6 the result is:\n{code}\nWarning: setcookie() expects parameter 2 to be string, object given in \/var\/www\/Magik\/library\/Magik\/Plugin\/Language.php on line 29\n\nNotice: Object of class Zend_Locale to string conversion in \/var\/www\/Magik\/library\/Magik\/Plugin\/Language.php on line 31\n{code}\n\nPHP 5.2.5 works without issue\n\nI can fix my local code by using the (string) cast but I am expecting ZF to handle this for me\n\nExample Zend_Db_Table_Select code:\n{code}\n        $sql = $this->select()\n        ->from($this->_name,array('uid', 'public', 'auth', 'name'))\n        ->where('uid = ?', $uid)\n        ->orWhere('public = 1')\n        ->order('name');\n\n        return $this->getAdapter()->fetchAll($sql);\n{code}\n\nUnder PHP 5.1.6 the result is:\n\n{code}\nNotice: Object of class Zend_Db_Table_Select to string conversion in \/var\/www\/ZendFramework\/library\/Zend\/Db\/Statement\/Pdo.php on line 232\n{code}\n\nUnder PHP 5.2.5 there are no issues.\n\nI can fix this in my code by change the variable $sql to read:\n{code}\n        $sql = $this->getAdapter()->select()\n        ->from($this->_name,array('uid', 'public', 'auth', 'name'))\n        ->where('uid = ?', $uid)\n        ->orWhere('public = 1')\n        ->order('name')\n        ->__toString();\n{code}\n\nAgain, I am expecting ZF to handle this for me.\n\nAm I wrong, or do I have to code for PHP versions 5.1.4 or should the framework handle all this for me?"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3021\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10172",
                    "id": 10172,
                    "description": "Minor Release",
                    "name": "1.5.0",
                    "userReleaseDate": "17\/Mar\/08",
                    "archived": true,
                    "releaseDate": "2008-03-17",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10132",
                    "id": 10132,
                    "name": "Zend_Db_Select",
                    "description": "OO interface to building a SELECT SQL query.",
                    "isAssigneeTypeValid": false
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10073",
                    "id": 10073,
                    "name": "Zend_Locale",
                    "description": "Zend_Locale is a basic wrapper for all I18N and L10N issues for the Zend Framework. It provides the userbasically with access to translation functionality. It can handle different source file types for translation.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20654",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "If you think that this warning\/notice is an error I am sure that you also have a resolution for this problem. :-)\n\nZend_Locale provides an __toString() method which should be called by PHP when an object is forced to an value.\nPHP does this but throws an warning at conversion time.\n\nI don't see an ZF problem. Also PHP states that a __toString() method is all what is needed.\n\nAnd also to mention:\nThere is no failure or exception. There is only a Warning\/Notice.\n\nYou can simply revert your problem when you typecast the object to an string.\nAs you forget to do this, PHP returns you a warning.\n\nI can't say for the Db classes but in my opinion the reason is the same.\n\nGreetings\nThomas, I18N Team Leader",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-04-02T12:53:31.000+0000",
                    "updated": "2008-04-02T12:53:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20659",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rcastley",
                        "name": "rcastley",
                        "displayName": "Robert Castley",
                        "active": true
                    },
                    "body": "Hi,\n\nI think you missed my point, when developing an application using ZF then I should be able to code for all version of PHP 5.1.4 or above (this is in the min. version).  I mostly develop on 5.2.5 but always test on a 5.1.6 version (Ubuntu 6).\n\nThe problem with my code in the above is that instead of getting a value back of e.g. en or fr I get Ob (because I strip back to 2 chars).  So my javascript language string looks like lang.Ob.js instead of lang.en.js.  Obviously this leads to a failure in my application as no such file exists!\n\nWhen developing and running on 5.2.5 I don't need to cast, but if I run on 5.1.6 then I need to modify my code with the cast.\n\nMy question is should I always cast and not rely upon ZF?  In an ideal world I think that ZF should handle this.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rcastley",
                        "name": "rcastley",
                        "displayName": "Robert Castley",
                        "active": true
                    },
                    "created": "2008-04-02T14:14:42.000+0000",
                    "updated": "2008-04-02T14:14:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20660",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "My opinon is still that this is no problem of ZF.\n\nThe behaviour of cast has been changed by PHP in newer versions. And your code is problematic.\n\nYou are trying to do a automated object to string conversion within a function which generates a warning with PHP versions lower than 5.2.\nAnd you do not want to change your code so it works for all versions of PHP.\n\nAlso you are setting a value by giving a function which should autoconvert a object. Same problem as above.\nAlso to mention that your code is wrong and will not work for 1\/3 of all locales.\nWhen you do not want to use the proper methods (->getLanguage) and you say ZF makes problems because PHP gives you a warning when autoconverting object to string I still say it's not a ZF problem because PHP does not call __toString without throwing a warning.\n\nI must also mention that your warning is thrown at line 29 which is the setcookie line and the notice on line 31 which is not available as you only gave us the lines 29 and 30.\n\nYou should eighter fix your code, or use the right methods or ignore the warning.\nYou are free to reopen this issue as needed or start a discussion in the mailing list.\n\nGreetings Thomas",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-04-02T14:42:56.000+0000",
                    "updated": "2008-04-02T14:42:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/20662",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rcastley",
                        "name": "rcastley",
                        "displayName": "Robert Castley",
                        "active": true
                    },
                    "body": "Hi (again!)\n\nI admit I am not the greatest PHP coder in the world and I really appreciate you even taking the time to respond, but the logic doesn't seem to sink in for me.\n\nI have created a working example of code:\n\n{code}\n<?php\nerror_reporting(E_ALL|E_STRICT);\n\n\/**\n *  Define directory\/path separators\n *\/\ndefine ('DS', DIRECTORY_SEPARATOR);\ndefine ('PS', PATH_SEPARATOR);\ndefine ('ROOT', dirname(__FILE__));\n\n\/**\n * Set the PHP include path\n *\/\nini_set('include_path', ini_get('include_path')\n. PS . 'ZendFramework' . DS . 'library'\n);\n\n\/**\n * Autoload required Zend Framework classes\n *\/\nrequire_once 'Zend\/Loader.php';\nZend_Loader::registerAutoload();\n\n\n$locale = new Zend_Locale();\nprint_r ($locale);\necho \"\\nsetting: setcooke(lang, $locale, null, \/)\\n\";\nsetcookie('lang', $locale, null, '\/');\n\n?>\n{code}\n\nWhen the above is run under PHP 5.1.6 I get:\n\n{code}\nZend_Locale Object ( [_Locale:private] => en [_Codeset:private] => ) Setting: setcooke(lang, Object id #1, null, \/)\nWarning: setcookie() expects parameter 2 to be string, object given in \/var\/www\/example.php on line 28\n{code}\n\nWhen I run the exact same code under PHP 5.2.5 I get:\n\n{code}\nZend_Locale Object ( [_Locale:private] => en [_Codeset:private] => ) setting: setcooke(lang, en, null, \/)\n{code}\n\nSo, in order to get x-version compatibility do I need to use:\n\n{code}\n$locale->toString()\n{code}\n\nMany thanks!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rcastley",
                        "name": "rcastley",
                        "displayName": "Robert Castley",
                        "active": true
                    },
                    "created": "2008-04-02T15:28:26.000+0000",
                    "updated": "2008-04-02T15:28:26.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37818",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guishoudaoge",
                        "name": "guishoudaoge",
                        "displayName": "Joe Chen",
                        "active": true
                    },
                    "body": "http:\/\/us3.php.net\/manual\/en\/language.oop5.magic.php#language.oop5.magic.tostring\r\n\r\nbefore PHP 5.2.0 the __toString method was only called when it was directly combined with echo() or print().\r\n\r\n\r\nIt is PHP 5.1.6 problem,  not support <? $example = \"-\" . $object . \"-\"; ?>, and other ways.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=guishoudaoge",
                        "name": "guishoudaoge",
                        "displayName": "Joe Chen",
                        "active": true
                    },
                    "created": "2010-01-19T03:42:04.000+0000",
                    "updated": "2010-01-19T03:42:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37830",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "As said 2 years ago...\r\nWhen you use a object as parameter and a PHP version which does not use __toString() there is NO WAY for ZF to correct this behaviour.\r\n\r\nThis is a PHP version dependend PHP behaviour. And when the user says that he is not able to use $object->toString() when he already knows that this is a PHP problem, there is nothing more to say than closing the issue as non-issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-01-19T13:07:02.000+0000",
                    "updated": "2010-01-19T13:07:02.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3021\/transitions"
}