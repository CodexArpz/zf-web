{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3168",
    "key": "ZF-3168",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Db_Select naturalJoin with Oracle"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3168\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-11-20T20:53:28.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                "name": "mikaelkael",
                "displayName": "Mickael Perraud",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-04-23T12:51:49.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-11-20T20:53:28.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "On Oracle, columns that are used for a named-join (either a NATURAL join or a join with a USING clause) cannot have an explicit qualifier.\r\nThis code:\r\n{code}\r\n$select = new Zend_Db_Select();\r\n$select->form('table1');\r\n$select->joinNatural('table2');\r\n{code}\r\nrenders\r\n{code:sql}\r\nSELECT table1.*, table2.* FROM table1 NATURAL JOIN table2;\r\n{code}\r\nBut in this case, Oracle only accepts:\r\n{code:sql}\r\nSELECT * FROM table1 NATURAL JOIN table2;\r\n{code}\r\n----\r\nAnother code:\r\n{code}\r\n$select = new Zend_Db_Select();\r\n$select->form('table1');\r\n$select->joinNatural('table2');\r\n$select->join('table3','table1.col = table3.col'); \/\/ Column doesn't present in table2\r\n{code}\r\nrenders\r\n{code:sql}\r\nSELECT table1.*, table2.*, table3.* FROM table1 NATURAL JOIN table2 INNER JOIN table3 ON table1.col = table3.col;\r\n{code}\r\nIn this case, Oracle accepts:\r\n{code:sql}\r\nSELECT * FROM table1 NATURAL JOIN table2 INNER JOIN table3 ON table1.col = table3.col;\r\n    or\r\nSELECT table3.* FROM table1 NATURAL JOIN table2 INNER JOIN table3 ON table1.col = table3.col;\r\n{code}\r\n----\r\nLast piece of code:\r\n{code}\r\n$select = new Zend_Db_Select();\r\n$select->form('table1','col1');  \/\/ Column col1 can be in table2 or not\r\n$select->joinNatural('table2',null);\r\n{code}\r\nrenders\r\n{code:sql}\r\nSELECT table1.col1, table2. FROM table1 NATURAL JOIN table2;\r\n{code}\r\nIn this case, Oracle accepts:\r\n{code:sql}\r\nSELECT col1 FROM table1 NATURAL JOIN table2;\r\n{code}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/6",
                "name": "N\/A"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3168\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User"
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11263",
                    "filename": "zf3168.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "created": "2008-04-25T12:57:32.000+0000",
                    "size": 4730,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11263\/zf3168.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11262",
                    "filename": "zf3168.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "created": "2008-04-25T12:47:35.000+0000",
                    "size": 4696,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11262\/zf3168.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11267",
                    "filename": "zf3168_with_tests.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "created": "2008-04-26T04:29:57.000+0000",
                    "size": 8066,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11267\/zf3168_with_tests.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11266",
                    "filename": "zf3168_with_tests.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "created": "2008-04-26T03:05:01.000+0000",
                    "size": 7375,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11266\/zf3168_with_tests.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10174",
                    "id": 10174,
                    "description": "Mini Release",
                    "name": "1.5.1",
                    "userReleaseDate": "25\/Mar\/08",
                    "archived": true,
                    "releaseDate": "2008-03-25",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10132",
                    "id": 10132,
                    "name": "Zend_Db_Select",
                    "description": "OO interface to building a SELECT SQL query.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21501",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "body": "Correction",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "created": "2008-04-25T12:57:32.000+0000",
                    "updated": "2008-04-25T12:57:32.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21514",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "body": "New patch with associated tests",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "created": "2008-04-26T03:05:01.000+0000",
                    "updated": "2008-04-26T03:05:01.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/21515",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "body": "Another correction, this time on tests (default autoQutoeIdentifier is true)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "created": "2008-04-26T04:29:57.000+0000",
                    "updated": "2008-04-26T04:29:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/22224",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "Ralph, it might be worth checking in to whether Simon can take this one on. If not, please evaluate and fix\/categorize as necessary.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-06-09T12:30:15.000+0000",
                    "updated": "2008-06-09T12:30:15.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28018",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "Mickael, work with me next week to get this resolved.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2009-01-10T11:59:37.000+0000",
                    "updated": "2009-01-10T11:59:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28410",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "body": "I have also 2 tests failures that can be linked to this issue:\n\n2) testTableRelationshipFindManyToManyRowsetSelect(Zend_Db_Table_Relationships_OracleTest)\nZend_Db_Statement_Oracle_Exception: 918 ORA-00918: d\u00dafinition de colonne ambigu SELECT z2.*\n            FROM (\n                SELECT z1.**, ROWNUM AS \"zend_db_rownum\"\n                FROM (\n                    SELECT \"i\".*, \"m\".* FROM \"zfbugs_products\" \"i\"\n INNER JOIN \"zfproducts\" \"m\" ON \"i\".\"product_id\" = \"m\".\"product_id\" WHERE (\"bug_id\" = 1) AND (\"i\".\"bug_id\" = 1.000000) O\nRDER BY \"product_name\" ASC\n                ) z1\n            ) z2\n            WHERE z2.\"zend_db_rownum\" BETWEEN 1 AND 2\nD:\\web\\ZendFramework\\standard\\trunk\\library\\Zend\\Db\\Statement\\Oracle.php:274\nD:\\web\\ZendFramework\\standard\\trunk\\library\\Zend\\Db\\Statement.php:283\nD:\\web\\ZendFramework\\standard\\trunk\\library\\Zend\\Db\\Adapter\\Abstract.php:457\nD:\\web\\ZendFramework\\standard\\trunk\\library\\Zend\\Db\\Select.php:639\nD:\\web\\ZendFramework\\standard\\trunk\\library\\Zend\\Db\\Table\\Row\\Abstract.php:1043\n\n3) testTableRelationshipMagicFindManyToManyRowsetSelect(Zend_Db_Table_Relationships_OracleTest)\nZend_Db_Statement_Oracle_Exception: 918 ORA-00918: d\u00dafinition de colonne ambigu SELECT z2.*\n            FROM (\n                SELECT z1.**, ROWNUM AS \"zend_db_rownum\"\n                FROM (\n                    SELECT \"i\".*, \"m\".* FROM \"zfbugs_products\" \"i\"\n INNER JOIN \"zfproducts\" \"m\" ON \"i\".\"product_id\" = \"m\".\"product_id\" WHERE (\"bug_id\" = 1) AND (\"i\".\"bug_id\" = 1.000000) O\nRDER BY \"product_name\" ASC\n                ) z1\n            ) z2\n            WHERE z2.\"zend_db_rownum\" BETWEEN 1 AND 2",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mikaelkael",
                        "name": "mikaelkael",
                        "displayName": "Mickael Perraud",
                        "active": true
                    },
                    "created": "2009-01-22T11:07:55.000+0000",
                    "updated": "2009-01-22T11:07:55.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29212",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=echo_94",
                        "name": "echo_94",
                        "displayName": "Thomas VEQUAUD",
                        "active": true
                    },
                    "body": "Hi there,\n\nI've got an exception with an oracle query executed via Zend but it works when I execute it with Toad...\n\nHere is the method building the query :\n      $select = $this->select();\n      $select->setIntegrityCheck(false);\n      $select->from(array(\"INDIVIDUS\" => \"EAI_TA_INDIVIDUS\"));\n      $select->joinInner(array(\"AFF\" => \"EAI_TA_AFFECTATIONS\"), 'INDIVIDUS.IND_ID = AFF.IND_ID');\n      $select->where('INDIVIDUS.ANN_ANNEE = ?', (int)$annee);\n      $select->where('INDIVIDUS.IND_MATRICULE = ?', $matricule);\n\nHere is the query :\nSELECT \"INDIVIDUS\".*, \"AFF\".*\nFROM \"EAI_TA_INDIVIDUS\" \"INDIVIDUS\"\nINNER JOIN \"EAI_TA_AFFECTATIONS\" \"AFF\" ON INDIVIDUS.IND_ID = AFF.IND_ID\nWHERE (INDIVIDUS.ANN_ANNEE = 2009) AND (INDIVIDUS.IND_MATRICULE = '17483')\n\nAnd here is the exception\n\nexception 'Zend_Db_Statement_Exception' with message 'SQLSTATE[HY000]: General error: 918 OCIStmtExecute: ORA-00918: column ambiguously defined\n (ext\\pdo_oci\\oci_statement.c:146)' in D:\\www\\Zend Framework\\Zend\\Db\\Statement\\Pdo.php:238\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=echo_94",
                        "name": "echo_94",
                        "displayName": "Thomas VEQUAUD",
                        "active": true
                    },
                    "created": "2009-02-28T01:29:08.000+0000",
                    "updated": "2009-02-28T01:32:23.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/52797",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "body": "Bulk change of all issues last updated before 1st January 2010 as \"Won't Fix\".\r\n\r\nFeel free to re-open and provide a patch if you want to fix this issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "created": "2012-11-20T20:53:28.000+0000",
                    "updated": "2012-11-20T20:53:28.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3168\/transitions"
}