{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6858",
    "key": "ZF-6858",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Form_File_Element: If file uploaded contains non latin characters (e.g. Arabic, Hebrew), $adapter->getFileName() returns only file extension."
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6858\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10331",
                    "id": 10331,
                    "description": "Mini Release",
                    "name": "1.8.3",
                    "userReleaseDate": "09\/Jun\/09",
                    "archived": false,
                    "releaseDate": "2009-06-09",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-05-29T11:37:05.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=untitled.no4@gmail.com",
                "name": "untitled.no4@gmail.com",
                "displayName": "G Cohen",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-05-29T06:57:36.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-06-02T05:23:35.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I have a form with a file element as such:\n$image = new Zend_Form_Element_File($image);\n\t$image->setLabel('Upload picture')\n\t\t->setRequired(TRUE)\n\t\t->setDestination($full_image_path)\n\t\t->addFilter('StripTags')\n\t\t->addFilter('StringTrim')\n\t\t->addValidator('Size', true, '2MB')\n\t\t->addValidator('Extension', true, 'jpg,jpeg');\n\t$image->getValidator('Extension')->setMessage('Only Jpeg (.jpg, .jpeg) images allowed');\n$form->addElement($image);\n\nThen when I process the form I have the following:\n$adapter = $form->getElement($image)->getTransferAdapter();\n$filename = $adapter-getFileName();\nWhen the name of the file uploaded uses non latin characters then the file name returned is empty with only the file extension (.jpg, for instance). The file is uploaded normally. \n\nTested with filename containing Hebrew, Arabic, Thai and Russian characters.\n\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6858\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10280",
                    "id": 10280,
                    "description": "Mini Release",
                    "name": "1.7.4",
                    "userReleaseDate": "02\/Feb\/09",
                    "archived": false,
                    "releaseDate": "2009-02-02",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31481",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Please note that this is a PHP error and not a error from ZF.\nFor reproduction do the following:\n\n{code}\n<?php\nerror_reporting(E_ALL|E_STRICT);\nini_set('include_path',ini_get('include_path').PATH_SEPARATOR.'..\/library');\nrequire_once('Zend\/Loader\/Autoloader.php');\n$loader = Zend_Loader_Autoloader::getInstance();\n\n\nprint \"<pre>\";\nvar_dump($_FILES);\nif (!empty($_FILES)) {\n    move_uploaded_file($_FILES['file']['tmp_name'], 'C:\\temp\\\u00fc\u00f6\u00df.jpg');\n}\n\n$request = new Zend_Controller_Request_Http();\n\n\/\/ setup the form\n$form = new Zend_Form();\n$form->setMethod(Zend_Form::METHOD_POST)\n     ->setAttrib('enctype', Zend_Form::ENCTYPE_MULTIPART);\n\n        $form = new Zend_Form();\n$element  = new Zend_Form_Element_File('file');\n$element->setLabel('Image')\n        ->setRequired(true)\n        ->setDestination('C:\\temp');\n\/\/$element->addFilter('rename', array('target' => 'C:\/temp\/', 'overwrite' => true));\n\n$form->addElement($element);\n$form->setAttrib('enctype', 'multipart\/form-data');\n$form->addElement('submit', 'Submit');\n\n\n\/\/ check the form\nif($request->isPost()) {\n    $formData = $request->getPost();\n    if($form->isValid($formData)) {\n        $form->file->addError('Test Error before receive');\n        $form->file->receive();\n        $form->file->addError('Test Error after receive');\n    } else {\nprint \"\\nMESSAGES:\";\n        $form->file->addError('Test Error when invalid');\n\/\/        print_r($form->file->getMessages());\n    }\n}\n\nprint \"<\/pre>\";\n\n?>\n\n<html>\n<head>\n<title>Test<\/title>\n<\/head>\n<body>\n<?php echo $form->render(new Zend_View());?>\n<\/body>\n<\/html>\n{code}\n\nAs you can see we call move_uploaded_file before any code from ZF is executed. Still move_uploaded_file is not able to rename the file when there are non-ascii characters available.\n\nIn my case, on Windows, the filename is written in iso-encoding and therefor broken as it's then \"\u00c3\u00bc\u00c3\u00b6\u00c3\u0178.jpg\" instead of \"\u00fc\u00f6\u00df.jpg'.\n\nTested on PHP 5.2.4 , WinXP.\nZF is not able to fix this behaviour. Therefor I will close this issue as won't fix.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-05-29T11:36:32.000+0000",
                    "updated": "2009-05-29T11:36:32.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31542",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=untitled.no4@gmail.com",
                        "name": "untitled.no4@gmail.com",
                        "displayName": "G Cohen",
                        "active": true
                    },
                    "body": "Thank you for the detailed answer. I'll have to think of a workaround to this.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=untitled.no4@gmail.com",
                        "name": "untitled.no4@gmail.com",
                        "displayName": "G Cohen",
                        "active": true
                    },
                    "created": "2009-06-02T02:16:03.000+0000",
                    "updated": "2009-06-02T02:16:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31548",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "When you know a workaround feel free to give us the information.\nMaybe we can include such a workaround also within the framework itself.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-06-02T05:23:29.000+0000",
                    "updated": "2009-06-02T05:23:29.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6858\/transitions"
}