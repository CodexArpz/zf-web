{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11594",
    "key": "ZF-11594",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Some zend validators dont set options in __construct"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11594\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10160",
                    "id": 10160,
                    "description": "Major Release",
                    "name": "Next Major Release",
                    "archived": false,
                    "released": false
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-10-27T18:50:47.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nick4fake",
                "name": "nick4fake",
                "displayName": "Bogdan Yurov",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-07-23T05:07:27.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-10-27T20:03:03.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "When creating form we can set validators via setValidators, e.g.:\r\n\r\n{code}\r\n$foo->setValidators(array(\r\n  new Zend_Validate_NotEmpty(array(\r\n    'messages' => array(\r\n    'isEmpty' => 'asdasd\u044c',\r\n     Zend_Validate_NotEmpty::INVALID => 'msg'\r\n   )\r\n))\r\n{code}\r\n\r\nHowever, that doesnt work. Message is never set. In source file:\r\n\r\n{code}\r\npublic function __construct($options = null)\r\n    {\r\n        if ($options instanceof Zend_Config) {\r\n            $options = $options->toArray();\r\n        } else if (!is_array($options)) {\r\n            $options = func_get_args();\r\n            $temp    = array();\r\n            if (!empty($options)) {\r\n                $temp['type'] = array_shift($options);\r\n            }\r\n\r\n            $options = $temp;\r\n        }\r\n\r\n        if (is_array($options) && array_key_exists('type', $options)) {\r\n            $this->setType($options['type']);\r\n        }\r\n    }\r\n{code}\r\n\r\nFor example, in Zend_Validate_EmailAddress:\r\n\r\n{code}\r\npublic function __construct($options = array())\r\n    {\r\n        if ($options instanceof Zend_Config) {\r\n            $options = $options->toArray();\r\n        } else if (!is_array($options)) {\r\n            $options = func_get_args();\r\n            $temp['allow'] = array_shift($options);\r\n            if (!empty($options)) {\r\n                $temp['mx'] = array_shift($options);\r\n            }\r\n\r\n            if (!empty($options)) {\r\n                $temp['hostname'] = array_shift($options);\r\n            }\r\n\r\n            $options = $temp;\r\n        }\r\n\r\n        $options += $this->_options;\r\n        $this->setOptions($options); \/\/ VERY IMPORTANT\r\n    }\r\n{code}\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11594\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10550",
                    "id": 10550,
                    "description": "Mini Release",
                    "name": "1.11.5",
                    "userReleaseDate": "07\/Apr\/11",
                    "archived": false,
                    "releaseDate": "2011-04-07",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10140",
                    "id": 10140,
                    "name": "Zend_Validate",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47702",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "All validators which use options set them within __construct.\r\n\r\nOnly the EmailAddress validator has a own setOptions method allows to use setMessages within setOption.\r\nThis is unique to this validator as it customizes the hostname validator.\r\n\r\nNote that this is no bug but actually intended behaviour.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2011-07-27T19:41:12.000+0000",
                    "updated": "2011-07-27T19:41:12.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47706",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nick4fake",
                        "name": "nick4fake",
                        "displayName": "Bogdan Yurov",
                        "active": true
                    },
                    "body": "Why that is not a bug? It would be great, if instead of:\r\n$name = new Zend_Form_Element_Text('name');\r\n.... many lines\r\n$name->getValidator('NotEmpty')->setMessages(array(\r\n  Zend_Validate_NotEmpty::IS_EMPTY => 'Name:'\r\n));\r\nI could write only:\r\n$name->->setValidators(array(\r\n  new Zend_Validate_NotEmpty(\r\n    'messages' => array(\r\n      Zend_Validate_NotEmpty::IS_EMPTY => 'Name:'      \r\n    )\r\n  )\r\n))\r\n\r\nIt IS a bug, when differend validators have very different __construct behaviour and most logical behaviour is supported only by one validator.\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nick4fake",
                        "name": "nick4fake",
                        "displayName": "Bogdan Yurov",
                        "active": true
                    },
                    "created": "2011-07-28T06:36:43.000+0000",
                    "updated": "2011-07-28T06:36:43.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47707",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "body": "*Please use code tags!*\r\n\r\nThis is not a bug: Zend_Form_Element handles this.\r\n{code:title=Excerpt from Zend_Form_Element::_loadValidator()}\r\nprotected function _loadValidator(array $validator)\r\n{\r\n    \/\/ \u2026\r\n\r\n    $messages = false;\r\n    if (isset($validator['options']) && array_key_exists('messages', (array)$validator['options'])) {\r\n        $messages = $validator['options']['messages'];\r\n        unset($validator['options']['messages']);\r\n    }\r\n\r\n    \/\/ \u2026\r\n\r\n    if ($messages) {\r\n        if (is_array($messages)) {\r\n            $instance->setMessages($messages);\r\n        } elseif (is_string($messages)) {\r\n            $instance->setMessage($messages);\r\n        }\r\n    }\r\n    \r\n    \/\/ \u2026\r\n}\r\n{code}\r\n\r\n{code:title=Example}\r\n$this->addElement(\r\n    'text',\r\n    'foo',\r\n    array(\r\n        'label'      => 'Foo',\r\n        'validators' => array(\r\n            array(\r\n                'NotEmpty',\r\n                true,\r\n                array(\r\n                    'messages' => array(\r\n                        Zend_Validate_NotEmpty::IS_EMPTY => 'My message.',\r\n                    ),\r\n                ),\r\n            ),            \r\n        ),\r\n    )\r\n);\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "created": "2011-07-28T07:08:40.000+0000",
                    "updated": "2011-07-28T07:26:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47708",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nick4fake",
                        "name": "nick4fake",
                        "displayName": "Bogdan Yurov",
                        "active": true
                    },
                    "body": "But i wrote it in another way:\r\nnew Zend_Validate_NotEmpty(\r\n'messages' => array(\r\nZend_Validate_NotEmpty::IS_EMPTY => 'Name:' \r\n)\r\n)\r\nthat doesn't work",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nick4fake",
                        "name": "nick4fake",
                        "displayName": "Bogdan Yurov",
                        "active": true
                    },
                    "created": "2011-07-28T07:32:09.000+0000",
                    "updated": "2011-07-28T07:32:09.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47710",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "body": "*Please use code tags!* No one can read your code examples!\r\n\r\nYour initial question begins with: \"When creating form\u2026\" and my example shows a working path.\r\nWhy is it a bug and not a proposal for an improvement?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "created": "2011-07-28T07:46:47.000+0000",
                    "updated": "2011-07-28T07:46:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47711",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nick4fake",
                        "name": "nick4fake",
                        "displayName": "Bogdan Yurov",
                        "active": true
                    },
                    "body": "I'm sorry, did not know how to use the code tag. BB or HTML?\r\nIt is a bug, because in zend docs two ways of coding described: factory and objects (your code - factory, my code - with the help of objects). First of all one would think that both approaches are identical, while you write, that only with the first one described behaviour can be achieved.\r\n\r\nSorry for my english and tone (I would not want you to think I was rude, the reason is bad knowlege :) )",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nick4fake",
                        "name": "nick4fake",
                        "displayName": "Bogdan Yurov",
                        "active": true
                    },
                    "created": "2011-07-28T08:10:04.000+0000",
                    "updated": "2011-07-28T08:10:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47712",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "body": "{quote}I'm sorry, did not know how to use the code tag. BB or HTML?{quote}\r\n[Take a look at the question mark over the send button.|http:\/\/framework.zend.com\/issues\/secure\/WikiRendererHelpAction.jspa?section=all]\r\n\r\nMy proposal for Zend_Form_Element:\r\n{code:title=Proposal (not tested!)}\r\npublic function addValidator($validator, $breakChainOnFailure = false, $options = array())\r\n{\r\n    if ($validator instanceof Zend_Validate_Interface) {\r\n        $name = get_class($validator);\r\n\r\n        if (!isset($validator->zfBreakChainOnFailure)) {\r\n            $validator->zfBreakChainOnFailure = $breakChainOnFailure;\r\n        }\r\n        \r\n        \/\/ Set messages\r\n        if (array_key_exists('messages', (array) $options)) {            \r\n            if (is_array($options['messages'])) {\r\n                $validator->setMessages($options['messages']);\r\n            } elseif (is_string($options['messages'])) {\r\n                $validator->setMessage($options['messages']);\r\n            }\r\n        } \r\n    } elseif (is_string($validator)) {\r\n        \/\/ \u2026\r\n    } else {\r\n        \/\/ \u2026\r\n    }\r\n\r\n    \/\/ \u2026\r\n}\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "created": "2011-07-28T08:35:46.000+0000",
                    "updated": "2011-07-28T08:35:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47713",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nick4fake",
                        "name": "nick4fake",
                        "displayName": "Bogdan Yurov",
                        "active": true
                    },
                    "body": "That is great! The only problem is that this code is not in the branch yet.\r\nThanks. I suggest adding something like this to the branch.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nick4fake",
                        "name": "nick4fake",
                        "displayName": "Bogdan Yurov",
                        "active": true
                    },
                    "created": "2011-07-28T08:47:34.000+0000",
                    "updated": "2011-07-28T08:47:34.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47716",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "body": "I wrote a unit test and the implementation for Zend_Form_Element.\r\nShould we move this issue to Zend_Form?\r\n\r\nThomas, what is your opinion?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "created": "2011-07-28T09:31:55.000+0000",
                    "updated": "2011-07-28T09:31:55.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47719",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "@Yurov:\r\n{quote}Why that is not a bug?{quote}\r\nA feature which is wether described within the documentation nor implemented within the component is a new feature request and not a bug.\r\n\r\n@Kai:\r\nI suggest to add a new feature request linked to this one where you can add this feature to Zend_Form.\r\nRegardless of your improvement for Zend_Form I am actually doing on a similar change to Zend_Validator because it should also work this way when validators are used standalone.\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2011-07-28T10:38:25.000+0000",
                    "updated": "2011-07-28T10:38:25.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48822",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Added to ZF2 with [GH-520|https:\/\/github.com\/zendframework\/zf2\/pull\/520].\nBackporting to ZF1 is not possible due to BC inconsistencies.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2011-10-27T18:50:47.000+0000",
                    "updated": "2011-10-27T18:50:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/48828",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nick4fake",
                        "name": "nick4fake",
                        "displayName": "Bogdan Yurov",
                        "active": true
                    },
                    "body": "Thanks a lot!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=nick4fake",
                        "name": "nick4fake",
                        "displayName": "Bogdan Yurov",
                        "active": true
                    },
                    "created": "2011-10-27T20:03:03.000+0000",
                    "updated": "2011-10-27T20:03:03.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11594\/transitions"
}