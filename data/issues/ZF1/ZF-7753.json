{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7753",
    "key": "ZF-7753",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Rest_Route doesn't accepts 'action' for url assembling"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField",
            "value": {
                "timeoriginalestimate": 0,
                "timeestimate": 0
            }
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/11",
                "name": "Patch",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7753\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/5",
                "name": "Cannot Reproduce"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-10-16T16:59:03.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                "name": "admloki",
                "displayName": "Alex Zinchenko",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-09-02T03:35:52.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-01-29T19:42:01.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "Zend_Navigation",
                "Zend_Rest_Route"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend_Rest_Route doesn't accepts 'action' for url assembling.\n\nE.g.\n{code:javascript}\n$navi = new Zend_Navigation();\n$page = Zend_Navigation_Page::factory(array('controller' => 'page',  'label'\t=> 'Pages');\n$page2 = Zend_Navigation_Page::factory(array('controller' => 'page',  'label' => 'New page', 'action' => 'new');\n$page2->setParent($page);\n$navi->addPage($page);\n\nZend_Registry::set('Zend_Navigation', $navi);\n{code}\nthen in the view\n{code}\n<?=$this->navigation()->menu(); ?>\n{code}\nwill result into\n{code}\n<ul>\n        <li class=\"active\">\n                <a href=\"\/page\">Page<\/a>\n                <ul>\n                    <li class=\"active\">\n                        <a href=\"\/page\">Create new page<\/a>\n                    <\/li>\n                <\/ul>\n        <\/li>\n<\/ul>\n{code}\n\nSolution:\nModify the assemble() method.\n\nIn Zend_Rest_Route, line 248, add:\n{code}\nif(isset($params[$this->_actionKey])) {\n        \t$action = $params[$this->_actionKey];\n        \tif($action === $this->_defaults[$this->_actionKey]) {\n\t        \t$action = '';\n\t        } else {\n\t        \t$action = '\/' . $params[$this->_actionKey];\n\t        }\n        } else {\n        \t$action = '';\n        }\n{code}\nIn Zend_Rest_Route, line 261, replace:\n{code}\nif (!empty($url) || $controller !== $this->_defaults[$this->_controllerKey]) {\n        \t\t$url = '\/' . $controller . $url;\n}\n{code}\nwith\n{code}\n$url = '\/' . $controller . $action . $url;\n{code}\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/1",
                "name": "Blocker"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7753\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                "name": "freak",
                "displayName": "Dolf Schimmel (Freeaqingme)",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12185",
                    "filename": "zend_rest_route.diff",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                        "name": "admloki",
                        "displayName": "Alex Zinchenko",
                        "active": true
                    },
                    "created": "2009-09-02T13:25:31.000+0000",
                    "size": 2679,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12185\/zend_rest_route.diff"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10320",
                    "id": 10320,
                    "description": "Minor Release",
                    "name": "1.9.0",
                    "userReleaseDate": "31\/Jul\/09",
                    "archived": false,
                    "releaseDate": "2009-07-31",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10350",
                    "id": 10350,
                    "description": "Mini Release",
                    "name": "1.9.1",
                    "userReleaseDate": "11\/Aug\/09",
                    "archived": false,
                    "releaseDate": "2009-08-11",
                    "released": true
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10361",
                    "id": 10361,
                    "description": "Mini Release",
                    "name": "1.9.2",
                    "userReleaseDate": "25\/Aug\/09",
                    "archived": false,
                    "releaseDate": "2009-08-25",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10406",
                    "id": 10406,
                    "name": "Zend_Navigation",
                    "isAssigneeTypeValid": false
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10422",
                    "id": 10422,
                    "name": "Zend_Rest_Route",
                    "description": "Includes both Zend_Rest_Route and Zend_Rest_Controller",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34176",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                        "name": "admloki",
                        "displayName": "Alex Zinchenko",
                        "active": true
                    },
                    "body": "Much elegant solution.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                        "name": "admloki",
                        "displayName": "Alex Zinchenko",
                        "active": true
                    },
                    "created": "2009-09-02T06:26:58.000+0000",
                    "updated": "2009-09-02T06:26:58.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34177",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                        "name": "admloki",
                        "displayName": "Alex Zinchenko",
                        "active": true
                    },
                    "body": "Now it's really elegant solution.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                        "name": "admloki",
                        "displayName": "Alex Zinchenko",
                        "active": true
                    },
                    "created": "2009-09-02T06:28:07.000+0000",
                    "updated": "2009-09-02T06:28:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34178",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "You need to specify the route with your pages:\n{code}\npage2 = Zend_Navigation_Page::factory(array('route' => 'routeName', 'controller' => 'page',  'label' => 'New page', 'action' => 'new');\n{code}\nand then it should work. I've had success with this approach using the actions \"index\", \"get\", \"post\", \"put\", and \"delete\"; I haven't tried \"edit\" or \"new\", but both should work.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2009-09-02T06:29:18.000+0000",
                    "updated": "2009-09-02T06:29:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34182",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                        "name": "admloki",
                        "displayName": "Alex Zinchenko",
                        "active": true
                    },
                    "body": "My application uses Zend_Rest_Route as default router.\nI don't think its because of undefined route name in Zend_Navigation_Page initialization.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                        "name": "admloki",
                        "displayName": "Alex Zinchenko",
                        "active": true
                    },
                    "created": "2009-09-02T07:34:37.000+0000",
                    "updated": "2009-09-02T07:34:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34183",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                        "name": "admloki",
                        "displayName": "Alex Zinchenko",
                        "active": true
                    },
                    "body": "Matthew, i checked that - solution you provided not working.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                        "name": "admloki",
                        "displayName": "Alex Zinchenko",
                        "active": true
                    },
                    "created": "2009-09-02T07:38:51.000+0000",
                    "updated": "2009-09-02T07:38:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34199",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                        "name": "admloki",
                        "displayName": "Alex Zinchenko",
                        "active": true
                    },
                    "body": "Found a solution for issue [ZF-7760|http:\/\/framework.zend.com\/issues\/browse\/ZF-7760]. Please check.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admloki",
                        "name": "admloki",
                        "displayName": "Alex Zinchenko",
                        "active": true
                    },
                    "created": "2009-09-02T13:25:32.000+0000",
                    "updated": "2009-09-02T13:25:32.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34724",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=robinsk",
                        "name": "robinsk",
                        "displayName": "Robin Skoglund",
                        "active": true
                    },
                    "body": "1. Are you absolutely sure you're using a REST route?\n2. Have you tried specifying the route in the page, as Matthew suggests?\n3. If none of the two above work out for you, could you provde minimum code required to reproduce the bug?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=robinsk",
                        "name": "robinsk",
                        "displayName": "Robin Skoglund",
                        "active": true
                    },
                    "created": "2009-09-19T15:57:52.000+0000",
                    "updated": "2009-09-19T15:57:52.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34976",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lcrouch",
                        "name": "lcrouch",
                        "displayName": "Luke Crouch",
                        "active": true
                    },
                    "body": "sorry for the hiatus everyone. busy having a baby. ;)\n\nis this still an issue? reading the comment backlog, I can't tell if Matthew's solution worked or not, and I've never used Zend_Navigation. can someone write a test case that replicates the way Zend_Navigation could\/should use the route for pagination url's?\n\nthanks.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lcrouch",
                        "name": "lcrouch",
                        "displayName": "Luke Crouch",
                        "active": true
                    },
                    "created": "2009-09-29T13:36:41.000+0000",
                    "updated": "2009-09-29T13:36:41.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35315",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=robinsk",
                        "name": "robinsk",
                        "displayName": "Robin Skoglund",
                        "active": true
                    },
                    "body": "It's been a few weeks now, so I guess this is not an issue anymore.\n\nAlex: Could you provide a reproducable case?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=robinsk",
                        "name": "robinsk",
                        "displayName": "Robin Skoglund",
                        "active": true
                    },
                    "created": "2009-10-16T15:34:06.000+0000",
                    "updated": "2009-10-16T15:34:06.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35319",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "body": "So, after having a hard time to reproduce the behavior I was totally unable to. The code I used:\r\n{code}<?php\r\nerror_reporting(E_ALL|E_STRICT);\r\n\r\nrequire_once 'Zend\/Navigation.php';\r\nrequire_once 'Zend\/View.php';\r\nrequire_once 'Zend\/Navigation\/Page.php';\r\nrequire_once 'Zend\/View\/Helper\/Navigation.php';\r\nrequire_once 'Zend\/Controller\/Front.php';\r\nrequire_once 'Zend\/Controller\/Request\/Http.php';\r\n\r\nZend_Controller_Front::getInstance()->getRouter()->addDefaultRoutes();\r\nZend_Controller_Front::getInstance()->setRequest('Zend_Controller_Request_Http');\r\n\r\n$navi = new Zend_Navigation();\r\n$page = Zend_Navigation_Page::factory(array('controller' => 'page',  'label'    => 'Pages'));\r\n$page2 = Zend_Navigation_Page::factory(array('controller' => 'page',  'label' => 'New page', 'action' => '$\r\n$page2->setParent($page);\r\n$navi->addPage($page);\r\n\r\n$helper = new Zend_View_Helper_Navigation();\r\n$helper->setView(new Zend_View());\r\n\r\necho $helper->menu($navi);\r\n{code}\r\n\r\nTherefore closing this issue as cannot reproduce. A next time you create an issue, please make sure to include _all_ relevant code, preferably in a way it can be tested in cli mode. Furthermore it's unclear what the expected outcome of your code is, making it all totally vague.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=freak",
                        "name": "freak",
                        "displayName": "Dolf Schimmel (Freeaqingme)",
                        "active": true
                    },
                    "created": "2009-10-16T16:58:31.000+0000",
                    "updated": "2009-10-16T16:58:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/35367",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=groovecoder",
                        "name": "groovecoder",
                        "displayName": "Luke Crouch",
                        "active": true
                    },
                    "body": "Thanks Dolf.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=groovecoder",
                        "name": "groovecoder",
                        "displayName": "Luke Crouch",
                        "active": true
                    },
                    "created": "2009-10-17T13:07:27.000+0000",
                    "updated": "2009-10-17T13:07:27.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44212",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=r13ckj",
                        "name": "r13ckj",
                        "displayName": "Rick Jones",
                        "active": true
                    },
                    "body": "Hi Dolf, I think I'm experiencing the same issue. In your test you're not adding a REST route. Wouldn't that be why you can't reproduce the issue?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=r13ckj",
                        "name": "r13ckj",
                        "displayName": "Rick Jones",
                        "active": true
                    },
                    "created": "2011-01-29T18:59:08.000+0000",
                    "updated": "2011-01-29T18:59:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44213",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=r13ckj",
                        "name": "r13ckj",
                        "displayName": "Rick Jones",
                        "active": true
                    },
                    "body": "Ah! My issue was slightly different - I was using post action in nav conf. Now I understand more about how REST routing works in Zend Framework, I've figured it out. There doesn't appear to be an issue here. As Matthew said it might be a problem by not declaring routes in nav conf. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=r13ckj",
                        "name": "r13ckj",
                        "displayName": "Rick Jones",
                        "active": true
                    },
                    "created": "2011-01-29T19:41:59.000+0000",
                    "updated": "2011-01-29T19:41:59.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7753\/transitions"
}