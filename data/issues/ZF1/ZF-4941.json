{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4941",
    "key": "ZF-4941",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Broken ViewRenderer inflections for   :controller with custom dispatcher."
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4941\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-11-21T05:00:24.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coling",
                "name": "coling",
                "displayName": "Colin Guthrie",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-11-13T12:57:45.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-11-21T05:00:24.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I have a custom dispatcher which changes the class structure of the controllers to better suit my file layout and autoloading infrastructure. Therefor my dispatcher::formatControllerName function does not return strings that end in \"Controller\" as per the default.\n\nIn the ViewRenderer.php file there is the function:\n\n{code}\n protected function _translateSpec(array $vars = array())\n {\n   ...\n   $controller = substr($dispatcher->formatControllerName($request->getControllerName()), 0, -10);\n   ...\n }\n{code}\n\nObviously this code is assuming the normal \"Controller\" suffix on controller names, but with a custom dispatcher this may not be the case.\n\nIn my code I have a controller name of \"Controller_Index\", this is converted to \"Contro\", by the above line, and ultimately to \"contro\" later on.\n\n\nThis assumption is not documented in the:\nhttp:\/\/www.framework.zend.com\/manual\/en\/zend.controller.actionhelpers.html#zend.controller.actionhelpers.viewrenderer\n\nwhich talks about the conventions surrounding the automatic conversions:\n\n{quote}\n:controller: MixedCase and camelCasedWords are separated by dashes; underscores are converted to directory separators, and the entire string cast to lower case. Examples: \"FooBar\" becomes \"foo-bar\"; \"FooBar_Admin\" becomes \"foo-bar\/admin\".\n\nInternally, the inflector uses the filters Zend_Filter_Word_CamelCaseToDash, Zend_Filter_Word_UnderscoreToSeparator, and Zend_Filter_StringToLower.\n{quote}\n\n\nPerhaps the dispatcher should have another method called:\nformatControllerNameForManipulation() that (by default) does not append the \"Controller\" suffix that formatControllerName does. This would avoid the need for the substr(..., 0, -10) and is a something that could be controlled in a custom dispatcher?\n\nI need to implement a solution here, so I'd like to know the right approach to take, so the patch can go upstream. I'll attach my first stab at a fix in a moment, and I'd really appreciate feedback.\n\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4941\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11637",
                    "filename": "ViewRenderer-Fix-Broken-Controller-Formatting.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coling",
                        "name": "coling",
                        "displayName": "Colin Guthrie",
                        "active": true
                    },
                    "created": "2008-11-13T13:00:35.000+0000",
                    "size": 3428,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11637\/ViewRenderer-Fix-Broken-Controller-Formatting.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11649",
                    "filename": "ViewRenderer-Fix-Broken-Controller-Formatting2.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coling",
                        "name": "coling",
                        "displayName": "Colin Guthrie",
                        "active": true
                    },
                    "created": "2008-11-20T06:47:12.000+0000",
                    "size": 3652,
                    "mimeType": "text\/x-patch",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11649\/ViewRenderer-Fix-Broken-Controller-Formatting2.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10251",
                    "id": 10251,
                    "description": "Mini Release",
                    "name": "1.6.2",
                    "userReleaseDate": "13\/Oct\/08",
                    "archived": false,
                    "releaseDate": "2008-10-13",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10011",
                    "id": 10011,
                    "name": "Zend_Controller",
                    "description": "front controller, including router and dispatcher",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26088",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coling",
                        "name": "coling",
                        "displayName": "Colin Guthrie",
                        "active": true
                    },
                    "body": "Here is a patch that adds a new method to the Dispatcher interface and the abstract implementation. This should be mostly backwards compatible. For those who have defined a custom dispatcher, it may have some impact if they implement a creative formatControllerName method and use ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coling",
                        "name": "coling",
                        "displayName": "Colin Guthrie",
                        "active": true
                    },
                    "created": "2008-11-13T13:00:38.000+0000",
                    "updated": "2008-11-13T13:00:38.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26089",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coling",
                        "name": "coling",
                        "displayName": "Colin Guthrie",
                        "active": true
                    },
                    "body": "Forgot to say that I've not yet filled in the contributor agreement thing... I'm falling behind on such things.... I'll do it shortly but rest assured you can use the patch attached however you see fit :)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coling",
                        "name": "coling",
                        "displayName": "Colin Guthrie",
                        "active": true
                    },
                    "created": "2008-11-13T13:11:11.000+0000",
                    "updated": "2008-11-13T13:11:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26506",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coling",
                        "name": "coling",
                        "displayName": "Colin Guthrie",
                        "active": true
                    },
                    "body": "I found another occurrence of the same assumption in ViewRenderer. This updated patch addresses this.\n\nI also removed the removal of the redundant call that I mentioned in my last patch as this is a different issue and I don't want to cloud the real issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coling",
                        "name": "coling",
                        "displayName": "Colin Guthrie",
                        "active": true
                    },
                    "created": "2008-11-20T06:47:14.000+0000",
                    "updated": "2008-11-20T06:47:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26525",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "This is a backwards incompatible patch as it adds a new method to an existing interface -- this would be an API break for anybody implementing the interface currently.\n\nThe real issue here is that we pull the controller name from the dispatcher, which, in the standard implementation, returns the class name (i.e., 'index' gets returned as IndexController). What should likely happen instead is that we pull it via the request object. I will work on a fix immediately.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-11-20T12:37:32.000+0000",
                    "updated": "2008-11-20T12:37:32.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26528",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Fix applied in trunk for the formatControllerName() issue (no longer uses it; instead, pulls directly from the request object). Use the ViewRenderer's inflector to format the name accordingly for view script mapping.\n\n(Fix applied to trunk in r12725 and 1.7 release branch in r12726)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-11-20T12:56:59.000+0000",
                    "updated": "2008-11-20T12:56:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26548",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coling",
                        "name": "coling",
                        "displayName": "Colin Guthrie",
                        "active": true
                    },
                    "body": "Awesome, thanks Matthew.\n\nForgive me for being a tool, but I can find your first commit fine (http:\/\/framework.zend.com\/code\/rdiff\/Zend_Framework?csid=12725&u&N) but wanted to copy the patch of your second one to my 1.7 version and cannot for the life of me find it.\n\nIt doesn't seems to be in either Zend_Framework or Standard_Library that I can see :s If you could direct me (more for future reference as I'm sure the patch still applies) that would be great.\n\nAlso should I close this issue our you? Not quite sure of the workflow here....",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coling",
                        "name": "coling",
                        "displayName": "Colin Guthrie",
                        "active": true
                    },
                    "created": "2008-11-21T04:19:30.000+0000",
                    "updated": "2008-11-21T04:19:30.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/26550",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "The two revisions are the same -- the first was simply applied against trunk, the second against the 1.7 release branch (so that it will be picked up in future 1.7.x releases). You can use the one you linked to to apply against your install.\n\nTypically the person fixing the issue closes it; I'll do so.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-11-21T05:00:07.000+0000",
                    "updated": "2008-11-21T05:00:07.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4941\/transitions"
}