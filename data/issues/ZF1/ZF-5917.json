{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5917",
    "key": "ZF-5917",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Date calculation don't work right for year, week of day and day of week"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5917\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10291",
                    "id": 10291,
                    "description": "Mini Release",
                    "name": "1.7.7",
                    "userReleaseDate": "16\/Mar\/09",
                    "archived": false,
                    "releaseDate": "2009-03-16",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-03-02T03:32:11.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fadoe",
                "name": "fadoe",
                "displayName": "Falk Doering",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-03-02T00:27:00.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-03-02T04:07:36.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I calculate the date by tree variables: the year, the week of year and the day of week. I works good for the year 2009, the calendar week 10 and days 1 to 7. But the same doesn't work for the year 2008.\n\nExample code:\n\n<?php\n\nrequire_once 'Zend\/Date.php';\n\ndate_default_timezone_set('Europe\/Berlin');\n\n$year = 2009;\n$calendarweek = 10;\n\nfor ($i = 1; $i <= 7; $i++) {\n\n\t$dateTmp = new Zend_Date();\n\t$dateTmp->set($i, Zend_Date::WEEKDAY_8601);\n\t$dateTmp->set($calendarweek, Zend_Date::WEEK);\n\t$dateTmp->set($year, Zend_Date::YEAR);\n\n\techo $year . '\/' . $calendarweek . '\/' . $i . ': ' .$dateTmp->toString(\"YYYY-MM-dd\") . '<br \/>';\n\n}\n\necho '<hr \/>';\n$year = 2008;\n\nfor ($i = 1; $i <= 7; $i++) {\n\n\t$dateTmp = new Zend_Date();\n\t$dateTmp->set($i, Zend_Date::WEEKDAY_8601);\n\t$dateTmp->set($calendarweek, Zend_Date::WEEK);\n\t$dateTmp->set($year, Zend_Date::YEAR);\n\n\techo $year . '\/' . $calendarweek . '\/' . $i . ': ' .$dateTmp->toString(\"YYYY-MM-dd\") . '<br \/>';\n\n}\n\n\nOutput:\n\n2009\/10\/1: 2009-03-02\n2009\/10\/2: 2009-03-03\n2009\/10\/3: 2009-03-04\n2009\/10\/4: 2009-03-05\n2009\/10\/5: 2009-03-06\n2009\/10\/6: 2009-03-07\n2009\/10\/7: 2009-03-08\n\n2008\/10\/1: 2008-03-02\n2008\/10\/2: 2008-03-03\n2008\/10\/3: 2008-03-04\n2008\/10\/4: 2008-03-05\n2008\/10\/5: 2008-03-06\n2008\/10\/6: 2008-03-07\n2008\/10\/7: 2008-03-08"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/2",
                "name": "Critical"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5917\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10272",
                    "id": 10272,
                    "description": "Mini Release",
                    "name": "1.7.5",
                    "userReleaseDate": "16\/Feb\/09",
                    "archived": false,
                    "releaseDate": "2009-02-16",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10072",
                    "id": 10072,
                    "name": "Zend_Date",
                    "description": "Zend_Date is the basic library for the handling of all date, time and calendar-related issues.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29220",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Would you be so polite to write what you problem is ?\nFilling a issue without writing what's the problem is not helpfull.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-02T01:19:31.000+0000",
                    "updated": "2009-03-02T01:19:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29221",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fadoe",
                        "name": "fadoe",
                        "displayName": "Falk Doering",
                        "active": true
                    },
                    "body": "I think the problem is clear. The date calculation is wrong.\n\nThe first day (monday ISO 8601) from calendar week 10 in 2008 is not the 2 march 2008, it is the 3 march 2008. The output is an saturday.\nThe secound day (tuesday ISO 8601) from calendar week 10 in 2008 is not the 3 march, it is the 4 march 2008. The output is an monday and so on.\n\nHere is an other example:\n\n<?php\n\ndate_default_timezone_set('Europe\/Berlin');\n\nrequire_once 'Zend\/Date.php';\n\nZend_Date::setOptions(array('format_type' => 'php'));\n\n$year = 2009;\n$calendarweek = 10;\n\n\nfor ($i = 1; $i <= 7; $i++) {\n\n\t$dateTmp = new Zend_Date();\n\t$dateTmp->set($i, Zend_Date::WEEKDAY_8601);\n\t$dateTmp->set($calendarweek, Zend_Date::WEEK);\n\t$dateTmp->set($year, Zend_Date::YEAR);\n\n\techo $year . '\/' . $calendarweek . '\/' . $i . ': ' .$dateTmp->toString(\"Y-m-d\") . '<br \/>';\n\techo $dateTmp->toString(\"Y\/W\/N\") . '<br \/>';\n}\n\necho '<hr \/>';\n$year = 2004;\n\nfor ($i = 1; $i <= 7; $i++) {\n\n\t$dateTmp = new Zend_Date();\n\t$dateTmp->set($i, Zend_Date::WEEKDAY_8601);\n\t$dateTmp->set($calendarweek, Zend_Date::WEEK);\n\t$dateTmp->set($year, Zend_Date::YEAR);\n\n\techo $year . '\/' . $calendarweek . '\/' . $i . ': ' .$dateTmp->toString(\"Y-m-d\") . '<br \/>';\n\techo $dateTmp->toString(\"Y\/W\/N\") . '<br \/>';\n\n}\n\nOutput:\n\n2009\/10\/1: 2009-03-02\n2009\/10\/1\n2009\/10\/2: 2009-03-03\n2009\/10\/2\n2009\/10\/3: 2009-03-04\n2009\/10\/3\n2009\/10\/4: 2009-03-05\n2009\/10\/4\n2009\/10\/5: 2009-03-06\n2009\/10\/5\n2009\/10\/6: 2009-03-07\n2009\/10\/6\n2009\/10\/7: 2009-03-08\n2009\/10\/7\n2004\/10\/1: 2004-03-02\n2004\/10\/2\n2004\/10\/2: 2004-03-03\n2004\/10\/3\n2004\/10\/3: 2004-03-04\n2004\/10\/4\n2004\/10\/4: 2004-03-05\n2004\/10\/5\n2004\/10\/5: 2004-03-06\n2004\/10\/6\n2004\/10\/6: 2004-03-07\n2004\/10\/7\n2004\/10\/7: 2004-03-08\n2004\/11\/1\n\nHere you can see, in 2004 the calendar week 10, day 7 is in the Zend_Date class the 11 calendar week, day 1. The same with 2005, 2006, 2007, 2008. Only 2009 is right.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fadoe",
                        "name": "fadoe",
                        "displayName": "Falk Doering",
                        "active": true
                    },
                    "created": "2009-03-02T02:32:50.000+0000",
                    "updated": "2009-03-02T02:32:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29223",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "{quote}I think the problem is clear. The date calculation is wrong. {quote}\nWhen this would be the case, I would not have asked.\n\n{code}\nfor ($i = 1; $i <= 7; $i++) {\n    $dateTmp = new Zend_Date();\n    $dateTmp->set($i, Zend_Date::WEEKDAY_8601);\n    $dateTmp->set($calendarweek, Zend_Date::WEEK);\n    $dateTmp->set($year, Zend_Date::YEAR);\n    echo $year . '\/' . $calendarweek . '\/' . $i . ': ' .$dateTmp->toString(\"YYYY-MM-dd\") . '<br \/>'; }\n{code}\n\nYou are doing the following:\n\n||code||resulting date||\n|$dateTmp = new Zend_Date();|02.March.2009|\n|$dateTmp->set($i, Zend_Date::WEEKDAY_8601);|02.March.2009 expecting monday as $i|\n|$dateTmp->set($calendarweek, Zend_Date::WEEK);|02.March.2009 when week is 10|\n|$dateTmp->set($year, Zend_Date::YEAR);|02.March.2008 when year is 2008|\n\nAs you can see, all values are set according to the actual date.\nWhen you need the calendarweek 10 of year 2008, you can not set the week in the year 2009... I bet 100% that they differ.\n\nWhen calculating dates you have to take this in account.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-02T03:30:58.000+0000",
                    "updated": "2009-03-02T03:30:58.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29224",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "False order of calculation. No issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-02T03:32:10.000+0000",
                    "updated": "2009-03-02T03:32:10.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29226",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fadoe",
                        "name": "fadoe",
                        "displayName": "Falk Doering",
                        "active": true
                    },
                    "body": "Okay. You are right. But what is the solution? I think it make no sence that $date = new Zend_Date(); and $date = Zend_Date::now(); are the same. How can i create an empty Zend_Date-Object?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fadoe",
                        "name": "fadoe",
                        "displayName": "Falk Doering",
                        "active": true
                    },
                    "created": "2009-03-02T04:07:36.000+0000",
                    "updated": "2009-03-02T04:07:36.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5917\/transitions"
}