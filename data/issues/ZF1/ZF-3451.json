{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3451",
    "key": "ZF-3451",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Inconsistencies in the Zend_Auth_Adapter.. api"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3451\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=akzincdig",
                "name": "akzincdig",
                "displayName": "Ashley Kitson",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-06-12T02:38:12.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-02-08T06:14:11.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "There are inconsistencies across the various supplied adapters for Zend_Auth.  In particular the naming conventions for getting and setting usernames and password\/credentials do not match up across the different adapters.  In code I have recently developed I have need to 'if statement' certain aspects e.g.\n\n1\/ when setting credentials\n\n\t        \/\/because the zend supplied adapters don't all have the same interface\n\t        \/\/we need to check for existence of functions before calling them\n\t        \/\/@todo - raise bug with ZF and change when fixed\n\t        if (self::$_authType=='digest' || self::$_authType=='ldap') {\n                        self::$_authHandler->setUsername($username)\n                                   ->setPassword($password);\n\t           } else {\n                            self::$_authHandler->setIdentity($username)\n                                   ->setCredential($password);\n\t        }\n\n2\/ when retrieving the username:\n\n\tpublic function getIdentity(Zend_Auth_Result $res) {\n\t    $id = $res->getIdentity();\n\t    if (self::$_authType=='digest') {\n\t        return $id['username'];\n\t    } else {\n\t        return $id;\n\t    }\n\t}\n\nI think that the Zend_Auth_Adapter_Interface specification needs to be extended and all child adapters made to conform to it.  I might suggest that at a minimum it needs to include:\n\npublic function authenticate(); \/\/already there\npublic function authenticateWithCredentials($username,$password);\npublic function setUsername(string $username);\npublic function setPassword(string $password);\npublic function getUsername();\npublic function getPassword();\npublic function setOptions(array $options);  \/\/set adapter specific options\npublic function getOptions();\n\nAlso Zend_Auth_Result should be extended by adding a getUsername() method to return just the username used to authenticate, in addition to the getIdentity() method which can continue to return the full identity array.\n\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3451\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/10000",
                "name": "Postponed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10174",
                    "id": 10174,
                    "description": "Mini Release",
                    "name": "1.5.1",
                    "userReleaseDate": "25\/Mar\/08",
                    "archived": true,
                    "releaseDate": "2008-03-25",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10084",
                    "id": 10084,
                    "name": "Zend_Auth",
                    "description": "A abstraction for various concrete web application authentication implementations.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23739",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=miallen",
                        "name": "miallen",
                        "displayName": "Michael B Allen",
                        "active": true
                    },
                    "body": "Assuming credentials are always a username and password is a common mistake in web applications. Credential can be a domain+username+password, a PKI certificate, a base 64 encoded blob (e.g. SPNEGO Single Sign-On), etc.\n\nI think the following would be better:\n\npublic function authenticate($credential = null);\npublic function setCredential($credential);\npublic function getCredential();\n\nSo using the LDAP adapter might look like:\n\n  $ldap->authenticate(array($username, $password));\n\nBut I would allow adapters to provide adapter specific methods (e.g. setUsername(), setPassword()).\n\nAlso, I don't think Zend_Auth::getIdentity() should return anything but a string that uniquely identifies the user across all adapters used by the application. If you want more info about the user there could be a Zend_Auth::getAccount() method that returned an object with account related methods like setPassword(), etc. Of course that's beyond the scope of the current ZF effort but I'm just thinking ahead.\n\nI've explained this approach in more detail on the ZF mailing list in the past:\n\n  http:\/\/www.nabble.com\/Re:-Storing-additional-authentication-data-with-Zend_Auth_Adapter_OpenId-p16225178s16154.html\n\nOf course this is all just one man's opinion.\n\nMike",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=miallen",
                        "name": "miallen",
                        "displayName": "Michael B Allen",
                        "active": true
                    },
                    "created": "2008-08-26T13:47:48.000+0000",
                    "updated": "2008-08-26T13:47:48.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28691",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gearhead",
                        "name": "gearhead",
                        "displayName": "Bryce Lohr",
                        "active": true
                    },
                    "body": "With respect to the credentials problem, the standard OO answer is \"encapsulate what varies\". Since we know credentials take many varied forms, we could introduce a \"Zend_Auth_Credentials_Interface\", then add a \"setCredentials(Zend_Auth_Credentials_Interface $creds)\" method to Zend_Auth_Adapter_Interface. Each auth adapter would then provide its own concrete implementation of the credentials interface to represent any kind of credentials it needs. Of course, the application would have be prepared to provide all the correct credentials, whatever form they take. But in situations like the reported issue where you want to use two different adapters, both based on a username and password, you could do something like this:\n\n\/\/ MyCredentialsFactory would know (perhaps from application configuration) which concrete adapter is being used\n$creds = MyCredentialsFactory->create($username, $password);\n\n$authAdapter->setCredentials($creds);\n$result = $authAdapter->authenticate();",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gearhead",
                        "name": "gearhead",
                        "displayName": "Bryce Lohr",
                        "active": true
                    },
                    "created": "2009-02-07T08:54:47.000+0000",
                    "updated": "2009-02-07T08:54:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28698",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "The approach you outline regarding credentials is actually how the adapter implementation works currently, more or less. You instantiate your adapter, and typically pass the credentials in the constructor _or_ pass them to appropriate concrete methods in the speciific adapter. This is in part because credentials do not need to consist necessarily of a username and password.\n\nTo a degree, I like the idea of a credential interface, but I think it's overkill, as credentialling was part of the design of the authentication adapters. That said, I think there are some benefits to making the shipped adapters more consistent -- but it will have to be something that waits until we can break backwards compatibility.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2009-02-08T06:12:20.000+0000",
                    "updated": "2009-02-08T06:12:20.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3451\/transitions"
}