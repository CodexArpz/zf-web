{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12157",
    "key": "ZF-12157",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Validate_EmailAddress returns INVALID_SEGMENT when the address is routable"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12157\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rokclimb15@gmail.com",
                "name": "rokclimb15@gmail.com",
                "displayName": "Brian Morton",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2012-04-16T19:50:34.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-04-16T19:50:34.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "Zend_Validate_EmailAddress"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "ESPN.com has public routable MX servers that sit on a network segment beginning with 192, but not in a class C reserved range.  The _isReserved check has a couple of bugs that prevent proper validation.\r\n\r\nA test case\r\n\r\n{code}\r\n$validator = new Zend_Validate_EmailAddress();\r\n$validator->setOptions(array(\r\n    'allow' => Zend_Validate_Hostname::ALLOW_DNS,\r\n    'mx'    => true,\r\n    'deep'  => true\r\n));\r\nZend_Debug::dump($validator->isValid('test@espn.com'));\r\n{code}\r\n\r\nSome debug data:\r\n{panel}\r\ndig espn.com MX\r\n\r\n; <<>> DiG 9.7.1-P2 <<>> espn.com MX\r\n;; global options: +cmd\r\n;; Got answer:\r\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 17090\r\n;; flags: qr rd ra; QUERY: 1, ANSWER: 5, AUTHORITY: 0, ADDITIONAL: 5\r\n\r\n;; QUESTION SECTION:\r\n;espn.com.\t\t\tIN\tMX\r\n\r\n;; ANSWER SECTION:\r\nespn.com.\t\t374\tIN\tMX\t10 mx005.espn.com.\r\nespn.com.\t\t374\tIN\tMX\t10 mx006.espn.com.\r\nespn.com.\t\t374\tIN\tMX\t10 mx002.espn.com.\r\nespn.com.\t\t374\tIN\tMX\t10 mx003.espn.com.\r\nespn.com.\t\t374\tIN\tMX\t10 mx004.espn.com.\r\n\r\n;; ADDITIONAL SECTION:\r\nmx005.espn.com.\t\t227\tIN\tA\t192.234.2.158\r\nmx006.espn.com.\t\t205\tIN\tA\t192.234.2.159\r\nmx002.espn.com.\t\t228\tIN\tA\t192.234.2.155\r\nmx003.espn.com.\t\t205\tIN\tA\t192.234.2.156\r\nmx004.espn.com.\t\t169\tIN\tA\t192.234.2.157\r\n{panel}\r\n\r\nLines 365 and 366 of Zend_Validate_EmailAddress->_isReserved have typecasts to integer that make the subsequent checks as type array on lines 370 and 371 fail.  Removing the int casts makes the comparison work properly.\r\n\r\nMoreover, the entire check is conceptually incorrect since a range outside of what is in _invalidIp is fundamentally valid.  Rather than checking if it is outside of the address range in each _invalidIp and returning false, it should probably check if it is inside the range and return true on line 372, and then return false by default on line 377.\r\n\r\n\r\n\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12157\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10981",
                    "id": 10981,
                    "description": "Mini Release",
                    "name": "1.11.11",
                    "userReleaseDate": "29\/Sep\/11",
                    "archived": false,
                    "releaseDate": "2011-09-29",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10140",
                    "id": 10140,
                    "name": "Zend_Validate",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [

            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12157\/transitions"
}