{
    "expand": "html",
    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-319",
    "key": "ZF-319",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_HTTP_Response   isRedirect is incorrect"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-319\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10040",
                    "id": 10040,
                    "description": "Preview Release; MVC maturation, HTTP client, Gdata",
                    "name": "0.6.0",
                    "userReleaseDate": "16\/Dec\/06",
                    "archived": true,
                    "releaseDate": "2006-12-16",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2006-11-27T11:48:16.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=sfox@carleton.edu",
                "name": "sfox@carleton.edu",
                "displayName": "Sean Fox",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2006-08-14T11:36:58.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2007-07-05T14:43:17.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I haven't dug into the code completely but it appears that:\n\nWhen a Zend_Http_Client request results in a redirect the  response headers are reset at each redirection.  As a result the response headers always reflects the final response.   So for instance the status header is always 200  (even if the initial response was a 301) and so when isRedirect is called it always returns false (unless we've gone over the redirection limit).  \n\nIt would seem necessary to track if any redirect has happened  (e.g. by setting some sort of hasbeenRedirected flag at line 94 in Client.php) and save that information so that isRedirect could correctly reflect what happened during the request.\n\nOn a related note it would be useful to be able to determine the actual url finally retrieved after a sequence of redirects and\/or the headers of intermediate request(s) in a series of redirects (so one could determine the final url requested from the location headers)"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-319\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=shahar",
                "name": "shahar",
                "displayName": "Shahar Evron",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/attachment\/10092",
                    "filename": "ZF-ver-0.1.5-redirect-fix.patch",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=sfox@carleton.edu",
                        "name": "sfox@carleton.edu",
                        "displayName": "Sean Fox",
                        "active": true
                    },
                    "created": "2006-08-15T11:50:26.000+0000",
                    "size": 2921,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/framework.zend.com\/issues\/secure\/attachment\/10092\/ZF-ver-0.1.5-redirect-fix.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10001",
                    "id": 10001,
                    "description": "Preview Release",
                    "name": "0.1.5",
                    "userReleaseDate": "11\/Jul\/06",
                    "archived": true,
                    "releaseDate": "2006-07-11",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/component\/10015",
                    "id": 10015,
                    "name": "Zend_Http_Client",
                    "description": "performs HTTP requests",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/10702",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=sfox@carleton.edu",
                        "name": "sfox@carleton.edu",
                        "displayName": "Sean Fox",
                        "active": true
                    },
                    "body": "Thinking about this more it is seems the real problem isn't that isRedirect returns the wrong code (if the request you are interested in is the last one in a redirect sequence) and it is a useful indicator as to whether you've run up against redirectMax.  It's that one might (I am) be interested in whether  any redirects took place in the process of getting to the final request.  Of particular interest is the particular redirect code(s) and the final uri requested (the one for which the header information this function returns applies).   To that end I've cooked up the attached patch to add in  getRedirectStatus and getFinalUri variables to http response and made the minor changes need to http client so those variable are appropriately populated.   The patch is against 0.1.5  (not the developer's version if that is really any different) and it's not the most complete set of functions for dealing with this issue (it might be nice to see the whole string of redirects followed rather than just get information about the last one).  But for my purposes this is sufficient.  Perhaps it's worth adding into the framework code.....",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=sfox@carleton.edu",
                        "name": "sfox@carleton.edu",
                        "displayName": "Sean Fox",
                        "active": true
                    },
                    "created": "2006-08-15T11:49:49.000+0000",
                    "updated": "2006-08-15T11:49:49.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/10703",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=sfox@carleton.edu",
                        "name": "sfox@carleton.edu",
                        "displayName": "Sean Fox",
                        "active": true
                    },
                    "body": "The aforementioned patch",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=sfox@carleton.edu",
                        "name": "sfox@carleton.edu",
                        "displayName": "Sean Fox",
                        "active": true
                    },
                    "created": "2006-08-15T11:50:26.000+0000",
                    "updated": "2006-08-15T11:50:26.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/10798",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=shahar",
                        "name": "shahar",
                        "displayName": "Shahar Evron",
                        "active": true
                    },
                    "body": "If you can, please try to look into the incubator HTTP client (which will hopefully soon replace the current version of the HTTP client) - it is much different and more robust.\n\nAnyway, I'm going to look into improving this issue issue.\n\nIn the mean time, you should be able to get the final URL with $client->getUri()->__toString()\n(or simply getUri() if you're interested in the Zend_Uri_Http object).\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=shahar",
                        "name": "shahar",
                        "displayName": "Shahar Evron",
                        "active": true
                    },
                    "created": "2006-09-09T03:36:38.000+0000",
                    "updated": "2006-09-09T03:36:38.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/11380",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Changing fix version to 0.6.0.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2006-11-13T15:15:58.000+0000",
                    "updated": "2006-11-13T15:15:58.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/11662",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=shahar",
                        "name": "shahar",
                        "displayName": "Shahar Evron",
                        "active": true
                    },
                    "body": "I'm not going to fix this now as I think that there is no wide need for such \"logging\" HTTP client. Most people just need to get the final result, and adding these history functionalities would be an unnecessary complication for most developers.\n\nIMHO, the best way to tackle this would be to inherit Zend_Http_Client and override the request() method, so that it would log all response codes \/ URIs before continuing in a redirection. This shouldn't be to hard to do.\n\nIf you have more suggestions \/ thoughts, I suggest discussing them in fw-webservices@lists.zend.com .\n\nThanks!",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=shahar",
                        "name": "shahar",
                        "displayName": "Shahar Evron",
                        "active": true
                    },
                    "created": "2006-11-27T11:48:16.000+0000",
                    "updated": "2006-11-27T11:48:16.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-319\/transitions"
}