{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3934",
    "key": "ZF-3934",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "clean of Zend_Cache with File Backend does not work as expected"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3934\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-08-13T00:48:40.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lordlamer",
                "name": "lordlamer",
                "displayName": "frank habermann",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-08-12T12:47:57.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-08-28T02:58:38.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "The clean function with CLEANING_MODE_MATCHING_TAG and CLEANING_MODE_NOT_:MATCHING_TAG with File Backend does not work as expected. I think i found a logical problem in this class.\n\nExample:\n{code}\n$cache->save($huge_data, 'myUniqueID', array('tagA', 'tagB', 'tagC'));\n$cache->clean(Zend_Cache::CLEANING_MODE_MATCHING_TAG, array('tagX', 'tagC'));\n{code}\n\nMy logic says that the cache wit id 'myUniqueID' should be cleared. But try it out. It will not be deleted If the first of the tags will not be found the hole entry will not be deleted in the backend.\n\nSo i changed the following here in file Zend\/Cache\/Backend\/File.php from line 508 to 531\n{code}\n                    case Zend_Cache::CLEANING_MODE_MATCHING_TAG:\n                        $matching = false;\n                        foreach ($tags as $tag) {\n                            if (in_array($tag, $metadatas['tags'])) {\n                                $matching = true;\n                                break;\n                            }\n                        }\n                        if ($matching) {\n                            $result = ($result) && ($this->remove($id));\n                        }\n                        break;\n                    case Zend_Cache::CLEANING_MODE_NOT_MATCHING_TAG:\n                        $matching = true;\n                        foreach ($tags as $tag) {\n                            if (in_array($tag, $metadatas['tags'])) {\n                                $matching = false;\n                                break;\n                            }\n                        }\n                        if ($matching) {\n                            $result = ($result) && $this->remove($id);\n                        }                       \n                        break;\n{code}\n\nAfter changing this the function works as expected.\n\n---\n\na third parameter to the clean function would be fine to affect if AND or OR is used by CLEANING_MODE_MATCHING_TAG and CLEANING_MODE_NOT_MATCHING_TAG"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/2",
                "name": "Critical"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3934\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                "name": "fab",
                "displayName": "Fabien MARTY",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10050",
                    "id": 10050,
                    "description": "Minor Release Candidate",
                    "name": "1.6.0RC2",
                    "userReleaseDate": "11\/Aug\/08",
                    "archived": true,
                    "releaseDate": "2008-08-11",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10028",
                    "id": 10028,
                    "name": "Zend_Cache",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23470",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "body": "No it works as expected\n\nwhen you use \"$cache->clean(Zend_Cache::CLEANING_MODE_MATCHING_TAG, array('tagX', 'tagC'));\" you want to clean cache records which are tagged with tagX __AND__ tagC\n\nif you want to clean cache records which are tagged with  tagX __OR__ tagC, you have to do (two lines)\n\n{code}\n\"$cache->clean(Zend_Cache::CLEANING_MODE_MATCHING_TAG, array('tagX')\"; \"$cache->clean(Zend_Cache::CLEANING_MODE_MATCHING_TAG, array('tagC')\";\n{code}\n\nIt's a choice (because you can do AND and OR). If we choosed your solution, it would be impossible to make an AND\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=fab",
                        "name": "fab",
                        "displayName": "Fabien MARTY",
                        "active": true
                    },
                    "created": "2008-08-13T00:48:07.000+0000",
                    "updated": "2008-08-13T00:48:07.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3934\/transitions"
}