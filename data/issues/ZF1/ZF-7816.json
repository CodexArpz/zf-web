{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7816",
    "key": "ZF-7816",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "ContextSwitch and Zend_Rest_Route Are Fighting!"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7816\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-09-10T03:44:05.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ajcoon",
                "name": "ajcoon",
                "displayName": "AJ Coon",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-09-09T18:03:14.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-09-10T03:44:05.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "When using Zend\/Controller\/Action\/Helper\/ContextSwitch.php to handle view resolution for different response formats (e.g. XML, JSON), specifying \"format\" causes Zend_Rest_Route to handle POST as PUT.\n\n\nGiven a request such as this:\n\nPOST \/controller\/format\/json\nsend: {'username':'ajcoon','password':'mypass'}\n\nAs I understand it, the inclusion of \/format\/json tells the ContextSwitch to look for a view under application\/views\/scripts\/$action.json.phtml.  \n\n\nBut, the presence \/format\/json in the request causes Zend_Rest_Route to set $action to 'put', even though 'post' has been specified as the HTTP method.  See Zend\/Rest\/Route.php:173\n    switch( $values[$this->_actionKey] ){\n\nThere should be a way to use ContextSwitch and Zend_Rest_Route together.  Maybe there is, and it's not documented?\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7816\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10340",
                    "id": 10340,
                    "description": "Mini Release",
                    "name": "1.8.4",
                    "userReleaseDate": "23\/Jun\/09",
                    "archived": false,
                    "releaseDate": "2009-06-23",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10422",
                    "id": 10422,
                    "name": "Zend_Rest_Route",
                    "description": "Includes both Zend_Rest_Route and Zend_Rest_Controller",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34357",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lcrouch",
                        "name": "lcrouch",
                        "displayName": "Luke Crouch",
                        "active": true
                    },
                    "body": "Hmm ... I've not used ContextSwitch before but you're right - they should be compatible. Can you try:\n\nPOST \/controller\/?format=json\n\nI know it's not optimal, but maybe it can work for now?\n\nAside from that, IMO ContextSwitch should be enhanced to accommodate formats specified via the 'Accept' HTTP request header, e.g.,\n\nhttp:\/\/www.w3.org\/Protocols\/HTTP\/HTRQ_Headers.html#z3\n\nSo maybe the best fix belongs there? If others agree, I can make the change. I've written my own context-switching action helper that does it already.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lcrouch",
                        "name": "lcrouch",
                        "displayName": "Luke Crouch",
                        "active": true
                    },
                    "created": "2009-09-09T19:44:56.000+0000",
                    "updated": "2009-09-09T19:44:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34358",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ajcoon",
                        "name": "ajcoon",
                        "displayName": "AJ Coon",
                        "active": true
                    },
                    "body": "?format=json definitely does the trick, thanks for the suggestion.\n\nI agree with your recommendation.  IMO, would add to it that:\n* ContextSwitch should compare Accept header to URL and throw exception if context specified is not in Accept header.  An exception message should be set such that this usage error is clear to the user.\n* When inspecting URI, ContextSwitch should be aware of its contextParam value (might not always be set to 'format')\n\nOverall I think ContextSwitch is a great idea and will definitely continue using it!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ajcoon",
                        "name": "ajcoon",
                        "displayName": "AJ Coon",
                        "active": true
                    },
                    "created": "2009-09-09T20:02:21.000+0000",
                    "updated": "2009-09-09T20:02:21.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/34362",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "For the projects where I've been using Zend_Rest_Route, I've written plugins that do detection on the Accept header and then set the \"format\" request parameter accordingly. This is a better approach overall -- and likely should be built in to ContextSwitch. However, that's a topic for another proposal.\n\nClosing this issue as \"not an issue\" as there are clearly workarounds! :)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2009-09-10T03:42:10.000+0000",
                    "updated": "2009-09-10T03:42:10.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7816\/transitions"
}