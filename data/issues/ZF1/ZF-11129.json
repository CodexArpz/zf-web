{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11129",
    "key": "ZF-11129",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "DbSelect Adapter connect again"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11129\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-02-26T06:14:22.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                "name": "thadafinser",
                "displayName": "Martin Keckeis",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-03-02T00:47:37.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-02-26T06:14:22.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "New Problem description - see my next comment\r\n\r\n\r\nOld description\r\n-Hello,-\r\n\r\n-i'm using Zend_Paginator with the DbSelect adapter.-\r\n\r\n-Zend_Paginator_Adapter_DbSelect connect to the database, although there is a connection.-\r\n\r\n-Screenshots:\r\n-$dbLisp connects to the database to get the session.-\r\n-Afterwards I use $dbLisp-->select() to create the Zend_Db_Select object -> so it should also be connected, but Zend_Paginator connect again.-"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11129\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                "name": "adamlundrigan",
                "displayName": "Adam Lundrigan",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13661",
                    "filename": "double_connect.jpg",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                        "name": "thadafinser",
                        "displayName": "Martin Keckeis",
                        "active": true
                    },
                    "created": "2011-03-04T04:20:21.000+0000",
                    "size": 309265,
                    "mimeType": "image\/jpeg",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13661\/double_connect.jpg",
                    "thumbnail": "http:\/\/fw02.zend.com\/issues\/secure\/thumbnail\/13661\/_thumb_13661.png"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13659",
                    "filename": "double_connect_cache.jpg",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                        "name": "thadafinser",
                        "displayName": "Martin Keckeis",
                        "active": true
                    },
                    "created": "2011-03-04T04:20:21.000+0000",
                    "size": 250254,
                    "mimeType": "image\/jpeg",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13659\/double_connect_cache.jpg",
                    "thumbnail": "http:\/\/fw02.zend.com\/issues\/secure\/thumbnail\/13659\/_thumb_13659.png"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/13657",
                    "filename": "paginator_firebug.jpg",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                        "name": "thadafinser",
                        "displayName": "Martin Keckeis",
                        "active": true
                    },
                    "created": "2011-03-02T00:48:20.000+0000",
                    "size": 48630,
                    "mimeType": "image\/jpeg",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/13657\/paginator_firebug.jpg",
                    "thumbnail": "http:\/\/fw02.zend.com\/issues\/secure\/thumbnail\/13657\/_thumb_13657.png"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10028",
                    "id": 10028,
                    "name": "Zend_Cache",
                    "isAssigneeTypeValid": false
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10012",
                    "id": 10012,
                    "name": "Zend_Db",
                    "description": "interfaces, APIs, and adapters for various third-party data stores",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44607",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "body": "Zend_Paginator and his adapter connects never to a database!\r\nThis is the sole task of the database adapter.\r\n\r\nWhy is this issue critical?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "created": "2011-03-02T02:03:03.000+0000",
                    "updated": "2011-03-02T02:03:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44611",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "body": "Can you provide a complete example to reproduce the problem?\r\nThanks.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "created": "2011-03-02T06:37:01.000+0000",
                    "updated": "2011-03-02T06:37:01.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44612",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "body": "I can not reproduce the problem:\r\n\r\n{code:title=Simple example}\r\n\/\/ Adapter\r\n$dbAdapter = new Zend_Db_Adapter_Pdo_Mysql(array(\r\n    'host'     => 'localhost',\r\n    'username' => 'foo',\r\n    'password' => '',\r\n    'dbname'   => 'bar',\r\n    'profiler' => true,\r\n));\r\n\r\n\/\/ Select for a general query\r\n$selectForGeneralQuery = new Zend_Db_Select($dbAdapter);\r\n$selectForGeneralQuery->from('baz')->limit(1);\r\n\r\n\/\/ Execute\r\n$dbAdapter->query($selectForGeneralQuery);\r\n\r\n\/\/ Select for paginator\r\n$selectForPaginator = new Zend_Db_Select($dbAdapter);\r\n$selectForPaginator->from('baz');\r\n\r\n\/\/ Paginator\r\n$paginator = Zend_Paginator::factory($selectForPaginator);\r\n$paginator->setCurrentPageNumber(1);\r\n\r\n\/\/ Execute\r\n$paginator->getItem(1);\r\n\r\n\/\/ Ouput\r\nforeach ($dbAdapter->getProfiler()->getQueryProfiles() as $query) {\r\n    echo ($query->getQuery()) . \"\\n\";\r\n}\r\n<\/ul>\r\n{code}\r\n\r\n{code:title=Ouput|borderStyle=solid}\r\nconnect\r\nSELECT `baz`.* FROM `baz` LIMIT 1\r\nSELECT COUNT(1) AS `zend_paginator_row_count` FROM `baz`\r\nSELECT `baz`.* FROM `baz` LIMIT 10\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "created": "2011-03-02T07:19:37.000+0000",
                    "updated": "2011-03-02T09:57:35.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44632",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                        "name": "thadafinser",
                        "displayName": "Martin Keckeis",
                        "active": true
                    },
                    "body": "Okay i found the problem.\r\n\r\nI store a copy of Zend_Db_Select in the cache (the select query).\r\n\r\nIn Zend_Cache the PHP function \"serialize\" is called.\r\n\r\nSerialize call the function \"__sleep\" from Zend_Db_Select object, which is located in Zend_Db_Adapter_Abstract.\r\nWhere the variable $this->_connection is set to \"false\".\r\n\r\nAfter that serialization the next query has to connect again.\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                        "name": "thadafinser",
                        "displayName": "Martin Keckeis",
                        "active": true
                    },
                    "created": "2011-03-04T04:22:19.000+0000",
                    "updated": "2011-03-04T04:46:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44633",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "body": "This is a normal behaviour:\r\n\r\n{code:title=Excerpt from Zend_Db_Adapter_Abstract}\r\n\/**\r\n * called when object is getting serialized\r\n * This disconnects the DB object that cant be serialized\r\n *\r\n * @throws Zend_Db_Adapter_Exception\r\n * @return array\r\n *\/\r\npublic function __sleep()\r\n{\r\n    \/\/ ...\r\n}\r\n{code}\r\n\r\n[http:\/\/framework.zend.com\/svn\/framework\/standard\/tags\/release-1.11.4\/library\/Zend\/Db\/Adapter\/Abstract.php]",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "created": "2011-03-04T05:57:11.000+0000",
                    "updated": "2011-03-04T05:57:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44666",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                        "name": "thadafinser",
                        "displayName": "Martin Keckeis",
                        "active": true
                    },
                    "body": "Yes it is the normal behaviour.\r\n\r\nBut in my case it's a problem:\r\nI use an instance ob the \"Zend_Db_Adapter_Pdo_Mysql\" to operate with the database.\r\nAlso i use this instance to create the \"Zend_Db_Select\".\r\n\r\nAfter the \"Zend_Db_Select\" object get saved in the cache serialized, the \"Zend_Db_Adapter_Pdo_Mysql\" instance also lose the connection and have to reconnect, if querys are executed after the serialization.\r\n\r\nSo how can i save the \"Zend_Db_Select\" in the cache, without losing my connection?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                        "name": "thadafinser",
                        "displayName": "Martin Keckeis",
                        "active": true
                    },
                    "created": "2011-03-08T00:37:19.000+0000",
                    "updated": "2011-03-08T00:37:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44669",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "body": "Within one page request you use a cache?!\r\n\r\nYou do the following: \r\n\r\n# create a Zend_Db_Select-object\r\n# save this select-object in cache\r\n# fetch the object from the cache\r\n# execute the select-query\r\n\r\n\r\nDid I understand correctly?\r\n\r\nCorrect me, but I think point 2 and 3 are unnecessary.\r\n\r\n{quote}So how can i save the \"Zend_Db_Select\" in the cache, without losing my connection?{quote}\r\nExtend the adapter class.\r\n\r\n(By the way, I hope, you don't save the select-object in Zend_Registry!)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "created": "2011-03-08T01:06:08.000+0000",
                    "updated": "2011-03-08T01:06:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44672",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                        "name": "thadafinser",
                        "displayName": "Martin Keckeis",
                        "active": true
                    },
                    "body": "I hope not, that i save it there ;-)\r\nNo, i save it with Zend_Cache in a file...\r\n\r\nI explain it now a little bit further:\r\nI got a datagrid, where result data from the Zend_Db_Select are displayed.\r\nThe datagrid got pagination, custom user filters and so on....\r\n\r\nOn the grid you have also the option to export the current displayed (and maybe filtered) data to PDF or Excel (without pagination\/limit).\r\nSo i have to take the last executed query from the user (which is saved in the cache) and remove the limit.\r\n\r\nI know that another options would be to cache the last filters set, but i liked to work with the Zend_Db_Select object.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thadafinser",
                        "name": "thadafinser",
                        "displayName": "Martin Keckeis",
                        "active": true
                    },
                    "created": "2011-03-08T02:33:04.000+0000",
                    "updated": "2011-03-08T02:33:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/44674",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "body": "Save the Zend_Db_Select object in the cache as the last step of all operations. So you have only one connection to the database and with the next request you can get the same select object from the cache.\r\n\r\n# create a Zend_Db_Select-object\r\n# execute the query\r\n# ...\r\n# save this select-object in cache - last step!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kaiuwe",
                        "name": "kaiuwe",
                        "displayName": "Kai Uwe",
                        "active": true
                    },
                    "created": "2011-03-08T03:30:51.000+0000",
                    "updated": "2011-03-08T03:30:51.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11129\/transitions"
}