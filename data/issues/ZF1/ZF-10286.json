{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10286",
    "key": "ZF-10286",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Auth_Adapater_Digest does not read entire file on blank lines"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10286\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/5",
                "name": "Cannot Reproduce"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-05-29T14:49:43.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=yanickrochon",
                "name": "yanickrochon",
                "displayName": "Yanick Rochon",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-08-09T17:39:09.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-05-29T14:49:43.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "After a good 5 minutes of login failures during development using a digest authentification, I finally realized what was going on: my file has a blank line in it.\r\n\r\nLook at the source code, I noticed that, on line 214 (in the authenticate() method), the while block condition fails whenever a blank line is found in the digest file.\r\n\r\nSince this is not written in the docs, it should be added about this behavior. Or better yet, the condition should be modified to read the entire file regardless of empty lines. In the PHP manual (http:\/\/php.net\/manual\/en\/function.fgets.php) the demo shows a similar while, but using feof($fileHandle) instead. Which gives more flexibility and ensures that the entire file is read before exiting the while block.\r\n\r\nFor example :\r\n\r\n{noformat} \r\n\/\/ line 214\r\nwhile (!@feof($fileHandle)) {\r\n\t$line = trim(fgets($fileHandle));\r\n\tif (!empty($line) && substr($line, 0, $idLength) === $id) {\r\n\t\tif (substr($line, -32) === md5(\"$this->_username:$this->_realm:$this->_password\")) {\r\n\t\t\t$result['code'] = Zend_Auth_Result::SUCCESS;\r\n\t\t} else {\r\n\t\t\t$result['code'] = Zend_Auth_Result::FAILURE_CREDENTIAL_INVALID;\r\n\t\t\t$result['messages'][] = 'Password incorrect';\r\n\t\t}\r\n\t\treturn new Zend_Auth_Result($result['code'], $result['identity'], $result['messages']);\r\n\t}\r\n}\r\n{noformat} "
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/5",
                "name": "Trivial"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10286\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                "name": "adamlundrigan",
                "displayName": "Adam Lundrigan",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10480",
                    "id": 10480,
                    "description": "Mini Release",
                    "name": "1.10.7",
                    "userReleaseDate": "28\/Jul\/10",
                    "archived": false,
                    "releaseDate": "2010-07-28",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10084",
                    "id": 10084,
                    "name": "Zend_Auth",
                    "description": "A abstraction for various concrete web application authentication implementations.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50811",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "body": "Patch w\/ Test:\r\n{code}\r\n\r\nIndex: tests\/Zend\/Auth\/Adapter\/Http\/_files\/htdigest.3\r\n===================================================================\r\n--- tests\/Zend\/Auth\/Adapter\/Http\/_files\/htdigest.3\t(revision 24820)\r\n+++ tests\/Zend\/Auth\/Adapter\/Http\/_files\/htdigest.3\t(working copy)\r\n@@ -1,2 +1,5 @@\r\n Bryce:Test Realm:d5b7c330d5685beb782a9e22f0f20579\r\n Mufasa:Test Realm:200dc292ecb68e04c95bb74ae2ce3c80\r\n+\r\n+\r\n+EmptyLineTest:Test Realm:200dc292ecb68e04c95bb74ae2ce3c80\r\nIndex: tests\/Zend\/Auth\/Adapter\/Http\/Resolver\/FileTest.php\r\n===================================================================\r\n--- tests\/Zend\/Auth\/Adapter\/Http\/Resolver\/FileTest.php\t(revision 24820)\r\n+++ tests\/Zend\/Auth\/Adapter\/Http\/Resolver\/FileTest.php\t(working copy)\r\n@@ -235,6 +235,18 @@\r\n     }\r\n \r\n     \/**\r\n+     * @group ZF-10286\r\n+     *\/\r\n+    public function testResolveFileIgnoresEmptyLines()\r\n+    {\r\n+        $this->assertEquals(\r\n+            $this->_resolver->resolve('EmptyLineTest', 'Test Realm'),\r\n+            '200dc292ecb68e04c95bb74ae2ce3c80',\r\n+            'Did not read entire file due to empty line'\r\n+        );\r\n+    }\r\n+\r\n+    \/**\r\n      * Ensures that resolve() works as expected when provided valid credentials\r\n      *\r\n      * @return void\r\n{code}\r\n\r\nThe above test passes without any modification to the existing {{Zend_Auth_Adapter_Http_Resolver_File}} class. ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=adamlundrigan",
                        "name": "adamlundrigan",
                        "displayName": "Adam Lundrigan",
                        "active": true
                    },
                    "created": "2012-05-29T14:49:43.000+0000",
                    "updated": "2012-05-29T14:49:43.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10286\/transitions"
}