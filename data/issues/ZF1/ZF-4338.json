{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4338",
    "key": "ZF-4338",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Add parentheses around UNION'ed selects"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4338\/votes",
                "votes": 11,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-08-14T12:07:11.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jaka",
                "name": "jaka",
                "displayName": "Jaka Jancar",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-09-20T08:20:46.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-10-28T14:22:59.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "MySQL manual says:\r\n\r\n{quote}\r\nTo use an ORDER BY or LIMIT clause to sort or limit the entire UNION result, parenthesize the individual SELECT statements and place the ORDER BY or LIMIT after the last one. The following example uses both clauses:\r\n{code}\r\n(SELECT a FROM t1 WHERE a=10 AND B=1)\r\nUNION\r\n(SELECT a FROM t2 WHERE a=11 AND B=2)\r\nORDER BY a LIMIT 10;\r\n{code}\r\n[...]\r\nTo apply ORDER BY or LIMIT to an individual SELECT, place the clause inside the parentheses that enclose the SELECT:\r\n{code}\r\n(SELECT a FROM t1 WHERE a=10 AND B=1 ORDER BY a LIMIT 10)\r\nUNION\r\n(SELECT a FROM t2 WHERE a=11 AND B=2 ORDER BY a LIMIT 10);\r\n{code}\r\n{quote}\r\n\r\nZend_Db_Select::_renderUnion() doesn't add parentheses around selects so ORDER BY is ambiguous.\r\n\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4338\/watchers",
                "isWatching": false,
                "watchCount": 8
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "zf-crteam-padraic",
                "zf-crteam-priority"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                "name": "padraic",
                "displayName": "P\u00e1draic Brady",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-11392",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11392",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                },
                {
                    "issueKey": "ZF-11852",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11852",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                },
                {
                    "issueKey": "ZF-7592",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-7592",
                    "type": {
                        "name": "Duplicate",
                        "direction": "INBOUND",
                        "description": "is duplicated by"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12102",
                    "filename": "Select.php.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=p0l0",
                        "name": "p0l0",
                        "displayName": "Marco",
                        "active": true
                    },
                    "created": "2009-07-23T22:41:57.000+0000",
                    "size": 492,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12102\/Select.php.patch"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12101",
                    "filename": "Select.php.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=p0l0",
                        "name": "p0l0",
                        "displayName": "Marco",
                        "active": true
                    },
                    "created": "2009-07-23T22:34:05.000+0000",
                    "size": 666,
                    "mimeType": "text\/plain",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12101\/Select.php.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10240",
                    "id": 10240,
                    "description": "Minor Release",
                    "name": "1.6.0",
                    "userReleaseDate": "02\/Sep\/08",
                    "archived": false,
                    "releaseDate": "2008-09-02",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10132",
                    "id": 10132,
                    "name": "Zend_Db_Select",
                    "description": "OO interface to building a SELECT SQL query.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28720",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=xorax",
                        "name": "xorax",
                        "displayName": "Martin Panel",
                        "active": true
                    },
                    "body": "Is so difficult to implement it ???\nThat affect all version after 1.6.0 and extends Zend_Db_Select is not easy !\n\n{code}\nprotected function _renderUnion($sql)\n{\n    if ($this->_parts[self::UNION]) {\n        $parts = count($this->_parts[self::UNION]);\n        foreach ($this->_parts[self::UNION] as $cnt => $union) {\n            list($target, $type) = $union;\n            if ($target instanceof Zend_Db_Select) {\n                $target = $target->assemble();\n            }\n            $sql .= ' ( '.$target.' ) ';\n            if ($cnt < $parts - 1) {\n                $sql .= ' ' . $type . ' ';\n            }\n        }\n    }\n     return $sql;\n}\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=xorax",
                        "name": "xorax",
                        "displayName": "Martin Panel",
                        "active": true
                    },
                    "created": "2009-02-10T03:02:59.000+0000",
                    "updated": "2009-02-10T03:02:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29117",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coditza",
                        "name": "coditza",
                        "displayName": "Petre Balau",
                        "active": true
                    },
                    "body": "To get the parentheses around the individual selects, use something like this:\n\n{code:java}\n$select_1 = $db->select()->...;\n$select_2 = $db->select()->...;\n\n$main_select = $db->select()->union( array(  '('.$select_1.')',  '('.$select_2.')' ) );\n{code}\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=coditza",
                        "name": "coditza",
                        "displayName": "Petre Balau",
                        "active": true
                    },
                    "created": "2009-02-26T09:17:00.000+0000",
                    "updated": "2009-02-26T09:17:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29125",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jaka",
                        "name": "jaka",
                        "displayName": "Jaka Jancar",
                        "active": true
                    },
                    "body": "That's a workaround, of course.\n\nBut that's not the point. This should be done inside Zend_Db_Select, otherwise it produces ambiguous SQL.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=jaka",
                        "name": "jaka",
                        "displayName": "Jaka Jancar",
                        "active": true
                    },
                    "created": "2009-02-26T10:41:34.000+0000",
                    "updated": "2009-02-26T10:41:34.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32891",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=p0l0",
                        "name": "p0l0",
                        "displayName": "Marco",
                        "active": true
                    },
                    "body": "I have made this patch on latest version, I don't think it breaks anything if each Union uses parentheses.\n\nWithout parentheses we can not use LIMIT or ORDER BY, except if we use the union( array(  '('.$select_1.')',  '('.$select_2.')' ) ); workaround, which is not very \"Zend\"",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=p0l0",
                        "name": "p0l0",
                        "displayName": "Marco",
                        "active": true
                    },
                    "created": "2009-07-23T22:34:07.000+0000",
                    "updated": "2009-07-23T22:34:07.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32892",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=p0l0",
                        "name": "p0l0",
                        "displayName": "Marco",
                        "active": true
                    },
                    "body": "Sorry, this is the correct patch file.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=p0l0",
                        "name": "p0l0",
                        "displayName": "Marco",
                        "active": true
                    },
                    "created": "2009-07-23T22:41:57.000+0000",
                    "updated": "2009-07-23T22:41:57.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38537",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=pybeaudouin",
                        "name": "pybeaudouin",
                        "displayName": "Pierre-Yves Beaudouin",
                        "active": true
                    },
                    "body": "Marco, thank you for your patch ! Unfortunately it does not seem to work with Framework 10.1, I get another error:\r\n\r\nNo table has been specified for the FROM clause\r\n\r\nI can not add parenthesis around my selects because it will convert them as strings and I need them as objects. Maybe your patch work on an older version of the framework ?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=pybeaudouin",
                        "name": "pybeaudouin",
                        "displayName": "Pierre-Yves Beaudouin",
                        "active": true
                    },
                    "created": "2010-02-18T07:47:13.000+0000",
                    "updated": "2010-02-18T07:47:13.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/38570",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=pybeaudouin",
                        "name": "pybeaudouin",
                        "displayName": "Pierre-Yves Beaudouin",
                        "active": true
                    },
                    "body": "Sorry for the spam - this bug is for ZF 1.7.5. Your patch works well with ZF 1.10.1.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=pybeaudouin",
                        "name": "pybeaudouin",
                        "displayName": "Pierre-Yves Beaudouin",
                        "active": true
                    },
                    "created": "2010-02-19T00:22:43.000+0000",
                    "updated": "2010-02-19T00:22:43.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46813",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=croensch",
                        "name": "croensch",
                        "displayName": "Christoph Roensch",
                        "active": true
                    },
                    "body": "I [believe|http:\/\/stackoverflow.com\/questions\/4653124] this is non-standard SQL, because of that it cannot be included in Zend_Db_Select.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=croensch",
                        "name": "croensch",
                        "displayName": "Christoph Roensch",
                        "active": true
                    },
                    "created": "2011-05-26T22:24:23.000+0000",
                    "updated": "2011-05-26T22:24:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47943",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "Marked as Won't Fix on the basis of:\n\n1. This is not standard SQL and is MySQL specific\n2. A known workaround exists and the fix would breach backwards compatibility.\n\nReporters and Assignee are recommended to fix in ZF2 if still a problem - or open a ZF2 issue in its respect.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2011-08-14T12:07:11.000+0000",
                    "updated": "2011-08-14T12:07:11.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4338\/transitions"
}