{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4940",
    "key": "ZF-4940",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "InlineScript script identification \/ auto-sensing same scripts"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/2",
                "name": "New Feature",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4940\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-11-20T20:53:07.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mot",
                "name": "mot",
                "displayName": "Tom Klingenberg",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-11-13T10:12:17.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-11-20T20:53:07.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "While using the InlineScript() view helper I had the Idea that this little helper checks for duplicate scripts (same script-fragment added multiple times) and reduces it to the single one.\n\nThis can be established by simply comparing a script while added against already stored scripts and\/or by letting the programmer providing an ID that identifies the script and in case the ID already exists overwrites the current store.\n\nIn my case it would be nice to have it because other view helper (for example with forms) add some code that is inititalized on the jQuery document.ready implementation and if the same form element is used multiple times, there is normally no need to have the init script multiple times at the end of a page as an inline script.\n\nI guesst this does make sense for other developers as well.\n\nI have not created any patch, I wanted to get feedback on the issue first.\n\nOnline-docs: http:\/\/framework.zend.com\/manual\/en\/zend.view.helpers.html#zend.view.helpers.initial.inlinescript\n\n---\n\nAfter taking the Idea some days with me, I would say it would be nice to have an add function that checks for uniqueness. Something like $this->inlineScript()->appendScriptOnce . That way the known way of using the helper is not affected and a programmer can more fine grained control the usage.\n\n---\n\nI created a working piece of code, that adds such a method on the fly by extending the ZF inlinescript view helper. I did it this way because while taking a look into the logic in __call of HeadScript I became aware of the fact that the function naming with \"Once\" at the end breaks the pattern used in there.\n\n{code}\n\/**\n * InlineScript()->appendScriptOnce()\n *\/\nclass View_Helper_InlineScript extends Zend_View_Helper_InlineScript {\n\n\t\/**\n\t * Overload method access\n\t *\n\t * Allows the following method call:\n\t * - appendScriptOnce($script, $type = 'text\/javascript', $attrs = array())\n\t * \n\t * @param  string $method \n\t * @param  array $args \n\t * @return View_Helper_InlineScript\n\t * @throws Zend_View_Exception if too few arguments or invalid method\n\t *\/\n\tpublic function __call($method, $args)\n\t{\t\t\t\t\t\t\n\t\tstatic $time = 0;\n\t\t\n\t\tif ('appendScriptOnce' === $method)\n\t\t{\n\t\t\tif (1 > count($args)) {\n\t\t\t\trequire_once 'Zend\/View\/Exception.php';\n\t\t\t\tthrow new Zend_View_Exception(sprintf('Method \"%s\" requires at least one argument, a script', $method));\n\t\t\t}\n                \n\t\t\t$content = $args[0];\n\t\t\t\n\t\t\tif (!$this->_isDuplicate($content))\n\t\t\t{\n\t\t\t\treturn parent::__call($method = 'appendScript', $args);\t\t\t\t\n\t\t\t} \n\t\t\telse \n\t\t\t{\t\t\t\t\n\t\t\t\treturn $this;\t\t\t\t\n\t\t\t}\t\n\t\t} \n\t\telse\n\t\t{\t\n\t\t\treturn parent::__call($method, $args);\n\t\t}\t\t\n\t}\n\t\n    \/**\n     * Return inlineScriptOnce object\n     *\n     * Returns inlineScriptOnce helper object; optionally, allows specifying a \n     * script or script file to include.\n     *\n     * @param  string $mode Script or file\n     * @param  string $spec Script\/url\n     * @param  string $placement Append, prepend, or set\n     * @param  array $attrs Array of script attributes\n     * @param  string $type Script type and\/or array of script attributes\n     * @return View_Helper_InlineScript\n     *\/\n    public function inlineScript($mode = Zend_View_Helper_HeadScript::FILE, $spec = null, $placement = 'APPEND', array $attrs = array(), $type = 'text\/javascript')\n    {\n        return parent::inlineScript($mode, $spec, $placement, $attrs, $type);\n    }\n    \n    \n    \/**\n     * Is the content specified a duplicate?\n     * \n     * @param  string $content\n     * @return bool\n     *\/\n    protected function _isDuplicate($content)\n    {\n        foreach ($this->getContainer() as $item)\n        {\n            if (($item->source === $content))\n            {\n                return true;\n            }\n        }\n        return false;\n    }\n    \n} \/\/ class\n{code}\nI have placed a file called \"InlineScript.php\" in the applications view helper directory and added that path with the 'View_Helper' Prefix.  Runs with no problems right now in my testapp.\n\nNeedless to say, this kind of implementation could be used to re-define the default behaviour as well converting all appendScript calls inside all views into this Once-variant.\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/6",
                "name": "N\/A"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4940\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User"
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10251",
                    "id": 10251,
                    "description": "Mini Release",
                    "name": "1.6.2",
                    "userReleaseDate": "13\/Oct\/08",
                    "archived": false,
                    "releaseDate": "2008-10-13",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10026",
                    "id": 10026,
                    "name": "Zend_View",
                    "description": "View portion of the ZF MVC",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/52604",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "body": "Bulk change of all issues last updated before 1st January 2010 as \"Won't Fix\".\r\n\r\nFeel free to re-open and provide a patch if you want to fix this issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rob",
                        "name": "rob",
                        "displayName": "Rob Allen",
                        "active": true
                    },
                    "created": "2012-11-20T20:53:07.000+0000",
                    "updated": "2012-11-20T20:53:07.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4940\/transitions"
}