{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10207",
    "key": "ZF-10207",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Return full locale instead of language code when locale has one region only"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10207\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/3",
                "name": "Duplicate"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10480",
                    "id": 10480,
                    "description": "Mini Release",
                    "name": "1.10.7",
                    "userReleaseDate": "28\/Jul\/10",
                    "archived": false,
                    "releaseDate": "2010-07-28",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-07-27T13:18:22.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=zeulus",
                "name": "zeulus",
                "displayName": "Marcin W\u00f3jcik",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-07-22T10:00:21.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-07-27T13:18:24.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I've found one annoying thing, when using Zend_Currency, which requires whole language+region locale. \r\n\r\nIn my situation, when trying:\r\n$currency = new Zend_Currency(array('value' => 12.34), new Zend_Locale());\r\n$currency = new Zend_Currency(array('value' => 12.34));\r\n\r\n...and using browser with:\r\nAccept-Language: pl,en-us;q=0.7,en;q=0.3\r\npl has default 1.0 quality factor.\r\n\r\n...and having:\r\nEnvironment language pl_PL, pl\r\nDefault language en_US\r\n\r\nI get that languages returned:\r\n\r\nbrowser array(3) {\r\n  [\"pl\"] => float(1)\r\n  [\"en_US\"] => float(0.7)\r\n  [\"en\"] => float(0.7)\r\n}\r\n\r\nenvironment array(2) {\r\n  [\"pl_PL\"] => int(1)\r\n  [\"pl\"] => int(1)\r\n}\r\n\r\ndefault array(1) {\r\n  [\"en\"] => bool(true)\r\n}\r\n\r\nauto array(4) {\r\n  [\"pl\"] => float(1)\r\n  [\"en_US\"] => float(0.7)\r\n  [\"en\"] => float(0.7)\r\n  [\"pl_PL\"] => int(1)\r\n}\r\n\r\nIssue: \r\nWhen it comes to choose, 'pl' is returned as locale, which disallows directly using Zend_Currency().\r\n\r\nSolution (request):\r\nWhen there are two languages with the same, highest quality factor, return more detailed one.\r\n\r\nGeneral idea: \r\nWhen language has only one region (it's not only Poland, there are more countries\/locales like this) there should be returned more detailed locale string ('pl_PL' instead of 'pl', 'lv_LV' <= 'lv')."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10207\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10470",
                    "id": 10470,
                    "description": "Mini Release",
                    "name": "1.10.6",
                    "userReleaseDate": "22\/Jun\/10",
                    "archived": false,
                    "releaseDate": "2010-06-22",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10073",
                    "id": 10073,
                    "name": "Zend_Locale",
                    "description": "Zend_Locale is a basic wrapper for all I18N and L10N issues for the Zend Framework. It provides the userbasically with access to translation functionality. It can handle different source file types for translation.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41697",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Locale Upgrading is another issue which is already worked on.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-07-24T06:46:51.000+0000",
                    "updated": "2010-07-24T06:46:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41699",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=zeulus",
                        "name": "zeulus",
                        "displayName": "Marcin W\u00f3jcik",
                        "active": true
                    },
                    "body": "Great, thanks.\r\n\r\nAnother thing that bothers me is when using Zend_Dojo_Form_Element_CurrencyTextBox with currency set to, let's say 'PLN', it's displaying well, with all advantages of dijit.form.currencytextbox, but this element actually returns not-localized, plain float to form field. \r\n\r\nWhat makes the problem is Zend_Validate_Float, which is using Zend_Locale. When it receives float string, not number, it does not recognize it as dotted float is not compliant with Polish locale.\r\n\r\nReproduction: \r\n1. Set Zend_Dojo_Form_Element_CurrencyTextBox 'value' to 12.34 and 'currency' to 'PLN'.\r\n2. While displaying dijit.form.currencytextbox it displays locale-aware value ('pl_PL' - 12,34), but imput holds '12.34'\r\n3. Zend_Validate_Float gets string '12.34' and does not recognizes it as float, and tries to use Zend_Locale_Format::isFloat($value, array('locale' => $this->_locale)) - but fails to recognize, because value returned from dijit has dot instead of comma. \r\n\r\n\r\nI had to create my custom float validator that is exact copy of Zend_Validate_Float but has one more check between is_float() and try{} section - if (is_string($value) && is_numeric($value)) - but that is not elegant way, isn't it?\r\n\r\nDo I miss the way to force dijit to return localized float value?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=zeulus",
                        "name": "zeulus",
                        "displayName": "Marcin W\u00f3jcik",
                        "active": true
                    },
                    "created": "2010-07-24T07:12:49.000+0000",
                    "updated": "2010-07-24T07:12:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41700",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Dojo uses it's own validation. It is not combined or related to Zend_Validate.\r\n\r\nThe main problem is that Dojo converts all input values to english locale. But when your system uses polish locale you will have problems as you noted because polish is not compatible with english notation.\r\n\r\nTo make this working you simply have to set english as locale to Zend_Validate_Float when you are using Zend_Dojo as input within your form.\r\n\r\nSomething like\r\n{code}\r\nnew Zend_Validate_Float(array('locale' => 'en'));\r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-07-24T07:23:01.000+0000",
                    "updated": "2010-07-24T07:23:01.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41703",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=zeulus",
                        "name": "zeulus",
                        "displayName": "Marcin W\u00f3jcik",
                        "active": true
                    },
                    "body": "It is good solution when you know that client browser has javascript enabled, but what if you\/me\/anyone need it working in both situations?\r\n\r\nIf javascript is disabled, dijit won't convert it to English locale, and there will be message: '12,34' does not appear to be a float.\r\n\r\nSo still, possible solutions are: \r\n\r\n1. find out how to force dijit to return localized value and make Zend_Dojo_Form_Element_CurrencyTextBox to do that (if Zend_Locale is enabled, otherwise it will be ok)\r\n\r\n2. use is_numeric() in Zend_Validate_Float() after is_float() and before Zend_Locale_Format::isFloat() - not elegant way, might pass not only floats, but does not break app\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=zeulus",
                        "name": "zeulus",
                        "displayName": "Marcin W\u00f3jcik",
                        "active": true
                    },
                    "created": "2010-07-24T08:09:06.000+0000",
                    "updated": "2010-07-24T08:09:06.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41763",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Closing as duplicate of ZF-6862 for Zend_Locale (locale upgrading).\r\n\r\nFor your reply which is not related to the issue:\r\n\r\nPlease open a new issue when you have problems with Zend_Dojo  with code for reproduction. Same applies for Zend_Validate when you have problems with this component\r\n\r\nThank you for your report",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-07-27T13:18:23.000+0000",
                    "updated": "2010-07-27T13:18:23.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10207\/transitions"
}