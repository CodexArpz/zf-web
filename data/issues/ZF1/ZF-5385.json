{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5385",
    "key": "ZF-5385",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Form_Decorators_FormErrors Doesnt Handle Manually Added Errors Properly"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5385\/votes",
                "votes": 4,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10460",
                    "id": 10460,
                    "description": "Mini Release",
                    "name": "1.10.5",
                    "userReleaseDate": "26\/May\/10",
                    "archived": false,
                    "releaseDate": "2010-05-26",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-05-24T08:56:42.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bradgman",
                "name": "bradgman",
                "displayName": "Brad Gushurst",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-12-30T16:44:59.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-05-29T03:11:20.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend_Form\n\nThe addErrorMessage method on line #2075 adds an error message to the $_errorMessage array without a key value, hence automatically getting a numeric key.\n\nZend_Form_Decorator_FormErrors\n\nThe _recurseForm method on line #366 parses through a list of errors including the $_errorMessage array from the form to put together the errors. The error messages added through the addErrorMessage method will not get picked up through here as its $key => $value pairs will not meet any of the conditions within the loop.\n\nSolutions:\n\n1. Modify the recurse form loop to handle elements with the numeric key.\n\n2. Specify a key in the addErrorMessage method and specifically handle that key within the _recurseForm method as well."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5385\/watchers",
                "isWatching": false,
                "watchCount": 5
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                "name": "alab",
                "displayName": "Christian Albrecht",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/12544",
                    "filename": "zend_form_custom_errors_decorator.patch",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=reko_t",
                        "name": "reko_t",
                        "displayName": "Reko Tiira",
                        "active": true
                    },
                    "created": "2009-12-28T03:10:27.000+0000",
                    "size": 2549,
                    "mimeType": "text\/x-diff",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/12544\/zend_form_custom_errors_decorator.patch"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10270",
                    "id": 10270,
                    "description": "Mini Release",
                    "name": "1.7.1",
                    "userReleaseDate": "01\/Dec\/08",
                    "archived": false,
                    "releaseDate": "2008-12-01",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10029",
                    "id": 10029,
                    "name": "Zend_Form",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31566",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=robtuley",
                        "name": "robtuley",
                        "displayName": "Rob Tuley",
                        "active": true
                    },
                    "body": "I just encountered the same problem. My workaround looked something like adding a extra elseif clause to handle these errors within _recurseForm...",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=robtuley",
                        "name": "robtuley",
                        "displayName": "Rob Tuley",
                        "active": true
                    },
                    "created": "2009-06-03T03:12:14.000+0000",
                    "updated": "2009-06-03T03:12:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37195",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=reko_t",
                        "name": "reko_t",
                        "displayName": "Reko Tiira",
                        "active": true
                    },
                    "body": "Attached a patch that fixes the issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=reko_t",
                        "name": "reko_t",
                        "displayName": "Reko Tiira",
                        "active": true
                    },
                    "created": "2009-12-28T03:10:33.000+0000",
                    "updated": "2009-12-28T03:10:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39670",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erwind",
                        "name": "erwind",
                        "displayName": "Erwin Derksen",
                        "active": true
                    },
                    "body": "Imho, the patch has several drawbacks:\r\n\r\n- hasErrorMessages seems superfluous as the existing method isErrors seems more appropriate (in combination with using addError() instead of addErrorMessage())\r\n- the FormError decorator should render all messages, either being related or unrelated to an element. It should do so, regardless of how the form handles this (see next point). The patch renders either the custom messages or the elements\/subforsm messages (as previously).\r\n- the Form itself also acts a bit strange in only returning either the custom messages or the element\/subform related messages. This should be configurable.\r\n\r\nSo I changed the patch to\r\n{code}\r\n        foreach ($errors as $name => $list) {\r\n            if (is_int($name)) {\r\n                $content .= $this->getMarkupListStart()\r\n                         .  $view->formErrors($list, $this->getOptions())\r\n                         .  $this->getMarkupListEnd();\r\n        \t\t}\r\n            else if (null !== ($element = $form->getElement($name))) {\r\n                $element->setView($view);\r\n                $content .= $this->getMarkupListItemStart()\r\n                         .  $this->renderLabel($element, $view)\r\n                         .  $view->formErrors($list, $this->getOptions())\r\n                         .  $this->getMarkupListItemEnd();\r\n            } elseif (!$this->ignoreSubForms() && nul !== ($subForm = $form->getSubForm($name))) {\r\n                $content .= $this->getMarkupListStart()\r\n                         .  $this->_recurseForm($subForm, $view)\r\n                         .  $this->getMarkupListEnd();\r\n            }\r\n        }\r\n{code}\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erwind",
                        "name": "erwind",
                        "displayName": "Erwin Derksen",
                        "active": true
                    },
                    "created": "2010-03-31T05:33:14.000+0000",
                    "updated": "2010-03-31T05:33:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/39674",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erwind",
                        "name": "erwind",
                        "displayName": "Erwin Derksen",
                        "active": true
                    },
                    "body": "I'm sorry, but the code I posted half an hour ago does not render valid html (<ul> directly within <ul>). Better is to use the code below.\r\n\r\nnote that the subform branch in the current version (1.10.2) contains the same error! (I'm not reporting that separately as this issue is open and major, so should receive enough attention). I changed it for the subform branch as well. However, I don't use subforms, so I'm not sure about that branch. If you want errors from a subform in their own list (to hide or expand them using javascript\/css use the second code part.\r\n\r\n{code}\r\n        foreach ($errors as $name => $list) {\r\n            if (is_int($name)) {\r\n                $content .= $this->getMarkupListItemStart()\r\n                         .  $view->formErrors($list, $this->getOptions())\r\n                         .  $this->getMarkupListItemEnd();\r\n        \t\t}\r\n            else if (null !== ($element = $form->getElement($name))) {\r\n                $element->setView($view);\r\n                $content .= $this->getMarkupListItemStart()\r\n                         .  $this->renderLabel($element, $view)\r\n                         .  $view->formErrors($list, $this->getOptions())\r\n                         .  $this->getMarkupListItemEnd();\r\n            } else if (!$this->ignoreSubForms() && nul !== ($subForm = $form->getSubForm($name))) {\r\n                $content .= $this->_recurseForm($subForm, $view);\r\n            }\r\n}\r\n{code}\r\n\r\n{code}\r\n        foreach ($errors as $name => $list) {\r\n           if (is_int($name)) {\r\n                $content .= $this->getMarkupListItemStart()\r\n                         .  $view->formErrors($list, $this->getOptions())\r\n                         .  $this->getMarkupListItemEnd();\r\n        \t\t}\r\n            else if (null !== ($element = $form->getElement($name))) {\r\n                $element->setView($view);\r\n                $content .= $this->getMarkupListItemStart()\r\n                         .  $this->renderLabel($element, $view)\r\n                         .  $view->formErrors($list, $this->getOptions())\r\n                         .  $this->getMarkupListItemEnd();\r\n            } else if (!$this->ignoreSubForms() && nul !== ($subForm = $form->getSubForm($name))) {\r\n                $content .= $this->getMarkupListItemStart()\r\n                         .  $this->getMarkupListStart()\r\n                         .  $this->_recurseForm($subForm, $view)\r\n                         .  $this->getMarkupListEnd()\r\n                         .  $this->getMarkupListItemEnd();\r\n            }\r\n        }\r\n{code}\r\n ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=erwind",
                        "name": "erwind",
                        "displayName": "Erwin Derksen",
                        "active": true
                    },
                    "created": "2010-03-31T06:12:39.000+0000",
                    "updated": "2010-03-31T06:12:39.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40662",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "Fixed in trunk r22272 and merged into 1.10 release branch",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-05-24T08:56:42.000+0000",
                    "updated": "2010-05-24T08:56:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/40760",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "body": "Fixed the fix in [r22316|http:\/\/framework.zend.com\/code\/changelog\/Standard_Library?cs=22316] and added UnitTests",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=alab",
                        "name": "alab",
                        "displayName": "Christian Albrecht",
                        "active": true
                    },
                    "created": "2010-05-29T03:11:20.000+0000",
                    "updated": "2010-05-29T03:11:20.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5385\/transitions"
}