{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10082",
    "key": "ZF-10082",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_File_Transfer_Adapter_Http::getProgress() not working well with uploadprogress"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10082\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10480",
                    "id": 10480,
                    "description": "Mini Release",
                    "name": "1.10.7",
                    "userReleaseDate": "28\/Jul\/10",
                    "archived": false,
                    "releaseDate": "2010-07-28",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2010-07-04T12:28:04.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                "name": "anybody",
                "displayName": "Julian Pustkuchen",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2010-06-30T06:23:50.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2010-11-22T11:43:15.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend_File_Transfer_Adapter_Http::getProgress() doesn't work well in combination with \"PECL uploadprogress\", because the $_GET value \"progress_key\" is never set by this module.\r\n\r\nThe point is, that you have to set the value manually to make it work:\r\n\r\n\/\/WORKS AS EXPECTED:\r\n$x = uploadprogress_get_info($parUploadId);\r\n\r\n\/\/MANUALLY ADD TO MAKE IT WORK:\t\r\n$_GET['progress_key'] = $parUploadId;\r\n\r\nrequire_once 'Zend\/ProgressBar\/Adapter\/JsPush.php';\r\n$adapter = new Zend_ProgressBar_Adapter_JsPush();\r\n\/\/ALWAYS RETURNS null WITHOUT THE CORRECTION ABOVE:\r\n$upload  = Zend_File_Transfer_Adapter_Http::getProgress();\r\n\r\n$upload = null;\r\nwhile (!$upload['done']) {\r\n    \/\/ALWAYS RETURNS null WITHOUT THE CORRECTION ABOVE:\r\n    $upload = Zend_File_Transfer_Adapter_Http::getProgress($upload);\r\n    var_dump($upload);\r\n}\r\n\r\nFurthermore you should please add some documentation which hidden fields (and in which order) should be contained in the form, not only mention that Zend_Form adds it automatically. Not everyone uses it!\r\n\r\nPlease fix this issue so that the described workaround is no more needed. Without this hack the module never works."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/2",
                "name": "Critical"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10082\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10470",
                    "id": 10470,
                    "description": "Mini Release",
                    "name": "1.10.6",
                    "userReleaseDate": "22\/Jun\/10",
                    "archived": false,
                    "releaseDate": "2010-06-22",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10320",
                    "id": 10320,
                    "name": "Zend_File_Transfer",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41308",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "The manual of uploadprogress notes which hidden fields have to be set.\r\nAdditionally there is an full example within the ZF demo section which shows how to use this external module manually within ZF.\r\n\r\nThe ZF manual itself is witten to be used with Zend_Form.\r\nStill it notes:\r\n{code}\r\nSecond, you need to have the proper hidden fields added in the form which sends the files. When you use Zend_Form_Element_File this hidden fields are automatically added by Zend_Form. \r\n{code}\r\n\r\nThis is no hack... Zend_Form adds this form fields automatically and you are not using Zend_Form. How should Zend_File_Transfer add form fields? Your intention is in my eyes unlogically.\r\n\r\nWhich hidden fields you have to add belongs on the used extension and it's version as also on the used settings for this extension.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-07-03T11:14:39.000+0000",
                    "updated": "2010-07-03T11:14:39.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41330",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Closing as non-issue.\r\n\r\nThe hidden key \"progress_key\" is not necessary for the uploadprogress extension to work. It is used internally by Zend_Form_Element. You can use any key you want. Look at the demo implementation to see how this works.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-07-04T12:28:04.000+0000",
                    "updated": "2010-07-04T12:28:04.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41332",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "body": "Sorry but I think you didn't get me or just didn't test the tool correctly with uploadprogress.\r\n\r\nFirstofall of course the manual of uploadprogress mentions which hidden fields to set, but please try, it doesn't work with Zend_File_Transfer if you do so.\r\nOf course progress_key is not necessary for uploadprogress, but for Zend Frameworks implementation it is! As you should know Zend_Framework is no full stack framework and if this part does not work without using Zend_Form then for ... sake DOCUMENT the magic behaviour and this required field!\r\n\r\nThe reason is (please just debug one time to see and not only say what you THINK, not knowing what really happens in the code logically). In the next lines I'm referring to the documentation, just as you wanted me to do:\r\n\r\nHTTP.php (~Line 335):\r\n\/\/ID can't be set yet, because at first call it is the Adapter -> unset before\r\n       if (empty($id)) {\r\n            if (!isset($_GET['progress_key'])) {\r\n                $status['message'] = 'No upload in progress';\r\n                $status['done']    = true;\r\n            } else {\r\n                $id = $_GET['progress_key'];\r\n            }\r\n        }\r\n\r\nSo please tell me what will happen if you do not use Zend_Form and don't use my workaround ;)\r\nAnd believe me... this is not just a guess, I wasted several hours with this!\r\n\r\nIf this should be the right behaviour, please have another look at the documentation:\r\n\r\n      $adapter = new Zend_ProgressBar_Adapter_Console();\r\n      $upload  = Zend_File_Transfer_Adapter_Http::getProgress($adapter);\r\n\r\n      $upload = null;\r\n      while (!$upload['done']) {\r\n          $upload = Zend_File_Transfer_Adapter_Http:getProgress($upload);\r\n      }\r\n\r\nAfter the first \"getProgress\" the upload is set to null, what happens? The same again for one more time (but for the last, because after this 'done' is true).\r\nIf you don't set upload to null on the other hand, it is true immediately and so the while-loop never runs.\r\n\r\nPlease don't get me wrong, everybody makes mistakes and that is OK! But why can't you just document this? Everything would be fine, you don't even have to fix it if you think that it is OK.\r\n\r\nThis is my last statement, anyway you think about it or test it or leave it like it is, but I thougt that Zend Framework is professional, I'm really disapointed.\r\n\r\nI wasted several hours, furthermore documented it here for you and you just seem to say... this can't be the point,... no, thats not what I expect from a Zend FW developer. I apologize, if it's wrong what I pointed out before, but I really don't think so.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=anybody",
                        "name": "anybody",
                        "displayName": "Julian Pustkuchen",
                        "active": true
                    },
                    "created": "2010-07-04T12:59:27.000+0000",
                    "updated": "2010-07-04T12:59:27.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/41449",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "There is no mistake at all.\r\n\r\nWhen you are using a manual self defined key then you simply must give that key to getProgress().\r\nThat's how uploadprogress shows how it works itself.\r\nAnd that's also how APC defines how it works itself.\r\n\r\nNormally you also do upload_get_info($unique_key); when using the extension manually.\r\nAnd when using getProgress() instead it must have the same key... getProgress($unique_key)\r\n\r\nI don't see this as failure and there is no need to use a workaround to make this work.\r\nAs I said before you can use ANY self defined key.\r\n\r\nThe point is that Zend_File_Transfer allows to use both extensions. Yes... independently from Zend_Form.\r\nBut still you should know how these two extensions work.\r\nBoth projects have their own documentation. And it will not be duplicated by ZF.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-07-12T15:05:28.000+0000",
                    "updated": "2010-07-12T15:05:28.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/43253",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Correct fix version as it has been deleted unintentionally by another user",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-11-22T11:43:15.000+0000",
                    "updated": "2010-11-22T11:43:15.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-10082\/transitions"
}