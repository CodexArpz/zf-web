{
    "expand": "html",
    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-770",
    "key": "ZF-770",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Locale unit tests crash"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issueType\/13",
                "name": "Unit Tests: Problem",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-770\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10021",
                    "id": 10021,
                    "description": "Preview release; DB, Filter, Log",
                    "name": "0.8.0",
                    "userReleaseDate": "21\/Feb\/07",
                    "archived": true,
                    "releaseDate": "2007-02-21",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2007-02-05T19:47:06.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                "name": "bkarwin",
                "displayName": "Bill Karwin",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2007-01-18T19:28:13.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-06-15T13:51:53.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I ran the unit tests and commented out all test suites except for those for Zend_Locale in zf\/tests\/Zend\/AllTests.php.\nThe PHP process crashed and \n\nEnvironment:\nWindows XP\n\nPHP 5.2.0 (cli) (built: Nov  2 2006 11:57:36)\nCopyright (c) 1997-2006 The PHP Group\nZend Engine v2.2.0, Copyright (c) 1998-2006 Zend Technologies\n\nXdebug is not loaded.  I have it installed on my machine but the line in php.ini that loads the DLL is commented out.\n\n{code}\nC:\\zf\\tests>phpunit --verbose  AllTests.php\nPHPUnit 3.0.0 by Sebastian Bergmann.\n\nZend Framework\n ZendTest\n .........\n\n Zend Framework - Zend\n  Zend_LocaleTest\n  ......................................\n  ..........\n\n  Zend Framework - Zend_Locale\n   Zend_Locale_DataTest\n   .....................................\n   .................................\n\n   Zend_Locale_FormatTest\n   .....................................\n   .....................................\n   .....................................\n   .....................................\n   ....\n\n\nTime: 00:03\n\n\nOK (279 tests)\n{code}\n\nAt the end, after  \"OK (279 tests)\" but before I get my next command prompt, the process crashed.  I will attach a screen shot."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-770\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                "name": "bkarwin",
                "displayName": "Bill Karwin",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/attachment\/10213",
                    "filename": "ZF-770-crash.gif",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-01-18T19:28:51.000+0000",
                    "size": 24118,
                    "mimeType": "image\/gif",
                    "content": "http:\/\/framework.zend.com\/issues\/secure\/attachment\/10213\/ZF-770-crash.gif",
                    "thumbnail": "http:\/\/framework.zend.com\/issues\/secure\/thumbnail\/10213\/_thumb_10213.png"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10020",
                    "id": 10020,
                    "description": "Preview Release; I18N, Acl, Auth, Session",
                    "name": "0.7.0",
                    "userReleaseDate": "18\/Jan\/07",
                    "archived": true,
                    "releaseDate": "2007-01-18",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/component\/10073",
                    "id": 10073,
                    "name": "Zend_Locale",
                    "description": "Zend_Locale is a basic wrapper for all I18N and L10N issues for the Zend Framework. It provides the userbasically with access to translation functionality. It can handle different source file types for translation.",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12289",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Screen shot of my Windows XP machine, showing the crash.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-01-18T19:28:51.000+0000",
                    "updated": "2007-01-18T19:28:51.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12290",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "I know this sort of crash, but we were not able to detect where it's related.\nThere are several scenarios which we have tested:\n\n* Run the tests alone \"phpunit Zend_LocaleTest\"... no known problems on any machine with any test.\n* Run the tests with PHPUNIT 3.0.1... this brakes somewhere in the locale tests almost every time. Seems to be a problem with this version of phpunit.\n* Exclude some testbeds... unpredicted behavior... sometimes all tests pass, sometimes with the same configuration the tests kill php. But the tests are always OK.\n* If we have an testbed with a very huge ammount of tests like Zend_Date the php is killed 50% when running tests and one test fail. If the tests are OK, php is not killed.\n\nThere is no difference if the tests are run on windows or linux... myself is using windowsXP as you are doing.\n\nAfter all... there was already an related issue with PHP brake.... it was solved by installing the latest XDebug and PHPUnit 3.0.0 (not 3.0.1) on the testmachine.\n\nWell...\nI am no PHPUnit Guru but in my opinion, if all tests show OK, no code from my testbed or class is executed anymore, so why should my testbed or my class kill php ???\n\nI think this is a special sort of failure which shall be given to sebastian for further investigation.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2007-01-19T01:12:04.000+0000",
                    "updated": "2007-01-19T01:12:04.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12291",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Sebastian...\nmaybe you are able to look what's happening here with phpunit.\nWould be a great help if you could investigate this issue.\n\nIf you need further informations just get in contact.\nTests were done by\nMe, gavin, shreef and bill with different results in the reaction of the testbed. But all tests are always shown as OK and none fails.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2007-01-19T01:16:13.000+0000",
                    "updated": "2007-01-19T01:16:13.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12292",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "No problems on my side... all tests ok and no corruption of PHP itself.\n\nEnvironment: \n\nWindows XP\n\nApache\/2.2.2 (Win32) mod_ssl\/2.2.2 OpenSSL\/0.9.8b PHP\/5.1.4 \n\nSystem  Windows NT 5.1 build 2600  \nBuild Date  May 4 2006 10:30:29  \n\nZend Engine v2.1.0, Copyright (c) 1998-2006 Zend Technologies\n    with Xdebug v2.0.0RC2-dev, Copyright (c) 2002, 2003, 2004, 2005, 2006, by Derick Rethans",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2007-01-19T01:45:48.000+0000",
                    "updated": "2007-01-19T01:45:48.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12338",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=sebastian",
                        "name": "sebastian",
                        "displayName": "Sebastian Bergmann",
                        "active": true
                    },
                    "body": "The attached screenshot is useless, sorry.\n\nPlease update your Xdebug to the current CVS version which has a couple of segfault fixes. Please try running the tests without Xdebug at all.\n\nAnyways, a segfault in Xdebug (or even in PHP) is neither a Zend Framework nor a PHPUnit issue.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=sebastian",
                        "name": "sebastian",
                        "displayName": "Sebastian Bergmann",
                        "active": true
                    },
                    "created": "2007-01-23T09:00:10.000+0000",
                    "updated": "2007-01-23T09:00:10.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12340",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "I know that the screenshot contains no specific diagnostic information.  I included it just to illustrate the symptom of the crash, so everyone knows what I'm talking about.  Other types of errors allow one to cut & paste the text of the errors.  But a Windows segfault pops up that little dialog window so I had to include it as a screenshot.\n\nI got the segfault even when the Xdebug DLL is *not* loaded -- it's commented out in my php.ini.  If Xdebug is loaded, then \"php -v\" reports it.  When I have Xdebug commented out, \"php -v\" does not report it.  When I have Xdebug commented out, the tests run a lot faster, but still crash.\n\nI have also tried increasing the max memory of PHP up to 96M, but it doesn't change the crashing behavior.\n\nAnyway, I will do as you suggest, I will uninstall the Xdebug extension completely and try it again.  Then I will update to the latest Xdebug binary from CVS and try it with and without the Xdebug DLL loaded.\n",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-01-23T13:14:10.000+0000",
                    "updated": "2007-01-23T13:14:10.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12346",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=gavin",
                        "name": "gavin",
                        "displayName": "Gavin",
                        "active": true
                    },
                    "body": "BTW, bugs.php.net generally lists dozens of bugs that can cause segfaults for any given 90 day period.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=gavin",
                        "name": "gavin",
                        "displayName": "Gavin",
                        "active": true
                    },
                    "created": "2007-01-23T18:23:05.000+0000",
                    "updated": "2007-01-23T18:23:05.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12454",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "As this issue is not related to Zend_Locale itself it was assigned to Component \"Unknown\".\n\nWith the latest Branch, phpunit 3.0.0 and latest Xdebug I was not able to reproduce this failure anymore.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2007-01-30T03:56:41.000+0000",
                    "updated": "2007-01-30T03:56:41.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12481",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Upgrade to Xdebug DLL version 2.0.0RC3-dev resolved this issue.\n\nThe unit tests no longer crash.  I can run through all the unit test suites and get a full report of code coverage.\n\nThe new dev version of Xdebug DLL is much slower than 2.0.0RC1. but that is another issue and it is clearly the responsibility of Xdebug.\n\nI'm going ahead and closing this issue as \"Not an Issue\" because it has nothing to do with Zend Framework code or PHPUnit code.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-01-31T21:12:42.000+0000",
                    "updated": "2007-01-31T21:12:42.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12528",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Environment:  Windows XP\nPHP 5.2.0 (cli) (built: Nov  2 2006 11:57:36)\nCopyright (c) 1997-2006 The PHP Group\nZend Engine v2.2.0, Copyright (c) 1998-2006 Zend Technologies\n\nNo Xdebug loaded.\n\nStill experiencing crashes during test run.\n\nI can prevent the crash by commenting out the following test:\n{code}Zend_Locale_DataTest::testLDMLReadingDatechars(){code}\nIf I keep that test, PHP crashes.\n\nAnother problem test:\n{code}Zend_Locale_DataTest::testLDMLSupplementalData(){code}\nIf I keep the latter test, then PHP does not crash, but it increased CPU utilization to 50%+, and consumed 52,744KB of RAM in the PHP process, and hangs.  The PHP process for phpunit does not exit.  I waited for 5 minutes but it did not change.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-02-05T17:05:34.000+0000",
                    "updated": "2007-02-05T17:05:34.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12529",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "No -- I spoke too soon.  Even with those two test methods commented out, php still crashes after the Locale tests, in a subsequent test suite.  It crashes in the Zend_Gdata suite.\n\nCommenting out the following line in Zend\/AllTests.php stops the crashing:\n{code}\n$suite->addTestSuite('Zend_LocaleTest');\n{code}\n\nFurther experiment: in Zend\/LocaleTest.php, I edited the test testgetHttpCharset(), and edited out the calls to Zend_Locale::getHTTPCharset().  This also stopped the php test process from crashing.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-02-05T17:49:25.000+0000",
                    "updated": "2007-02-05T17:49:25.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12530",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Fixed (again) in revision 3230.\n\nThis is apparently related to a bug in PHP's putenv() function:\nhttp:\/\/bugs.php.net\/bug.php?id=39751 \n",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2007-02-05T19:47:06.000+0000",
                    "updated": "2007-02-05T19:47:06.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12531",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=gavin",
                        "name": "gavin",
                        "displayName": "Gavin",
                        "active": true
                    },
                    "body": "Found and fixed the problem using a workaround:\nhttp:\/\/framework.zend.com\/fisheye\/changelog\/Zend_Framework\/?cs=3230",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=gavin",
                        "name": "gavin",
                        "displayName": "Gavin",
                        "active": true
                    },
                    "created": "2007-02-05T20:09:03.000+0000",
                    "updated": "2007-02-05T20:09:03.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/22334",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "Changing to comply with new IT coventions for components.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-06-15T13:51:53.000+0000",
                    "updated": "2008-06-15T13:51:53.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-770\/transitions"
}