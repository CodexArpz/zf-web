{
    "expand": "html",
    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-588",
    "key": "ZF-588",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Can't draw special characters (ie. euro symbol) on linux"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField",
            "value": {
                "timeoriginalestimate": 180,
                "timeestimate": 180
            }
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-588\/votes",
                "votes": 7,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10250",
                    "id": 10250,
                    "description": "Mini Release",
                    "name": "1.7.3",
                    "userReleaseDate": "19\/Jan\/09",
                    "archived": false,
                    "releaseDate": "2009-01-19",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2008-12-03T06:13:55.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                "name": "strfrank",
                "displayName": "Franco A.",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2006-11-22T16:20:35.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2008-12-03T06:14:19.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Trying to draw the euro symbol with a line like this:\n\n$page->drawText(chr(128), 100, 100);\n\nI get a correctly printed euro symbol using apache 2.0.54, php 5.1.2 on windows, but only a set of white spaces if using apache and php (same versions) on linux (tried ubuntu 6 and fedora 5).\nI also tried different combinations of encodings with no success."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/customFieldOption\/10039",
                "value": "  Should Have"
            }
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-588\/watchers",
                "isWatching": false,
                "watchCount": 5
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                "name": "alexander",
                "displayName": "Alexander Veremyev",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-3650",
                    "issue": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-3650",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/attachment\/10211",
                    "filename": "test_encodeString.pdf",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "created": "2007-01-16T16:26:18.000+0000",
                    "size": 852,
                    "mimeType": "application\/pdf",
                    "content": "http:\/\/framework.zend.com\/issues\/secure\/attachment\/10211\/test_encodeString.pdf"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/attachment\/10212",
                    "filename": "test_no_encodeString.pdf",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "created": "2007-01-16T16:26:28.000+0000",
                    "size": 868,
                    "mimeType": "application\/pdf",
                    "content": "http:\/\/framework.zend.com\/issues\/secure\/attachment\/10212\/test_no_encodeString.pdf"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/version\/10002",
                    "id": 10002,
                    "description": "Preview Release; MVC refactoring and other enhancements and fixes",
                    "name": "0.2.0",
                    "userReleaseDate": "29\/Oct\/06",
                    "archived": true,
                    "releaseDate": "2006-10-29",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/component\/10020",
                    "id": 10020,
                    "name": "Zend_Pdf",
                    "description": "pure PHP manipulation engine for composing PDFs",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/11694",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "body": "Assigning to Alexander.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=bkarwin",
                        "name": "bkarwin",
                        "displayName": "Bill Karwin",
                        "active": true
                    },
                    "created": "2006-11-28T17:50:05.000+0000",
                    "updated": "2006-11-28T17:50:05.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12255",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "body": "Looks like at least on my linux systems (ubuntu and fedora core 5), there's a problem in Zend_Pdf_Page->drawText().\nThis row:\n$textObj = new Zend_Pdf_Element_String($this->_font->encodeString($text, $charEncoding));\ncalls encodeString() which tries to encode the text to CP1252 charset with no success. I tried a text with characters like '\u00e0' or '\u00ec' (which are common in my language) and they don't get encoded.\nIf I change the line above to\n$textObj = new Zend_Pdf_Element_String($text);\n\nIn my ubuntu system the output of iconv_get_encoding() says ISO-8859-1 for all three kinds.\nHope this helps",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "created": "2007-01-16T10:13:00.000+0000",
                    "updated": "2007-01-16T10:13:00.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12256",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "body": "Sorry, there's a missing part in my last message:\n\nIf I change the line above to:\n$textObj = new Zend_Pdf_Element_String($text);\nI get correct accented characters",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "created": "2007-01-16T10:22:34.000+0000",
                    "updated": "2007-01-16T10:22:34.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12257",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=willie",
                        "name": "willie",
                        "displayName": "Willie Alberty",
                        "active": true
                    },
                    "body": "{{Zend_Pdf_Resource_Font::encodeString()}} is necessary because the actual character encoding method used in the binary stream of the PDF file is WinAnsiEncoding, which is CP-1252.\n\nCP-1252 is over a dozen years old and so predates the Euro; there is no Euro symbol character in the CP-1252 character map. This is why, in the current code base, you were unable to draw that character. There is an effort underway to replace the dated WinAnsiEncoding method with a Unicode-based system which will completely eliminate these kinds of problems.\n\nYour results from bypassing {{encodeString()}} are interesting though... it should not have worked. Or, at least, if it did, there should be problems when viewing the PDF on other, non-Microsoft platforms. I'll take a closer look at what's happening here and try to come up with a reasonable explanation and\/or fix.\n\nIn the interim, can you attach your sample PDF file (the one that works) to this issue? I'm curious to see if the PDF works properly on my Mac.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=willie",
                        "name": "willie",
                        "displayName": "Willie Alberty",
                        "active": true
                    },
                    "created": "2007-01-16T11:16:54.000+0000",
                    "updated": "2007-01-16T11:16:54.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/12264",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "body": "I attached two files:\n- test_encodeString.pdf: generated with original Zend Framework\n- test_no_encodeString.pdf: generated after having modified Zend_Pdf_Resource_Font::encodeString() this way:\npublic function encodeString($string, $charEncoding)\n{\n  return $string;\n}\n\nText is generated calling drawText this way:\n$pg->drawText(\"a -> \u00e0\", $x, $y);\n$pg->drawText(\"e -> \u00e8\", $x, $y);\n$pg->drawText(\"i -> \u00ec\", $x, $y);\n$pg->drawText(\"euro -> \".chr(128), $x, $y);\n\nI can see the symbols in the second file and not in the first (I open the files both on linux and windows, they look the same).\nI noticed that the characters '\u00e0', etc. are recognized as invalid by the iconv function in encodeString.\nFor example, if I remove the \/\/IGNORE statement for the output encoding, trying to render the text:\n\nTest \u00e0\u00e0 write\n\nThe result is:\n\nTest\n\nWhile leaving the \/\/IGNORE statement the result is\n\nTest    write\n\nThanks for your help,\nFrank\n\nP.S.\nAccording to this:\nhttp:\/\/en.wikipedia.org\/wiki\/Windows-1252\nIt looks that the euro symbol is included in this encoding, along with accented letters like '\u00e0' and '\u00ec'.  In fact I produced pdf documents with the euro symbol with tools like gs.\n\nThanks",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "created": "2007-01-16T16:25:47.000+0000",
                    "updated": "2007-01-16T16:25:47.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/20941",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "body": "This doesn't appear to have been fixed in 1.5.0. Please update if this is not correct.",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=wil",
                        "name": "wil",
                        "displayName": "Wil Sinclair",
                        "active": true
                    },
                    "created": "2008-04-18T13:11:50.000+0000",
                    "updated": "2008-04-18T13:11:50.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/21199",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "body": "Actually I solved the euro symbol problem like this in 1.5:\n\n$page->drawText(html_entity_decode(\"&euro;\", ENT_COMPAT, \"UTF-8\"), $x, $y, \"UTF-8\");\n\nNot perfect but it works, I think there's also a problem with source code file encoding while specifying non standard characters.\nThanks,\nFrank",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "created": "2008-04-19T06:49:24.000+0000",
                    "updated": "2008-04-19T06:49:24.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/21200",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "body": "Sorry, I noticed that the editor converted my code, the first argument of html_entity_decode must be the entity for the euro symbol $ e u r o ;",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=strfrank",
                        "name": "strfrank",
                        "displayName": "Franco A.",
                        "active": true
                    },
                    "created": "2008-04-19T06:51:23.000+0000",
                    "updated": "2008-04-19T06:51:23.000+0000"
                },
                {
                    "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/comment\/26915",
                    "author": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "body": "PDF standard fonts support smal set of single byte encodings (See [PDF Reference, Appendix D|http:\/\/www.adobe.com\/devnet\/acrobat\/pdfs\/pdf_reference_1-7.pdf]). They are generally equal to Latin1 (CP1252).\n\nBUT! You have to specify character encoding for the string provided to drawText() method:\n{code}\n$font = Zend_Pdf_Font::fontWithName(Zend_Pdf_Font::FONT_COURIER);\n$pdfPage->setFont($font, 36)\n        ->drawText('Euro sign - \u20ac', 72, 720, 'UTF-8')\n        ->drawText('Text with umlauts - \u00e0 \u00e8 \u00ec', 72, 650, 'UTF-8');\n{code}\n\nYou also must be sure, that string is actualy uses specified encoding.\n\n[ZF-3650] documentation task should describe this more clear.\n",
                    "updateAuthor": {
                        "self": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/user?username=alexander",
                        "name": "alexander",
                        "displayName": "Alexander Veremyev",
                        "active": true
                    },
                    "created": "2008-12-03T06:13:54.000+0000",
                    "updated": "2008-12-03T06:13:54.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/framework.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-588\/transitions"
}