{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4175",
    "key": "ZF-4175",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_View_Helper_HtmlElement *should* escape javascript events (on*)"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4175\/votes",
                "votes": 2,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admwiggin",
                "name": "admwiggin",
                "displayName": "Tianon Gravi",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-09-03T08:41:10.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-08-13T22:12:10.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "I downloaded the latest ZF (1.6.0), and noticed the following in my search to fix a little piece of broken code:\non Zend\/View\/Helper\/HtmlElement.php:\n r20458@zlaptop:  matthew | 2008-07-07 09:07:58 -0400\n  * do not escape javascript on* HTML attributes\n  * JSON-encode non-scalar on* HTML attributes\n  * Fix quotation issues in Slider dijits\n\nWhat is the purpose of not escaping on* HTML attributes?  {code:xml}&{code} in a script still needs to become {code:xml}&amp;{code}\n\nThe functionality breaker comes from double quotes within the attribute (within the javascript code).  These cause unexpected behavior when calling formReset or similar with an onclick event containing any amount of semi-complex code.\n\nIs the reason for this change Dojo-related?  If so, what purpose does it serve and what is gained by the change?"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4175\/watchers",
                "isWatching": false,
                "watchCount": 4
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/1",
                "name": "Open"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "zf-crteam-padraic",
                "zf-crteam-priority"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10240",
                    "id": 10240,
                    "description": "Minor Release",
                    "name": "1.6.0",
                    "userReleaseDate": "02\/Sep\/08",
                    "archived": false,
                    "releaseDate": "2008-09-02",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10026",
                    "id": 10026,
                    "name": "Zend_View",
                    "description": "View portion of the ZF MVC",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24235",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Fixed wrong component assignment",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2008-09-03T09:36:43.000+0000",
                    "updated": "2008-09-03T09:36:43.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24441",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Could the reporter of this issue post a real-world use case where escaping in the on* attributes would be useful? \n\nRight now, my colleagues and I cannot think of one. Having it unescaped has many uses, however:\n{code}\n<input onChange=\"if(foo && bar) return false;\" type=\"text\" name=\"foo\" value=\"\" \/>\n{code}\nescaping here would result in invalid javascript.\n\nAnother use case where escaping is bad is for JSON-encoded attributes, which a variety of Javascript toolkits utilize; escaping in such a case will result in invalid JSON.\n\nIf we support this request, it will be via an optional flag to *enable* escaping for such event attributes, but currently we cannot see a good reason for it.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2008-09-11T06:20:55.000+0000",
                    "updated": "2008-09-11T06:20:55.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24447",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mben",
                        "name": "mben",
                        "displayName": "Marc Bennewitz (GIATA mbH)",
                        "active": true
                    },
                    "body": "The escaping of javascript in event attributes doesn't create a invalid javascript. But if it is not escaped it can be invalid:\n\nPlease test the example:\nnot escaped is invalid:\n{code}<input type=\"text\" onclick=\"alert(\"This is a test including special chars: &,%,?,\\\",'\");\" \/>{code}\nescaped is valid:\n{code}<input type=\"text\" onclick=\"alert(&quot;This is a test including special chars: &amp;,%,?,\\&quot;,'&quot;);\" \/>{code}\n\nI don't understand why you encode json if it is a non scalar attribute value. The event attributes are js functions but json doesn't do anything.\nExample:\n{code}<input type=\"text\" onclick=\"[1,{},3]\" \/>{code}\nWhat is the use of this event function ? Can you give me an example where it is usable ?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mben",
                        "name": "mben",
                        "displayName": "Marc Bennewitz (GIATA mbH)",
                        "active": true
                    },
                    "created": "2008-09-11T07:16:06.000+0000",
                    "updated": "2008-09-11T07:16:06.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/24448",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admwiggin",
                        "name": "admwiggin",
                        "displayName": "Tianon Gravi",
                        "active": true
                    },
                    "body": "Marc answered beautifully.  Also, if we view the standard for XHTML 1.0 itself, we find the following:\nhttp:\/\/www.w3.org\/TR\/xhtml1\/#h-4.4\n\"Attribute values must always be quoted\"\n\nThis includes onclick, onchange, etc.  Just try running Marc's example, and then try validating both ways.  You'll understand.\n\nI too am also curious as to how JSON-encoded on* values are useful.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=admwiggin",
                        "name": "admwiggin",
                        "displayName": "Tianon Gravi",
                        "active": true
                    },
                    "created": "2008-09-11T07:33:01.000+0000",
                    "updated": "2008-09-11T07:33:01.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25102",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tnfict",
                        "name": "tnfict",
                        "displayName": "TNF ICT Dept",
                        "active": true
                    },
                    "body": "Recent changes in ZF (starting at 1.6.0) broke backward compatibility for us in the formButton implementation.\n\nWhere we had the following code:\n<?php echo $this->formButton('bMailAttendants', $this->getTranslation('mail_attendants'), array('class' => 'buttonDefault', 'onclick' => 'mailAttendants(this,\"'.$this->controllerName.'\")')); ?>\n\nwe had to change this to:\n<?php echo $this->formButton('bMailAttendants', $this->getTranslation('mail_attendants'), array('class' => 'buttonDefault', 'onclick' => 'mailAttendants(this,\\''.$this->controllerName.'\\')')); ?>\n\nto work around the escaping code in Zend_View_Helper_HtmlElement::_htmlAttribs()\n\nI submitted this as a separate bug, ZF-4313, because at the time, I couldn't comment on issues. Please feel free to mark ZF-4313 as a duplicate of this bug.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=tnfict",
                        "name": "tnfict",
                        "displayName": "TNF ICT Dept",
                        "active": true
                    },
                    "created": "2008-10-13T04:14:50.000+0000",
                    "updated": "2008-10-13T04:14:50.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/25979",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=yoshida@zend.co.jp",
                        "name": "yoshida@zend.co.jp",
                        "displayName": "old of Satoru Yoshida",
                        "active": true
                    },
                    "body": "The problem that TNF ICT Dept  commented is solved in ZF-4333 and ZF-4313.\n\nBut in this comment, I do not mean this issue is fixed.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=yoshida@zend.co.jp",
                        "name": "yoshida@zend.co.jp",
                        "displayName": "old of Satoru Yoshida",
                        "active": true
                    },
                    "created": "2008-11-08T18:28:39.000+0000",
                    "updated": "2008-11-08T18:28:39.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4175\/transitions"
}