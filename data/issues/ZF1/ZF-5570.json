{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5570",
    "key": "ZF-5570",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Flex ArrayCollection only mapping from PHP to Flex not the other way around"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5570\/votes",
                "votes": 7,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-08-15T18:23:55.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lionpeal",
                "name": "lionpeal",
                "displayName": "Panupan Sriautharawong",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-01-16T16:08:41.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-08-15T18:23:55.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "amf",
                "arraycollection",
                "flex",
                "mapping",
                "php",
                "vo",
                "zend"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Hello, I've tried everything to pass an ArrayCollection from Flex to the PHP side without success.  \n\n*Step 1*\ncreated ArrayCollection vo in php flex\/messaging\/io\/ArrayCollection.php\n<?php\nclass ArrayCollection{\n\t\/\/public $_explicitType = \"mx.collections.ArrayCollection\";\n\tvar $_explicitType = \"flex.messaging.io.ArrayCollection\";\n\t\n\tvar $source = array();\n \n\tfunction ArrayCollection()\n\t{\n\t\t$this->source = array();\n\t}\n}\n\n*Step 2*\nincluded the ArrayCollection.php file and set the class map in the amf.php gateway\n$server->setClassMap('flex.messaging.io.ArrayCollection', 'ArrayCollection');\n\n*Step 3*\ncreated the service class.\n\n*Step 4*\nTo test mapping bidirectionally I made a service method called returnIt which takes a object and returns it.\n\n*Step 5* \ncreate flex app to invoke service method.\n\n\nI have checked inside the returnIt method with Zend Logger that infact the ArrayCollection was being mapping correctly.  But then something happens and the script aborts and the ArrayCollection is never returned to Flex.. \n\nI've mapped my other custom classes successfully, just not for the Flex ArrayCollection.\n\n\n\n\n\n\nHere are the relevant debugging messages..\n\n*From Flex Debugger (using AMF3 NetConnection):*\nAMFPHP.onNetStatus NetConnection.Call.BadVersion\n\n*From Flex Debugger (using RemoteObject):*\n[FaultEvent fault=[RPC Fault faultString=\"Channel disconnected\" faultCode=\"Client.Error.DeliveryInDoubt\" faultDetail=\"Channel disconnected before an acknowledgement was received\"] messageId=\"43D17271-865C-EC1E-E1CB-E1DC89C39167\" type=\"fault\" bubbles=false cancelable=true eventPhase=2]\n\n*From my PHP error_log:*\n\n[16-Jan-2009 18:40:52] PHP Warning:  Invalid argument supplied for foreach() in \/Users\/panupan\/Zend\/workspaces\/DefaultWorkspace\/bbahh\/library\/Zend\/Amf\/Parse\/Amf3\/Deserializer.php on line 388\n\n*The returned error message (as seen from ServiceCapture) when using the Flex RemoteObject and Zend AMF sever set to production false:*\n\nextendedData (null): null\nfaultCode (Number): 0\nfaultDetail (String): #0 \/Users\/panupan\/Zend\/workspaces\/DefaultWorkspace\/bbahh\/library\/Zend\/Amf\/Server.php(291): Zend_Amf_Server->_loadCommandMessage(Object(Zend_Amf_Value_Messaging_CommandMessage))\n#1 \/Users\/panupan\/Zend\/workspaces\/DefaultWorkspace\/bbahh\/library\/Zend\/Amf\/Server.php(384): Zend_Amf_Server->_handle(Object(Zend_Amf_Request_Http))\n#2 \/Users\/panupan\/Zend\/workspaces\/DefaultWorkspace\/bbahh\/public\/amf.php(28): Zend_Amf_Server->handle()\n#3 {main}\nfaultString (String): CommandMessage::12 not implemented\nrootCause (null): null\ncorrelationId (String): 5519AEBD-8877-6AB3-5C38-E1DC89BB3AF1\nclientId (String): 393BE507-F7CD-ECC8-C360-0000301BD7EA\ndestination (null): null\nmessageId (String): 47D34E84-7B65-E269-4A28-00006AA3EDD4\ntimestamp (String): 123214997300\ntimeToLive (Number): 0\nheaders (Object): \n\nbody (null): null\n\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5570\/watchers",
                "isWatching": false,
                "watchCount": 8
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "zf-crteam-padraic",
                "zf-crteam-priority"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                "name": "padraic",
                "displayName": "P\u00e1draic Brady",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11704",
                    "filename": "ArrayCollectionMappingBug.zip",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lionpeal",
                        "name": "lionpeal",
                        "displayName": "Panupan Sriautharawong",
                        "active": true
                    },
                    "created": "2009-01-16T16:12:23.000+0000",
                    "size": 7915302,
                    "mimeType": "application\/zip",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11704\/ArrayCollectionMappingBug.zip"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11705",
                    "filename": "ArrayCollectionMappingBugFlexApp.zip",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lionpeal",
                        "name": "lionpeal",
                        "displayName": "Panupan Sriautharawong",
                        "active": true
                    },
                    "created": "2009-01-16T16:14:12.000+0000",
                    "size": 426068,
                    "mimeType": "application\/zip",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11705\/ArrayCollectionMappingBugFlexApp.zip"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10271",
                    "id": 10271,
                    "description": "Mini Release",
                    "name": "1.7.2",
                    "userReleaseDate": "23\/Dec\/08",
                    "archived": false,
                    "releaseDate": "2008-12-23",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10350",
                    "id": 10350,
                    "name": "Zend_Amf",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28266",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lionpeal",
                        "name": "lionpeal",
                        "displayName": "Panupan Sriautharawong",
                        "active": true
                    },
                    "body": "PHP side source code.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lionpeal",
                        "name": "lionpeal",
                        "displayName": "Panupan Sriautharawong",
                        "active": true
                    },
                    "created": "2009-01-16T16:12:28.000+0000",
                    "updated": "2009-01-16T16:12:28.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/28267",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lionpeal",
                        "name": "lionpeal",
                        "displayName": "Panupan Sriautharawong",
                        "active": true
                    },
                    "body": "Flex side source code",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=lionpeal",
                        "name": "lionpeal",
                        "displayName": "Panupan Sriautharawong",
                        "active": true
                    },
                    "created": "2009-01-16T16:14:13.000+0000",
                    "updated": "2009-01-16T16:14:13.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29575",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dinamic",
                        "name": "dinamic",
                        "displayName": "Nikola Petkanski",
                        "active": true
                    },
                    "body": "I've came upon the very same issue using ZF 1.7.0 and 1.7.7.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dinamic",
                        "name": "dinamic",
                        "displayName": "Nikola Petkanski",
                        "active": true
                    },
                    "created": "2009-03-19T03:32:54.000+0000",
                    "updated": "2009-03-19T03:32:54.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29578",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dinamic",
                        "name": "dinamic",
                        "displayName": "Nikola Petkanski",
                        "active": true
                    },
                    "body": "I've just found a workaround for this issue.\n\nHere is the corresponding code:\n\n#start: library\/Zend\/Amf\/Parse\/Amf3\/Deserializer.php:388\n\n\/\/ Add properties back to the return object.\nforeach($properties as $key=>$value) {\n\tif($key) {\n\t\t$returnObject->$key = $value;\n\t}\n}\n\n#end: library\/Zend\/Amf\/Parse\/Amf3\/Deserializer.php:388\n\nIt seems at some point $properties is left to a value of NULL, thus foreach() fails.\nTo workaround the issue you can simply set one line before the foreach() like that:\n\nif (!is_array($properties)) $properties = array();\n\nAnother solutions might be to use something similar:\n\n\/\/ Check for any properties defined\nif (is_array($properties))\n{\n\t\/\/ Add properties back to the return object.\n\tforeach($properties as $key=>$value) {\n\t\tif($key) {\n\t\t\t$returnObject->$key = $value;\n\t\t}\n\t}\n}\n\nThere is no notable difference in using any of the methods.\n\nPlease note that this is a workaround! An official fix for the issue still has to be released.\n\n\nBest regards,\n\nNikola Petkanski\nPHP Developer\nhttp:\/\/www.e-man.co.uk\/",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dinamic",
                        "name": "dinamic",
                        "displayName": "Nikola Petkanski",
                        "active": true
                    },
                    "created": "2009-03-19T04:13:31.000+0000",
                    "updated": "2009-03-19T04:13:31.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/30053",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bloomboy",
                        "name": "bloomboy",
                        "displayName": "Morgan Gustafsson",
                        "active": true
                    },
                    "body": "Hi,\n\nThe $properties array is not defined for externalizable objects such as {ArrayCollection} and {ObjectProxy}.\nLook at switch\/case starting on 335.\n\nMy solution was to insert (on row 346):\n$properties = array();\n\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=bloomboy",
                        "name": "bloomboy",
                        "displayName": "Morgan Gustafsson",
                        "active": true
                    },
                    "created": "2009-04-09T06:10:56.000+0000",
                    "updated": "2009-04-09T06:10:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/47970",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "body": "Fixed in r24385 using suggested workaround (seem fine to cast $properties to an array if not already in that form).",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=padraic",
                        "name": "padraic",
                        "displayName": "P\u00e1draic Brady",
                        "active": true
                    },
                    "created": "2011-08-15T18:23:55.000+0000",
                    "updated": "2011-08-15T18:23:55.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-5570\/transitions"
}