{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6869",
    "key": "ZF-6869",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "`Zend_Application::mergeOptions` can fail to merge sub-arrays of options with differing cases of keys"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6869\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-08-24T14:05:54.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dtrebbien",
                "name": "dtrebbien",
                "displayName": "Daniel Trebbien",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2009-05-31T05:25:13.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2009-08-24T14:05:54.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels",
            "value": [
                "array_change_key_case",
                "mergeOptions",
                "options"
            ]
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Zend Framework version: 1.8.4-minimal\nPHP version: 5.2.10\nOS: Windows 2000 Service Pack 4\n\n\nThis concerns the options-retrieval part of constructing a {{Zend_Application}} object.\n\nIt is important to be able to specify options both in the {{application.ini}} file as well as in the second argument to the {{Zend_Application}} constructor. This is because the INI file can contain just the options, such as paths, that potentially depend on server configuration, and the options array can contain the options that do not (like the file extension of layout scripts).\n\nCurrently, however, one has to be careful to use the capitalization on keys as they appear the INI file, or else {{mergeOptions}} can fail to merge the INI options into the options array properly. This is a bug because option keys are mostly processed case-insensitively, so {{mergeOptions}} should be able to merge INI options into the options array regardless of key case.\n\nI will attach a minimal test case which demonstrates this. {{index.php}} constructs a {{Zend_Application}}, and {{echo}} s its options. With the buggy behavior, you should see:\n{code}\nArray\n(\n    [config] => C:\\Program Files\\Apache Software Foundation\\HTTPD\\htdocs\\mintest\\application\/configs\/application.ini\n    [resources] => Array\n        (\n            [Layout] => Array\n                (\n                    [viewSuffix] => tpl\n                )\n\n            [frontController] => Array\n                (\n                    [controllerDirectory] => C:\\Program Files\\Apache Software Foundation\\HTTPD\\htdocs\\mintest\\application\/controllers\n                    [throwExceptions] => 1\n                )\n\n            [layout] => Array\n                (\n                    [layoutPath] => C:\\Program Files\\Apache Software Foundation\\HTTPD\\htdocs\\mintest\\application\/layouts\n                )\n\n        )\n\n    [phpSettings] => Array\n        (\n            [display_startup_errors] => 1\n            [display_errors] => 1\n        )\n\n    [includePaths] => Array\n        (\n            [library] => C:\\Program Files\\Apache Software Foundation\\HTTPD\\htdocs\\mintest\\application\/..\/library\n        )\n\n    [bootstrap] => Array\n        (\n            [path] => C:\\Program Files\\Apache Software Foundation\\HTTPD\\htdocs\\mintest\\application\/Bootstrap.php\n            [class] => Bootstrap\n        )\n\n)\n{code}\n\nNotice that the 'resources' option has a 'Layout' and 'layout' key. Commenting out the {{echo}} line, and uncommenting the \"run\" line results in a *Fatal Error* due to the 'layout' array being ignored.\n\nIf you change the 'L' in 'Layout' on line 22 of {{index.php}} to 'l', then the {{echo}} line shows:\n{code}\nArray\n(\n    [config] => C:\\Program Files\\Apache Software Foundation\\HTTPD\\htdocs\\mintest\\application\/configs\/application.ini\n    [resources] => Array\n        (\n            [layout] => Array\n                (\n                    [viewSuffix] => tpl\n                    [layoutPath] => C:\\Program Files\\Apache Software Foundation\\HTTPD\\htdocs\\mintest\\application\/layouts\n                )\n\n            [frontController] => Array\n                (\n                    [controllerDirectory] => C:\\Program Files\\Apache Software Foundation\\HTTPD\\htdocs\\mintest\\application\/controllers\n                    [throwExceptions] => 1\n                )\n\n        )\n\n    [phpSettings] => Array\n        (\n            [display_startup_errors] => 1\n            [display_errors] => 1\n        )\n\n    [includePaths] => Array\n        (\n            [library] => C:\\Program Files\\Apache Software Foundation\\HTTPD\\htdocs\\mintest\\application\/..\/library\n        )\n\n    [bootstrap] => Array\n        (\n            [path] => C:\\Program Files\\Apache Software Foundation\\HTTPD\\htdocs\\mintest\\application\/Bootstrap.php\n            [class] => Bootstrap\n        )\n\n)\n{code}\n\n{{index.php}} with the \"run\" line shows:\nh1. index\n\n(as expected)\n\nAfter applying the patch (that I will also attach), using either 'Layout' or 'layout' as they key in the options array produces the expected output.\n\n{{Zend_Application_Resource_ResourceAbstract}} and {{Zend_Application_Bootstrap_BootstrapAbstract}} need similar modifications, and a patch for each of the corresponding files will also be attached.\n\nNote that the new implementation of {{mergeOptions}} that I have provided is somewhat inefficient, but it is the most compatible with code that is in the Zend Framework, as well as code that has already been written which relies on the case of options. For example, {{Zend_Application_Resource_View}} blindly passes the options that it receives to {{Zend_View::__construct}}, which requires that some option keys have capital letters (eg.: {{scriptPath}}). A filter could be created that would translate the lower-cased version to the expected form, but, again, code for application resources that has already been written, that relies on the fact that {{mergeOptions}} does not lower-case all option keys, will break.\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6869\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11966",
                    "filename": "Application.php.diff",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dtrebbien",
                        "name": "dtrebbien",
                        "displayName": "Daniel Trebbien",
                        "active": true
                    },
                    "created": "2009-05-31T05:26:50.000+0000",
                    "size": 1823,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11966\/Application.php.diff"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11968",
                    "filename": "BootstrapAbstract.php.diff",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dtrebbien",
                        "name": "dtrebbien",
                        "displayName": "Daniel Trebbien",
                        "active": true
                    },
                    "created": "2009-05-31T05:28:12.000+0000",
                    "size": 1315,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11968\/BootstrapAbstract.php.diff"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11965",
                    "filename": "mintest.zip",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dtrebbien",
                        "name": "dtrebbien",
                        "displayName": "Daniel Trebbien",
                        "active": true
                    },
                    "created": "2009-05-31T05:26:46.000+0000",
                    "size": 3373,
                    "mimeType": "application\/zip",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11965\/mintest.zip"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/11967",
                    "filename": "ResourceAbstract.php.diff",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dtrebbien",
                        "name": "dtrebbien",
                        "displayName": "Daniel Trebbien",
                        "active": true
                    },
                    "created": "2009-05-31T05:28:12.000+0000",
                    "size": 1302,
                    "mimeType": "application\/octet-stream",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/11967\/ResourceAbstract.php.diff"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10340",
                    "id": 10340,
                    "description": "Mini Release",
                    "name": "1.8.4",
                    "userReleaseDate": "23\/Jun\/09",
                    "archived": false,
                    "releaseDate": "2009-06-23",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10390",
                    "id": 10390,
                    "name": "Zend_Application",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31515",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dtrebbien",
                        "name": "dtrebbien",
                        "displayName": "Daniel Trebbien",
                        "active": true
                    },
                    "body": "The syntax of code blocks is not PHP.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dtrebbien",
                        "name": "dtrebbien",
                        "displayName": "Daniel Trebbien",
                        "active": true
                    },
                    "created": "2009-05-31T05:30:14.000+0000",
                    "updated": "2009-05-31T05:30:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31517",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Can you please test against 1.8.2? I believe this may have been fixed already.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2009-05-31T09:10:46.000+0000",
                    "updated": "2009-05-31T09:10:46.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/31524",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dtrebbien",
                        "name": "dtrebbien",
                        "displayName": "Daniel Trebbien",
                        "active": true
                    },
                    "body": "This is still a bug in 1.8.2. I downloaded ZF 1.8.2, and there are no changes in {{Application.php}} from 1.8.1.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dtrebbien",
                        "name": "dtrebbien",
                        "displayName": "Daniel Trebbien",
                        "active": true
                    },
                    "created": "2009-06-01T05:23:52.000+0000",
                    "updated": "2009-06-01T05:23:52.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/32119",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dtrebbien",
                        "name": "dtrebbien",
                        "displayName": "Daniel Trebbien",
                        "active": true
                    },
                    "body": "Update: Tried in ZF 1.8.4",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dtrebbien",
                        "name": "dtrebbien",
                        "displayName": "Daniel Trebbien",
                        "active": true
                    },
                    "created": "2009-06-23T13:32:20.000+0000",
                    "updated": "2009-06-23T13:32:20.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/33867",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Actually... closing this as \"won't fix\".\n\nCurrently, most classes have case-sensitive keys (but will often ignore the first character of the key, particularly if a setter for the key exists). As a result, this makes merging keys that do not have matching case difficult at best, and problematic at worst (if we flatten the key to make it easier to merge, which version do we keep? and if we keep the wrong version, will the functionality continue to work?)\n\nIt's up to the developer to ensure that the keys between configuration files and\/or options arrays are consistent.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2009-08-24T14:05:42.000+0000",
                    "updated": "2009-08-24T14:05:42.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-6869\/transitions"
}