{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11042",
    "key": "ZF-11042",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Getting the full url when a default action is used"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11042\/votes",
                "votes": 2,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/2",
                "name": "Won't Fix"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2011-05-30T04:57:53.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=webermax",
                "name": "webermax",
                "displayName": "Maximilian Weber",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2011-02-06T15:20:29.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2011-05-30T07:08:00.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "it is not possible to get the full url including the default action.\r\n\r\nthis is annoying when you need to add parameters via JS\r\n\r\nZend_Controller_Router_Route_Module, line 250: \r\n{code}\r\nif (!empty($url) || $action !== $this->_defaults[$this->_actionKey]) { \r\n    if ($encode) $action = urlencode($action); \r\n    $url = '\/' . $action . $url; \r\n}\r\n{code} "
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11042\/watchers",
                "isWatching": false,
                "watchCount": 3
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                "name": "kblomqvist",
                "displayName": "Kim Blomqvist",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10490",
                    "id": 10490,
                    "name": "Zend_Controller_Router",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46858",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "body": "Umm... cannot see any attached patch. Furthermore I think this is more like an improvement. Could you provide a detailed use case as I haven't had problems with JS and Module route.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "created": "2011-05-28T07:46:00.000+0000",
                    "updated": "2011-05-28T07:46:00.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46860",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=webermax",
                        "name": "webermax",
                        "displayName": "Maximilian Weber",
                        "active": true
                    },
                    "body": "{code}\r\n\r\n\/**\r\n* url() has no option to populate the default action\r\n*\/\r\n\r\n$actionUrl = $this->view->url(...));\r\n\r\n\/\/ this is my current fix\r\nif ($actionUrl == '\/module\/controller')\r\n    $actionUrl = '\/module\/controller\/index';\r\n\r\n\/\/ method is GET\r\n$form->setAction($actionUrl);\r\n{\/code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=webermax",
                        "name": "webermax",
                        "displayName": "Maximilian Weber",
                        "active": true
                    },
                    "created": "2011-05-28T08:04:47.000+0000",
                    "updated": "2011-05-28T08:04:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46863",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gabor_nagy",
                        "name": "gabor_nagy",
                        "displayName": "Gabor Nagy",
                        "active": true
                    },
                    "body": "I try to explain a detailed use case where the current behaviour gets annoying. I have created an ajax grid component in which some parameters (e.g. filtering, ordering) are set by JavaScript code dynamically. It pulls the basic URL from a hidden form field - generated on the server side - and appends the extra parameters to it on the client side. When there are no parameters set, the generated URL coming from the server is missing the action part as described above. So in this case when the JS code tries to append the URL, it cannot figure out what the action name actually is.\r\n\r\nI used a dirty hack to fix this, that I included a dummy parameter when generating the URL on the server side so it now contains the action name every time. I think having a framework-level option to always generate the full URL would help a lot in such cases.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gabor_nagy",
                        "name": "gabor_nagy",
                        "displayName": "Gabor Nagy",
                        "active": true
                    },
                    "created": "2011-05-28T09:28:47.000+0000",
                    "updated": "2011-05-28T09:28:47.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46866",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "body": "But wouldn't this break the comfort from the user point of view? For example if I make a link to the landing page\r\n\r\n{code}\r\n<a href=\"<?php $this->url(array('controller' => 'index', 'action' => 'index'));?>home page<\/a>\r\n{code}\r\n\r\n... I will end up to the url {{\/}}. With your modifications for the router I would end up to the url {{\/index\/index}}, which is pretty verbose for the user's eyes.\r\n\r\nMaybe there should be some additional logic which to set for url view helper to support the use case here.\r\n\r\nedit: I would suggest you to make your own view helper, {{fullUrl}}.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=kblomqvist",
                        "name": "kblomqvist",
                        "displayName": "Kim Blomqvist",
                        "active": true
                    },
                    "created": "2011-05-28T10:56:27.000+0000",
                    "updated": "2011-05-28T11:04:06.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46896",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wilmoore",
                        "name": "wilmoore",
                        "displayName": "Wil Moore III (wilmoore)",
                        "active": true
                    },
                    "body": "I agree with Kim that you should override the intrinsic view helper with your own.\r\n\r\n# Add to your application config\r\n  resources.view.helperPath.some_prefix = \/full\/path\/to\/some_prefix_directory\r\n# Extend Zend_View_Helper_Url\r\n  class some_prefix_url extends Zend_View_Helper_Url {}\r\n# Implement the \"url\" method which overrides the super method\r\n  public function url(...)\r\n\r\nThe beauty of using this methodology is that you don't have to change any of your current URLs since view helpers are called in a hierarchical manner. In other words, if you provide a \"url\" helper, it is used, otherwise, the default (Zend Provided) helper of the same name is used.\r\n\r\nHere is the intrinsic method:\r\n\r\n{code}\r\n    public function url(array $urlOptions = array(), $name = null, $reset = false, $encode = true)\r\n    {\r\n        $router = Zend_Controller_Front::getInstance()->getRouter();\r\n        return $router->assemble($urlOptions, $name, $reset, $encode);\r\n    }\r\n{code}\r\n\r\nI suggest for your custom version, something like this:\r\n\r\n{code}\r\n    public function url(array $urlOptions = array(), $name = null, $reset = false, $encode = true, array $options = array())\r\n    {\r\n        if (! empty($options['full'])) { return $this->fullUrl(); \/\/ you must implement the fullUrl method }\r\n        return parent::url($urlOptions, $name, $reset, $encode);\r\n    }\r\n{code}\r\n\r\nNow, when you want to grab a full url, you simply utilize the optional $options array and provide the 'full' key with a value of true (or anything that evaluates to true).\r\n\r\nI attribute my understanding of this technique to a post by Hector Virgen: http:\/\/zend-framework-community.634137.n4.nabble.com\/Generating-URL-s-View-Helper-Action-Helper-tp3002936p3004194.html",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=wilmoore",
                        "name": "wilmoore",
                        "displayName": "Wil Moore III (wilmoore)",
                        "active": true
                    },
                    "created": "2011-05-28T23:33:02.000+0000",
                    "updated": "2011-05-28T23:36:27.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/46907",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gabor_nagy",
                        "name": "gabor_nagy",
                        "displayName": "Gabor Nagy",
                        "active": true
                    },
                    "body": "Kim, Wil, thank you for the idea and the detailed instructions!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=gabor_nagy",
                        "name": "gabor_nagy",
                        "displayName": "Gabor Nagy",
                        "active": true
                    },
                    "created": "2011-05-30T07:08:00.000+0000",
                    "updated": "2011-05-30T07:08:00.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-11042\/transitions"
}