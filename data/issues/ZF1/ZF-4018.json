{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4018",
    "key": "ZF-4018",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Zend_Email_Validate ( wrong result on idn domain )"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4018\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10241",
                    "id": 10241,
                    "description": "Minor Release",
                    "name": "1.8.0",
                    "userReleaseDate": "30\/Apr\/09",
                    "archived": false,
                    "releaseDate": "2009-04-30",
                    "released": true
                }
            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2009-03-26T13:54:52.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=brunofriedmann",
                "name": "brunofriedmann",
                "displayName": "Bruno Friedmann",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2008-08-21T01:24:06.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2013-03-08T12:03:19.000+0000"
        },
        "customfield_10041": {
            "name": "Tags",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:labels"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "With a check on \n\n$validatorHostname = new Zend_Validate_Hostname();\n$validatorEmail = new Zend_Validate_EmailAddress(Zend_Validate_Hostname::ALLOW_DNS, true, $validatorHostname);\n\n$email to test someuser@m\u00fcnche.ch return false \n'm\u00fcnche.ch' does not appear to have a valid MX record for the email address 'someuser@m\u00fcnche.ch'\n\nOr this domain as a valid MX\n\ndig mx xn--mnche-kva.ch\n\n; <<>> DiG 9.4.2-P1 <<>> mx xn--mnche-kva.ch\n;; global options:  printcmd\n;; Got answer:\n;; ->>HEADER<<- opcode: QUERY, status: NOERROR, id: 46968\n;; flags: qr rd ra; QUERY: 1, ANSWER: 1, AUTHORITY: 3, ADDITIONAL: 4\n\n;; QUESTION SECTION:\n;xn--mnche-kva.ch.              IN      MX\n\n;; ANSWER SECTION:\nxn--mnche-kva.ch.       43200   IN      MX      10 mail.xn--mnche-kva.ch.\n\n;; AUTHORITY SECTION:\nxn--mnche-kva.ch.       42170   IN      NS      ns3.ch-meta.net.\nxn--mnche-kva.ch.       42170   IN      NS      ns.ch-meta.net.\nxn--mnche-kva.ch.       42170   IN      NS      ns2.ch-meta.net.\n\n;; ADDITIONAL SECTION:\nmail.xn--mnche-kva.ch.  43200   IN      A       80.74.152.70\nns.ch-meta.net.         171770  IN      A       80.74.130.30\nns2.ch-meta.net.        171770  IN      A       80.74.130.130\nns3.ch-meta.net.        171770  IN      A       80.74.144.44\n\ntest to confirm \n$email = someuser@m\u00fcnchen.ch \nreturn false : this is true the domain doesn't have a mx record.\n\ndig mx xn--mnchen-3ya.ch return nothing ... \n\nShould be corrected before 1.6 release to my opinion\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4018\/watchers",
                "isWatching": false,
                "watchCount": 2
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                "name": "thomas",
                "displayName": "Thomas Weidner",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [
                {
                    "issueKey": "ZF-12537",
                    "issue": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-12537",
                    "type": {
                        "name": "Related",
                        "direction": "INBOUND",
                        "description": "is related to"
                    }
                }
            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/version\/10050",
                    "id": 10050,
                    "description": "Minor Release Candidate",
                    "name": "1.6.0RC2",
                    "userReleaseDate": "11\/Aug\/08",
                    "archived": true,
                    "releaseDate": "2008-08-11",
                    "released": true
                }
            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF",
                "key": "ZF",
                "name": "Zend Framework",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10140",
                    "id": 10140,
                    "name": "Zend_Validate",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23560",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=brunofriedmann",
                        "name": "brunofriedmann",
                        "displayName": "Bruno Friedmann",
                        "active": true
                    },
                    "body": "after some try it appear that the ace code in not sended to dns_get_mx it's the full human string \nso when m\u00fcnche.ch is write by the user, the dns_get_mx check have to receive this xn--mnche-kva.ch\n\nbut validatehostname complain if it is used with the ace chain ... \nxn--mnche-kva.ch is not valid 'xn--mnche-kva.ch' appears to be a DNS hostname but contains a dash (-) in an invalid position\n'xn--mnche-kva.ch' appears to be a local network name but local network names are not allowed --->>> this is wrong a local host would be mypc.mydomain.mytld \n\nNot an easy case ... ",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=brunofriedmann",
                        "name": "brunofriedmann",
                        "displayName": "Bruno Friedmann",
                        "active": true
                    },
                    "created": "2008-08-21T01:56:05.000+0000",
                    "updated": "2008-08-21T01:56:05.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/23561",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=brunofriedmann",
                        "name": "brunofriedmann",
                        "displayName": "Bruno Friedmann",
                        "active": true
                    },
                    "body": "Information about ICN ( switzerland base ) \nhttp:\/\/nic.switch.ch\/reg\/ocView.action?request_locale=en\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=brunofriedmann",
                        "name": "brunofriedmann",
                        "displayName": "Bruno Friedmann",
                        "active": true
                    },
                    "created": "2008-08-21T01:58:19.000+0000",
                    "updated": "2008-08-21T01:58:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/29754",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "IDN is supported for CH.\nPunycode is not accepted for email adresses as \"--\" is not allowed for the 3rd\/4th character within domain names as per definition within the domain holder.\n\nOptional support for PunyCode is not an issue of Zend_Validate_Email and filled within another independent issue.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2009-03-26T13:54:51.000+0000",
                    "updated": "2009-03-26T13:54:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37410",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=max_b",
                        "name": "max_b",
                        "displayName": "Max Barel",
                        "active": true
                    },
                    "body": "Though this issue is marked as fixed\/resolved, I think it's not. Or I need clearer explanation.\r\nHere is a simple test case:\r\nmax@xn--iphignie-f1a.com does validate as it should, no problem due to hyphen in 3rd char.\r\nmax@iphig\u00e9nie.com does not validate IF setValidateMx(true).\r\n\r\nSo there is a difference in the way both addresses are processed while it should not since the second should be reduced to the first.\r\n\r\nCan someone clarify or else reopen the issue?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=max_b",
                        "name": "max_b",
                        "displayName": "Max Barel",
                        "active": true
                    },
                    "created": "2010-01-05T14:21:51.000+0000",
                    "updated": "2010-01-05T14:21:51.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37411",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=max_b",
                        "name": "max_b",
                        "displayName": "Max Barel",
                        "active": true
                    },
                    "body": "Forgot to mention I just tested on 1.9",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=max_b",
                        "name": "max_b",
                        "displayName": "Max Barel",
                        "active": true
                    },
                    "created": "2010-01-05T14:23:17.000+0000",
                    "updated": "2010-01-05T14:23:17.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37412",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=max_b",
                        "name": "max_b",
                        "displayName": "Max Barel",
                        "active": true
                    },
                    "body": "Well, I dig into and found the point.\r\nHostname validation works the reverse: it convert xn-- form to utf8 then checks the validity of the utf8 string along definition for the given tld.\r\nThis is ok for testing the domain. Definitely not for the validateMx step since it uses dns_get_mx without prior conversion to punycode.\r\n\r\nSo the documentation is wrong stating that the validator is able to check IDN. It is only able to statically check the string, not to step on DNS part.\r\n\r\nAlongside no way to use mail with an utf8 IDN. It should be converted to xn-- outside of Zend.\r\n\r\nToo bad the punycode conversion is only the decoding half.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=max_b",
                        "name": "max_b",
                        "displayName": "Max Barel",
                        "active": true
                    },
                    "created": "2010-01-05T15:21:03.000+0000",
                    "updated": "2010-01-05T15:21:03.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37413",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "Validating MX means that the given hostname is processed by getmxrr().\r\n\r\nWhen getmxrr() resolves Punycode but not IDN I would say that there is a problem with your host and not with getmxrr().\r\n\r\nI would understand when punycode does not work but IDN.\r\nI can not understand why the reverse does not.\r\n\r\nEighter way... what ever you give a input is processed by getmxrr() which itself requests this information at your host. So for me it seems like there is a host problem.\r\n\r\nThe original issue has been fixed as CH did not have an attached IDN and this case is tested in our testbed now.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-01-05T15:51:19.000+0000",
                    "updated": "2010-01-05T15:51:19.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37414",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=max_b",
                        "name": "max_b",
                        "displayName": "Max Barel",
                        "active": true
                    },
                    "body": "Hi Thomas,\r\nto be sure we both use the same definition lets state:\r\npunycode:  xn--iphignie-f1a.com (or do you call this IDN?)\r\nIDN: iphig\u00e9nie.com\r\n\r\nThe first is correctly resolved by getmxrr() as expected since it conform to legacy domain naming.\r\nThe second is not, and I see nowhere it should. No documentation states that getmxrr() does encode utf8 punycode.\r\n\r\nDo you agree?\r\nIf yes, we also agree that one can't validate IDN in utf8 string form.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=max_b",
                        "name": "max_b",
                        "displayName": "Max Barel",
                        "active": true
                    },
                    "created": "2010-01-05T16:13:33.000+0000",
                    "updated": "2010-01-05T16:13:33.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37415",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "body": "As said before:\r\nIf the host you are working with supports IDN depends on the host itself, and not on getmxrr().\r\n\r\nA IDN domain must not be converted to punycode for requests. Punycode is only needed for domains which do not support IDN.\r\n\r\nNote that IDN domains are also not converted to punycode by your host.\r\n\r\nSo: No, I do not agree and tested it with verizon.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=thomas",
                        "name": "thomas",
                        "displayName": "Thomas Weidner",
                        "active": true
                    },
                    "created": "2010-01-05T17:03:25.000+0000",
                    "updated": "2010-01-05T17:03:25.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/37418",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=max_b",
                        "name": "max_b",
                        "displayName": "Max Barel",
                        "active": true
                    },
                    "body": "This is not the understanding I had.\r\nI though any effective DNS request should be in punycode form (xn--iphignie-f1a.com). And that the conversion should be handled at application level. You are saying quite the opposite. For a TLD to support IDN it should accept xn-- starting domain and define a character set allowed. I'll have to check this out further.\r\n\r\nAnyway, i tested this both on my OS X 10.6 dev host and on linux debian on the production server. I would like to know on which environment you successfully test an IDN in utf8 string format.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=max_b",
                        "name": "max_b",
                        "displayName": "Max Barel",
                        "active": true
                    },
                    "created": "2010-01-05T17:28:48.000+0000",
                    "updated": "2010-01-05T17:28:48.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF-4018\/transitions"
}