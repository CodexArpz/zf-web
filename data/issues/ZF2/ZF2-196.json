{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-196",
    "key": "ZF2-196",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Multipart type respected in Zend\\Mail\\Message::setBody"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/4",
                "name": "Improvement",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-196\/votes",
                "votes": 1,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/8",
                "name": "Issue Moved"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-10-08T20:15:25.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=piotrekr",
                "name": "piotrekr",
                "displayName": "Piotrek Ryba\u0142towski",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2012-03-07T10:41:49.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-10-08T20:15:25.000+0000"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "When calling Zend\\Mail\\Message::setBody providing a Mime Message object with multipart, in line 414 any multipart settings in Mime Message are ignored and _multipart\/mixed_ is put in statically. I guess _multipart\/alternative_ would be used more often to not display HTML and plain text version at one time, but the most ideal situation would be to have it set as an option.\r\n\r\nThanks!"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-196\/watchers",
                "isWatching": false,
                "watchCount": 5
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "mail"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=maks3w",
                "name": "maks3w",
                "displayName": "Maks 3w",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/attachment\/15133",
                    "filename": "zf2-multipart-mail.php",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=steffen",
                        "name": "steffen",
                        "displayName": "Steffen Weber",
                        "active": true
                    },
                    "created": "2012-06-12T17:45:09.000+0000",
                    "size": 814,
                    "mimeType": "application\/x-php",
                    "content": "http:\/\/fw02.zend.com\/issues\/secure\/attachment\/15133\/zf2-multipart-mail.php"
                }
            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF2",
                "key": "ZF2",
                "name": "Zend Framework 2.0",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10552",
                    "id": 10552,
                    "name": "Zend\\Mail",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51051",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=steffen",
                        "name": "steffen",
                        "displayName": "Steffen Weber",
                        "active": true
                    },
                    "body": "I have run into the same issue. It is currently impossible to send an email that contains HTML and a text fallback.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=steffen",
                        "name": "steffen",
                        "displayName": "Steffen Weber",
                        "active": true
                    },
                    "created": "2012-06-10T08:35:29.000+0000",
                    "updated": "2012-06-10T08:35:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51078",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=maks3w",
                        "name": "maks3w",
                        "displayName": "Maks 3w",
                        "active": true
                    },
                    "body": "Could you provide a example to reproduce the issue?",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=maks3w",
                        "name": "maks3w",
                        "displayName": "Maks 3w",
                        "active": true
                    },
                    "created": "2012-06-12T16:16:11.000+0000",
                    "updated": "2012-06-12T16:16:11.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51080",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=steffen",
                        "name": "steffen",
                        "displayName": "Steffen Weber",
                        "active": true
                    },
                    "body": "The attached demo script creates the following output with \"Content-Type: multipart\/mixed\" although \"Content-Type: multipart\/alternative\" would be desired:\r\n\r\nReturn-Path: <example@example.org>\r\nDate: Tue, 12 Jun 2012 19:42:56 +0200\r\nFrom: example@example.org\r\nSubject: ZF2 Multipart Mail\r\nMime-Version: 1.0\r\nContent-Type: multipart\/mixed;\r\n boundary=\"=_4ed23c87057835f27922e2478cd8eeac\"\r\nTo: example@example.org\r\nSender: \r\nCc: \r\n\r\nThis is a message in Mime Format.  If you see this, your mail reader does not support this format.\r\n\r\n--=_4ed23c87057835f27922e2478cd8eeac\r\nContent-Type: text\/plain; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\nPlain Text\r\n--=_4ed23c87057835f27922e2478cd8eeac\r\nContent-Type: text\/html; charset=UTF-8\r\nContent-Transfer-Encoding: quoted-printable\r\n\r\n<b>HTML<\/b>\r\n--=_4ed23c87057835f27922e2478cd8eeac--\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=steffen",
                        "name": "steffen",
                        "displayName": "Steffen Weber",
                        "active": true
                    },
                    "created": "2012-06-12T17:45:09.000+0000",
                    "updated": "2012-06-12T17:46:56.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51082",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=maks3w",
                        "name": "maks3w",
                        "displayName": "Maks 3w",
                        "active": true
                    },
                    "body": "As workaround you can put the following after $mail->setBody($message);\r\n\r\n$mail->headers()->get('content-type')->setType('multipart\/alternative')",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=maks3w",
                        "name": "maks3w",
                        "displayName": "Maks 3w",
                        "active": true
                    },
                    "created": "2012-06-12T19:25:14.000+0000",
                    "updated": "2012-06-12T19:25:14.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51083",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=steffen",
                        "name": "steffen",
                        "displayName": "Steffen Weber",
                        "active": true
                    },
                    "body": "Thank you for the workaround!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=steffen",
                        "name": "steffen",
                        "displayName": "Steffen Weber",
                        "active": true
                    },
                    "created": "2012-06-12T20:49:49.000+0000",
                    "updated": "2012-06-12T20:49:49.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51819",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stevetalbot",
                        "name": "stevetalbot",
                        "displayName": "Steve Talbot",
                        "active": true
                    },
                    "body": "Another workaround that I'm using successfully is to embed a multipart\/alternative object inside a multipart\/mixed message.  This allows you to have two alternative message bodies (HTML and plain text) and add attachments.  Hope this helps someone:\r\n\r\nuse Zend\\Mail\\Message as EmailMessage;\r\nuse Zend\\Mime\\Message as MimeMessage;\r\nuse Zend\\Mime\\Part as MimePart;\r\n\r\n\/\/ HTML message\r\n$htmlPart = new MimePart($bodyHtml);\r\n$htmlPart->type = 'text\/html';\r\n\r\n\/\/ Plain text message\r\n$textPart = new MimePart($bodyText);\r\n$textPart->type = 'text\/plain';\r\n\r\n\/\/ Assemble them into a multipart\/alternative object\r\n$alternatives = new MimeMessage();\r\n$alternatives->setParts(array($textPart, $htmlPart));\r\n$alternativesPart = new MimePart($alternatives->generateMessage());\r\n$alternativesPart->type = \"multipart\/alternative;\\n boundary=\\\"\".$alternatives->getMime()->boundary().\"\\\"\";\r\n\r\n\/\/ Now add the multipart\/alternative object to a multipart\/mixed object\r\n$body = new MimeMessage();\r\n$body->addPart($alternativesPart);\r\n\r\n\/\/ Add other parts (attachments) here\r\n\r\n\/\/ Create the email message\r\n$email = new EmailMessage();\r\n$email->setBody($body);\r\n\r\n\/\/ Then set your to address, from address and send it\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=stevetalbot",
                        "name": "stevetalbot",
                        "displayName": "Steve Talbot",
                        "active": true
                    },
                    "created": "2012-09-06T09:11:43.000+0000",
                    "updated": "2012-09-06T09:11:43.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/52091",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "This issue has been closed on Jira and moved to GitHub for issue tracking.  To continue following the resolution of this issues, please visit: https:\/\/github.com\/zendframework\/zf2\/issues\/2460",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2012-10-08T20:15:25.000+0000",
                    "updated": "2012-10-08T20:15:25.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-196\/transitions"
}