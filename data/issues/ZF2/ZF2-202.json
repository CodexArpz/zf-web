{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-202",
    "key": "ZF2-202",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "PHP Fatal Error in Zend\\Db\\Adapter\\Driver\\Pdo\\Connection::getDefaultSchema() when using a Postgresql database"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-202\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-07-08T20:59:46.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=rhunwicks",
                "name": "rhunwicks",
                "displayName": "Roger Hunwicks",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2012-03-07T20:31:47.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-07-08T20:59:46.000+0000"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "There is a fatal error in Zend\\Db\\Adapter\\Driver\\Pdo\\Connection::getDefaultSchema() when using a Postgresql database:\r\n\r\nPHP Fatal error:  Call to a member function fetch_row() on a non-object in \/vendor\/ZendFramework\/library\/Zend\/Db\/Adapter\/Driver\/Pdo\/Connection.php on line 114\r\n\r\nIt happens because getDefaultSchema() executes \"SELECT DATABASE()\" to get the default schema and this function does not exist in Postgresql.\r\n\r\nYou can fix it by checking that the query was successful before attempting the fetch_row(). I will submit a pull request to that effect.\r\n\r\nHowever, it is not clear that this code belongs here at all. Is the \"default schema\" concept generic enough to be here. I know that Postgresql has a schema search path, rather than a single schema. Consequently the default schema that new objects are created in will be the first schema in the search path that exists (there is normally a $user entry in the search path that is ignored if there is no schema matching the database username). However if you address an existing object without schema qualification then you will get the first object with the correct name that can be found along the search path.\r\n\r\nWe could attempt to be more complicated by checking for the first real schema in the search path, but there are performance implications to this and getDefaultSchema may be called a lot (I'm only guessing). In any case, my preference would be for getDefaultSchema() to return false (which is what my pull request does), or possibly null, on the basis that Postgresql doesn't really have a default schema.\r\n\r\nNote that this solution doesnt address the question of whether database-specific SQL (\"SELECT DATABASE()\")should appear in the generic PDO driver."
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-202\/watchers",
                "isWatching": false,
                "watchCount": 1
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                "name": "ralph",
                "displayName": "Ralph Schindler",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF2",
                "key": "ZF2",
                "name": "Zend Framework 2.0",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10520",
                    "id": 10520,
                    "name": "Zend\\Db",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50148",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "Fixed and merged into pull request 934",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2012-03-26T19:19:45.000+0000",
                    "updated": "2012-03-26T19:19:45.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/50757",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=hhgag",
                        "name": "hhgag",
                        "displayName": "Hasan H. G\u00fcrsoy",
                        "active": true
                    },
                    "body": "Hi Ralph,\r\n\r\nbugfix has been overwritten, see:\r\n\r\nhttps:\/\/github.com\/zendframework\/zf2\/blob\/master\/library\/Zend\/Db\/Adapter\/Driver\/Pdo\/Connection.php#L127\r\n\r\n",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=hhgag",
                        "name": "hhgag",
                        "displayName": "Hasan H. G\u00fcrsoy",
                        "active": true
                    },
                    "created": "2012-05-24T16:52:42.000+0000",
                    "updated": "2012-05-24T16:52:42.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51010",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=maks3w",
                        "name": "maks3w",
                        "displayName": "Maks 3w",
                        "active": true
                    },
                    "body": "Hi Hasan\r\n\r\nWhat's the problem?\r\n\r\nYour patch is intact.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=maks3w",
                        "name": "maks3w",
                        "displayName": "Maks 3w",
                        "active": true
                    },
                    "created": "2012-06-06T15:50:08.000+0000",
                    "updated": "2012-06-06T15:50:08.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51180",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=leftbrained",
                        "name": "leftbrained",
                        "displayName": "Chris Testroet",
                        "active": true
                    },
                    "body": "I see two existing problems with Pdo\\Connection::getDefaultSchema()\r\n\r\n1) It uses \"SELECT DATABASE()\" to get the current schema, afaik this only works on MySQL. The SQL Standard says it should be \"SELECT CURRENT_SCHEMA\". PostgreSQL follows the standard in this respect.\r\n\r\n2) It uses the method PDOStatement::fetch_row() , which doesn't exist. This appears to have been copy\/pasted from Mysqli\\Connection. This method should use PDOStatement::fetchColumn()\r\n\r\nBoth of these are addressed in [PR 1485|https:\/\/github.com\/zendframework\/zf2\/pull\/1485]. The PR is having a tough time getting reviewed by Ralph, as it's so large.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=leftbrained",
                        "name": "leftbrained",
                        "displayName": "Chris Testroet",
                        "active": true
                    },
                    "created": "2012-06-21T18:03:24.000+0000",
                    "updated": "2012-06-21T18:03:24.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51289",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=leftbrained",
                        "name": "leftbrained",
                        "displayName": "Chris Testroet",
                        "active": true
                    },
                    "body": "This issue was resolved in PR [#1613|https:\/\/github.com\/zendframework\/zf2\/pull\/1613]",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=leftbrained",
                        "name": "leftbrained",
                        "displayName": "Chris Testroet",
                        "active": true
                    },
                    "created": "2012-07-08T20:57:29.000+0000",
                    "updated": "2012-07-08T20:57:29.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-202\/transitions"
}