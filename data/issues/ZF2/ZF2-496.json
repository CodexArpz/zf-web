{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-496",
    "key": "ZF2-496",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Attached documents to message objects are corrupt"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-496\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/8",
                "name": "Issue Moved"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-10-08T20:14:49.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mithras",
                "name": "mithras",
                "displayName": "Jurian Sluiman",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2012-08-23T15:36:26.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-10-08T20:14:49.000+0000"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "See http:\/\/zend-framework-community.634137.n4.nabble.com\/Attachment-within-emails-are-having-encoding-issues-td4656174.html and this IRC log (23rd August):\r\n\r\n{quote}\r\n<weierophinney>: jurians: I was lookinag at your mail attachment issue. What's interesting is that Zend\\Mime, functionally, hasn't changed between ZF1 and ZF2. The only difference is how messages work. I'm guessing there's some difference in how ZF1's mail class did attachments -- in ZF2, I'm simply saying that if we get a Mime\\Message as the body to use it.\r\n\r\n<weierophinney>: jurians: I'll see if I can track it down quickly; if not, it may need to wait for a bugfix release.\r\n\r\n<weierophinney>: jurians: interesting. In ZF1, Zend_Mail extended Zend_Mime_Message. I'm stymied; no clue why it's not working in ZF1. Only thing I can think of is that Zend_Mail_Transport_Abstract was doing the part assembly (aggregating headers, boundaries, and content), and that Mime\\Message doesn't do that naturally.\r\n{quote}\r\n\r\nTask: attach a document (example a pdf) to the mail message and send it via the transport layer\r\nExpected result: attachment can be opened in an email client\r\nActual result: attachment is corrupt and cannot be openend.\r\n\r\nSimilar code in Zend Framework 1 worked as expected and since then not much changed in the Zend\\Mime part.\r\n\r\nExample code to reproduce in ZF2:\r\n\r\n{code}\r\n$text = new Mime\\Part('Hello world');\r\n$text->type = 'text\/plain';\r\n\r\n$html = new Mime\\Part('<p>Hello world<\/p>');\r\n$html->type = 'text\/html';\r\n\r\n$data = file_get_contents('\/path\/to\/my\/file.pdf');\r\n$pdf  = new Mime\\Part($data);\r\n$pdf->type = 'application\/pdf';\r\n$pdf->filename = 'My File.pdf';\r\n$pdf->disposition = Mime\\Mime::DISPOSITION_ATTACHMENT;\r\n\r\n$body = new Mime\\Message;\r\n$body->setParts(array($text, $html, $pdf));\r\n\r\n$message = new Message;\r\n$message->addTo('some@example', 'John Doe');\r\n$message->setBody($body);\r\n\r\n$transport->send($message);\r\n{code}"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/2",
                "name": "Critical"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-496\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/6",
                "name": "Closed"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF2",
                "key": "ZF2",
                "name": "Zend Framework 2.0",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10552",
                    "id": 10552,
                    "name": "Zend\\Mail",
                    "isAssigneeTypeValid": false
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10556",
                    "id": 10556,
                    "name": "Zend\\Mime",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51748",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=koen",
                        "name": "koen",
                        "displayName": "Koen Pieters",
                        "active": true
                    },
                    "body": "Found a work-a-round for this, the pdf is encoded '8bit'.\r\nIf you add encoding as 'quoted-printable' or 'base64' the attachment will work.\r\n{code}\r\n$pdf->encoding = 'quoted-printable'; \r\n{code}",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=koen",
                        "name": "koen",
                        "displayName": "Koen Pieters",
                        "active": true
                    },
                    "created": "2012-08-29T11:36:37.000+0000",
                    "updated": "2012-08-29T11:36:37.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51749",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "I suspect that ZF1 was making messages quoted-printable by default.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2012-08-29T14:10:29.000+0000",
                    "updated": "2012-08-29T14:10:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51750",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mithras",
                        "name": "mithras",
                        "displayName": "Jurian Sluiman",
                        "active": true
                    },
                    "body": "I have experimented with base64 encoded mime types, but my guess was to encode it myself.\r\n\r\n{code}\r\n$data = file_get_contents('\/path\/to\/my\/file.pdf');\r\n$data = base64_encode($data);\r\n$pdf  = new Mime\\Part($data);\r\n$pdf->type = 'application\/pdf';\r\n$pdf->filename = 'My File.pdf';\r\n$pdf->encoding = Mime\\Mime::ENCODING_BASE64;\r\n$pdf->disposition = Mime\\Mime::DISPOSITION_ATTACHMENT;\r\n{code}\r\n\r\nWith the comment of Koen I suspect I don't need to encode the data myself. Because I switched to Swift Mailer, it's quite some work to revert it: in the next week I will test this without a base64_encode() from myself.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=mithras",
                        "name": "mithras",
                        "displayName": "Jurian Sluiman",
                        "active": true
                    },
                    "created": "2012-08-29T14:17:59.000+0000",
                    "updated": "2012-08-29T14:17:59.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/52019",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "body": "This issue has been closed on Jira and moved to GitHub for issue tracking.  To continue following the resolution of this issues, please visit: https:\/\/github.com\/zendframework\/zf2\/issues\/2540",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ralph",
                        "name": "ralph",
                        "displayName": "Ralph Schindler",
                        "active": true
                    },
                    "created": "2012-10-08T20:14:49.000+0000",
                    "updated": "2012-10-08T20:14:49.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-496\/transitions"
}