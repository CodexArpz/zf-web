{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-186",
    "key": "ZF2-186",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "Config::merge() replacing numeric config settings"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-186\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/1",
                "name": "Fixed"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-03-03T13:40:56.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=joust",
                "name": "joust",
                "displayName": "Artur Bodera",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2012-03-03T10:06:05.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-03-03T13:40:56.000+0000"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "h3. The problem\r\nIn a scenario, where a config value is a numerical list (numerical array), {{Config::merge()}} overwrites individual items in the source list instead of appending to it.\r\n\r\nh3. Real-world scenario\r\n{{Config}} is probably most often used to configure components and modules. Numeric keys are rarely used, but if present, usually describe a list of possible items. \r\n\r\nAn example for that could be a {{Navigation}} container. A {{Navigation}} container is configured by an ordered list (i.e. numerical array) describing different pages. Let's assume that *ModuleA* provides a list of pages, and *ModuleB* provides its own list of pages.\r\n\r\nWhen merging two Config objects from two different modules, the items (pages) from ModuleB will override (replace pages) from ModuleA, which is not an expected behavior.\r\n\r\nh3. Sample script\r\n{code:php}\r\n\r\n$arrayA = array(\r\n    'flag' => true,\r\n    'text' => 'foo',\r\n    'list' => array( 'a', 'b', 'c' ),\r\n    'aSpecific' => 12\r\n);\r\n\r\n$arrayB = array(\r\n    'flag' => false,\r\n    'text' => 'bar',\r\n    'list' => array( 'd', 'e' ),\r\n    'bSpecific' => 100\r\n);\r\n\r\n$configA = new Config($arrayA);\r\n$configB = new Config($arrayB);\r\n\r\n$configA->merge($configB); \/\/ merge B onto A\r\n\r\n$expectedMergeResult = array(\r\n    'flag' => false,\r\n    'text' => 'bar',\r\n    'list' => array( 'a', 'b', 'c', 'd', 'e' ),\r\n    'aSpecific' => 12,\r\n    'bSpecific' => 100\r\n);\r\n\r\n\r\n{code}\r\n\r\nh3. How does it work outside of ZF?\r\nIn pure PHP implementation, the primary difference between {{array_merge_recursive()}} and {{array_replace_recursive()}} is that _merge will append (extend) nested, numerical arrays. The other function, _replace, will override numerical values. {{Config::merge()}} method does perform similar operation to {{array_replace_recursive()}} but does not provide any means to select a behavior for handling lists.\r\n\r\nh3. The solution\r\nThe default {{Config::merge()}} behavior needs to be compatible with {{array_merge_recursive()}} - i.e. it has to recognize lists and append their values. For cases when one needs to have a {{replace}} behavior, a separate function will be provided - {{Config::replace()}}\r\n\r\nh3. Differences between Config::merge() and array_merge_recursive()\r\n\r\nThe most important difference between those functions is how they handle string values.\r\n\r\nLet's assume we have following arrays:\r\n{code}\r\n$arrayA = array( 'foo' => 1, 'bar' => 'text' );\r\n$arrayB = array( 'bar' => 'other text' );\r\n{code}\r\n\r\nWhen given duplicate keys and string values {{array_merge_recursive()}} will create an array of values:\r\n{code}\r\nprint_r(array_merge_recursive($arrayA,$arrayB));\r\n\/\/ Array\r\n\/\/(\r\n\/\/    [foo] => 1\r\n\/\/    [bar] => Array\r\n\/\/        (\r\n\/\/            [0] => text\r\n\/\/            [1] => other text\r\n\/\/        )\r\n\/\/\r\n\/\/)\r\n{code}\r\n\r\nWith duplicate keys {{Config::merge()}} will overwrite the value, regardless of its type :\r\n{code}\r\n$configA = new Config($arrayA);\r\n$configB = new Config($arrayB);\r\n$configA->merge($configB);\r\n\r\nprint_r($configA->toArray());\r\n\/\/ Array\r\n\/\/(\r\n\/\/    [foo] => 1\r\n\/\/    [bar] => other text\r\n\/\/)\r\n{code}\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/3",
                "name": "Major"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-186\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [
                "Config",
                "merge"
            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=joust",
                "name": "joust",
                "displayName": "Artur Bodera",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF2",
                "key": "ZF2",
                "name": "Zend Framework 2.0",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10530",
                    "id": 10530,
                    "name": "Zend\\Config",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/49896",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=joust",
                        "name": "joust",
                        "displayName": "Artur Bodera",
                        "active": true
                    },
                    "body": "Fixed in https:\/\/github.com\/zendframework\/zf2\/pull\/880",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=joust",
                        "name": "joust",
                        "displayName": "Artur Bodera",
                        "active": true
                    },
                    "created": "2012-03-03T13:40:56.000+0000",
                    "updated": "2012-03-03T13:40:56.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-186\/transitions"
}