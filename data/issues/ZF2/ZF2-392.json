{
    "expand": "html",
    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-392",
    "key": "ZF2-392",
    "fields": {
        "summary": {
            "name": "summary",
            "type": "java.lang.String",
            "value": "ZF2 Beta 5 Zend\\InputFilter\\Input returns only the string \"Array\" when using $inputFilter->getValue() on multicheckbox element"
        },
        "timetracking": {
            "name": "timetracking",
            "type": "com.atlassian.jira.issue.fields.TimeTrackingSystemField"
        },
        "issuetype": {
            "name": "issuetype",
            "type": "com.atlassian.jira.issue.issuetype.IssueType",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issueType\/1",
                "name": "Bug",
                "subtask": false
            }
        },
        "votes": {
            "name": "votes",
            "type": "com.atlassian.jira.issue.fields.VotesSystemField",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-392\/votes",
                "votes": 0,
                "hasVoted": false
            }
        },
        "security": {
            "name": "security",
            "type": "com.atlassian.jira.issue.security.IssueSecurityLevel"
        },
        "resolution": {
            "name": "resolution",
            "type": "com.atlassian.jira.issue.resolution.Resolution",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/resolution\/6",
                "name": "Not an Issue"
            }
        },
        "fixVersions": {
            "name": "fixVersions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "resolutiondate": {
            "name": "resolutiondate",
            "type": "java.util.Date",
            "value": "2012-07-31T18:37:02.000+0000"
        },
        "reporter": {
            "name": "reporter",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dbierer",
                "name": "dbierer",
                "displayName": "Doug Bierer",
                "active": true
            }
        },
        "created": {
            "name": "created",
            "type": "java.util.Date",
            "value": "2012-07-11T19:12:42.000+0000"
        },
        "updated": {
            "name": "updated",
            "type": "java.util.Date",
            "value": "2012-07-31T18:37:02.000+0000"
        },
        "description": {
            "name": "description",
            "type": "java.lang.String",
            "value": "Created a form with the following definition for a multicheckbox form element:\r\n\r\n\r\n$this->add(array(\r\n    'name' => 'users',\r\n    'attributes' => array(\r\n        'type'  => 'multicheckbox',\r\n        'options' => $users,\r\n    ),\r\n));\r\n\r\n$users is an associative array consisting of array('email_address' => 'email_address')\r\n\r\nIn the Zend\\InputFilter class definition, here is the corresponding Input definition:\r\n\r\n\r\n$users = new Input('users');\r\n$users->getFilterChain()->attachByName('StripTags');\r\n$users->setRequired(FALSE);\r\n$users->allowEmpty(TRUE);\r\n\r\nIn the controller, assigned the input filter to the form and validated.  Validated OK.  \r\nTested the return value after form submission.  \r\nphpinfo() shows the proper valued being returned when multiple checkboxes are checked:\r\n\r\n_POST[\"users\"]\t\r\nArray\r\n(\r\n    [0] => test3@zend.com\r\n    [1] => test@zend.com\r\n)\r\n\r\nThe return value from \"$inputFilter->getValue('users')\" only returns this, however:\r\n\r\nstring(5) \"Array\"\r\n\r\nUsing \"$inputFilter->getRawValue('users')\" on the other hand returns this:\r\n\r\n\r\narray(2) {\r\n  [0]=>\r\n  string(14) \"test3@zend.com\"\r\n  [1]=>\r\n  string(13) \"test@zend.com\"\r\n}\r\n\r\n"
        },
        "priority": {
            "name": "priority",
            "type": "com.atlassian.jira.issue.priority.Priority",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/priority\/4",
                "name": "Minor"
            }
        },
        "duedate": {
            "name": "duedate",
            "type": "java.util.Date"
        },
        "customfield_10022": {
            "name": "Fix Version Priority",
            "type": "com.atlassian.jira.plugin.system.customfieldtypes:select"
        },
        "watcher": {
            "name": "watcher",
            "type": "watcher",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-392\/watchers",
                "isWatching": false,
                "watchCount": 0
            }
        },
        "worklog": {
            "name": "worklog",
            "type": "worklog",
            "value": [

            ]
        },
        "status": {
            "name": "status",
            "type": "com.atlassian.jira.issue.status.Status",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/status\/5",
                "name": "Resolved"
            }
        },
        "labels": {
            "name": "labels",
            "type": "com.atlassian.jira.issue.label.Label",
            "value": [

            ]
        },
        "assignee": {
            "name": "assignee",
            "type": "com.opensymphony.user.User",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                "name": "matthew",
                "displayName": "Matthew Weier O'Phinney",
                "active": true
            }
        },
        "links": {
            "name": "links",
            "type": "issuelinks",
            "value": [

            ]
        },
        "attachment": {
            "name": "attachment",
            "type": "attachment",
            "value": [

            ]
        },
        "sub-tasks": {
            "name": "sub-tasks",
            "type": "issuelinks",
            "value": [

            ]
        },
        "versions": {
            "name": "versions",
            "type": "com.atlassian.jira.project.version.Version",
            "value": [

            ]
        },
        "project": {
            "name": "project",
            "type": "com.atlassian.jira.project.Project",
            "value": {
                "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/project\/ZF2",
                "key": "ZF2",
                "name": "Zend Framework 2.0",
                "roles": {

                }
            }
        },
        "components": {
            "name": "components",
            "type": "com.atlassian.jira.bc.project.component.ProjectComponent",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/component\/10821",
                    "id": 10821,
                    "name": "Zend\\InputFilter",
                    "isAssigneeTypeValid": false
                }
            ]
        },
        "comment": {
            "name": "comment",
            "type": "com.atlassian.jira.issue.fields.CommentSystemField",
            "value": [
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51320",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "Can you check this against current master? I believe this may be fixed already.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2012-07-11T20:03:35.000+0000",
                    "updated": "2012-07-11T20:03:35.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51321",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dbierer",
                        "name": "dbierer",
                        "displayName": "Doug Bierer",
                        "active": true
                    },
                    "body": "Matthew -- will do.  Keeping busy? ;-)",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dbierer",
                        "name": "dbierer",
                        "displayName": "Doug Bierer",
                        "active": true
                    },
                    "created": "2012-07-11T20:29:29.000+0000",
                    "updated": "2012-07-11T20:29:29.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51322",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dbierer",
                        "name": "dbierer",
                        "displayName": "Doug Bierer",
                        "active": true
                    },
                    "body": "Matthew -- Just downloaded latest master zendframework-zf2-release-2.0.0beta5-216-gce974df.zip.  Still has the same problem.  Sorry!",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=dbierer",
                        "name": "dbierer",
                        "displayName": "Doug Bierer",
                        "active": true
                    },
                    "created": "2012-07-11T20:45:40.000+0000",
                    "updated": "2012-07-11T20:45:40.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51498",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ithier",
                        "name": "ithier",
                        "displayName": "Ithier de Lestrange",
                        "active": true
                    },
                    "body": "Also when I validate the form (with the InputFilter), I have the following message:\r\n\r\nNotice: Array to string conversion in [...]\\zf2-tutorial\\vendor\\zendframework\\zendframework\\library\\Zend\\Filter\\StripTags.php on line 181\r\n\r\nI think that the InputFilter doesn't know how to process array of values (instead of string values). ZF1 was doing it right with this code (from function Zend_Filter_Input::_filterRule)\r\n\r\n{code}\r\n        if (is_array($this->_data[$field])) {\r\n            foreach ($this->_data[$field] as $key => $value) {\r\n                $this->_data[$field][$key] = $filterRule[self::FILTER_CHAIN]->filter($value);\r\n            }\r\n        } else {\r\n            $this->_data[$field] =\r\n                $filterRule[self::FILTER_CHAIN]->filter($this->_data[$field]);\r\n        } \r\n{code}\r\n\r\nI hope it can help.",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=ithier",
                        "name": "ithier",
                        "displayName": "Ithier de Lestrange",
                        "active": true
                    },
                    "created": "2012-07-31T15:31:33.000+0000",
                    "updated": "2012-07-31T16:49:18.000+0000"
                },
                {
                    "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/comment\/51504",
                    "author": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "body": "The problem is the filter -- which is _not_ added by default. StripTags is assuming it's operating on a string, when, in fact, you're working with an array. If you want to filter all values in the array, you need to do a specialized filter -- a callback would likely work:\r\n{code}\r\n$input->getFilterChain()->attach(function ($value) {\r\n    $filter = new StripTags();\r\n    if (is_scalar($value)) {\r\n        return $filter->filter($value);\r\n    }\r\n    if (is_array($value)) {\r\n        foreach ($value as $key => $item) {\r\n            $value[$key] = $filter->filter($item);\r\n        }\r\n        return $value;\r\n    }\r\n    return $value;\r\n});\r\n{code}\r\n\r\nSince I don't see the StripTags filter in the default setup, I'm marking this as \"not an issue\".",
                    "updateAuthor": {
                        "self": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/user?username=matthew",
                        "name": "matthew",
                        "displayName": "Matthew Weier O'Phinney",
                        "active": true
                    },
                    "created": "2012-07-31T18:36:46.000+0000",
                    "updated": "2012-07-31T18:36:46.000+0000"
                }
            ]
        }
    },
    "transitions": "http:\/\/fw02.zend.com\/issues\/rest\/api\/latest\/issue\/ZF2-392\/transitions"
}